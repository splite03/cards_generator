(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var Tm=Object.defineProperty,Sm=(e,t,n)=>t in e?Tm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,et=(e,t,n)=>(Sm(e,typeof t!="symbol"?t+"":t,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();/**
* @vue/shared v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function lc(e,t){const n=new Set(e.split(","));return t?r=>n.has(r.toLowerCase()):r=>n.has(r)}const yt={},ar=[],ye=()=>{},Cm=()=>!1,qi=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),uc=e=>e.startsWith("onUpdate:"),Kt=Object.assign,hc=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},Im=Object.prototype.hasOwnProperty,at=(e,t)=>Im.call(e,t),K=Array.isArray,cr=e=>xs(e)==="[object Map]",Sh=e=>xs(e)==="[object Set]",km=e=>xs(e)==="[object RegExp]",J=e=>typeof e=="function",xt=e=>typeof e=="string",Ir=e=>typeof e=="symbol",Et=e=>e!==null&&typeof e=="object",Ch=e=>(Et(e)||J(e))&&J(e.then)&&J(e.catch),Ih=Object.prototype.toString,xs=e=>Ih.call(e),xm=e=>xs(e).slice(8,-1),kh=e=>xs(e)==="[object Object]",dc=e=>xt(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Xr=lc(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),$i=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},Am=/-(\w)/g,Fe=$i(e=>e.replace(Am,(t,n)=>n?n.toUpperCase():"")),Dm=/\B([A-Z])/g,kr=$i(e=>e.replace(Dm,"-$1").toLowerCase()),zi=$i(e=>e.charAt(0).toUpperCase()+e.slice(1)),Bo=$i(e=>e?`on${zi(e)}`:""),yn=(e,t)=>!Object.is(e,t),lr=(e,t)=>{for(let n=0;n<e.length;n++)e[n](t)},mi=(e,t,n)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:n})},ba=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let Ol;const xh=()=>Ol||(Ol=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function pe(e){if(K(e)){const t={};for(let n=0;n<e.length;n++){const r=e[n],s=xt(r)?Mm(r):pe(r);if(s)for(const i in s)t[i]=s[i]}return t}else if(xt(e)||Et(e))return e}const Nm=/;(?![^(]*\))/g,Rm=/:([^]+)/,Pm=/\/\*[^]*?\*\//g;function Mm(e){const t={};return e.replace(Pm,"").split(Nm).forEach(n=>{if(n){const r=n.split(Rm);r.length>1&&(t[r[0].trim()]=r[1].trim())}}),t}function Ut(e){let t="";if(xt(e))t=e;else if(K(e))for(let n=0;n<e.length;n++){const r=Ut(e[n]);r&&(t+=r+" ")}else if(Et(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}const Lm="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Om=lc(Lm);function Ah(e){return!!e||e===""}const Ae=e=>xt(e)?e:e==null?"":K(e)||Et(e)&&(e.toString===Ih||!J(e.toString))?JSON.stringify(e,Dh,2):String(e),Dh=(e,t)=>t&&t.__v_isRef?Dh(e,t.value):cr(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[r,s],i)=>(n[qo(r,i)+" =>"]=s,n),{})}:Sh(t)?{[`Set(${t.size})`]:[...t.values()].map(n=>qo(n))}:Ir(t)?qo(t):Et(t)&&!K(t)&&!kh(t)?String(t):t,qo=(e,t="")=>{var n;return Ir(e)?`Symbol(${(n=e.description)!=null?n:t})`:e};/**
* @vue/reactivity v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let _e;class Nh{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this.parent=_e,!t&&_e&&(this.index=(_e.scopes||(_e.scopes=[])).push(this)-1)}get active(){return this._active}run(t){if(this._active){const n=_e;try{return _e=this,t()}finally{_e=n}}}on(){_e=this}off(){_e=this.parent}stop(t){if(this._active){let n,r;for(n=0,r=this.effects.length;n<r;n++)this.effects[n].stop();for(n=0,r=this.cleanups.length;n<r;n++)this.cleanups[n]();if(this.scopes)for(n=0,r=this.scopes.length;n<r;n++)this.scopes[n].stop(!0);if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0,this._active=!1}}}function Um(e){return new Nh(e)}function Fm(e,t=_e){t&&t.active&&t.effects.push(e)}function Vm(){return _e}let Ln;class fc{constructor(t,n,r,s){this.fn=t,this.trigger=n,this.scheduler=r,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,Fm(this,s)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,Gn();for(let t=0;t<this._depsLength;t++){const n=this.deps[t];if(n.computed&&(jm(n.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),Hn()}return this._dirtyLevel>=4}set dirty(t){this._dirtyLevel=t?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let t=hn,n=Ln;try{return hn=!0,Ln=this,this._runnings++,Ul(this),this.fn()}finally{Fl(this),this._runnings--,Ln=n,hn=t}}stop(){var t;this.active&&(Ul(this),Fl(this),(t=this.onStop)==null||t.call(this),this.active=!1)}}function jm(e){return e.value}function Ul(e){e._trackId++,e._depsLength=0}function Fl(e){if(e.deps.length>e._depsLength){for(let t=e._depsLength;t<e.deps.length;t++)Rh(e.deps[t],e);e.deps.length=e._depsLength}}function Rh(e,t){const n=e.get(t);n!==void 0&&t._trackId!==n&&(e.delete(t),e.size===0&&e.cleanup())}let hn=!0,wa=0;const Ph=[];function Gn(){Ph.push(hn),hn=!1}function Hn(){const e=Ph.pop();hn=e===void 0?!0:e}function pc(){wa++}function mc(){for(wa--;!wa&&_a.length;)_a.shift()()}function Mh(e,t,n){if(t.get(e)!==e._trackId){t.set(e,e._trackId);const r=e.deps[e._depsLength];r!==t?(r&&Rh(r,e),e.deps[e._depsLength++]=t):e._depsLength++}}const _a=[];function Lh(e,t,n){pc();for(const r of e.keys()){let s;r._dirtyLevel<t&&(s??(s=e.get(r)===r._trackId))&&(r._shouldSchedule||(r._shouldSchedule=r._dirtyLevel===0),r._dirtyLevel=t),r._shouldSchedule&&(s??(s=e.get(r)===r._trackId))&&(r.trigger(),(!r._runnings||r.allowRecurse)&&r._dirtyLevel!==2&&(r._shouldSchedule=!1,r.scheduler&&_a.push(r.scheduler)))}mc()}const Oh=(e,t)=>{const n=new Map;return n.cleanup=e,n.computed=t,n},gi=new WeakMap,On=Symbol(""),Ea=Symbol("");function oe(e,t,n){if(hn&&Ln){let r=gi.get(e);r||gi.set(e,r=new Map);let s=r.get(n);s||r.set(n,s=Oh(()=>r.delete(n))),Mh(Ln,s)}}function He(e,t,n,r,s,i){const o=gi.get(e);if(!o)return;let a=[];if(t==="clear")a=[...o.values()];else if(n==="length"&&K(e)){const c=Number(r);o.forEach((l,u)=>{(u==="length"||!Ir(u)&&u>=c)&&a.push(l)})}else switch(n!==void 0&&a.push(o.get(n)),t){case"add":K(e)?dc(n)&&a.push(o.get("length")):(a.push(o.get(On)),cr(e)&&a.push(o.get(Ea)));break;case"delete":K(e)||(a.push(o.get(On)),cr(e)&&a.push(o.get(Ea)));break;case"set":cr(e)&&a.push(o.get(On));break}pc();for(const c of a)c&&Lh(c,4);mc()}function Bm(e,t){var n;return(n=gi.get(e))==null?void 0:n.get(t)}const qm=lc("__proto__,__v_isRef,__isVue"),Uh=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Ir)),Vl=$m();function $m(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...n){const r=lt(this);for(let i=0,o=this.length;i<o;i++)oe(r,"get",i+"");const s=r[t](...n);return s===-1||s===!1?r[t](...n.map(lt)):s}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...n){Gn(),pc();const r=lt(this)[t].apply(this,n);return mc(),Hn(),r}}),e}function zm(e){const t=lt(this);return oe(t,"has",e),t.hasOwnProperty(e)}class Fh{constructor(t=!1,n=!1){this._isReadonly=t,this._isShallow=n}get(t,n,r){const s=this._isReadonly,i=this._isShallow;if(n==="__v_isReactive")return!s;if(n==="__v_isReadonly")return s;if(n==="__v_isShallow")return i;if(n==="__v_raw")return r===(s?i?rg:qh:i?Bh:jh).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(r)?t:void 0;const o=K(t);if(!s){if(o&&at(Vl,n))return Reflect.get(Vl,n,r);if(n==="hasOwnProperty")return zm}const a=Reflect.get(t,n,r);return(Ir(n)?Uh.has(n):qm(n))||(s||oe(t,"get",n),i)?a:Zt(a)?o&&dc(n)?a:a.value:Et(a)?s?$h(a):vc(a):a}}class Vh extends Fh{constructor(t=!1){super(!1,t)}set(t,n,r,s){let i=t[n];if(!this._isShallow){const c=gr(i);if(!yi(r)&&!gr(r)&&(i=lt(i),r=lt(r)),!K(t)&&Zt(i)&&!Zt(r))return c?!1:(i.value=r,!0)}const o=K(t)&&dc(n)?Number(n)<t.length:at(t,n),a=Reflect.set(t,n,r,s);return t===lt(s)&&(o?yn(r,i)&&He(t,"set",n,r):He(t,"add",n,r)),a}deleteProperty(t,n){const r=at(t,n);t[n];const s=Reflect.deleteProperty(t,n);return s&&r&&He(t,"delete",n,void 0),s}has(t,n){const r=Reflect.has(t,n);return(!Ir(n)||!Uh.has(n))&&oe(t,"has",n),r}ownKeys(t){return oe(t,"iterate",K(t)?"length":On),Reflect.ownKeys(t)}}class Km extends Fh{constructor(t=!1){super(!0,t)}set(t,n){return!0}deleteProperty(t,n){return!0}}const Gm=new Vh,Hm=new Km,Wm=new Vh(!0),gc=e=>e,Ki=e=>Reflect.getPrototypeOf(e);function Gs(e,t,n=!1,r=!1){e=e.__v_raw;const s=lt(e),i=lt(t);n||(yn(t,i)&&oe(s,"get",t),oe(s,"get",i));const{has:o}=Ki(s),a=r?gc:n?_c:as;if(o.call(s,t))return a(e.get(t));if(o.call(s,i))return a(e.get(i));e!==s&&e.get(t)}function Hs(e,t=!1){const n=this.__v_raw,r=lt(n),s=lt(e);return t||(yn(e,s)&&oe(r,"has",e),oe(r,"has",s)),e===s?n.has(e):n.has(e)||n.has(s)}function Ws(e,t=!1){return e=e.__v_raw,!t&&oe(lt(e),"iterate",On),Reflect.get(e,"size",e)}function jl(e){e=lt(e);const t=lt(this);return Ki(t).has.call(t,e)||(t.add(e),He(t,"add",e,e)),this}function Bl(e,t){t=lt(t);const n=lt(this),{has:r,get:s}=Ki(n);let i=r.call(n,e);i||(e=lt(e),i=r.call(n,e));const o=s.call(n,e);return n.set(e,t),i?yn(t,o)&&He(n,"set",e,t):He(n,"add",e,t),this}function ql(e){const t=lt(this),{has:n,get:r}=Ki(t);let s=n.call(t,e);s||(e=lt(e),s=n.call(t,e)),r&&r.call(t,e);const i=t.delete(e);return s&&He(t,"delete",e,void 0),i}function $l(){const e=lt(this),t=e.size!==0,n=e.clear();return t&&He(e,"clear",void 0,void 0),n}function Qs(e,t){return function(n,r){const s=this,i=s.__v_raw,o=lt(i),a=t?gc:e?_c:as;return!e&&oe(o,"iterate",On),i.forEach((c,l)=>n.call(r,a(c),a(l),s))}}function Xs(e,t,n){return function(...r){const s=this.__v_raw,i=lt(s),o=cr(i),a=e==="entries"||e===Symbol.iterator&&o,c=e==="keys"&&o,l=s[e](...r),u=n?gc:t?_c:as;return!t&&oe(i,"iterate",c?Ea:On),{next(){const{value:h,done:f}=l.next();return f?{value:h,done:f}:{value:a?[u(h[0]),u(h[1])]:u(h),done:f}},[Symbol.iterator](){return this}}}}function on(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function Qm(){const e={get(s){return Gs(this,s)},get size(){return Ws(this)},has:Hs,add:jl,set:Bl,delete:ql,clear:$l,forEach:Qs(!1,!1)},t={get(s){return Gs(this,s,!1,!0)},get size(){return Ws(this)},has:Hs,add:jl,set:Bl,delete:ql,clear:$l,forEach:Qs(!1,!0)},n={get(s){return Gs(this,s,!0)},get size(){return Ws(this,!0)},has(s){return Hs.call(this,s,!0)},add:on("add"),set:on("set"),delete:on("delete"),clear:on("clear"),forEach:Qs(!0,!1)},r={get(s){return Gs(this,s,!0,!0)},get size(){return Ws(this,!0)},has(s){return Hs.call(this,s,!0)},add:on("add"),set:on("set"),delete:on("delete"),clear:on("clear"),forEach:Qs(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{e[s]=Xs(s,!1,!1),n[s]=Xs(s,!0,!1),t[s]=Xs(s,!1,!0),r[s]=Xs(s,!0,!0)}),[e,n,t,r]}const[Xm,Jm,Ym,Zm]=Qm();function yc(e,t){const n=t?e?Zm:Ym:e?Jm:Xm;return(r,s,i)=>s==="__v_isReactive"?!e:s==="__v_isReadonly"?e:s==="__v_raw"?r:Reflect.get(at(n,s)&&s in r?n:r,s,i)}const tg={get:yc(!1,!1)},eg={get:yc(!1,!0)},ng={get:yc(!0,!1)},jh=new WeakMap,Bh=new WeakMap,qh=new WeakMap,rg=new WeakMap;function sg(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function ig(e){return e.__v_skip||!Object.isExtensible(e)?0:sg(xm(e))}function vc(e){return gr(e)?e:bc(e,!1,Gm,tg,jh)}function og(e){return bc(e,!1,Wm,eg,Bh)}function $h(e){return bc(e,!0,Hm,ng,qh)}function bc(e,t,n,r,s){if(!Et(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const i=s.get(e);if(i)return i;const o=ig(e);if(o===0)return e;const a=new Proxy(e,o===2?r:n);return s.set(e,a),a}function ur(e){return gr(e)?ur(e.__v_raw):!!(e&&e.__v_isReactive)}function gr(e){return!!(e&&e.__v_isReadonly)}function yi(e){return!!(e&&e.__v_isShallow)}function zh(e){return ur(e)||gr(e)}function lt(e){const t=e&&e.__v_raw;return t?lt(t):e}function wc(e){return Object.isExtensible(e)&&mi(e,"__v_skip",!0),e}const as=e=>Et(e)?vc(e):e,_c=e=>Et(e)?$h(e):e;class Kh{constructor(t,n,r,s){this.getter=t,this._setter=n,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new fc(()=>t(this._value),()=>ci(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!s,this.__v_isReadonly=r}get value(){const t=lt(this);return(!t._cacheable||t.effect.dirty)&&yn(t._value,t._value=t.effect.run())&&ci(t,4),Gh(t),t.effect._dirtyLevel>=2&&ci(t,2),t._value}set value(t){this._setter(t)}get _dirty(){return this.effect.dirty}set _dirty(t){this.effect.dirty=t}}function ag(e,t,n=!1){let r,s;const i=J(e);return i?(r=e,s=ye):(r=e.get,s=e.set),new Kh(r,s,i||!s,n)}function Gh(e){var t;hn&&Ln&&(e=lt(e),Mh(Ln,(t=e.dep)!=null?t:e.dep=Oh(()=>e.dep=void 0,e instanceof Kh?e:void 0)))}function ci(e,t=4,n){e=lt(e);const r=e.dep;r&&Lh(r,t)}function Zt(e){return!!(e&&e.__v_isRef===!0)}function dt(e){return cg(e,!1)}function cg(e,t){return Zt(e)?e:new lg(e,t)}class lg{constructor(t,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?t:lt(t),this._value=n?t:as(t)}get value(){return Gh(this),this._value}set value(t){const n=this.__v_isShallow||yi(t)||gr(t);t=n?t:lt(t),yn(t,this._rawValue)&&(this._rawValue=t,this._value=n?t:as(t),ci(this,4))}}function Z(e){return Zt(e)?e.value:e}const ug={get:(e,t,n)=>Z(Reflect.get(e,t,n)),set:(e,t,n,r)=>{const s=e[t];return Zt(s)&&!Zt(n)?(s.value=n,!0):Reflect.set(e,t,n,r)}};function Hh(e){return ur(e)?e:new Proxy(e,ug)}function Wh(e){const t=K(e)?new Array(e.length):{};for(const n in e)t[n]=Xh(e,n);return t}class hg{constructor(t,n,r){this._object=t,this._key=n,this._defaultValue=r,this.__v_isRef=!0}get value(){const t=this._object[this._key];return t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}get dep(){return Bm(lt(this._object),this._key)}}class dg{constructor(t){this._getter=t,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function Qh(e,t,n){return Zt(e)?e:J(e)?new dg(e):Et(e)&&arguments.length>1?Xh(e,t,n):dt(e)}function Xh(e,t,n){const r=e[t];return Zt(r)?r:new hg(e,t,n)}/**
* @vue/runtime-core v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function dn(e,t,n,r){try{return r?e(...r):e()}catch(s){Gi(s,t,n)}}function Se(e,t,n,r){if(J(e)){const i=dn(e,t,n,r);return i&&Ch(i)&&i.catch(o=>{Gi(o,t,n)}),i}const s=[];for(let i=0;i<e.length;i++)s.push(Se(e[i],t,n,r));return s}function Gi(e,t,n,r=!0){const s=t?t.vnode:null;if(t){let i=t.parent;const o=t.proxy,a=`https://vuejs.org/error-reference/#runtime-${n}`;for(;i;){const l=i.ec;if(l){for(let u=0;u<l.length;u++)if(l[u](e,o,a)===!1)return}i=i.parent}const c=t.appContext.config.errorHandler;if(c){dn(c,null,10,[e,o,a]);return}}fg(e,n,s,r)}function fg(e,t,n,r=!0){console.error(e)}let cs=!1,Ta=!1;const Xt=[];let Re=0;const hr=[];let an=null,xn=0;const Jh=Promise.resolve();let Ec=null;function pg(e){const t=Ec||Jh;return e?t.then(this?e.bind(this):e):t}function mg(e){let t=Re+1,n=Xt.length;for(;t<n;){const r=t+n>>>1,s=Xt[r],i=ls(s);i<e||i===e&&s.pre?t=r+1:n=r}return t}function Tc(e){(!Xt.length||!Xt.includes(e,cs&&e.allowRecurse?Re+1:Re))&&(e.id==null?Xt.push(e):Xt.splice(mg(e.id),0,e),Yh())}function Yh(){!cs&&!Ta&&(Ta=!0,Ec=Jh.then(td))}function gg(e){const t=Xt.indexOf(e);t>Re&&Xt.splice(t,1)}function yg(e){K(e)?hr.push(...e):(!an||!an.includes(e,e.allowRecurse?xn+1:xn))&&hr.push(e),Yh()}function zl(e,t,n=cs?Re+1:0){for(;n<Xt.length;n++){const r=Xt[n];if(r&&r.pre){if(e&&r.id!==e.uid)continue;Xt.splice(n,1),n--,r()}}}function Zh(e){if(hr.length){const t=[...new Set(hr)].sort((n,r)=>ls(n)-ls(r));if(hr.length=0,an){an.push(...t);return}for(an=t,xn=0;xn<an.length;xn++)an[xn]();an=null,xn=0}}const ls=e=>e.id==null?1/0:e.id,vg=(e,t)=>{const n=ls(e)-ls(t);if(n===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return n};function td(e){Ta=!1,cs=!0,Xt.sort(vg);try{for(Re=0;Re<Xt.length;Re++){const t=Xt[Re];t&&t.active!==!1&&dn(t,null,14)}}finally{Re=0,Xt.length=0,Zh(),cs=!1,Ec=null,(Xt.length||hr.length)&&td()}}function bg(e,t,...n){if(e.isUnmounted)return;const r=e.vnode.props||yt;let s=n;const i=t.startsWith("update:"),o=i&&t.slice(7);if(o&&o in r){const u=`${o==="modelValue"?"model":o}Modifiers`,{number:h,trim:f}=r[u]||yt;f&&(s=n.map(m=>xt(m)?m.trim():m)),h&&(s=n.map(ba))}let a,c=r[a=Bo(t)]||r[a=Bo(Fe(t))];!c&&i&&(c=r[a=Bo(kr(t))]),c&&Se(c,e,6,s);const l=r[a+"Once"];if(l){if(!e.emitted)e.emitted={};else if(e.emitted[a])return;e.emitted[a]=!0,Se(l,e,6,s)}}function ed(e,t,n=!1){const r=t.emitsCache,s=r.get(e);if(s!==void 0)return s;const i=e.emits;let o={},a=!1;if(!J(e)){const c=l=>{const u=ed(l,t,!0);u&&(a=!0,Kt(o,u))};!n&&t.mixins.length&&t.mixins.forEach(c),e.extends&&c(e.extends),e.mixins&&e.mixins.forEach(c)}return!i&&!a?(Et(e)&&r.set(e,null),null):(K(i)?i.forEach(c=>o[c]=null):Kt(o,i),Et(e)&&r.set(e,o),o)}function Hi(e,t){return!e||!qi(t)?!1:(t=t.slice(2).replace(/Once$/,""),at(e,t[0].toLowerCase()+t.slice(1))||at(e,kr(t))||at(e,t))}let re=null,Wi=null;function vi(e){const t=re;return re=e,Wi=e&&e.type.__scopeId||null,t}function wg(e){Wi=e}function _g(){Wi=null}function Eg(e,t=re,n){if(!t||e._n)return e;const r=(...s)=>{r._d&&eu(-1);const i=vi(t);let o;try{o=e(...s)}finally{vi(i),r._d&&eu(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function $o(e){const{type:t,vnode:n,proxy:r,withProxy:s,props:i,propsOptions:[o],slots:a,attrs:c,emit:l,render:u,renderCache:h,data:f,setupState:m,ctx:E,inheritAttrs:v}=e;let x,F;const w=vi(e);try{if(n.shapeFlag&4){const y=s||r,$=y;x=De(u.call($,y,h,i,m,f,E)),F=c}else{const y=t;x=De(y.length>1?y(i,{attrs:c,slots:a,emit:l}):y(i,null)),F=t.props?c:Tg(c)}}catch(y){ts.length=0,Gi(y,e,1),x=ne(jn)}let _=x;if(F&&v!==!1){const y=Object.keys(F),{shapeFlag:$}=_;y.length&&$&7&&(o&&y.some(uc)&&(F=Sg(F,o)),_=Bn(_,F))}return n.dirs&&(_=Bn(_),_.dirs=_.dirs?_.dirs.concat(n.dirs):n.dirs),n.transition&&(_.transition=n.transition),x=_,vi(w),x}const Tg=e=>{let t;for(const n in e)(n==="class"||n==="style"||qi(n))&&((t||(t={}))[n]=e[n]);return t},Sg=(e,t)=>{const n={};for(const r in e)(!uc(r)||!(r.slice(9)in t))&&(n[r]=e[r]);return n};function Cg(e,t,n){const{props:r,children:s,component:i}=e,{props:o,children:a,patchFlag:c}=t,l=i.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&c>=0){if(c&1024)return!0;if(c&16)return r?Kl(r,o,l):!!o;if(c&8){const u=t.dynamicProps;for(let h=0;h<u.length;h++){const f=u[h];if(o[f]!==r[f]&&!Hi(l,f))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?Kl(r,o,l):!0:!!o;return!1}function Kl(e,t,n){const r=Object.keys(t);if(r.length!==Object.keys(e).length)return!0;for(let s=0;s<r.length;s++){const i=r[s];if(t[i]!==e[i]&&!Hi(n,i))return!0}return!1}function Ig({vnode:e,parent:t},n){for(;t;){const r=t.subTree;if(r.suspense&&r.suspense.activeBranch===e&&(r.el=e.el),r===e)(e=t.vnode).el=n,t=t.parent;else break}}const kg="components",xg="directives",Ag=Symbol.for("v-ndc");function nd(e){return Dg(xg,e)}function Dg(e,t,n=!0,r=!1){const s=re||Bt;if(s){const i=s.type;if(e===kg){const a=Na(i,!1);if(a&&(a===t||a===Fe(t)||a===zi(Fe(t))))return i}const o=Gl(s[e]||i[e],t)||Gl(s.appContext[e],t);return!o&&r?i:o}}function Gl(e,t){return e&&(e[t]||e[Fe(t)]||e[zi(Fe(t))])}const rd=e=>e.__isSuspense;function Ng(e,t){t&&t.pendingBranch?K(e)?t.effects.push(...e):t.effects.push(e):yg(e)}const Rg=Symbol.for("v-scx"),Pg=()=>Fn(Rg),Js={};function Un(e,t,n){return sd(e,t,n)}function sd(e,t,{immediate:n,deep:r,flush:s,once:i,onTrack:o,onTrigger:a}=yt){if(t&&i){const k=t;t=(...R)=>{k(...R),$()}}const c=Bt,l=k=>r===!0?k:Dn(k,r===!1?1:void 0);let u,h=!1,f=!1;if(Zt(e)?(u=()=>e.value,h=yi(e)):ur(e)?(u=()=>l(e),h=!0):K(e)?(f=!0,h=e.some(k=>ur(k)||yi(k)),u=()=>e.map(k=>{if(Zt(k))return k.value;if(ur(k))return l(k);if(J(k))return dn(k,c,2)})):J(e)?t?u=()=>dn(e,c,2):u=()=>(m&&m(),Se(e,c,3,[E])):u=ye,t&&r){const k=u;u=()=>Dn(k())}let m,E=k=>{m=_.onStop=()=>{dn(k,c,4),m=_.onStop=void 0}},v;if(Yi)if(E=ye,t?n&&Se(t,c,3,[u(),f?[]:void 0,E]):u(),s==="sync"){const k=Pg();v=k.__watcherHandles||(k.__watcherHandles=[])}else return ye;let x=f?new Array(e.length).fill(Js):Js;const F=()=>{if(!(!_.active||!_.dirty))if(t){const k=_.run();(r||h||(f?k.some((R,V)=>yn(R,x[V])):yn(k,x)))&&(m&&m(),Se(t,c,3,[k,x===Js?void 0:f&&x[0]===Js?[]:x,E]),x=k)}else _.run()};F.allowRecurse=!!t;let w;s==="sync"?w=F:s==="post"?w=()=>Ft(F,c&&c.suspense):(F.pre=!0,c&&(F.id=c.uid),w=()=>Tc(F));const _=new fc(u,ye,w),y=Vm(),$=()=>{_.stop(),y&&hc(y.effects,_)};return t?n?F():x=_.run():s==="post"?Ft(_.run.bind(_),c&&c.suspense):_.run(),v&&v.push($),$}function Mg(e,t,n){const r=this.proxy,s=xt(e)?e.includes(".")?id(r,e):()=>r[e]:e.bind(r,r);let i;J(t)?i=t:(i=t.handler,n=t);const o=As(this),a=sd(s,i.bind(r),n);return o(),a}function id(e,t){const n=t.split(".");return()=>{let r=e;for(let s=0;s<n.length&&r;s++)r=r[n[s]];return r}}function Dn(e,t,n=0,r){if(!Et(e)||e.__v_skip)return e;if(t&&t>0){if(n>=t)return e;n++}if(r=r||new Set,r.has(e))return e;if(r.add(e),Zt(e))Dn(e.value,t,n,r);else if(K(e))for(let s=0;s<e.length;s++)Dn(e[s],t,n,r);else if(Sh(e)||cr(e))e.forEach(s=>{Dn(s,t,n,r)});else if(kh(e))for(const s in e)Dn(e[s],t,n,r);return e}function ir(e,t){if(re===null)return e;const n=Zi(re)||re.proxy,r=e.dirs||(e.dirs=[]);for(let s=0;s<t.length;s++){let[i,o,a,c=yt]=t[s];i&&(J(i)&&(i={mounted:i,updated:i}),i.deep&&Dn(o),r.push({dir:i,instance:n,value:o,oldValue:void 0,arg:a,modifiers:c}))}return e}function Sn(e,t,n,r){const s=e.dirs,i=t&&t.dirs;for(let o=0;o<s.length;o++){const a=s[o];i&&(a.oldValue=i[o].value);let c=a.dir[r];c&&(Gn(),Se(c,n,8,[e.el,a,e,t]),Hn())}}function od(e,t){e.shapeFlag&6&&e.component?od(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}/*! #__NO_SIDE_EFFECTS__ */function Ye(e,t){return J(e)?Kt({name:e.name},t,{setup:e}):e}const Jr=e=>!!e.type.__asyncLoader,ad=e=>e.type.__isKeepAlive,Lg={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(e,{slots:t}){const n=yy(),r=n.ctx;if(!r.renderer)return()=>{const w=t.default&&t.default();return w&&w.length===1?w[0]:w};const s=new Map,i=new Set;let o=null;const a=n.suspense,{renderer:{p:c,m:l,um:u,o:{createElement:h}}}=r,f=h("div");r.activate=(w,_,y,$,k)=>{const R=w.component;l(w,_,y,0,a),c(R.vnode,w,_,y,R,a,$,w.slotScopeIds,k),Ft(()=>{R.isDeactivated=!1,R.a&&lr(R.a);const V=w.props&&w.props.onVnodeMounted;V&&fe(V,R.parent,w)},a)},r.deactivate=w=>{const _=w.component;l(w,f,null,1,a),Ft(()=>{_.da&&lr(_.da);const y=w.props&&w.props.onVnodeUnmounted;y&&fe(y,_.parent,w),_.isDeactivated=!0},a)};function m(w){zo(w),u(w,n,a,!0)}function E(w){s.forEach((_,y)=>{const $=Na(_.type);$&&(!w||!w($))&&v(y)})}function v(w){const _=s.get(w);!o||!tr(_,o)?m(_):o&&zo(o),s.delete(w),i.delete(w)}Un(()=>[e.include,e.exclude],([w,_])=>{w&&E(y=>zr(w,y)),_&&E(y=>!zr(_,y))},{flush:"post",deep:!0});let x=null;const F=()=>{x!=null&&s.set(x,Ko(n.subTree))};return Sc(F),ld(F),ud(()=>{s.forEach(w=>{const{subTree:_,suspense:y}=n,$=Ko(_);if(w.type===$.type&&w.key===$.key){zo($);const k=$.component.da;k&&Ft(k,y);return}m(w)})}),()=>{if(x=null,!t.default)return null;const w=t.default(),_=w[0];if(w.length>1)return o=null,w;if(!Ed(_)||!(_.shapeFlag&4)&&!(_.shapeFlag&128))return o=null,_;let y=Ko(_);const $=y.type,k=Na(Jr(y)?y.type.__asyncResolved||{}:$),{include:R,exclude:V,max:tt}=e;if(R&&(!k||!zr(R,k))||V&&k&&zr(V,k))return o=y,_;const rt=y.key==null?$:y.key,St=s.get(rt);return y.el&&(y=Bn(y),_.shapeFlag&128&&(_.ssContent=y)),x=rt,St?(y.el=St.el,y.component=St.component,y.transition&&od(y,y.transition),y.shapeFlag|=512,i.delete(rt),i.add(rt)):(i.add(rt),tt&&i.size>parseInt(tt,10)&&v(i.values().next().value)),y.shapeFlag|=256,o=y,rd(_.type)?_:y}}},Og=Lg;function zr(e,t){return K(e)?e.some(n=>zr(n,t)):xt(e)?e.split(",").includes(t):km(e)?e.test(t):!1}function Ug(e,t){cd(e,"a",t)}function Fg(e,t){cd(e,"da",t)}function cd(e,t,n=Bt){const r=e.__wdc||(e.__wdc=()=>{let s=n;for(;s;){if(s.isDeactivated)return;s=s.parent}return e()});if(Qi(t,r,n),n){let s=n.parent;for(;s&&s.parent;)ad(s.parent.vnode)&&Vg(r,t,n,s),s=s.parent}}function Vg(e,t,n,r){const s=Qi(t,e,r,!0);hd(()=>{hc(r[t],s)},n)}function zo(e){e.shapeFlag&=-257,e.shapeFlag&=-513}function Ko(e){return e.shapeFlag&128?e.ssContent:e}function Qi(e,t,n=Bt,r=!1){if(n){const s=n[e]||(n[e]=[]),i=t.__weh||(t.__weh=(...o)=>{if(n.isUnmounted)return;Gn();const a=As(n),c=Se(t,n,e,o);return a(),Hn(),c});return r?s.unshift(i):s.push(i),i}}const Ze=e=>(t,n=Bt)=>(!Yi||e==="sp")&&Qi(e,(...r)=>t(...r),n),jg=Ze("bm"),Sc=Ze("m"),Bg=Ze("bu"),ld=Ze("u"),ud=Ze("bum"),hd=Ze("um"),qg=Ze("sp"),$g=Ze("rtg"),zg=Ze("rtc");function Kg(e,t=Bt){Qi("ec",e,t)}function fn(e,t,n,r){let s;const i=n&&n[r];if(K(e)||xt(e)){s=new Array(e.length);for(let o=0,a=e.length;o<a;o++)s[o]=t(e[o],o,void 0,i&&i[o])}else if(typeof e=="number"){s=new Array(e);for(let o=0;o<e;o++)s[o]=t(o+1,o,void 0,i&&i[o])}else if(Et(e))if(e[Symbol.iterator])s=Array.from(e,(o,a)=>t(o,a,void 0,i&&i[a]));else{const o=Object.keys(e);s=new Array(o.length);for(let a=0,c=o.length;a<c;a++){const l=o[a];s[a]=t(e[l],l,a,i&&i[a])}}else s=[];return n&&(n[r]=s),s}const Sa=e=>e?Cd(e)?Zi(e)||e.proxy:Sa(e.parent):null,Yr=Kt(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Sa(e.parent),$root:e=>Sa(e.root),$emit:e=>e.emit,$options:e=>Cc(e),$forceUpdate:e=>e.f||(e.f=()=>{e.effect.dirty=!0,Tc(e.update)}),$nextTick:e=>e.n||(e.n=pg.bind(e.proxy)),$watch:e=>Mg.bind(e)}),Go=(e,t)=>e!==yt&&!e.__isScriptSetup&&at(e,t),Gg={get({_:e},t){const{ctx:n,setupState:r,data:s,props:i,accessCache:o,type:a,appContext:c}=e;let l;if(t[0]!=="$"){const m=o[t];if(m!==void 0)switch(m){case 1:return r[t];case 2:return s[t];case 4:return n[t];case 3:return i[t]}else{if(Go(r,t))return o[t]=1,r[t];if(s!==yt&&at(s,t))return o[t]=2,s[t];if((l=e.propsOptions[0])&&at(l,t))return o[t]=3,i[t];if(n!==yt&&at(n,t))return o[t]=4,n[t];Ca&&(o[t]=0)}}const u=Yr[t];let h,f;if(u)return t==="$attrs"&&oe(e,"get",t),u(e);if((h=a.__cssModules)&&(h=h[t]))return h;if(n!==yt&&at(n,t))return o[t]=4,n[t];if(f=c.config.globalProperties,at(f,t))return f[t]},set({_:e},t,n){const{data:r,setupState:s,ctx:i}=e;return Go(s,t)?(s[t]=n,!0):r!==yt&&at(r,t)?(r[t]=n,!0):at(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(i[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:r,appContext:s,propsOptions:i}},o){let a;return!!n[o]||e!==yt&&at(e,o)||Go(t,o)||(a=i[0])&&at(a,o)||at(r,o)||at(Yr,o)||at(s.config.globalProperties,o)},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:at(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function Hl(e){return K(e)?e.reduce((t,n)=>(t[n]=null,t),{}):e}let Ca=!0;function Hg(e){const t=Cc(e),n=e.proxy,r=e.ctx;Ca=!1,t.beforeCreate&&Wl(t.beforeCreate,e,"bc");const{data:s,computed:i,methods:o,watch:a,provide:c,inject:l,created:u,beforeMount:h,mounted:f,beforeUpdate:m,updated:E,activated:v,deactivated:x,beforeDestroy:F,beforeUnmount:w,destroyed:_,unmounted:y,render:$,renderTracked:k,renderTriggered:R,errorCaptured:V,serverPrefetch:tt,expose:rt,inheritAttrs:St,components:be,directives:rn,filters:Or}=t;if(l&&Wg(l,r,null),o)for(const bt in o){const pt=o[bt];J(pt)&&(r[bt]=pt.bind(n))}if(s){const bt=s.call(n,n);Et(bt)&&(e.data=vc(bt))}if(Ca=!0,i)for(const bt in i){const pt=i[bt],ze=J(pt)?pt.bind(n,n):J(pt.get)?pt.get.bind(n,n):ye,Uo=!J(pt)&&J(pt.set)?pt.set.bind(n):ye,Ur=Pt({get:ze,set:Uo});Object.defineProperty(r,bt,{enumerable:!0,configurable:!0,get:()=>Ur.value,set:Jn=>Ur.value=Jn})}if(a)for(const bt in a)dd(a[bt],r,n,bt);if(c){const bt=J(c)?c.call(n):c;Reflect.ownKeys(bt).forEach(pt=>{ka(pt,bt[pt])})}u&&Wl(u,e,"c");function Gt(bt,pt){K(pt)?pt.forEach(ze=>bt(ze.bind(n))):pt&&bt(pt.bind(n))}if(Gt(jg,h),Gt(Sc,f),Gt(Bg,m),Gt(ld,E),Gt(Ug,v),Gt(Fg,x),Gt(Kg,V),Gt(zg,k),Gt($g,R),Gt(ud,w),Gt(hd,y),Gt(qg,tt),K(rt))if(rt.length){const bt=e.exposed||(e.exposed={});rt.forEach(pt=>{Object.defineProperty(bt,pt,{get:()=>n[pt],set:ze=>n[pt]=ze})})}else e.exposed||(e.exposed={});$&&e.render===ye&&(e.render=$),St!=null&&(e.inheritAttrs=St),be&&(e.components=be),rn&&(e.directives=rn)}function Wg(e,t,n=ye){K(e)&&(e=Ia(e));for(const r in e){const s=e[r];let i;Et(s)?"default"in s?i=Fn(s.from||r,s.default,!0):i=Fn(s.from||r):i=Fn(s),Zt(i)?Object.defineProperty(t,r,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):t[r]=i}}function Wl(e,t,n){Se(K(e)?e.map(r=>r.bind(t.proxy)):e.bind(t.proxy),t,n)}function dd(e,t,n,r){const s=r.includes(".")?id(n,r):()=>n[r];if(xt(e)){const i=t[e];J(i)&&Un(s,i)}else if(J(e))Un(s,e.bind(n));else if(Et(e))if(K(e))e.forEach(i=>dd(i,t,n,r));else{const i=J(e.handler)?e.handler.bind(n):t[e.handler];J(i)&&Un(s,i,e)}}function Cc(e){const t=e.type,{mixins:n,extends:r}=t,{mixins:s,optionsCache:i,config:{optionMergeStrategies:o}}=e.appContext,a=i.get(t);let c;return a?c=a:!s.length&&!n&&!r?c=t:(c={},s.length&&s.forEach(l=>bi(c,l,o,!0)),bi(c,t,o)),Et(t)&&i.set(t,c),c}function bi(e,t,n,r=!1){const{mixins:s,extends:i}=t;i&&bi(e,i,n,!0),s&&s.forEach(o=>bi(e,o,n,!0));for(const o in t)if(!(r&&o==="expose")){const a=Qg[o]||n&&n[o];e[o]=a?a(e[o],t[o]):t[o]}return e}const Qg={data:Ql,props:Xl,emits:Xl,methods:Kr,computed:Kr,beforeCreate:ee,created:ee,beforeMount:ee,mounted:ee,beforeUpdate:ee,updated:ee,beforeDestroy:ee,beforeUnmount:ee,destroyed:ee,unmounted:ee,activated:ee,deactivated:ee,errorCaptured:ee,serverPrefetch:ee,components:Kr,directives:Kr,watch:Jg,provide:Ql,inject:Xg};function Ql(e,t){return t?e?function(){return Kt(J(e)?e.call(this,this):e,J(t)?t.call(this,this):t)}:t:e}function Xg(e,t){return Kr(Ia(e),Ia(t))}function Ia(e){if(K(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function ee(e,t){return e?[...new Set([].concat(e,t))]:t}function Kr(e,t){return e?Kt(Object.create(null),e,t):t}function Xl(e,t){return e?K(e)&&K(t)?[...new Set([...e,...t])]:Kt(Object.create(null),Hl(e),Hl(t??{})):t}function Jg(e,t){if(!e)return t;if(!t)return e;const n=Kt(Object.create(null),e);for(const r in t)n[r]=ee(e[r],t[r]);return n}function fd(){return{app:null,config:{isNativeTag:Cm,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Yg=0;function Zg(e,t){return function(n,r=null){J(n)||(n=Kt({},n)),r!=null&&!Et(r)&&(r=null);const s=fd(),i=new WeakSet;let o=!1;const a=s.app={_uid:Yg++,_component:n,_props:r,_container:null,_context:s,_instance:null,version:Ty,get config(){return s.config},set config(c){},use(c,...l){return i.has(c)||(c&&J(c.install)?(i.add(c),c.install(a,...l)):J(c)&&(i.add(c),c(a,...l))),a},mixin(c){return s.mixins.includes(c)||s.mixins.push(c),a},component(c,l){return l?(s.components[c]=l,a):s.components[c]},directive(c,l){return l?(s.directives[c]=l,a):s.directives[c]},mount(c,l,u){if(!o){const h=ne(n,r);return h.appContext=s,u===!0?u="svg":u===!1&&(u=void 0),l&&t?t(h,c):e(h,c,u),o=!0,a._container=c,c.__vue_app__=a,Zi(h.component)||h.component.proxy}},unmount(){o&&(e(null,a._container),delete a._container.__vue_app__)},provide(c,l){return s.provides[c]=l,a},runWithContext(c){const l=Zr;Zr=a;try{return c()}finally{Zr=l}}};return a}}let Zr=null;function ka(e,t){if(Bt){let n=Bt.provides;const r=Bt.parent&&Bt.parent.provides;r===n&&(n=Bt.provides=Object.create(r)),n[e]=t}}function Fn(e,t,n=!1){const r=Bt||re;if(r||Zr){const s=r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:Zr._context.provides;if(s&&e in s)return s[e];if(arguments.length>1)return n&&J(t)?t.call(r&&r.proxy):t}}function ty(e,t,n,r=!1){const s={},i={};mi(i,Ji,1),e.propsDefaults=Object.create(null),pd(e,t,s,i);for(const o in e.propsOptions[0])o in s||(s[o]=void 0);n?e.props=r?s:og(s):e.type.props?e.props=s:e.props=i,e.attrs=i}function ey(e,t,n,r){const{props:s,attrs:i,vnode:{patchFlag:o}}=e,a=lt(s),[c]=e.propsOptions;let l=!1;if((r||o>0)&&!(o&16)){if(o&8){const u=e.vnode.dynamicProps;for(let h=0;h<u.length;h++){let f=u[h];if(Hi(e.emitsOptions,f))continue;const m=t[f];if(c)if(at(i,f))m!==i[f]&&(i[f]=m,l=!0);else{const E=Fe(f);s[E]=xa(c,a,E,m,e,!1)}else m!==i[f]&&(i[f]=m,l=!0)}}}else{pd(e,t,s,i)&&(l=!0);let u;for(const h in a)(!t||!at(t,h)&&((u=kr(h))===h||!at(t,u)))&&(c?n&&(n[h]!==void 0||n[u]!==void 0)&&(s[h]=xa(c,a,h,void 0,e,!0)):delete s[h]);if(i!==a)for(const h in i)(!t||!at(t,h))&&(delete i[h],l=!0)}l&&He(e,"set","$attrs")}function pd(e,t,n,r){const[s,i]=e.propsOptions;let o=!1,a;if(t)for(let c in t){if(Xr(c))continue;const l=t[c];let u;s&&at(s,u=Fe(c))?!i||!i.includes(u)?n[u]=l:(a||(a={}))[u]=l:Hi(e.emitsOptions,c)||(!(c in r)||l!==r[c])&&(r[c]=l,o=!0)}if(i){const c=lt(n),l=a||yt;for(let u=0;u<i.length;u++){const h=i[u];n[h]=xa(s,c,h,l[h],e,!at(l,h))}}return o}function xa(e,t,n,r,s,i){const o=e[n];if(o!=null){const a=at(o,"default");if(a&&r===void 0){const c=o.default;if(o.type!==Function&&!o.skipFactory&&J(c)){const{propsDefaults:l}=s;if(n in l)r=l[n];else{const u=As(s);r=l[n]=c.call(null,t),u()}}else r=c}o[0]&&(i&&!a?r=!1:o[1]&&(r===""||r===kr(n))&&(r=!0))}return r}function md(e,t,n=!1){const r=t.propsCache,s=r.get(e);if(s)return s;const i=e.props,o={},a=[];let c=!1;if(!J(e)){const u=h=>{c=!0;const[f,m]=md(h,t,!0);Kt(o,f),m&&a.push(...m)};!n&&t.mixins.length&&t.mixins.forEach(u),e.extends&&u(e.extends),e.mixins&&e.mixins.forEach(u)}if(!i&&!c)return Et(e)&&r.set(e,ar),ar;if(K(i))for(let u=0;u<i.length;u++){const h=Fe(i[u]);Jl(h)&&(o[h]=yt)}else if(i)for(const u in i){const h=Fe(u);if(Jl(h)){const f=i[u],m=o[h]=K(f)||J(f)?{type:f}:Kt({},f);if(m){const E=tu(Boolean,m.type),v=tu(String,m.type);m[0]=E>-1,m[1]=v<0||E<v,(E>-1||at(m,"default"))&&a.push(h)}}}const l=[o,a];return Et(e)&&r.set(e,l),l}function Jl(e){return e[0]!=="$"&&!Xr(e)}function Yl(e){return e===null?"null":typeof e=="function"?e.name||"":typeof e=="object"&&e.constructor&&e.constructor.name||""}function Zl(e,t){return Yl(e)===Yl(t)}function tu(e,t){return K(t)?t.findIndex(n=>Zl(n,e)):J(t)&&Zl(t,e)?0:-1}const gd=e=>e[0]==="_"||e==="$stable",Ic=e=>K(e)?e.map(De):[De(e)],ny=(e,t,n)=>{if(t._n)return t;const r=Eg((...s)=>Ic(t(...s)),n);return r._c=!1,r},yd=(e,t,n)=>{const r=e._ctx;for(const s in e){if(gd(s))continue;const i=e[s];if(J(i))t[s]=ny(s,i,r);else if(i!=null){const o=Ic(i);t[s]=()=>o}}},vd=(e,t)=>{const n=Ic(t);e.slots.default=()=>n},ry=(e,t)=>{if(e.vnode.shapeFlag&32){const n=t._;n?(e.slots=lt(t),mi(t,"_",n)):yd(t,e.slots={})}else e.slots={},t&&vd(e,t);mi(e.slots,Ji,1)},sy=(e,t,n)=>{const{vnode:r,slots:s}=e;let i=!0,o=yt;if(r.shapeFlag&32){const a=t._;a?n&&a===1?i=!1:(Kt(s,t),!n&&a===1&&delete s._):(i=!t.$stable,yd(t,s)),o=t}else t&&(vd(e,t),o={default:1});if(i)for(const a in s)!gd(a)&&o[a]==null&&delete s[a]};function Aa(e,t,n,r,s=!1){if(K(e)){e.forEach((f,m)=>Aa(f,t&&(K(t)?t[m]:t),n,r,s));return}if(Jr(r)&&!s)return;const i=r.shapeFlag&4?Zi(r.component)||r.component.proxy:r.el,o=s?null:i,{i:a,r:c}=e,l=t&&t.r,u=a.refs===yt?a.refs={}:a.refs,h=a.setupState;if(l!=null&&l!==c&&(xt(l)?(u[l]=null,at(h,l)&&(h[l]=null)):Zt(l)&&(l.value=null)),J(c))dn(c,a,12,[o,u]);else{const f=xt(c),m=Zt(c);if(f||m){const E=()=>{if(e.f){const v=f?at(h,c)?h[c]:u[c]:c.value;s?K(v)&&hc(v,i):K(v)?v.includes(i)||v.push(i):f?(u[c]=[i],at(h,c)&&(h[c]=u[c])):(c.value=[i],e.k&&(u[e.k]=c.value))}else f?(u[c]=o,at(h,c)&&(h[c]=o)):m&&(c.value=o,e.k&&(u[e.k]=o))};o?(E.id=-1,Ft(E,n)):E()}}}const Ft=Ng;function iy(e){return oy(e)}function oy(e,t){const n=xh();n.__VUE__=!0;const{insert:r,remove:s,patchProp:i,createElement:o,createText:a,createComment:c,setText:l,setElementText:u,parentNode:h,nextSibling:f,setScopeId:m=ye,insertStaticContent:E}=e,v=(d,p,g,T=null,S=null,D=null,O=void 0,A=null,N=!!p.dynamicChildren)=>{if(d===p)return;d&&!tr(d,p)&&(T=Ks(d),sn(d,S,D,!0),d=null),p.patchFlag===-2&&(N=!1,p.dynamicChildren=null);const{type:I,ref:U,shapeFlag:z}=p;switch(I){case Xi:x(d,p,g,T);break;case jn:F(d,p,g,T);break;case Wo:d==null&&w(p,g,T,O);break;case At:be(d,p,g,T,S,D,O,A,N);break;default:z&1?$(d,p,g,T,S,D,O,A,N):z&6?rn(d,p,g,T,S,D,O,A,N):(z&64||z&128)&&I.process(d,p,g,T,S,D,O,A,N,Fr)}U!=null&&S&&Aa(U,d&&d.ref,D,p||d,!p)},x=(d,p,g,T)=>{if(d==null)r(p.el=a(p.children),g,T);else{const S=p.el=d.el;p.children!==d.children&&l(S,p.children)}},F=(d,p,g,T)=>{d==null?r(p.el=c(p.children||""),g,T):p.el=d.el},w=(d,p,g,T)=>{[d.el,d.anchor]=E(d.children,p,g,T,d.el,d.anchor)},_=({el:d,anchor:p},g,T)=>{let S;for(;d&&d!==p;)S=f(d),r(d,g,T),d=S;r(p,g,T)},y=({el:d,anchor:p})=>{let g;for(;d&&d!==p;)g=f(d),s(d),d=g;s(p)},$=(d,p,g,T,S,D,O,A,N)=>{p.type==="svg"?O="svg":p.type==="math"&&(O="mathml"),d==null?k(p,g,T,S,D,O,A,N):tt(d,p,S,D,O,A,N)},k=(d,p,g,T,S,D,O,A)=>{let N,I;const{props:U,shapeFlag:z,transition:B,dirs:W}=d;if(N=d.el=o(d.type,D,U&&U.is,U),z&8?u(N,d.children):z&16&&V(d.children,N,null,T,S,Ho(d,D),O,A),W&&Sn(d,null,T,"created"),R(N,d,d.scopeId,O,T),U){for(const gt in U)gt!=="value"&&!Xr(gt)&&i(N,gt,null,U[gt],D,d.children,T,S,Ke);"value"in U&&i(N,"value",null,U.value,D),(I=U.onVnodeBeforeMount)&&fe(I,T,d)}W&&Sn(d,null,T,"beforeMount");const st=ay(S,B);st&&B.beforeEnter(N),r(N,p,g),((I=U&&U.onVnodeMounted)||st||W)&&Ft(()=>{I&&fe(I,T,d),st&&B.enter(N),W&&Sn(d,null,T,"mounted")},S)},R=(d,p,g,T,S)=>{if(g&&m(d,g),T)for(let D=0;D<T.length;D++)m(d,T[D]);if(S){let D=S.subTree;if(p===D){const O=S.vnode;R(d,O,O.scopeId,O.slotScopeIds,S.parent)}}},V=(d,p,g,T,S,D,O,A,N=0)=>{for(let I=N;I<d.length;I++){const U=d[I]=A?cn(d[I]):De(d[I]);v(null,U,p,g,T,S,D,O,A)}},tt=(d,p,g,T,S,D,O)=>{const A=p.el=d.el;let{patchFlag:N,dynamicChildren:I,dirs:U}=p;N|=d.patchFlag&16;const z=d.props||yt,B=p.props||yt;let W;if(g&&Cn(g,!1),(W=B.onVnodeBeforeUpdate)&&fe(W,g,p,d),U&&Sn(p,d,g,"beforeUpdate"),g&&Cn(g,!0),I?rt(d.dynamicChildren,I,A,g,T,Ho(p,S),D):O||ze(d,p,A,null,g,T,Ho(p,S),D,!1),N>0){if(N&16)St(A,p,z,B,g,T,S);else if(N&2&&z.class!==B.class&&i(A,"class",null,B.class,S),N&4&&i(A,"style",z.style,B.style,S),N&8){const st=p.dynamicProps;for(let gt=0;gt<st.length;gt++){const wt=st[gt],Rt=z[wt],we=B[wt];(we!==Rt||wt==="value")&&i(A,wt,Rt,we,S,d.children,g,T,Ke)}}N&1&&d.children!==p.children&&u(A,p.children)}else!O&&I==null&&St(A,p,z,B,g,T,S);((W=B.onVnodeUpdated)||U)&&Ft(()=>{W&&fe(W,g,p,d),U&&Sn(p,d,g,"updated")},T)},rt=(d,p,g,T,S,D,O)=>{for(let A=0;A<p.length;A++){const N=d[A],I=p[A],U=N.el&&(N.type===At||!tr(N,I)||N.shapeFlag&70)?h(N.el):g;v(N,I,U,null,T,S,D,O,!0)}},St=(d,p,g,T,S,D,O)=>{if(g!==T){if(g!==yt)for(const A in g)!Xr(A)&&!(A in T)&&i(d,A,g[A],null,O,p.children,S,D,Ke);for(const A in T){if(Xr(A))continue;const N=T[A],I=g[A];N!==I&&A!=="value"&&i(d,A,I,N,O,p.children,S,D,Ke)}"value"in T&&i(d,"value",g.value,T.value,O)}},be=(d,p,g,T,S,D,O,A,N)=>{const I=p.el=d?d.el:a(""),U=p.anchor=d?d.anchor:a("");let{patchFlag:z,dynamicChildren:B,slotScopeIds:W}=p;W&&(A=A?A.concat(W):W),d==null?(r(I,g,T),r(U,g,T),V(p.children||[],g,U,S,D,O,A,N)):z>0&&z&64&&B&&d.dynamicChildren?(rt(d.dynamicChildren,B,g,S,D,O,A),(p.key!=null||S&&p===S.subTree)&&bd(d,p,!0)):ze(d,p,g,U,S,D,O,A,N)},rn=(d,p,g,T,S,D,O,A,N)=>{p.slotScopeIds=A,d==null?p.shapeFlag&512?S.ctx.activate(p,g,T,O,N):Or(p,g,T,S,D,O,N):Gt(d,p,N)},Or=(d,p,g,T,S,D,O)=>{const A=d.component=gy(d,T,S);if(ad(d)&&(A.ctx.renderer=Fr),vy(A),A.asyncDep){if(S&&S.registerDep(A,bt),!d.el){const N=A.subTree=ne(jn);F(null,N,p,g)}}else bt(A,d,p,g,S,D,O)},Gt=(d,p,g)=>{const T=p.component=d.component;if(Cg(d,p,g))if(T.asyncDep&&!T.asyncResolved){pt(T,p,g);return}else T.next=p,gg(T.update),T.effect.dirty=!0,T.update();else p.el=d.el,T.vnode=p},bt=(d,p,g,T,S,D,O)=>{const A=()=>{if(d.isMounted){let{next:U,bu:z,u:B,parent:W,vnode:st}=d;{const Yn=wd(d);if(Yn){U&&(U.el=st.el,pt(d,U,O)),Yn.asyncDep.then(()=>{d.isUnmounted||A()});return}}let gt=U,wt;Cn(d,!1),U?(U.el=st.el,pt(d,U,O)):U=st,z&&lr(z),(wt=U.props&&U.props.onVnodeBeforeUpdate)&&fe(wt,W,U,st),Cn(d,!0);const Rt=$o(d),we=d.subTree;d.subTree=Rt,v(we,Rt,h(we.el),Ks(we),d,S,D),U.el=Rt.el,gt===null&&Ig(d,Rt.el),B&&Ft(B,S),(wt=U.props&&U.props.onVnodeUpdated)&&Ft(()=>fe(wt,W,U,st),S)}else{let U;const{el:z,props:B}=p,{bm:W,m:st,parent:gt}=d,wt=Jr(p);if(Cn(d,!1),W&&lr(W),!wt&&(U=B&&B.onVnodeBeforeMount)&&fe(U,gt,p),Cn(d,!0),z&&jo){const Rt=()=>{d.subTree=$o(d),jo(z,d.subTree,d,S,null)};wt?p.type.__asyncLoader().then(()=>!d.isUnmounted&&Rt()):Rt()}else{const Rt=d.subTree=$o(d);v(null,Rt,g,T,d,S,D),p.el=Rt.el}if(st&&Ft(st,S),!wt&&(U=B&&B.onVnodeMounted)){const Rt=p;Ft(()=>fe(U,gt,Rt),S)}(p.shapeFlag&256||gt&&Jr(gt.vnode)&&gt.vnode.shapeFlag&256)&&d.a&&Ft(d.a,S),d.isMounted=!0,p=g=T=null}},N=d.effect=new fc(A,ye,()=>Tc(I),d.scope),I=d.update=()=>{N.dirty&&N.run()};I.id=d.uid,Cn(d,!0),I()},pt=(d,p,g)=>{p.component=d;const T=d.vnode.props;d.vnode=p,d.next=null,ey(d,p.props,T,g),sy(d,p.children,g),Gn(),zl(d),Hn()},ze=(d,p,g,T,S,D,O,A,N=!1)=>{const I=d&&d.children,U=d?d.shapeFlag:0,z=p.children,{patchFlag:B,shapeFlag:W}=p;if(B>0){if(B&128){Ur(I,z,g,T,S,D,O,A,N);return}else if(B&256){Uo(I,z,g,T,S,D,O,A,N);return}}W&8?(U&16&&Ke(I,S,D),z!==I&&u(g,z)):U&16?W&16?Ur(I,z,g,T,S,D,O,A,N):Ke(I,S,D,!0):(U&8&&u(g,""),W&16&&V(z,g,T,S,D,O,A,N))},Uo=(d,p,g,T,S,D,O,A,N)=>{d=d||ar,p=p||ar;const I=d.length,U=p.length,z=Math.min(I,U);let B;for(B=0;B<z;B++){const W=p[B]=N?cn(p[B]):De(p[B]);v(d[B],W,g,null,S,D,O,A,N)}I>U?Ke(d,S,D,!0,!1,z):V(p,g,T,S,D,O,A,N,z)},Ur=(d,p,g,T,S,D,O,A,N)=>{let I=0;const U=p.length;let z=d.length-1,B=U-1;for(;I<=z&&I<=B;){const W=d[I],st=p[I]=N?cn(p[I]):De(p[I]);if(tr(W,st))v(W,st,g,null,S,D,O,A,N);else break;I++}for(;I<=z&&I<=B;){const W=d[z],st=p[B]=N?cn(p[B]):De(p[B]);if(tr(W,st))v(W,st,g,null,S,D,O,A,N);else break;z--,B--}if(I>z){if(I<=B){const W=B+1,st=W<U?p[W].el:T;for(;I<=B;)v(null,p[I]=N?cn(p[I]):De(p[I]),g,st,S,D,O,A,N),I++}}else if(I>B)for(;I<=z;)sn(d[I],S,D,!0),I++;else{const W=I,st=I,gt=new Map;for(I=st;I<=B;I++){const ce=p[I]=N?cn(p[I]):De(p[I]);ce.key!=null&&gt.set(ce.key,I)}let wt,Rt=0;const we=B-st+1;let Yn=!1,Pl=0;const Vr=new Array(we);for(I=0;I<we;I++)Vr[I]=0;for(I=W;I<=z;I++){const ce=d[I];if(Rt>=we){sn(ce,S,D,!0);continue}let xe;if(ce.key!=null)xe=gt.get(ce.key);else for(wt=st;wt<=B;wt++)if(Vr[wt-st]===0&&tr(ce,p[wt])){xe=wt;break}xe===void 0?sn(ce,S,D,!0):(Vr[xe-st]=I+1,xe>=Pl?Pl=xe:Yn=!0,v(ce,p[xe],g,null,S,D,O,A,N),Rt++)}const Ml=Yn?cy(Vr):ar;for(wt=Ml.length-1,I=we-1;I>=0;I--){const ce=st+I,xe=p[ce],Ll=ce+1<U?p[ce+1].el:T;Vr[I]===0?v(null,xe,g,Ll,S,D,O,A,N):Yn&&(wt<0||I!==Ml[wt]?Jn(xe,g,Ll,2):wt--)}}},Jn=(d,p,g,T,S=null)=>{const{el:D,type:O,transition:A,children:N,shapeFlag:I}=d;if(I&6){Jn(d.component.subTree,p,g,T);return}if(I&128){d.suspense.move(p,g,T);return}if(I&64){O.move(d,p,g,Fr);return}if(O===At){r(D,p,g);for(let U=0;U<N.length;U++)Jn(N[U],p,g,T);r(d.anchor,p,g);return}if(O===Wo){_(d,p,g);return}if(T!==2&&I&1&&A)if(T===0)A.beforeEnter(D),r(D,p,g),Ft(()=>A.enter(D),S);else{const{leave:U,delayLeave:z,afterLeave:B}=A,W=()=>r(D,p,g),st=()=>{U(D,()=>{W(),B&&B()})};z?z(D,W,st):st()}else r(D,p,g)},sn=(d,p,g,T=!1,S=!1)=>{const{type:D,props:O,ref:A,children:N,dynamicChildren:I,shapeFlag:U,patchFlag:z,dirs:B}=d;if(A!=null&&Aa(A,null,g,d,!0),U&256){p.ctx.deactivate(d);return}const W=U&1&&B,st=!Jr(d);let gt;if(st&&(gt=O&&O.onVnodeBeforeUnmount)&&fe(gt,p,d),U&6)Em(d.component,g,T);else{if(U&128){d.suspense.unmount(g,T);return}W&&Sn(d,null,p,"beforeUnmount"),U&64?d.type.remove(d,p,g,S,Fr,T):I&&(D!==At||z>0&&z&64)?Ke(I,p,g,!1,!0):(D===At&&z&384||!S&&U&16)&&Ke(N,p,g),T&&Nl(d)}(st&&(gt=O&&O.onVnodeUnmounted)||W)&&Ft(()=>{gt&&fe(gt,p,d),W&&Sn(d,null,p,"unmounted")},g)},Nl=d=>{const{type:p,el:g,anchor:T,transition:S}=d;if(p===At){_m(g,T);return}if(p===Wo){y(d);return}const D=()=>{s(g),S&&!S.persisted&&S.afterLeave&&S.afterLeave()};if(d.shapeFlag&1&&S&&!S.persisted){const{leave:O,delayLeave:A}=S,N=()=>O(g,D);A?A(d.el,D,N):N()}else D()},_m=(d,p)=>{let g;for(;d!==p;)g=f(d),s(d),d=g;s(p)},Em=(d,p,g)=>{const{bum:T,scope:S,update:D,subTree:O,um:A}=d;T&&lr(T),S.stop(),D&&(D.active=!1,sn(O,d,p,g)),A&&Ft(A,p),Ft(()=>{d.isUnmounted=!0},p),p&&p.pendingBranch&&!p.isUnmounted&&d.asyncDep&&!d.asyncResolved&&d.suspenseId===p.pendingId&&(p.deps--,p.deps===0&&p.resolve())},Ke=(d,p,g,T=!1,S=!1,D=0)=>{for(let O=D;O<d.length;O++)sn(d[O],p,g,T,S)},Ks=d=>d.shapeFlag&6?Ks(d.component.subTree):d.shapeFlag&128?d.suspense.next():f(d.anchor||d.el);let Fo=!1;const Rl=(d,p,g)=>{d==null?p._vnode&&sn(p._vnode,null,null,!0):v(p._vnode||null,d,p,null,null,null,g),Fo||(Fo=!0,zl(),Zh(),Fo=!1),p._vnode=d},Fr={p:v,um:sn,m:Jn,r:Nl,mt:Or,mc:V,pc:ze,pbc:rt,n:Ks,o:e};let Vo,jo;return t&&([Vo,jo]=t(Fr)),{render:Rl,hydrate:Vo,createApp:Zg(Rl,Vo)}}function Ho({type:e,props:t},n){return n==="svg"&&e==="foreignObject"||n==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:n}function Cn({effect:e,update:t},n){e.allowRecurse=t.allowRecurse=n}function ay(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function bd(e,t,n=!1){const r=e.children,s=t.children;if(K(r)&&K(s))for(let i=0;i<r.length;i++){const o=r[i];let a=s[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[i]=cn(s[i]),a.el=o.el),n||bd(o,a)),a.type===Xi&&(a.el=o.el)}}function cy(e){const t=e.slice(),n=[0];let r,s,i,o,a;const c=e.length;for(r=0;r<c;r++){const l=e[r];if(l!==0){if(s=n[n.length-1],e[s]<l){t[r]=s,n.push(r);continue}for(i=0,o=n.length-1;i<o;)a=i+o>>1,e[n[a]]<l?i=a+1:o=a;l<e[n[i]]&&(i>0&&(t[r]=n[i-1]),n[i]=r)}}for(i=n.length,o=n[i-1];i-- >0;)n[i]=o,o=t[o];return n}function wd(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:wd(t)}const ly=e=>e.__isTeleport,At=Symbol.for("v-fgt"),Xi=Symbol.for("v-txt"),jn=Symbol.for("v-cmt"),Wo=Symbol.for("v-stc"),ts=[];let Ee=null;function X(e=!1){ts.push(Ee=e?null:[])}function uy(){ts.pop(),Ee=ts[ts.length-1]||null}let us=1;function eu(e){us+=e}function _d(e){return e.dynamicChildren=us>0?Ee||ar:null,uy(),us>0&&Ee&&Ee.push(e),e}function ht(e,t,n,r,s,i){return _d(L(e,t,n,r,s,i,!0))}function ve(e,t,n,r,s){return _d(ne(e,t,n,r,s,!0))}function Ed(e){return e?e.__v_isVNode===!0:!1}function tr(e,t){return e.type===t.type&&e.key===t.key}const Ji="__vInternal",Td=({key:e})=>e??null,li=({ref:e,ref_key:t,ref_for:n})=>(typeof e=="number"&&(e=""+e),e!=null?xt(e)||Zt(e)||J(e)?{i:re,r:e,k:t,f:!!n}:e:null);function L(e,t=null,n=null,r=0,s=null,i=e===At?0:1,o=!1,a=!1){const c={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Td(t),ref:t&&li(t),scopeId:Wi,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:re};return a?(kc(c,n),i&128&&e.normalize(c)):n&&(c.shapeFlag|=xt(n)?8:16),us>0&&!o&&Ee&&(c.patchFlag>0||i&6)&&c.patchFlag!==32&&Ee.push(c),c}const ne=hy;function hy(e,t=null,n=null,r=0,s=null,i=!1){if((!e||e===Ag)&&(e=jn),Ed(e)){const a=Bn(e,t,!0);return n&&kc(a,n),us>0&&!i&&Ee&&(a.shapeFlag&6?Ee[Ee.indexOf(e)]=a:Ee.push(a)),a.patchFlag|=-2,a}if(Ey(e)&&(e=e.__vccOpts),t){t=dy(t);let{class:a,style:c}=t;a&&!xt(a)&&(t.class=Ut(a)),Et(c)&&(zh(c)&&!K(c)&&(c=Kt({},c)),t.style=pe(c))}const o=xt(e)?1:rd(e)?128:ly(e)?64:Et(e)?4:J(e)?2:0;return L(e,t,n,r,s,o,i,!0)}function dy(e){return e?zh(e)||Ji in e?Kt({},e):e:null}function Bn(e,t,n=!1){const{props:r,ref:s,patchFlag:i,children:o}=e,a=t?fy(r||{},t):r;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:a,key:a&&Td(a),ref:t&&t.ref?n&&s?K(s)?s.concat(li(t)):[s,li(t)]:li(t):s,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:o,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==At?i===-1?16:i|16:i,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Bn(e.ssContent),ssFallback:e.ssFallback&&Bn(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce}}function Sd(e=" ",t=0){return ne(Xi,null,e,t)}function le(e="",t=!1){return t?(X(),ve(jn,null,e)):ne(jn,null,e)}function De(e){return e==null||typeof e=="boolean"?ne(jn):K(e)?ne(At,null,e.slice()):typeof e=="object"?cn(e):ne(Xi,null,String(e))}function cn(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Bn(e)}function kc(e,t){let n=0;const{shapeFlag:r}=e;if(t==null)t=null;else if(K(t))n=16;else if(typeof t=="object")if(r&65){const s=t.default;s&&(s._c&&(s._d=!1),kc(e,s()),s._c&&(s._d=!0));return}else{n=32;const s=t._;!s&&!(Ji in t)?t._ctx=re:s===3&&re&&(re.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else J(t)?(t={default:t,_ctx:re},n=32):(t=String(t),r&64?(n=16,t=[Sd(t)]):n=8);e.children=t,e.shapeFlag|=n}function fy(...e){const t={};for(let n=0;n<e.length;n++){const r=e[n];for(const s in r)if(s==="class")t.class!==r.class&&(t.class=Ut([t.class,r.class]));else if(s==="style")t.style=pe([t.style,r.style]);else if(qi(s)){const i=t[s],o=r[s];o&&i!==o&&!(K(i)&&i.includes(o))&&(t[s]=i?[].concat(i,o):o)}else s!==""&&(t[s]=r[s])}return t}function fe(e,t,n,r=null){Se(e,t,7,[n,r])}const py=fd();let my=0;function gy(e,t,n){const r=e.type,s=(t?t.appContext:e.appContext)||py,i={uid:my++,vnode:e,type:r,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,scope:new Nh(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:md(r,s),emitsOptions:ed(r,s),emit:null,emitted:null,propsDefaults:yt,inheritAttrs:r.inheritAttrs,ctx:yt,data:yt,props:yt,attrs:yt,slots:yt,refs:yt,setupState:yt,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=t?t.root:i,i.emit=bg.bind(null,i),e.ce&&e.ce(i),i}let Bt=null;const yy=()=>Bt||re;let wi,Da;{const e=xh(),t=(n,r)=>{let s;return(s=e[n])||(s=e[n]=[]),s.push(r),i=>{s.length>1?s.forEach(o=>o(i)):s[0](i)}};wi=t("__VUE_INSTANCE_SETTERS__",n=>Bt=n),Da=t("__VUE_SSR_SETTERS__",n=>Yi=n)}const As=e=>{const t=Bt;return wi(e),e.scope.on(),()=>{e.scope.off(),wi(t)}},nu=()=>{Bt&&Bt.scope.off(),wi(null)};function Cd(e){return e.vnode.shapeFlag&4}let Yi=!1;function vy(e,t=!1){t&&Da(t);const{props:n,children:r}=e.vnode,s=Cd(e);ty(e,n,s,t),ry(e,r);const i=s?by(e,t):void 0;return t&&Da(!1),i}function by(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=wc(new Proxy(e.ctx,Gg));const{setup:r}=n;if(r){const s=e.setupContext=r.length>1?_y(e):null,i=As(e);Gn();const o=dn(r,e,0,[e.props,s]);if(Hn(),i(),Ch(o)){if(o.then(nu,nu),t)return o.then(a=>{ru(e,a,t)}).catch(a=>{Gi(a,e,0)});e.asyncDep=o}else ru(e,o,t)}else Id(e,t)}function ru(e,t,n){J(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Et(t)&&(e.setupState=Hh(t)),Id(e,n)}let su;function Id(e,t,n){const r=e.type;if(!e.render){if(!t&&su&&!r.render){const s=r.template||Cc(e).template;if(s){const{isCustomElement:i,compilerOptions:o}=e.appContext.config,{delimiters:a,compilerOptions:c}=r,l=Kt(Kt({isCustomElement:i,delimiters:a},o),c);r.render=su(s,l)}}e.render=r.render||ye}{const s=As(e);Gn();try{Hg(e)}finally{Hn(),s()}}}function wy(e){return e.attrsProxy||(e.attrsProxy=new Proxy(e.attrs,{get(t,n){return oe(e,"get","$attrs"),t[n]}}))}function _y(e){const t=n=>{e.exposed=n||{}};return{get attrs(){return wy(e)},slots:e.slots,emit:e.emit,expose:t}}function Zi(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(Hh(wc(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in Yr)return Yr[n](e)},has(t,n){return n in t||n in Yr}}))}function Na(e,t=!0){return J(e)?e.displayName||e.name:e.name||t&&e.__name}function Ey(e){return J(e)&&"__vccOpts"in e}const Pt=(e,t)=>ag(e,t,Yi),Ty="3.4.21";/**
* @vue/runtime-dom v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const Sy="http://www.w3.org/2000/svg",Cy="http://www.w3.org/1998/Math/MathML",ln=typeof document<"u"?document:null,iu=ln&&ln.createElement("template"),Iy={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,r)=>{const s=t==="svg"?ln.createElementNS(Sy,e):t==="mathml"?ln.createElementNS(Cy,e):ln.createElement(e,n?{is:n}:void 0);return e==="select"&&r&&r.multiple!=null&&s.setAttribute("multiple",r.multiple),s},createText:e=>ln.createTextNode(e),createComment:e=>ln.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>ln.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,r,s,i){const o=n?n.previousSibling:t.lastChild;if(s&&(s===i||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),n),!(s===i||!(s=s.nextSibling)););else{iu.innerHTML=r==="svg"?`<svg>${e}</svg>`:r==="mathml"?`<math>${e}</math>`:e;const a=iu.content;if(r==="svg"||r==="mathml"){const c=a.firstChild;for(;c.firstChild;)a.appendChild(c.firstChild);a.removeChild(c)}t.insertBefore(a,n)}return[o?o.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},ky=Symbol("_vtc");function xy(e,t,n){const r=e[ky];r&&(t=(t?[t,...r]:[...r]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}const ou=Symbol("_vod"),Ay=Symbol("_vsh"),Dy=Symbol(""),Ny=/(^|;)\s*display\s*:/;function Ry(e,t,n){const r=e.style,s=xt(n);let i=!1;if(n&&!s){if(t)if(xt(t))for(const o of t.split(";")){const a=o.slice(0,o.indexOf(":")).trim();n[a]==null&&ui(r,a,"")}else for(const o in t)n[o]==null&&ui(r,o,"");for(const o in n)o==="display"&&(i=!0),ui(r,o,n[o])}else if(s){if(t!==n){const o=r[Dy];o&&(n+=";"+o),r.cssText=n,i=Ny.test(n)}}else t&&e.removeAttribute("style");ou in e&&(e[ou]=i?r.display:"",e[Ay]&&(r.display="none"))}const au=/\s*!important$/;function ui(e,t,n){if(K(n))n.forEach(r=>ui(e,t,r));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const r=Py(e,t);au.test(n)?e.setProperty(kr(r),n.replace(au,""),"important"):e[r]=n}}const cu=["Webkit","Moz","ms"],Qo={};function Py(e,t){const n=Qo[t];if(n)return n;let r=Fe(t);if(r!=="filter"&&r in e)return Qo[t]=r;r=zi(r);for(let s=0;s<cu.length;s++){const i=cu[s]+r;if(i in e)return Qo[t]=i}return t}const lu="http://www.w3.org/1999/xlink";function My(e,t,n,r,s){if(r&&t.startsWith("xlink:"))n==null?e.removeAttributeNS(lu,t.slice(6,t.length)):e.setAttributeNS(lu,t,n);else{const i=Om(t);n==null||i&&!Ah(n)?e.removeAttribute(t):e.setAttribute(t,i?"":n)}}function Ly(e,t,n,r,s,i,o){if(t==="innerHTML"||t==="textContent"){r&&o(r,s,i),e[t]=n??"";return}const a=e.tagName;if(t==="value"&&a!=="PROGRESS"&&!a.includes("-")){const l=a==="OPTION"?e.getAttribute("value")||"":e.value,u=n??"";(l!==u||!("_value"in e))&&(e.value=u),n==null&&e.removeAttribute(t),e._value=n;return}let c=!1;if(n===""||n==null){const l=typeof e[t];l==="boolean"?n=Ah(n):n==null&&l==="string"?(n="",c=!0):l==="number"&&(n=0,c=!0)}try{e[t]=n}catch{}c&&e.removeAttribute(t)}function er(e,t,n,r){e.addEventListener(t,n,r)}function Oy(e,t,n,r){e.removeEventListener(t,n,r)}const uu=Symbol("_vei");function Uy(e,t,n,r,s=null){const i=e[uu]||(e[uu]={}),o=i[t];if(r&&o)o.value=r;else{const[a,c]=Fy(t);if(r){const l=i[t]=By(r,s);er(e,a,l,c)}else o&&(Oy(e,a,o,c),i[t]=void 0)}}const hu=/(?:Once|Passive|Capture)$/;function Fy(e){let t;if(hu.test(e)){t={};let n;for(;n=e.match(hu);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):kr(e.slice(2)),t]}let Xo=0;const Vy=Promise.resolve(),jy=()=>Xo||(Vy.then(()=>Xo=0),Xo=Date.now());function By(e,t){const n=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=n.attached)return;Se(qy(r,n.value),t,5,[r])};return n.value=e,n.attached=jy(),n}function qy(e,t){if(K(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(r=>s=>!s._stopped&&r&&r(s))}else return t}const du=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,$y=(e,t,n,r,s,i,o,a,c)=>{const l=s==="svg";t==="class"?xy(e,r,l):t==="style"?Ry(e,n,r):qi(t)?uc(t)||Uy(e,t,n,r,o):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):zy(e,t,r,l))?Ly(e,t,r,i,o,a,c):(t==="true-value"?e._trueValue=r:t==="false-value"&&(e._falseValue=r),My(e,t,r,l))};function zy(e,t,n,r){if(r)return!!(t==="innerHTML"||t==="textContent"||t in e&&du(t)&&J(n));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const s=e.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return du(t)&&xt(n)?!1:t in e}const fu=e=>{const t=e.props["onUpdate:modelValue"]||!1;return K(t)?n=>lr(t,n):t};function Ky(e){e.target.composing=!0}function pu(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Jo=Symbol("_assign"),Ys={created(e,{modifiers:{lazy:t,trim:n,number:r}},s){e[Jo]=fu(s);const i=r||s.props&&s.props.type==="number";er(e,t?"change":"input",o=>{if(o.target.composing)return;let a=e.value;n&&(a=a.trim()),i&&(a=ba(a)),e[Jo](a)}),n&&er(e,"change",()=>{e.value=e.value.trim()}),t||(er(e,"compositionstart",Ky),er(e,"compositionend",pu),er(e,"change",pu))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,modifiers:{lazy:n,trim:r,number:s}},i){if(e[Jo]=fu(i),e.composing)return;const o=s||e.type==="number"?ba(e.value):e.value,a=t??"";o!==a&&(document.activeElement===e&&e.type!=="range"&&(n||r&&e.value.trim()===a)||(e.value=a))}},Gy=["ctrl","shift","alt","meta"],Hy={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>Gy.some(n=>e[`${n}Key`]&&!t.includes(n))},Wy=(e,t)=>{const n=e._withMods||(e._withMods={}),r=t.join(".");return n[r]||(n[r]=(s,...i)=>{for(let o=0;o<t.length;o++){const a=Hy[t[o]];if(a&&a(s,t))return}return e(s,...i)})},Qy=Kt({patchProp:$y},Iy);let mu;function Xy(){return mu||(mu=iy(Qy))}const Jy=(...e)=>{const t=Xy().createApp(...e),{mount:n}=t;return t.mount=r=>{const s=Zy(r);if(!s)return;const i=t._component;!J(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.innerHTML="";const o=n(s,!1,Yy(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},t};function Yy(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function Zy(e){return xt(e)?document.querySelector(e):e}var tv=!1;/*!
* pinia v2.1.7
* (c) 2023 Eduardo San Martin Morote
* @license MIT
*/const ev=Symbol();var gu;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(gu||(gu={}));function nv(){const e=Um(!0),t=e.run(()=>dt({}));let n=[],r=[];const s=wc({install(i){s._a=i,i.provide(ev,s),i.config.globalProperties.$pinia=s,r.forEach(o=>n.push(o)),r=[]},use(i){return!this._a&&!tv?r.push(i):n.push(i),this},_p:n,_a:null,_e:e,_s:new Map,state:t});return s}const rv={class:"select"},sv={class:"select__selected"},iv={key:0,class:"select__dropdown"},ov=["onClick"],av=["src"],cv=Ye({__name:"Select",props:{items:{},selected:{}},emits:["select"],setup(e,{emit:t}){const n=e,{selected:r,items:s}=Wh(n),i=t,o=()=>c.value=!1,a=()=>c.value=!c.value,c=dt(!1),l=Pt(()=>{var h;return r.value!==null?((h=s.value[+r.value])==null?void 0:h.name)??"None":"None"}),u=({name:h},f)=>{i("select",f),o()};return(h,f)=>{const m=nd("outclick");return X(),ht("div",rv,[L("div",{class:Ut(["select__wrapper",{"select__wrapper--opened":c.value}])},[L("button",{class:"select__toggle",onClick:Wy(a,["stop"])},[L("span",sv,Ae(l.value),1),L("img",{class:Ut(["select__triangle",{"select__triangle--opened":c.value}]),src:"https://ucarecdn.com/a77ee644-5f48-43c6-9cb4-f620fd73761b/",alt:"triangle"},null,2)]),c.value?ir((X(),ht("div",iv,[(X(!0),ht(At,null,fn(Z(s),(E,v)=>(X(),ht("span",{class:Ut(["select__item",{"select__item--selected":l.value===E.name}]),onClick:x=>u(E,v)},[E.ico?(X(),ht("img",{key:0,class:"select__ico",src:`https://ucarecdn.com/${E.ico}/`,alt:"ico"},null,8,av)):le("",!0),Sd(" "+Ae(E.name||"Err"),1)],10,ov))),256))])),[[m,o]]):le("",!0)],2)])}}}),tn=(e,t)=>{const n=e.__vccOpts||e;for(const[r,s]of t)n[r]=s;return n},yu=tn(cv,[["__scopeId","data-v-6b1eb29d"]]),xc={0:{name:"Акт 1",backImg:"560b1c31-47cf-40aa-b0e3-181223034459",ico:"5efc700f-ce8c-4b66-8721-8e4794bca980"},1:{name:"Акт 2",backImg:"32e1da0c-2eb1-4fec-81e9-55dd61e9c7a7",ico:"db3b09d0-a84f-4b50-865b-667a412100da"},2:{name:"Акт 3",backImg:"71ebb5c6-b7b0-4619-bbef-fa078d885a99",ico:"19474701-7c1c-4263-8abc-103210ffc0be"}};function vu(e){return Object.prototype.toString.call(e)==="[object Object]"}const lv=/\W|_/g;function uv(e){return e.split(lv).map((t,n)=>t.charAt(0)[n>0?"toUpperCase":"toLowerCase"]()+t.slice(1)).join("")}function bu(e,{ignoreKeys:t}={ignoreKeys:[]}){return Array.isArray(e)?e.map(n=>$e(n,{ignoreKeys:t})):e}function $e(e,{ignoreKeys:t}={ignoreKeys:[]}){if(Array.isArray(e))return bu(e,{ignoreKeys:t});if(!vu(e))return e;const n={};for(const r of Object.keys(e)){let s=e[r];if(t.includes(r)){n[r]=s;continue}vu(s)?s=$e(s,{ignoreKeys:t}):Array.isArray(s)&&(s=bu(s,{ignoreKeys:t})),n[uv(r)]=s}return n}const hv=e=>new Promise(t=>setTimeout(t,e));function dv({libraryName:e,libraryVersion:t,userAgent:n,publicKey:r="",integration:s=""}){const i="JavaScript";if(typeof n=="string")return n;if(typeof n=="function")return n({publicKey:r,libraryName:e,libraryVersion:t,languageName:i,integration:s});const o=[e,t,r].filter(Boolean).join("/"),a=[i,s].filter(Boolean).join("; ");return`${o} (${a})`}const fv={factor:2,time:100};function pv(e,t=fv){let n=0;function r(s){const i=Math.round(t.time*t.factor**n);return s({attempt:n,retry:o=>hv(o??i).then(()=>(n+=1,r(s)))})}return r(e)}class Ac extends Error{}class to extends Ac{constructor(t){super(),et(this,"originalProgressEvent"),this.name="NetworkError",this.message="Network error",Object.setPrototypeOf(this,to.prototype),this.originalProgressEvent=t}}const eo=(e,t)=>{e&&(e.aborted?Promise.resolve().then(t):e.addEventListener("abort",()=>t(),{once:!0}))};class yr extends Ac{constructor(t="Request canceled"){super(t),et(this,"isCancel",!0),this.name="CancelError",Object.setPrototypeOf(this,yr.prototype)}}const mv=500,kd=({check:e,interval:t=mv,timeout:n,signal:r})=>new Promise((s,i)=>{let o,a;eo(r,()=>{o&&clearTimeout(o),i(new yr("Poll cancelled"))}),n&&(a=setTimeout(()=>{o&&clearTimeout(o),i(new yr("Timed out"))},n));const c=()=>{try{Promise.resolve(e(r)).then(l=>{l?(a&&clearTimeout(a),s(l)):o=setTimeout(c,t)}).catch(l=>{a&&clearTimeout(a),i(l)})}catch(l){a&&clearTimeout(a),i(l)}};o=setTimeout(c,0)}),nt={baseCDN:"https://ucarecdn.com",baseURL:"https://upload.uploadcare.com",maxContentLength:50*1024*1024,retryThrottledRequestMaxTimes:1,retryNetworkErrorMaxTimes:3,multipartMinFileSize:25*1024*1024,multipartChunkSize:5*1024*1024,multipartMinLastPartSize:1024*1024,maxConcurrentRequests:4,pollingTimeoutMilliseconds:1e4,pusherKey:"79ae88bd931ea68464d9"},no="application/octet-stream",xd="original",en=({method:e,url:t,data:n,headers:r={},signal:s,onProgress:i})=>new Promise((o,a)=>{const c=new XMLHttpRequest,l=(e==null?void 0:e.toUpperCase())||"GET";let u=!1;c.open(l,t,!0),r&&Object.entries(r).forEach(h=>{const[f,m]=h;typeof m<"u"&&!Array.isArray(m)&&c.setRequestHeader(f,m)}),c.responseType="text",eo(s,()=>{u=!0,c.abort(),a(new yr)}),c.onload=()=>{if(c.status!=200)a(new Error(`Error ${c.status}: ${c.statusText}`));else{const h={method:l,url:t,data:n,headers:r||void 0,signal:s,onProgress:i},f=c.getAllResponseHeaders().trim().split(/[\r\n]+/),m={};f.forEach(function(x){const F=x.split(": "),w=F.shift(),_=F.join(": ");w&&typeof w<"u"&&(m[w]=_)});const E=c.response,v=c.status;o({request:h,data:E,headers:m,status:v})}},c.onerror=h=>{u||a(new to(h))},i&&typeof i=="function"&&(c.upload.onprogress=h=>{h.lengthComputable?i({isComputable:!0,value:h.loaded/h.total}):i({isComputable:!1})}),n?c.send(n):c.send()});function gv(e,...t){return e}const yv=({name:e})=>e?[e]:[],vv=gv;var bv=()=>new FormData;const Ad=e=>!1,ro=e=>typeof Blob<"u"&&e instanceof Blob,so=e=>typeof File<"u"&&e instanceof File,io=e=>!!e&&typeof e=="object"&&!Array.isArray(e)&&"uri"in e&&typeof e.uri=="string",xr=e=>ro(e)||so(e)||Ad()||io(e),wv=e=>typeof e=="string"||typeof e=="number"||typeof e>"u",_v=e=>!!e&&typeof e=="object"&&!Array.isArray(e),Ev=e=>!!e&&typeof e=="object"&&"data"in e&&xr(e.data);function Dd(e,t,n){if(Array.isArray(n))for(const r of n)Dd(e,`${t}[]`,r);else if(Ev(n)){const{name:r,contentType:s}=n,i=vv(n.data,r,s??no),o=yv({name:r,contentType:s});e.push([t,i,...o])}else if(_v(n))for(const[r,s]of Object.entries(n))typeof s<"u"&&e.push([`${t}[${r}]`,String(s)]);else wv(n)&&n&&e.push([t,n.toString()])}function Tv(e){const t=[];for(const[n,r]of Object.entries(e))Dd(t,n,r);return t}function oo(e){const t=bv(),n=Tv(e);for(const r of n){const[s,i,...o]=r;t.append(s,i,...o)}return t}class ae extends Ac{constructor(t,n,r,s,i){super(),et(this,"code"),et(this,"request"),et(this,"response"),et(this,"headers"),this.name="UploadError",this.message=t,this.code=n,this.request=r,this.response=s,this.headers=i,Object.setPrototypeOf(this,ae.prototype)}}const Sv=e=>{const t=new URLSearchParams;for(const[n,r]of Object.entries(e))r&&typeof r=="object"&&!Array.isArray(r)?Object.entries(r).filter(s=>s[1]??!1).forEach(s=>t.set(`${n}[${s[0]}]`,String(s[1]))):Array.isArray(r)?r.forEach(s=>{t.append(`${n}[]`,s)}):typeof r=="string"&&r?t.set(n,r):typeof r=="number"&&t.set(n,r.toString());return t.toString()},Ve=(e,t,n)=>{const r=new URL(e);return r.pathname=(r.pathname+t).replace("//","/"),n&&(r.search=Sv(n)),r.toString()};var Cv="6.14.1";const Iv="UploadcareUploadClient",kv=Cv;function _n(e){return dv({libraryName:Iv,libraryVersion:kv,...e})}const xv="RequestThrottledError",wu=15e3,Av=1e3;function Dv(e){const{headers:t}=e||{};if(!t||typeof t["retry-after"]!="string")return wu;const n=parseInt(t["retry-after"],10);return Number.isFinite(n)?n*1e3:wu}function nn(e,t){const{retryThrottledRequestMaxTimes:n,retryNetworkErrorMaxTimes:r}=t;return pv(({attempt:s,retry:i})=>e().catch(o=>{if("response"in o&&(o==null?void 0:o.code)===xv&&s<n)return i(Dv(o));if(o instanceof to&&s<r)return i((s+1)*Av);throw o}))}const Nd=e=>{let t="";return(ro(e)||so(e)||io(e))&&(t=e.type),t||no},Rd=e=>{let t="";return so(e)&&e.name?t=e.name:ro(e)||Ad()?t="":io(e)&&e.name&&(t=e.name),t||xd};function Dc(e){return typeof e>"u"||e==="auto"?"auto":e?"1":"0"}function Pd(e,{publicKey:t,fileName:n,contentType:r,baseURL:s=nt.baseURL,secureSignature:i,secureExpire:o,store:a,signal:c,onProgress:l,source:u="local",integration:h,userAgent:f,retryThrottledRequestMaxTimes:m=nt.retryThrottledRequestMaxTimes,retryNetworkErrorMaxTimes:E=nt.retryNetworkErrorMaxTimes,metadata:v}){return nn(()=>en({method:"POST",url:Ve(s,"/base/",{jsonerrors:1}),headers:{"X-UC-User-Agent":_n({publicKey:t,integration:h,userAgent:f})},data:oo({file:{data:e,name:n||Rd(e),contentType:r||Nd(e)},UPLOADCARE_PUB_KEY:t,UPLOADCARE_STORE:Dc(a),signature:i,expire:o,source:u,metadata:v}),signal:c,onProgress:l}).then(({data:x,headers:F,request:w})=>{const _=$e(JSON.parse(x));if("error"in _)throw new ae(_.error.content,_.error.errorCode,w,_,F);return _}),{retryNetworkErrorMaxTimes:E,retryThrottledRequestMaxTimes:m})}var Ra;(function(e){e.Token="token",e.FileInfo="file_info"})(Ra||(Ra={}));function Md(e,{publicKey:t,baseURL:n=nt.baseURL,store:r,fileName:s,checkForUrlDuplicates:i,saveUrlForRecurrentUploads:o,secureSignature:a,secureExpire:c,source:l="url",signal:u,integration:h,userAgent:f,retryThrottledRequestMaxTimes:m=nt.retryThrottledRequestMaxTimes,retryNetworkErrorMaxTimes:E=nt.retryNetworkErrorMaxTimes,metadata:v}){return nn(()=>en({method:"POST",headers:{"X-UC-User-Agent":_n({publicKey:t,integration:h,userAgent:f})},url:Ve(n,"/from_url/",{jsonerrors:1,pub_key:t,source_url:e,store:Dc(r),filename:s,check_URL_duplicates:i?1:void 0,save_URL_duplicates:o?1:void 0,signature:a,expire:c,source:l,metadata:v}),signal:u}).then(({data:x,headers:F,request:w})=>{const _=$e(JSON.parse(x));if("error"in _)throw new ae(_.error.content,_.error.errorCode,w,_,F);return _}),{retryNetworkErrorMaxTimes:E,retryThrottledRequestMaxTimes:m})}var ie;(function(e){e.Unknown="unknown",e.Waiting="waiting",e.Progress="progress",e.Error="error",e.Success="success"})(ie||(ie={}));const Nv=e=>"status"in e&&e.status===ie.Error;function Ld(e,{publicKey:t,baseURL:n=nt.baseURL,signal:r,integration:s,userAgent:i,retryThrottledRequestMaxTimes:o=nt.retryThrottledRequestMaxTimes,retryNetworkErrorMaxTimes:a=nt.retryNetworkErrorMaxTimes}={}){return nn(()=>en({method:"GET",headers:t?{"X-UC-User-Agent":_n({publicKey:t,integration:s,userAgent:i})}:void 0,url:Ve(n,"/from_url/status/",{jsonerrors:1,token:e}),signal:r}).then(({data:c,headers:l,request:u})=>{const h=$e(JSON.parse(c));if("error"in h&&!Nv(h))throw new ae(h.error.content,h.error.errorCode,u,h,l);return h}),{retryNetworkErrorMaxTimes:a,retryThrottledRequestMaxTimes:o})}function Od(e,{publicKey:t,baseURL:n=nt.baseURL,jsonpCallback:r,secureSignature:s,secureExpire:i,signal:o,source:a,integration:c,userAgent:l,retryThrottledRequestMaxTimes:u=nt.retryThrottledRequestMaxTimes,retryNetworkErrorMaxTimes:h=nt.retryNetworkErrorMaxTimes}){return nn(()=>en({method:"POST",headers:{"X-UC-User-Agent":_n({publicKey:t,integration:c,userAgent:l})},url:Ve(n,"/group/",{jsonerrors:1}),data:oo({files:e,callback:r,pub_key:t,signature:s,expire:i,source:a}),signal:o}).then(({data:f,headers:m,request:E})=>{const v=$e(JSON.parse(f));if("error"in v)throw new ae(v.error.content,v.error.errorCode,E,v,m);return v}),{retryNetworkErrorMaxTimes:h,retryThrottledRequestMaxTimes:u})}function Rv(e,{publicKey:t,baseURL:n=nt.baseURL,signal:r,source:s,integration:i,userAgent:o,retryThrottledRequestMaxTimes:a=nt.retryThrottledRequestMaxTimes,retryNetworkErrorMaxTimes:c=nt.retryNetworkErrorMaxTimes}){return nn(()=>en({method:"GET",headers:{"X-UC-User-Agent":_n({publicKey:t,integration:i,userAgent:o})},url:Ve(n,"/group/info/",{jsonerrors:1,pub_key:t,group_id:e,source:s}),signal:r}).then(({data:l,headers:u,request:h})=>{const f=$e(JSON.parse(l));if("error"in f)throw new ae(f.error.content,f.error.errorCode,h,f,u);return f}),{retryThrottledRequestMaxTimes:a,retryNetworkErrorMaxTimes:c})}function Nc(e,{publicKey:t,baseURL:n=nt.baseURL,signal:r,source:s,integration:i,userAgent:o,retryThrottledRequestMaxTimes:a=nt.retryThrottledRequestMaxTimes,retryNetworkErrorMaxTimes:c=nt.retryNetworkErrorMaxTimes}){return nn(()=>en({method:"GET",headers:{"X-UC-User-Agent":_n({publicKey:t,integration:i,userAgent:o})},url:Ve(n,"/info/",{jsonerrors:1,pub_key:t,file_id:e,source:s}),signal:r}).then(({data:l,headers:u,request:h})=>{const f=$e(JSON.parse(l));if("error"in f)throw new ae(f.error.content,f.error.errorCode,h,f,u);return f}),{retryThrottledRequestMaxTimes:a,retryNetworkErrorMaxTimes:c})}function Ud(e,{publicKey:t,contentType:n,fileName:r,multipartChunkSize:s=nt.multipartChunkSize,baseURL:i="",secureSignature:o,secureExpire:a,store:c,signal:l,source:u="local",integration:h,userAgent:f,retryThrottledRequestMaxTimes:m=nt.retryThrottledRequestMaxTimes,retryNetworkErrorMaxTimes:E=nt.retryNetworkErrorMaxTimes,metadata:v}){return nn(()=>en({method:"POST",url:Ve(i,"/multipart/start/",{jsonerrors:1}),headers:{"X-UC-User-Agent":_n({publicKey:t,integration:h,userAgent:f})},data:oo({filename:r||xd,size:e,content_type:n||no,part_size:s,UPLOADCARE_STORE:Dc(c),UPLOADCARE_PUB_KEY:t,signature:o,expire:a,source:u,metadata:v}),signal:l}).then(({data:x,headers:F,request:w})=>{const _=$e(JSON.parse(x));if("error"in _)throw new ae(_.error.content,_.error.errorCode,w,_,F);return _.parts=Object.keys(_.parts).map(y=>_.parts[Number(y)]),_}),{retryThrottledRequestMaxTimes:m,retryNetworkErrorMaxTimes:E})}function Fd(e,t,{contentType:n,signal:r,onProgress:s,retryThrottledRequestMaxTimes:i=nt.retryThrottledRequestMaxTimes,retryNetworkErrorMaxTimes:o=nt.retryNetworkErrorMaxTimes}){return nn(()=>en({method:"PUT",url:t,data:e,onProgress:s,signal:r,headers:{"Content-Type":n||no}}).then(a=>(s&&s({isComputable:!0,value:1}),a)).then(({status:a})=>({code:a})),{retryThrottledRequestMaxTimes:i,retryNetworkErrorMaxTimes:o})}function Vd(e,{publicKey:t,baseURL:n=nt.baseURL,source:r="local",signal:s,integration:i,userAgent:o,retryThrottledRequestMaxTimes:a=nt.retryThrottledRequestMaxTimes,retryNetworkErrorMaxTimes:c=nt.retryNetworkErrorMaxTimes}){return nn(()=>en({method:"POST",url:Ve(n,"/multipart/complete/",{jsonerrors:1}),headers:{"X-UC-User-Agent":_n({publicKey:t,integration:i,userAgent:o})},data:oo({uuid:e,UPLOADCARE_PUB_KEY:t,source:r}),signal:s}).then(({data:l,headers:u,request:h})=>{const f=$e(JSON.parse(l));if("error"in f)throw new ae(f.error.content,f.error.errorCode,h,f,u);return f}),{retryThrottledRequestMaxTimes:a,retryNetworkErrorMaxTimes:c})}function ao(e,{publicKey:t,baseURL:n,source:r,integration:s,userAgent:i,retryThrottledRequestMaxTimes:o,retryNetworkErrorMaxTimes:a,signal:c,onProgress:l}){return kd({check:u=>Nc(e,{publicKey:t,baseURL:n,signal:u,source:r,integration:s,userAgent:i,retryThrottledRequestMaxTimes:o,retryNetworkErrorMaxTimes:a}).then(h=>h.isReady?h:(l&&l({isComputable:!0,value:1}),!1)),signal:c})}function Pv(e){return"defaultEffects"in e}class Ds{constructor(t,{baseCDN:n=nt.baseCDN,fileName:r}={}){et(this,"uuid"),et(this,"name",null),et(this,"size",null),et(this,"isStored",null),et(this,"isImage",null),et(this,"mimeType",null),et(this,"cdnUrl",null),et(this,"s3Url",null),et(this,"originalFilename",null),et(this,"imageInfo",null),et(this,"videoInfo",null),et(this,"contentInfo",null),et(this,"metadata",null),et(this,"s3Bucket",null),et(this,"defaultEffects",null);const{uuid:s,s3Bucket:i}=t,o=Ve(n,`${s}/`),a=i?Ve(`https://${i}.s3.amazonaws.com/`,`${s}/${t.filename}`):null;this.uuid=s,this.name=r||t.filename,this.size=t.size,this.isStored=t.isStored,this.isImage=t.isImage,this.mimeType=t.mimeType,this.cdnUrl=o,this.originalFilename=t.originalFilename,this.imageInfo=t.imageInfo,this.videoInfo=t.videoInfo,this.contentInfo=t.contentInfo,this.metadata=t.metadata||null,this.s3Bucket=i||null,this.s3Url=a,Pv(t)&&(this.defaultEffects=t.defaultEffects)}}const Mv=(e,{publicKey:t,fileName:n,baseURL:r,secureSignature:s,secureExpire:i,store:o,contentType:a,signal:c,onProgress:l,source:u,integration:h,userAgent:f,retryThrottledRequestMaxTimes:m,retryNetworkErrorMaxTimes:E,baseCDN:v,metadata:x})=>Pd(e,{publicKey:t,fileName:n,contentType:a,baseURL:r,secureSignature:s,secureExpire:i,store:o,signal:c,onProgress:l,source:u,integration:h,userAgent:f,retryThrottledRequestMaxTimes:m,retryNetworkErrorMaxTimes:E,metadata:x}).then(({file:F})=>ao(F,{publicKey:t,baseURL:r,source:u,integration:h,userAgent:f,retryThrottledRequestMaxTimes:m,retryNetworkErrorMaxTimes:E,onProgress:l,signal:c})).then(F=>new Ds(F,{baseCDN:v})),Lv=(e,{publicKey:t,fileName:n,baseURL:r,signal:s,onProgress:i,source:o,integration:a,userAgent:c,retryThrottledRequestMaxTimes:l,retryNetworkErrorMaxTimes:u,baseCDN:h})=>Nc(e,{publicKey:t,baseURL:r,signal:s,source:o,integration:a,userAgent:c,retryThrottledRequestMaxTimes:l,retryNetworkErrorMaxTimes:u}).then(f=>new Ds(f,{baseCDN:h,fileName:n})).then(f=>(i&&i({isComputable:!0,value:1}),f)),Ov=(e,{signal:t}={})=>{let n=null,r=null;const s=e.map(()=>new AbortController),i=o=>()=>{r=o,s.forEach((a,c)=>c!==o&&a.abort())};return eo(t,()=>{s.forEach(o=>o.abort())}),Promise.all(e.map((o,a)=>{const c=i(a);return Promise.resolve().then(()=>o({stopRace:c,signal:s[a].signal})).then(l=>(c(),l)).catch(l=>(n=l,null))})).then(o=>{if(r===null)throw n;return o[r]})};var Uv=window.WebSocket;class Fv{constructor(){et(this,"events",Object.create({}))}emit(t,n){var r;(r=this.events[t])==null||r.forEach(s=>s(n))}on(t,n){this.events[t]=this.events[t]||[],this.events[t].push(n)}off(t,n){n?this.events[t]=this.events[t].filter(r=>r!==n):this.events[t]=[]}}const Vv=(e,t)=>e==="success"?{status:ie.Success,...t}:e==="progress"?{status:ie.Progress,...t}:{status:ie.Error,...t};class jv{constructor(t,n=3e4){et(this,"key"),et(this,"disconnectTime"),et(this,"ws"),et(this,"queue",[]),et(this,"isConnected",!1),et(this,"subscribers",0),et(this,"emmitter",new Fv),et(this,"disconnectTimeoutId",null),this.key=t,this.disconnectTime=n}connect(){if(this.disconnectTimeoutId&&clearTimeout(this.disconnectTimeoutId),!this.isConnected&&!this.ws){const t=`wss://ws.pusherapp.com/app/${this.key}?protocol=5&client=js&version=1.12.2`;this.ws=new Uv(t),this.ws.addEventListener("error",n=>{this.emmitter.emit("error",new Error(n.message))}),this.emmitter.on("connected",()=>{this.isConnected=!0,this.queue.forEach(n=>this.send(n.event,n.data)),this.queue=[]}),this.ws.addEventListener("message",n=>{const r=JSON.parse(n.data.toString());switch(r.event){case"pusher:connection_established":{this.emmitter.emit("connected",void 0);break}case"pusher:ping":{this.send("pusher:pong",{});break}case"progress":case"success":case"fail":this.emmitter.emit(r.channel,Vv(r.event,JSON.parse(r.data)))}})}}disconnect(){const t=()=>{var n;(n=this.ws)==null||n.close(),this.ws=void 0,this.isConnected=!1};this.disconnectTime?this.disconnectTimeoutId=setTimeout(()=>{t()},this.disconnectTime):t()}send(t,n){var r;const s=JSON.stringify({event:t,data:n});(r=this.ws)==null||r.send(s)}subscribe(t,n){this.subscribers+=1,this.connect();const r=`task-status-${t}`,s={event:"pusher:subscribe",data:{channel:r}};this.emmitter.on(r,n),this.isConnected?this.send(s.event,s.data):this.queue.push(s)}unsubscribe(t){this.subscribers-=1;const n=`task-status-${t}`,r={event:"pusher:unsubscribe",data:{channel:n}};this.emmitter.off(n),this.isConnected?this.send(r.event,r.data):this.queue=this.queue.filter(s=>s.data.channel!==n),this.subscribers===0&&this.disconnect()}onError(t){return this.emmitter.on("error",t),()=>this.emmitter.off("error",t)}}let Yo=null;const Rc=e=>{if(!Yo){const t=typeof window>"u"?0:3e4;Yo=new jv(e,t)}return Yo},Bv=e=>{Rc(e).connect()};function qv({token:e,publicKey:t,baseURL:n,integration:r,userAgent:s,retryThrottledRequestMaxTimes:i,retryNetworkErrorMaxTimes:o,onProgress:a,signal:c}){return kd({check:l=>Ld(e,{publicKey:t,baseURL:n,integration:r,userAgent:s,retryThrottledRequestMaxTimes:i,retryNetworkErrorMaxTimes:o,signal:l}).then(u=>{switch(u.status){case ie.Error:return new ae(u.error,u.errorCode);case ie.Waiting:return!1;case ie.Unknown:return new ae(`Token "${e}" was not found.`);case ie.Progress:return a&&(u.total==="unknown"?a({isComputable:!1}):a({isComputable:!0,value:u.done/u.total})),!1;case ie.Success:return a&&a({isComputable:!0,value:u.done/u.total}),u;default:throw new Error("Unknown status")}}),signal:c})}const $v=({token:e,pusherKey:t,signal:n,onProgress:r})=>new Promise((s,i)=>{const o=Rc(t),a=o.onError(i),c=()=>{a(),o.unsubscribe(e)};eo(n,()=>{c(),i(new yr("pusher cancelled"))}),o.subscribe(e,l=>{switch(l.status){case ie.Progress:{r&&(l.total==="unknown"?r({isComputable:!1}):r({isComputable:!0,value:l.done/l.total}));break}case ie.Success:{c(),r&&r({isComputable:!0,value:l.done/l.total}),s(l);break}case ie.Error:c(),i(new ae(l.msg,l.error_code))}})}),zv=(e,{publicKey:t,fileName:n,baseURL:r,baseCDN:s,checkForUrlDuplicates:i,saveUrlForRecurrentUploads:o,secureSignature:a,secureExpire:c,store:l,signal:u,onProgress:h,source:f,integration:m,userAgent:E,retryThrottledRequestMaxTimes:v,pusherKey:x=nt.pusherKey,metadata:F})=>Promise.resolve(Bv(x)).then(()=>Md(e,{publicKey:t,fileName:n,baseURL:r,checkForUrlDuplicates:i,saveUrlForRecurrentUploads:o,secureSignature:a,secureExpire:c,store:l,signal:u,source:f,integration:m,userAgent:E,retryThrottledRequestMaxTimes:v,metadata:F})).catch(w=>{const _=Rc(x);return _==null||_.disconnect(),Promise.reject(w)}).then(w=>w.type===Ra.FileInfo?w:Ov([({signal:_})=>qv({token:w.token,publicKey:t,baseURL:r,integration:m,userAgent:E,retryThrottledRequestMaxTimes:v,onProgress:h,signal:_}),({signal:_})=>$v({token:w.token,pusherKey:x,signal:_,onProgress:h})],{signal:u})).then(w=>{if(w instanceof ae)throw w;return w}).then(w=>ao(w.uuid,{publicKey:t,baseURL:r,integration:m,userAgent:E,retryThrottledRequestMaxTimes:v,onProgress:h,signal:u})).then(w=>new Ds(w,{baseCDN:s})),Zo=new WeakMap,Kv=async e=>{if(Zo.has(e))return Zo.get(e);const t=await fetch(e.uri).then(n=>n.blob());return Zo.set(e,t),t},jd=async e=>{if(so(e)||ro(e))return e.size;if(io(e))return(await Kv(e)).size;throw new Error("Unknown file type. Cannot determine file size.")},Gv=(e,t=nt.multipartMinFileSize)=>e>=t,Bd=e=>{const t="[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}",n=new RegExp(t);return!xr(e)&&n.test(e)},Pc=e=>{const t="^(?:\\w+:)?\\/\\/([^\\s\\.]+\\.\\S{2}|localhost[\\:?\\d]*)\\S*$",n=new RegExp(t);return!xr(e)&&n.test(e)},Hv=(e,t)=>new Promise((n,r)=>{const s=[];let i=!1,o=t.length;const a=[...t],c=()=>{const l=t.length-a.length,u=a.shift();u&&u().then(h=>{i||(s[l]=h,o-=1,o?c():n(s))}).catch(h=>{i=!0,r(h)})};for(let l=0;l<e;l++)c()}),Wv=(e,t,n,r)=>{const s=r*t,i=Math.min(s+r,n);return e.slice(s,i)},Qv=async(e,t,n)=>r=>Wv(e,r,t,n),Xv=(e,t,{publicKey:n,contentType:r,onProgress:s,signal:i,integration:o,retryThrottledRequestMaxTimes:a,retryNetworkErrorMaxTimes:c})=>Fd(e,t,{publicKey:n,contentType:r,onProgress:s,signal:i,integration:o,retryThrottledRequestMaxTimes:a,retryNetworkErrorMaxTimes:c}),Jv=async(e,{publicKey:t,fileName:n,fileSize:r,baseURL:s,secureSignature:i,secureExpire:o,store:a,signal:c,onProgress:l,source:u,integration:h,userAgent:f,retryThrottledRequestMaxTimes:m,retryNetworkErrorMaxTimes:E,contentType:v,multipartChunkSize:x=nt.multipartChunkSize,maxConcurrentRequests:F=nt.maxConcurrentRequests,baseCDN:w,metadata:_})=>{const y=r??await jd(e);let $;const k=(R,V)=>{if(!l)return;$||($=Array(R).fill(0));const tt=rt=>rt.reduce((St,be)=>St+be,0);return rt=>{rt.isComputable&&($[V]=rt.value,l({isComputable:!0,value:tt($)/R}))}};return v||(v=Nd(e)),Ud(y,{publicKey:t,contentType:v,fileName:n||Rd(e),baseURL:s,secureSignature:i,secureExpire:o,store:a,signal:c,source:u,integration:h,userAgent:f,retryThrottledRequestMaxTimes:m,retryNetworkErrorMaxTimes:E,metadata:_}).then(async({uuid:R,parts:V})=>{const tt=await Qv(e,y,x);return Promise.all([R,Hv(F,V.map((rt,St)=>()=>Xv(tt(St),rt,{publicKey:t,contentType:v,onProgress:k(V.length,St),signal:c,integration:h,retryThrottledRequestMaxTimes:m,retryNetworkErrorMaxTimes:E})))])}).then(([R])=>Vd(R,{publicKey:t,baseURL:s,source:u,integration:h,userAgent:f,retryThrottledRequestMaxTimes:m,retryNetworkErrorMaxTimes:E})).then(R=>R.isReady?R:ao(R.uuid,{publicKey:t,baseURL:s,source:u,integration:h,userAgent:f,retryThrottledRequestMaxTimes:m,retryNetworkErrorMaxTimes:E,onProgress:l,signal:c})).then(R=>new Ds(R,{baseCDN:w}))};async function qd(e,{publicKey:t,fileName:n,baseURL:r=nt.baseURL,secureSignature:s,secureExpire:i,store:o,signal:a,onProgress:c,source:l,integration:u,userAgent:h,retryThrottledRequestMaxTimes:f,retryNetworkErrorMaxTimes:m,contentType:E,multipartMinFileSize:v,multipartChunkSize:x,maxConcurrentRequests:F,baseCDN:w=nt.baseCDN,checkForUrlDuplicates:_,saveUrlForRecurrentUploads:y,pusherKey:$,metadata:k}){if(xr(e)){const R=await jd(e);return Gv(R,v)?Jv(e,{publicKey:t,contentType:E,multipartChunkSize:x,fileSize:R,fileName:n,baseURL:r,secureSignature:s,secureExpire:i,store:o,signal:a,onProgress:c,source:l,integration:u,userAgent:h,maxConcurrentRequests:F,retryThrottledRequestMaxTimes:f,retryNetworkErrorMaxTimes:m,baseCDN:w,metadata:k}):Mv(e,{publicKey:t,fileName:n,contentType:E,baseURL:r,secureSignature:s,secureExpire:i,store:o,signal:a,onProgress:c,source:l,integration:u,userAgent:h,retryThrottledRequestMaxTimes:f,retryNetworkErrorMaxTimes:m,baseCDN:w,metadata:k})}if(Pc(e))return zv(e,{publicKey:t,fileName:n,baseURL:r,baseCDN:w,checkForUrlDuplicates:_,saveUrlForRecurrentUploads:y,secureSignature:s,secureExpire:i,store:o,signal:a,onProgress:c,source:l,integration:u,userAgent:h,retryThrottledRequestMaxTimes:f,retryNetworkErrorMaxTimes:m,pusherKey:$,metadata:k});if(Bd(e))return Lv(e,{publicKey:t,fileName:n,baseURL:r,signal:a,onProgress:c,source:l,integration:u,userAgent:h,retryThrottledRequestMaxTimes:f,retryNetworkErrorMaxTimes:m,baseCDN:w});throw new TypeError(`File uploading from "${e}" is not supported`)}class Yv{constructor(t,{baseCDN:n=nt.baseCDN}={}){et(this,"uuid"),et(this,"filesCount"),et(this,"totalSize"),et(this,"isStored"),et(this,"isImage"),et(this,"cdnUrl"),et(this,"files"),et(this,"createdAt"),et(this,"storedAt",null),this.uuid=t.id,this.filesCount=t.filesCount;const r=t.files.filter(Boolean);this.totalSize=Object.values(r).reduce((s,i)=>s+i.size,0),this.isStored=!!t.datetimeStored,this.isImage=!!Object.values(r).filter(s=>s.isImage).length,this.cdnUrl=t.cdnUrl,this.files=r.map(s=>new Ds(s,{baseCDN:n})),this.createdAt=t.datetimeCreated,this.storedAt=t.datetimeStored}}const Zv=e=>{for(const t of e)if(!xr(t))return!1;return!0},t0=e=>{for(const t of e)if(!Bd(t))return!1;return!0},e0=e=>{for(const t of e)if(!Pc(t))return!1;return!0};function n0(e,{publicKey:t,fileName:n,baseURL:r=nt.baseURL,secureSignature:s,secureExpire:i,store:o,signal:a,onProgress:c,source:l,integration:u,userAgent:h,retryThrottledRequestMaxTimes:f,retryNetworkErrorMaxTimes:m,contentType:E,multipartChunkSize:v=nt.multipartChunkSize,baseCDN:x=nt.baseCDN,checkForUrlDuplicates:F,saveUrlForRecurrentUploads:w,jsonpCallback:_}){if(!Zv(e)&&!e0(e)&&!t0(e))throw new TypeError(`Group uploading from "${e}" is not supported`);let y,$=!0;const k=e.length,R=(V,tt)=>{if(!c)return;y||(y=Array(V).fill(0));const rt=St=>St.reduce((be,rn)=>be+rn)/V;return St=>{if(!St.isComputable||!$){$=!1,c({isComputable:!1});return}y[tt]=St.value,c({isComputable:!0,value:rt(y)})}};return Promise.all(e.map((V,tt)=>xr(V)||Pc(V)?qd(V,{publicKey:t,fileName:n,baseURL:r,secureSignature:s,secureExpire:i,store:o,signal:a,onProgress:R(k,tt),source:l,integration:u,userAgent:h,retryThrottledRequestMaxTimes:f,retryNetworkErrorMaxTimes:m,contentType:E,multipartChunkSize:v,baseCDN:x,checkForUrlDuplicates:F,saveUrlForRecurrentUploads:w}).then(rt=>rt.uuid):V)).then(V=>Od(V,{publicKey:t,baseURL:r,jsonpCallback:_,secureSignature:s,secureExpire:i,signal:a,source:l,integration:u,userAgent:h,retryThrottledRequestMaxTimes:f,retryNetworkErrorMaxTimes:m}).then(tt=>new Yv(tt,{baseCDN:x})).then(tt=>(c&&c({isComputable:!0,value:1}),tt)))}const he=(e,t)=>({...t,...e});class $d{constructor(t){et(this,"settings"),this.settings=Object.assign({},nt,t)}updateSettings(t){this.settings=Object.assign(this.settings,t)}getSettings(){return this.settings}base(t,n={}){const r=this.getSettings();return Pd(t,he(n,r))}info(t,n={}){const r=this.getSettings();return Nc(t,he(n,r))}fromUrl(t,n={}){const r=this.getSettings();return Md(t,he(n,r))}fromUrlStatus(t,n={}){const r=this.getSettings();return Ld(t,he(n,r))}group(t,n={}){const r=this.getSettings();return Od(t,he(n,r))}groupInfo(t,n={}){const r=this.getSettings();return Rv(t,he(n,r))}multipartStart(t,n={}){const r=this.getSettings();return Ud(t,he(n,r))}multipartUpload(t,n,r={}){const s=this.getSettings();return Fd(t,n,he(r,s))}multipartComplete(t,n={}){const r=this.getSettings();return Vd(t,he(n,r))}uploadFile(t,n={}){const r=this.getSettings();return qd(t,he(n,r))}uploadFileGroup(t,n={}){const r=this.getSettings();return n0(t,he(n,r))}isReadyPoll(t,n={}){const r=this.getSettings();return ao(t,he(n,r))}}const r0={class:"image-loader"},s0={class:"image-loader__wrapper"},i0={class:"image-loader__input"},o0=["src"],a0={class:"image-loader__text"},c0={key:0,class:"image-loader__text"},l0=Ye({__name:"ImageLoader",props:{sizeRecommended:{}},emits:["onImageParse"],setup(e,{emit:t}){const n=t;new $d({publicKey:"10a6fd7ad4acb396dfe1"});const r=({target:c})=>{const l=c.files[0];if(l){const u=new FileReader;u.onload=h=>{const f=new Blob([h.target.result]);s.value=f,i.value=URL.createObjectURL(f),n("onImageParse",{previewUrl:i.value,imageContainer:s.value})},u.readAsArrayBuffer(l)}},s=dt(void 0),i=dt(void 0),o=Pt(()=>i.value?"https://ucarecdn.com/2908aae4-53b5-4798-b58f-c21797b07a97/":"https://ucarecdn.com/e8e68b20-7640-4abf-b79a-1d805e5f84b1/"),a=Pt(()=>i.value?"Редактировать":"Выбрать");return dt(void 0),(c,l)=>(X(),ht("div",r0,[L("div",s0,[L("label",i0,[L("img",{class:"image-loader__symbol",src:o.value},null,8,o0),L("span",a0,Ae(a.value),1),c.sizeRecommended?(X(),ht("p",c0,Ae(c.$props.sizeRecommended),1)):le("",!0),L("input",{type:"file",accept:"image/png, image/jpg, image/jpeg",alt:"what?",onChange:r},null,32)])])]))}}),Pa={0:{name:"Сила",img:"a692c434-c29e-4214-9b48-f920e7773dee",ico:""},1:{name:"Телосложение",img:"b185335d-0538-47ab-b95d-c911b1952c5b",ico:""},2:{name:"Интеллект",img:"b1ebd4cf-6386-4f13-a688-695399822e56",ico:""},3:{name:"Мудрость",img:"7ed9b0d3-b3fa-459a-801f-4704586a10b0",ico:""},4:{name:"Обаяние",img:"55adbf0d-2025-42fd-a6dc-cf1c4196c48e",ico:""},5:{name:"Ловкость",img:"91206445-133b-4599-a0b9-ef2a487eea05",ico:""}},de=26,jr=26,Ne={0:{name:"Сила",img:"a692c434-c29e-4214-9b48-f920e7773dee",ico:""},1:{name:"Телосложение",img:"b185335d-0538-47ab-b95d-c911b1952c5b",ico:""},2:{name:"Интеллект",img:"b1ebd4cf-6386-4f13-a688-695399822e56",ico:""},3:{name:"Мудрость",img:"7ed9b0d3-b3fa-459a-801f-4704586a10b0",ico:""},4:{name:"Обаяние",img:"55adbf0d-2025-42fd-a6dc-cf1c4196c48e",ico:""},5:{name:"Ловкость",img:"91206445-133b-4599-a0b9-ef2a487eea05",ico:""},6:{name:"Карта Героя",img:"9e24d935-6617-4d6f-a3e1-8ee9496e8579",ico:"",width:jr-2,count:"out"},7:{name:"Карта Анти-Героя",img:"cd2c363b-18be-4f60-8ba0-993bfedf204e",ico:"",width:jr-2,count:"out"},8:{name:"Триумф",img:"3a0a39fa-1484-4962-af36-4bf501e71ef0",ico:"",width:jr,count:"in"},9:{name:"Трагедия",img:"5a331c0b-b0b2-43de-a073-1876796b07b5",ico:"",width:jr,count:"in"},10:{name:"Опыт",img:"e25883b3-7949-49e1-826f-d371c00f2db3",ico:"",width:jr,count:"in"},11:{name:"Путь справедливости",img:"ec9ddfe0-8215-4865-80d4-810ac7a6c1ca",ico:"",height:de,width:de-1},12:{name:"Путь познания",img:"0b14e189-34ec-4471-9908-366e89bf4d5e",ico:"",height:de,width:de-1},13:{name:"Путь короны",img:"04a6d945-c604-4619-abc3-89fb85c467ac",ico:"",height:de,width:de-1},14:{name:"Путь зла",img:"fe71328a-b575-41ae-b518-2caca7617f37",ico:"",height:de,width:de-1},15:{name:"Путь святости",img:"91df25e9-825f-46d9-9cb1-c0ce79976f94",ico:"",height:de,width:de-1},16:{name:"Путь приоды",img:"cfd55f90-970f-46eb-8a48-04a70ff3113e",ico:"",height:de,width:de-1}},u0={class:"reward"},h0=["src","alt"],d0=Ye({__name:"Reward",props:{id:{}},setup(e){const t=Qh(e,"id");return Pt(()=>{switch(t.value){case 0:case 1:case 2:case 3:case 4:case 5:return!0;default:return!1}}),(n,r)=>(X(),ht("div",u0,[L("img",{class:"reward__image",src:`https://ucarecdn.com/${Z(Ne)[t.value].img}/`,alt:Z(Ne)[t.value].name,style:pe(`
				max-height: ${Z(Ne)[t.value].height??30}px;
				height: ${Z(Ne)[t.value].height??30}px;
				max-width: ${Z(Ne)[t.value].width??28}px;
				width: ${Z(Ne)[t.value].width??28}px;
			`)},null,12,h0)]))}}),_u=tn(d0,[["__scopeId","data-v-de5a2131"]]),f0=["data-noimg"],p0={class:"card-header__text"},m0={class:"card-path__rewards",ref:"topRew"},g0={class:"card-header__text"},y0={class:"card-path__rewards",ref:"botRew"},v0={class:"card__name card-challenge"},b0={class:"card-challenge__difficulty"},w0={key:0,class:"card-challenge__gap"},_0={key:0,class:"card-challenge__gap"},E0={class:"card-challenge__name"},T0=Ye({__name:"Card",props:{book:{type:Boolean},height:{},width:{},act:{},backImg:{},frontImg:{},topPath:{},botPath:{},cardName:{},difficulty:{},challengeRunes:{},zoom:{},topPathExtraDif:{},botPathExtraDif:{},topRewards:{},botRewards:{},card:{}},emits:["onImageParse"],setup(e){const t=e,n=Qh(t,"frontImg"),{act:r,botPath:s,topPath:i,book:o}=Wh(t),a=dt(0),c=dt(0),l=dt(!1),u=dt(!1),h=dt(!1),f=dt(!1),m=Pt(()=>{switch(r.value){case 0:case 1:case 2:return xc[r.value].backImg;default:return""}}),E=dt("topPathEl"),v=Pt(()=>{var y;if(i.value.length)return((y=E.value)==null?void 0:y.offsetHeight)+15});console.log(v);const x=y=>{if(u.value||f.value||h.value||!n.value||o.value)return;const $=y.offsetX,k=y.offsetY,R=y.target.offsetHeight,V=y.target.offsetWidth,tt=15,rt=15,St=R/2,be=V/2,rn=St/rt,Or=be/tt,Gt=($-be)/Or,bt=(k-St)/rn;a.value===0&&c.value===0&&(u.value=!0,setTimeout(()=>{u.value=!1},100)),c.value=Gt,a.value=bt},F=()=>{o.value||(l.value=!0)},w=()=>{l.value=!1,a.value=0,c.value=0},_=()=>{if(!(f.value||!n.value)){if(w(),h.value){h.value=!1,f.value=!0,setTimeout(()=>{f.value=!1,u.value=!1,l.value=!0},500);return}h.value=!h.value,f.value=!f.value,setTimeout(()=>{f.value=!1,u.value=!1,l.value=!0},500)}};return(y,$)=>{var k,R;return X(),ht("div",{class:"card",onMousemove:x,onMouseout:w,onMouseenter:F,onClick:_,"data-noimg":!n.value,style:pe(`
			transform: scale(${y.zoom/100});
		`)},[L("div",{class:Ut(["card__wrapper",{"card__wrapper--faced":f.value,"card__wrapper--outed":!l.value||u.value}]),style:pe(`
				height: ${y.$props.height??10}px;
				width: ${y.$props.width??10}px;
				transform: rotateX(${a.value}deg) rotateY(${h.value?"180":-c.value}deg);
			`)},[L("div",{class:Ut(["card__front",{"card__front--flipped":f.value}]),style:pe(`
			        background: url('${y.card.imageId?`https://ucarecdn.com/${y.card.imageId}/`:y.card.imageUrl}') no-repeat center/cover;
			     `)},[L("div",{class:Ut(["card__path card__path--top card-path",{"card__path--extra":y.topPathExtraDif,"card__path--dark":y.card.topPath.isDark}]),ref_key:"topPathEl",ref:E},[L("span",p0,[y.topPathExtraDif?(X(),ht("span",{key:0,class:Ut(["card-challenge__difficulty card-challenge__difficulty--extra",{"card__path--dark":y.card.topPath.isDark}])}," +"+Ae(y.topPathExtraDif),3)):le("",!0),L("span",{class:Ut({"card-challenge__name--dark":y.card.topPath.isDark}),style:pe(`
									width: calc(100% - ${((k=y.$refs.topRew)==null?void 0:k.offsetWidth)+43}px);
								`)},Ae(Z(i)),7)]),L("div",m0,[(X(!0),ht(At,null,fn(y.card.topPath.rewards,V=>(X(),ve(_u,{class:Ut({"card__path--dark":y.card.topPath.isDark}),id:V.id},null,8,["class","id"]))),256))],512)],2),L("div",{class:Ut(["card__path card__path--bottom card-path",{"card__path--extra":y.botPathExtraDif,"card__path--dark":y.card.botPath.isDark}])},[L("span",g0,[y.botPathExtraDif?(X(),ht("span",{key:0,class:Ut(["card-challenge__difficulty card-challenge__difficulty--extra",{"card__path--dark":y.card.botPath.isDark}])}," +"+Ae(y.botPathExtraDif),3)):le("",!0),L("span",{class:Ut({"card-challenge__name--dark":y.card.botPath.isDark}),style:pe(`
									width: calc(100% - ${((R=y.$refs.botRew)==null?void 0:R.offsetWidth)+43}px);
								`)},Ae(Z(s)),7)]),L("div",y0,[(X(!0),ht(At,null,fn(y.card.botPath.rewards,V=>(X(),ve(_u,{class:Ut({"card__path--dark":y.card.botPath.isDark}),id:V.id},null,8,["class","id"]))),256))],512)],2),L("div",v0,[L("div",{class:"card-challenge__rotated",style:pe(`top: ${v.value}px;`)},[L("div",b0,Ae(y.difficulty),1),(y.challengeRunes||[]).length!==0?(X(),ht("div",w0)):le("",!0),(X(!0),ht(At,null,fn(y.challengeRunes||[],(V,tt)=>(X(),ht(At,null,[L("div",{class:"card-challenge__rune",style:pe(`
									background: url('https://ucarecdn.com/${Z(Pa)[V].img}/') no-repeat center/contain;
								`)},null,4),tt!==(y.challengeRunes||[]).length-1?(X(),ht("div",_0)):le("",!0)],64))),256)),L("span",E0,Ae(y.cardName),1)],4)])],6),n.value?le("",!0):(X(),ve(l0,{key:0,class:"card__image-loader",onOnImageParse:$[0]||($[0]=V=>y.$emit("onImageParse",V)),"size-recommended":`${y.$props.height}x${y.$props.width}`},null,8,["size-recommended"]))],6),L("div",{class:Ut(["card__back",{"card__back--flipped":h.value}]),style:pe(`
		        background: url('https://ucarecdn.com/${y.$props.backImg||m.value}/') no-repeat center/cover;
		     `)},null,6)],44,f0)}}}),zd=tn(T0,[["__scopeId","data-v-9e51fc53"]]),_i=300,In={height:_i*1.72,width:_i},ta={height:_i*1.38,width:_i},Ei={0:{name:"Происхождение",img:"",ico:"e3245314-af5c-4464-8d6d-a390503a3aab",backImg:"aefa057a-2202-493b-a298-a661c0707fab",cardSize:In},1:{name:"Мотивация",img:"",ico:"4a372f73-d2a1-4f63-8e67-c9521953fbb1",backImg:"0458b31e-e350-49b7-a729-dedf1fa4d583",cardSize:In},2:{name:"Судьба",img:"",ico:"1ebde30a-5f86-48c5-b69f-5c946ea59de8",backImg:"2eddf5db-f2b7-420a-a49b-e057d675b872",cardSize:In},3:{name:"Карта Героя",img:"",ico:"af14f0cd-42e8-42cc-b36f-c2482ba7aa1b",backImg:"2980073f-66d0-4e20-aa04-3d399d56e937",cardSize:ta},4:{name:"Карта Антигероя",img:"",ico:"4cd045a9-ded3-4330-bc8c-7052accc7653",backImg:"3efb750a-54e0-4841-bd39-0dfd64ad072a",cardSize:ta},5:{name:"Карта Черты",img:"",ico:"5efc700f-ce8c-4b66-8721-8e4794bca980",backImg:null,cardSize:In},6:{name:"Испытание",img:"",ico:"db3b09d0-a84f-4b50-865b-667a412100da",backImg:null,cardSize:In},7:{name:"Злодей",img:"",ico:"19474701-7c1c-4263-8abc-103210ffc0be",backImg:null,cardSize:In},8:{name:"Злодейское дияние",img:"",ico:"ed81f971-0a43-4ec3-a1a6-48e5602f5d5b",backImg:"8a967fcd-b493-4323-8f0c-65cdd491fab7",cardSize:ta},9:{name:"Союзник",img:"",ico:"5542f8ed-b522-4f86-9d1a-97d5a5cecff7",backImg:null,cardSize:In}},S0=["min","max","minlength","maxlength","value"],C0=Ye({__name:"Input",props:{max:{},min:{},text:{}},emits:["update:text"],setup(e,{emit:t}){return(n,r)=>(X(),ht("input",{class:"custom-input",type:"text",min:n.$props.min,max:n.$props.max,minlength:n.$props.min,maxlength:n.$props.max,value:n.$props.text,onInput:r[0]||(r[0]=s=>n.$emit("update:text",s.target.value))},null,40,S0))}}),ea=tn(C0,[["__scopeId","data-v-b14928bf"]]),I0={class:"rune-checkbox"},k0=["checked","disabled"],x0=["src","data-type"],A0={key:0,class:"rune-checkbox__count",type:"number",max:"10",min:"0"},D0=Ye({__name:"RuneCheckbox",props:{checked:{type:Boolean},id:{},disabled:{type:Boolean},items:{},allowedCount:{type:Boolean}},emits:["toggle"],setup(e){return(t,n)=>(X(),ht("label",I0,[L("input",{type:"checkbox",checked:t.$props.checked,id:"123",onChange:n[0]||(n[0]=r=>t.$emit("toggle",t.id)),disabled:t.disabled},null,40,k0),L("img",{src:`https://ucarecdn.com/${t.items[t.id].img}/`,alt:"rune","data-type":t.id},null,8,x0),t.allowedCount?(X(),ht("input",A0)):le("",!0)]))}}),na=tn(D0,[["__scopeId","data-v-0c319c42"]]);var Eu={};/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Kd=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let s=e.charCodeAt(r);s<128?t[n++]=s:s<2048?(t[n++]=s>>6|192,t[n++]=s&63|128):(s&64512)===55296&&r+1<e.length&&(e.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(e.charCodeAt(++r)&1023),t[n++]=s>>18|240,t[n++]=s>>12&63|128,t[n++]=s>>6&63|128,t[n++]=s&63|128):(t[n++]=s>>12|224,t[n++]=s>>6&63|128,t[n++]=s&63|128)}return t},N0=function(e){const t=[];let n=0,r=0;for(;n<e.length;){const s=e[n++];if(s<128)t[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=e[n++];t[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=e[n++],o=e[n++],a=e[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;t[r++]=String.fromCharCode(55296+(c>>10)),t[r++]=String.fromCharCode(56320+(c&1023))}else{const i=e[n++],o=e[n++];t[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return t.join("")},Gd={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<e.length;s+=3){const i=e[s],o=s+1<e.length,a=o?e[s+1]:0,c=s+2<e.length,l=c?e[s+2]:0,u=i>>2,h=(i&3)<<4|a>>4;let f=(a&15)<<2|l>>6,m=l&63;c||(m=64,o||(f=64)),r.push(n[u],n[h],n[f],n[m])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Kd(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):N0(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<e.length;){const i=n[e.charAt(s++)],o=s<e.length?n[e.charAt(s)]:0;++s;const a=s<e.length?n[e.charAt(s)]:64;++s;const c=s<e.length?n[e.charAt(s)]:64;if(++s,i==null||o==null||a==null||c==null)throw new R0;const l=i<<2|o>>4;if(r.push(l),a!==64){const u=o<<4&240|a>>2;if(r.push(u),c!==64){const h=a<<6&192|c;r.push(h)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class R0 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const P0=function(e){const t=Kd(e);return Gd.encodeByteArray(t,!0)},Ti=function(e){return P0(e).replace(/\./g,"")},M0=function(e){try{return Gd.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function L0(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const O0=()=>L0().__FIREBASE_DEFAULTS__,U0=()=>{if(typeof process>"u"||typeof Eu>"u")return;const e=Eu.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},F0=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&M0(e[1]);return t&&JSON.parse(t)},Mc=()=>{try{return O0()||U0()||F0()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},V0=e=>{var t,n;return(n=(t=Mc())===null||t===void 0?void 0:t.emulatorHosts)===null||n===void 0?void 0:n[e]},j0=e=>{const t=V0(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return t[0]==="["?[t.substring(1,n-1),r]:[t.substring(0,n),r]},Hd=()=>{var e;return(e=Mc())===null||e===void 0?void 0:e.config};/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class B0{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}wrapCallback(t){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(n):t(n,r))}}}/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function q0(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=t||"demo-project",s=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Ti(JSON.stringify(n)),Ti(JSON.stringify(o)),""].join(".")}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function Si(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function $0(){var e;const t=(e=Mc())===null||e===void 0?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function z0(){return!$0()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Wd(){try{return typeof indexedDB=="object"}catch{return!1}}function K0(){return new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;t(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){t(n)}})}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const G0="FirebaseError";class Ar extends Error{constructor(t,n,r){super(n),this.code=t,this.customData=r,this.name=G0,Object.setPrototypeOf(this,Ar.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Qd.prototype.create)}}class Qd{constructor(t,n,r){this.service=t,this.serviceName=n,this.errors=r}create(t,...n){const r=n[0]||{},s=`${this.service}/${t}`,i=this.errors[t],o=i?H0(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Ar(s,a,r)}}function H0(e,t){return e.replace(W0,(n,r)=>{const s=t[r];return s!=null?String(s):`<${r}?>`})}const W0=/\{\$([^}]+)}/g;function Ma(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const s of n){if(!r.includes(s))return!1;const i=e[s],o=t[s];if(Tu(i)&&Tu(o)){if(!Ma(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Tu(e){return e!==null&&typeof e=="object"}/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function hs(e){return e&&e._delegate?e._delegate:e}class ds{constructor(t,n,r){this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const kn="[DEFAULT]";/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Q0{constructor(t,n){this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){const r=new B0;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(t){var n;const r=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),s=(n=t==null?void 0:t.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(J0(t))try{this.getOrInitializeService({instanceIdentifier:kn})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(t=kn){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...t.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=kn){return this.instances.has(t)}getOptions(t=kn){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:n={}}=t,r=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(t,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(t),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&t(o,s),()=>{i.delete(t)}}invokeOnInitCallbacks(t,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(t,n)}catch{}}getOrInitializeService({instanceIdentifier:t,options:n={}}){let r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:X0(t),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch{}return r||null}normalizeInstanceIdentifier(t=kn){return this.component?this.component.multipleInstances?t:kn:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function X0(e){return e===kn?void 0:e}function J0(e){return e.instantiationMode==="EAGER"}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Y0{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const n=this.getProvider(t.name);if(n.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);n.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const n=new Q0(t,this);return this.providers.set(t,n),n}getProviders(){return Array.from(this.providers.values())}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var ct;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(ct||(ct={}));const Z0={debug:ct.DEBUG,verbose:ct.VERBOSE,info:ct.INFO,warn:ct.WARN,error:ct.ERROR,silent:ct.SILENT},tb=ct.INFO,eb={[ct.DEBUG]:"log",[ct.VERBOSE]:"log",[ct.INFO]:"info",[ct.WARN]:"warn",[ct.ERROR]:"error"},nb=(e,t,...n)=>{if(t<e.logLevel)return;const r=new Date().toISOString(),s=eb[t];if(s)console[s](`[${r}]  ${e.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Xd{constructor(t){this.name=t,this._logLevel=tb,this._logHandler=nb,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in ct))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?Z0[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,ct.DEBUG,...t),this._logHandler(this,ct.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,ct.VERBOSE,...t),this._logHandler(this,ct.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,ct.INFO,...t),this._logHandler(this,ct.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,ct.WARN,...t),this._logHandler(this,ct.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,ct.ERROR,...t),this._logHandler(this,ct.ERROR,...t)}}const rb=(e,t)=>t.some(n=>e instanceof n);let Su,Cu;function sb(){return Su||(Su=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ib(){return Cu||(Cu=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Jd=new WeakMap,La=new WeakMap,Yd=new WeakMap,ra=new WeakMap,Lc=new WeakMap;function ob(e){const t=new Promise((n,r)=>{const s=()=>{e.removeEventListener("success",i),e.removeEventListener("error",o)},i=()=>{n(pn(e.result)),s()},o=()=>{r(e.error),s()};e.addEventListener("success",i),e.addEventListener("error",o)});return t.then(n=>{n instanceof IDBCursor&&Jd.set(n,e)}).catch(()=>{}),Lc.set(t,e),t}function ab(e){if(La.has(e))return;const t=new Promise((n,r)=>{const s=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",o),e.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(e.error||new DOMException("AbortError","AbortError")),s()};e.addEventListener("complete",i),e.addEventListener("error",o),e.addEventListener("abort",o)});La.set(e,t)}let Oa={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return La.get(e);if(t==="objectStoreNames")return e.objectStoreNames||Yd.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return pn(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function cb(e){Oa=e(Oa)}function lb(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...n){const r=e.call(sa(this),t,...n);return Yd.set(r,t.sort?t.sort():[t]),pn(r)}:ib().includes(e)?function(...t){return e.apply(sa(this),t),pn(Jd.get(this))}:function(...t){return pn(e.apply(sa(this),t))}}function ub(e){return typeof e=="function"?lb(e):(e instanceof IDBTransaction&&ab(e),rb(e,sb())?new Proxy(e,Oa):e)}function pn(e){if(e instanceof IDBRequest)return ob(e);if(ra.has(e))return ra.get(e);const t=ub(e);return t!==e&&(ra.set(e,t),Lc.set(t,e)),t}const sa=e=>Lc.get(e);function hb(e,t,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(e,t),a=pn(o);return r&&o.addEventListener("upgradeneeded",c=>{r(pn(o.result),c.oldVersion,c.newVersion,pn(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),a.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",l=>s(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}const db=["get","getKey","getAll","getAllKeys","count"],fb=["put","add","delete","clear"],ia=new Map;function Iu(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(ia.get(t))return ia.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,s=fb.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||db.includes(n)))return;const i=async function(o,...a){const c=this.transaction(o,s?"readwrite":"readonly");let l=c.store;return r&&(l=l.index(a.shift())),(await Promise.all([l[n](...a),s&&c.done]))[0]};return ia.set(t,i),i}cb(e=>({...e,get:(t,n,r)=>Iu(t,n)||e.get(t,n,r),has:(t,n)=>!!Iu(t,n)||e.has(t,n)}));/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class pb{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(mb(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function mb(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const Ua="@firebase/app",ku="0.9.28";/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const qn=new Xd("@firebase/app"),gb="@firebase/app-compat",yb="@firebase/analytics-compat",vb="@firebase/analytics",bb="@firebase/app-check-compat",wb="@firebase/app-check",_b="@firebase/auth",Eb="@firebase/auth-compat",Tb="@firebase/database",Sb="@firebase/database-compat",Cb="@firebase/functions",Ib="@firebase/functions-compat",kb="@firebase/installations",xb="@firebase/installations-compat",Ab="@firebase/messaging",Db="@firebase/messaging-compat",Nb="@firebase/performance",Rb="@firebase/performance-compat",Pb="@firebase/remote-config",Mb="@firebase/remote-config-compat",Lb="@firebase/storage",Ob="@firebase/storage-compat",Ub="@firebase/firestore",Fb="@firebase/firestore-compat",Vb="firebase",jb="10.8.1";/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Fa="[DEFAULT]",Bb={[Ua]:"fire-core",[gb]:"fire-core-compat",[vb]:"fire-analytics",[yb]:"fire-analytics-compat",[wb]:"fire-app-check",[bb]:"fire-app-check-compat",[_b]:"fire-auth",[Eb]:"fire-auth-compat",[Tb]:"fire-rtdb",[Sb]:"fire-rtdb-compat",[Cb]:"fire-fn",[Ib]:"fire-fn-compat",[kb]:"fire-iid",[xb]:"fire-iid-compat",[Ab]:"fire-fcm",[Db]:"fire-fcm-compat",[Nb]:"fire-perf",[Rb]:"fire-perf-compat",[Pb]:"fire-rc",[Mb]:"fire-rc-compat",[Lb]:"fire-gcs",[Ob]:"fire-gcs-compat",[Ub]:"fire-fst",[Fb]:"fire-fst-compat","fire-js":"fire-js",[Vb]:"fire-js-all"};/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Ci=new Map,Va=new Map;function qb(e,t){try{e.container.addComponent(t)}catch(n){qn.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Ii(e){const t=e.name;if(Va.has(t))return qn.debug(`There were multiple attempts to register component ${t}.`),!1;Va.set(t,e);for(const n of Ci.values())qb(n,e);return!0}function $b(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const zb={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},mn=new Qd("app","Firebase",zb);/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Kb{constructor(t,n,r){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ds("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw mn.create("app-deleted",{appName:this._name})}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Gb=jb;function Zd(e,t={}){let n=e;typeof t!="object"&&(t={name:t});const r=Object.assign({name:Fa,automaticDataCollectionEnabled:!1},t),s=r.name;if(typeof s!="string"||!s)throw mn.create("bad-app-name",{appName:String(s)});if(n||(n=Hd()),!n)throw mn.create("no-options");const i=Ci.get(s);if(i){if(Ma(n,i.options)&&Ma(r,i.config))return i;throw mn.create("duplicate-app",{appName:s})}const o=new Y0(s);for(const c of Va.values())o.addComponent(c);const a=new Kb(n,r,o);return Ci.set(s,a),a}function Hb(e=Fa){const t=Ci.get(e);if(!t&&e===Fa&&Hd())return Zd();if(!t)throw mn.create("no-app",{appName:e});return t}function dr(e,t,n){var r;let s=(r=Bb[e])!==null&&r!==void 0?r:e;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=t.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${t}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${t}" contains illegal characters (whitespace or "/")`),qn.warn(a.join(" "));return}Ii(new ds(`${s}-version`,()=>({library:s,version:t}),"VERSION"))}/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Wb="firebase-heartbeat-database",Qb=1,fs="firebase-heartbeat-store";let oa=null;function tf(){return oa||(oa=hb(Wb,Qb,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(fs)}catch(n){console.warn(n)}}}}).catch(e=>{throw mn.create("idb-open",{originalErrorMessage:e.message})})),oa}async function Xb(e){try{const t=(await tf()).transaction(fs),n=await t.objectStore(fs).get(ef(e));return await t.done,n}catch(t){if(t instanceof Ar)qn.warn(t.message);else{const n=mn.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});qn.warn(n.message)}}}async function xu(e,t){try{const n=(await tf()).transaction(fs,"readwrite");await n.objectStore(fs).put(t,ef(e)),await n.done}catch(n){if(n instanceof Ar)qn.warn(n.message);else{const r=mn.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});qn.warn(r.message)}}}function ef(e){return`${e.name}!${e.options.appId}`}/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Jb=1024,Yb=30*24*60*60*1e3;class Zb{constructor(t){this.container=t,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new ew(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var t,n;const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Au();if(!(((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(i=>i.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(i=>{const o=new Date(i.date).valueOf();return Date.now()-o<=Yb}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var t;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Au(),{heartbeatsToSend:r,unsentEntries:s}=tw(this._heartbeatsCache.heartbeats),i=Ti(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function Au(){return new Date().toISOString().substring(0,10)}function tw(e,t=Jb){const n=[];let r=e.slice();for(const s of e){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Du(n)>t){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Du(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class ew{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Wd()?K0().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Xb(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return xu(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return xu(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...t.heartbeats]})}else return}}function Du(e){return Ti(JSON.stringify({version:2,heartbeats:e})).length}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function nw(e){Ii(new ds("platform-logger",t=>new pb(t),"PRIVATE")),Ii(new ds("heartbeat",t=>new Zb(t),"PRIVATE")),dr(Ua,ku,e),dr(Ua,ku,"esm2017"),dr("fire-js","")}nw("");var rw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},M,Oc=Oc||{},G=rw||self;function co(e){var t=typeof e;return t=t!="object"?t:e?Array.isArray(e)?"array":t:"null",t=="array"||t=="object"&&typeof e.length=="number"}function Ns(e){var t=typeof e;return t=="object"&&e!=null||t=="function"}function sw(e){return Object.prototype.hasOwnProperty.call(e,aa)&&e[aa]||(e[aa]=++iw)}var aa="closure_uid_"+(1e9*Math.random()>>>0),iw=0;function ow(e,t,n){return e.call.apply(e.bind,arguments)}function aw(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,r),e.apply(t,s)}}return function(){return e.apply(t,arguments)}}function Jt(e,t,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Jt=ow:Jt=aw,Jt.apply(null,arguments)}function Zs(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),e.apply(this,r)}}function Ot(e,t){function n(){}n.prototype=t.prototype,e.$=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.ac=function(r,s,i){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return t.prototype[s].apply(r,o)}}function En(){this.s=this.s,this.o=this.o}var cw=0;En.prototype.s=!1;En.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),cw!=0)&&sw(this)};En.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const nf=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if(typeof e=="string")return typeof t!="string"||t.length!=1?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function Uc(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function Nu(e,t){for(let n=1;n<arguments.length;n++){const r=arguments[n];if(co(r)){const s=e.length||0,i=r.length||0;e.length=s+i;for(let o=0;o<i;o++)e[s+o]=r[o]}else e.push(r)}}function Yt(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}Yt.prototype.h=function(){this.defaultPrevented=!0};var lw=function(){if(!G.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const n=()=>{};G.addEventListener("test",n,t),G.removeEventListener("test",n,t)}catch{}return e}();function ps(e){return/^[\s\xa0]*$/.test(e)}function lo(){var e=G.navigator;return e&&(e=e.userAgent)?e:""}function Pe(e){return lo().indexOf(e)!=-1}function Fc(e){return Fc[" "](e),e}Fc[" "]=function(){};function uw(e,t){var n=r_;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}var hw=Pe("Opera"),vr=Pe("Trident")||Pe("MSIE"),rf=Pe("Edge"),ja=rf||vr,sf=Pe("Gecko")&&!(lo().toLowerCase().indexOf("webkit")!=-1&&!Pe("Edge"))&&!(Pe("Trident")||Pe("MSIE"))&&!Pe("Edge"),dw=lo().toLowerCase().indexOf("webkit")!=-1&&!Pe("Edge");function of(){var e=G.document;return e?e.documentMode:void 0}var Ba;t:{var ca="",la=function(){var e=lo();if(sf)return/rv:([^\);]+)(\)|;)/.exec(e);if(rf)return/Edge\/([\d\.]+)/.exec(e);if(vr)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e);if(dw)return/WebKit\/(\S+)/.exec(e);if(hw)return/(?:Version)[ \/]?(\S+)/.exec(e)}();if(la&&(ca=la?la[1]:""),vr){var ua=of();if(ua!=null&&ua>parseFloat(ca)){Ba=String(ua);break t}}Ba=ca}var qa;if(G.document&&vr){var fw=of();qa=fw||parseInt(Ba,10)||void 0}else qa=void 0;var pw=qa;function ms(e,t){if(Yt.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(sf){t:{try{Fc(t.nodeName);var s=!0;break t}catch{}s=!1}s||(t=null)}}else n=="mouseover"?t=e.fromElement:n=="mouseout"&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=e.clientX!==void 0?e.clientX:e.pageX,this.clientY=e.clientY!==void 0?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=typeof e.pointerType=="string"?e.pointerType:mw[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&ms.$.h.call(this)}}Ot(ms,Yt);var mw={2:"touch",3:"pen",4:"mouse"};ms.prototype.h=function(){ms.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var Rs="closure_listenable_"+(1e6*Math.random()|0),gw=0;function yw(e,t,n,r,s){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.la=s,this.key=++gw,this.fa=this.ia=!1}function uo(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function Vc(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function vw(e,t){for(const n in e)t.call(void 0,e[n],n,e)}function af(e){const t={};for(const n in e)t[n]=e[n];return t}const Ru="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function cf(e,t){let n,r;for(let s=1;s<arguments.length;s++){r=arguments[s];for(n in r)e[n]=r[n];for(let i=0;i<Ru.length;i++)n=Ru[i],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function ho(e){this.src=e,this.g={},this.h=0}ho.prototype.add=function(e,t,n,r,s){var i=e.toString();e=this.g[i],e||(e=this.g[i]=[],this.h++);var o=za(e,t,r,s);return-1<o?(t=e[o],n||(t.ia=!1)):(t=new yw(t,this.src,i,!!r,s),t.ia=n,e.push(t)),t};function $a(e,t){var n=t.type;if(n in e.g){var r=e.g[n],s=nf(r,t),i;(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(uo(t),e.g[n].length==0&&(delete e.g[n],e.h--))}}function za(e,t,n,r){for(var s=0;s<e.length;++s){var i=e[s];if(!i.fa&&i.listener==t&&i.capture==!!n&&i.la==r)return s}return-1}var jc="closure_lm_"+(1e6*Math.random()|0),ha={};function lf(e,t,n,r,s){if(r&&r.once)return hf(e,t,n,r,s);if(Array.isArray(t)){for(var i=0;i<t.length;i++)lf(e,t[i],n,r,s);return null}return n=$c(n),e&&e[Rs]?e.O(t,n,Ns(r)?!!r.capture:!!r,s):uf(e,t,n,!1,r,s)}function uf(e,t,n,r,s,i){if(!t)throw Error("Invalid event type");var o=Ns(s)?!!s.capture:!!s,a=qc(e);if(a||(e[jc]=a=new ho(e)),n=a.add(t,n,r,o,i),n.proxy)return n;if(r=bw(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)lw||(s=o),s===void 0&&(s=!1),e.addEventListener(t.toString(),r,s);else if(e.attachEvent)e.attachEvent(ff(t.toString()),r);else if(e.addListener&&e.removeListener)e.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function bw(){function e(n){return t.call(e.src,e.listener,n)}const t=ww;return e}function hf(e,t,n,r,s){if(Array.isArray(t)){for(var i=0;i<t.length;i++)hf(e,t[i],n,r,s);return null}return n=$c(n),e&&e[Rs]?e.P(t,n,Ns(r)?!!r.capture:!!r,s):uf(e,t,n,!0,r,s)}function df(e,t,n,r,s){if(Array.isArray(t))for(var i=0;i<t.length;i++)df(e,t[i],n,r,s);else r=Ns(r)?!!r.capture:!!r,n=$c(n),e&&e[Rs]?(e=e.i,t=String(t).toString(),t in e.g&&(i=e.g[t],n=za(i,n,r,s),-1<n&&(uo(i[n]),Array.prototype.splice.call(i,n,1),i.length==0&&(delete e.g[t],e.h--)))):e&&(e=qc(e))&&(t=e.g[t.toString()],e=-1,t&&(e=za(t,n,r,s)),(n=-1<e?t[e]:null)&&Bc(n))}function Bc(e){if(typeof e!="number"&&e&&!e.fa){var t=e.src;if(t&&t[Rs])$a(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(ff(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=qc(t))?($a(n,e),n.h==0&&(n.src=null,t[jc]=null)):uo(e)}}}function ff(e){return e in ha?ha[e]:ha[e]="on"+e}function ww(e,t){if(e.fa)e=!0;else{t=new ms(t,this);var n=e.listener,r=e.la||e.src;e.ia&&Bc(e),e=n.call(r,t)}return e}function qc(e){return e=e[jc],e instanceof ho?e:null}var da="__closure_events_fn_"+(1e9*Math.random()>>>0);function $c(e){return typeof e=="function"?e:(e[da]||(e[da]=function(t){return e.handleEvent(t)}),e[da])}function Lt(){En.call(this),this.i=new ho(this),this.S=this,this.J=null}Ot(Lt,En);Lt.prototype[Rs]=!0;Lt.prototype.removeEventListener=function(e,t,n,r){df(this,e,t,n,r)};function $t(e,t){var n,r=e.J;if(r)for(n=[];r;r=r.J)n.push(r);if(e=e.S,r=t.type||t,typeof t=="string")t=new Yt(t,e);else if(t instanceof Yt)t.target=t.target||e;else{var s=t;t=new Yt(r,e),cf(t,s)}if(s=!0,n)for(var i=n.length-1;0<=i;i--){var o=t.g=n[i];s=ti(o,r,!0,t)&&s}if(o=t.g=e,s=ti(o,r,!0,t)&&s,s=ti(o,r,!1,t)&&s,n)for(i=0;i<n.length;i++)o=t.g=n[i],s=ti(o,r,!1,t)&&s}Lt.prototype.N=function(){if(Lt.$.N.call(this),this.i){var e=this.i,t;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)uo(n[r]);delete e.g[t],e.h--}}this.J=null};Lt.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)};Lt.prototype.P=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};function ti(e,t,n,r){if(t=e.i.g[String(t)],!t)return!0;t=t.concat();for(var s=!0,i=0;i<t.length;++i){var o=t[i];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&$a(e.i,o),s=a.call(c,r)!==!1&&s}}return s&&!r.defaultPrevented}var zc=G.JSON.stringify;class _w{constructor(t,n){this.i=t,this.j=n,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}function Ew(){var e=Kc;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}class Tw{constructor(){this.h=this.g=null}add(t,n){const r=pf.get();r.set(t,n),this.h?this.h.next=r:this.g=r,this.h=r}}var pf=new _w(()=>new Sw,e=>e.reset());class Sw{constructor(){this.next=this.g=this.h=null}set(t,n){this.h=t,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function Cw(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function Iw(e){G.setTimeout(()=>{throw e},0)}let gs,ys=!1,Kc=new Tw,mf=()=>{const e=G.Promise.resolve(void 0);gs=()=>{e.then(kw)}};var kw=()=>{for(var e;e=Ew();){try{e.h.call(e.g)}catch(n){Iw(n)}var t=pf;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}ys=!1};function fo(e,t){Lt.call(this),this.h=e||1,this.g=t||G,this.j=Jt(this.qb,this),this.l=Date.now()}Ot(fo,Lt);M=fo.prototype;M.ga=!1;M.T=null;M.qb=function(){if(this.ga){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),$t(this,"tick"),this.ga&&(Gc(this),this.start()))}};M.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function Gc(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}M.N=function(){fo.$.N.call(this),Gc(this),delete this.g};function Hc(e,t,n){if(typeof e=="function")n&&(e=Jt(e,n));else if(e&&typeof e.handleEvent=="function")e=Jt(e.handleEvent,e);else throw Error("Invalid listener argument");return 2147483647<Number(t)?-1:G.setTimeout(e,t||0)}function gf(e){e.g=Hc(()=>{e.g=null,e.i&&(e.i=!1,gf(e))},e.j);const t=e.h;e.h=null,e.m.apply(null,t)}class xw extends En{constructor(t,n){super(),this.m=t,this.j=n,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:gf(this)}N(){super.N(),this.g&&(G.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function vs(e){En.call(this),this.h=e,this.g={}}Ot(vs,En);var Pu=[];function yf(e,t,n,r){Array.isArray(n)||(n&&(Pu[0]=n.toString()),n=Pu);for(var s=0;s<n.length;s++){var i=lf(t,n[s],r||e.handleEvent,!1,e.h||e);if(!i)break;e.g[i.key]=i}}function vf(e){Vc(e.g,function(t,n){this.g.hasOwnProperty(n)&&Bc(t)},e),e.g={}}vs.prototype.N=function(){vs.$.N.call(this),vf(this)};vs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function po(){this.g=!0}po.prototype.Ea=function(){this.g=!1};function Aw(e,t,n,r,s,i){e.info(function(){if(e.g)if(i)for(var o="",a=i.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var u=l[0];l=l[1];var h=u.split("_");o=2<=h.length&&h[1]=="type"?o+(u+"="+l+"&"):o+(u+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+t+`
`+n+`
`+o})}function Dw(e,t,n,r,s,i,o){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+t+`
`+n+`
`+i+" "+o})}function or(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+Rw(e,n)+(r?" "+r:"")})}function Nw(e,t){e.info(function(){return"TIMEOUT: "+t})}po.prototype.info=function(){};function Rw(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n){for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if(i!="noop"&&i!="stop"&&i!="close")for(var o=1;o<s.length;o++)s[o]=""}}}}return zc(n)}catch{return t}}var Wn={},Mu=null;function mo(){return Mu=Mu||new Lt}Wn.Ta="serverreachability";function bf(e){Yt.call(this,Wn.Ta,e)}Ot(bf,Yt);function bs(e){const t=mo();$t(t,new bf(t))}Wn.STAT_EVENT="statevent";function wf(e,t){Yt.call(this,Wn.STAT_EVENT,e),this.stat=t}Ot(wf,Yt);function se(e){const t=mo();$t(t,new wf(t,e))}Wn.Ua="timingevent";function _f(e,t){Yt.call(this,Wn.Ua,e),this.size=t}Ot(_f,Yt);function Ps(e,t){if(typeof e!="function")throw Error("Fn must not be null and must be a function");return G.setTimeout(function(){e()},t)}var go={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Ef={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Wc(){}Wc.prototype.h=null;function Lu(e){return e.h||(e.h=e.i())}function Tf(){}var Ms={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Qc(){Yt.call(this,"d")}Ot(Qc,Yt);function Xc(){Yt.call(this,"c")}Ot(Xc,Yt);var Ka;function yo(){}Ot(yo,Wc);yo.prototype.g=function(){return new XMLHttpRequest};yo.prototype.i=function(){return{}};Ka=new yo;function Ls(e,t,n,r){this.l=e,this.j=t,this.m=n,this.W=r||1,this.U=new vs(this),this.P=Pw,e=ja?125:void 0,this.V=new fo(e),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Sf}function Sf(){this.i=null,this.g="",this.h=!1}var Pw=45e3,Cf={},Ga={};M=Ls.prototype;M.setTimeout=function(e){this.P=e};function Ha(e,t,n){e.L=1,e.A=bo(Xe(t)),e.u=n,e.S=!0,If(e,null)}function If(e,t){e.G=Date.now(),Os(e),e.B=Xe(e.A);var n=e.B,r=e.W;Array.isArray(r)||(r=[String(r)]),Mf(n.i,"t",r),e.o=0,n=e.l.J,e.h=new Sf,e.g=ep(e.l,n?t:null,!e.u),0<e.O&&(e.M=new xw(Jt(e.Pa,e,e.g),e.O)),yf(e.U,e.g,"readystatechange",e.nb),t=e.I?af(e.I):{},e.u?(e.v||(e.v="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.B,e.v,e.u,t)):(e.v="GET",e.g.ha(e.B,e.v,null,t)),bs(),Aw(e.j,e.v,e.B,e.m,e.W,e.u)}M.nb=function(e){e=e.target;const t=this.M;t&&Me(e)==3?t.l():this.Pa(e)};M.Pa=function(e){try{if(e==this.g)t:{const u=Me(this.g);var t=this.g.Ia();const h=this.g.da();if(!(3>u)&&(u!=3||ja||this.g&&(this.h.h||this.g.ja()||Vu(this.g)))){this.J||u!=4||t==7||(t==8||0>=h?bs(3):bs(2)),vo(this);var n=this.g.da();this.ca=n;e:if(kf(this)){var r=Vu(this.g);e="";var s=r.length,i=Me(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Nn(this),es(this);var o="";break e}this.h.i=new G.TextDecoder}for(t=0;t<s;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:i&&t==s-1});r.length=0,this.h.g+=e,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,Dw(this.j,this.v,this.B,this.m,this.W,u,n),this.i){if(this.aa&&!this.K){e:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ps(a)){var l=a;break e}}l=null}if(n=l)or(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Wa(this,n);else{this.i=!1,this.s=3,se(12),Nn(this),es(this);break t}}this.S?(xf(this,u,o),ja&&this.i&&u==3&&(yf(this.U,this.V,"tick",this.mb),this.V.start())):(or(this.j,this.m,o,null),Wa(this,o)),u==4&&Nn(this),this.i&&!this.J&&(u==4?Jf(this.l,this):(this.i=!1,Os(this)))}else t_(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.s=3,se(12)):(this.s=0,se(13)),Nn(this),es(this)}}}catch{}finally{}};function kf(e){return e.g?e.v=="GET"&&e.L!=2&&e.l.Ha:!1}function xf(e,t,n){let r=!0,s;for(;!e.J&&e.o<n.length;)if(s=Mw(e,n),s==Ga){t==4&&(e.s=4,se(14),r=!1),or(e.j,e.m,null,"[Incomplete Response]");break}else if(s==Cf){e.s=4,se(15),or(e.j,e.m,n,"[Invalid Chunk]"),r=!1;break}else or(e.j,e.m,s,null),Wa(e,s);kf(e)&&e.o!=0&&(e.h.g=e.h.g.slice(e.o),e.o=0),t!=4||n.length!=0||e.h.h||(e.s=1,se(16),r=!1),e.i=e.i&&r,r?0<n.length&&!e.ba&&(e.ba=!0,t=e.l,t.g==e&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),nl(t),t.M=!0,se(11))):(or(e.j,e.m,n,"[Invalid Chunked Response]"),Nn(e),es(e))}M.mb=function(){if(this.g){var e=Me(this.g),t=this.g.ja();this.o<t.length&&(vo(this),xf(this,e,t),this.i&&e!=4&&Os(this))}};function Mw(e,t){var n=e.o,r=t.indexOf(`
`,n);return r==-1?Ga:(n=Number(t.substring(n,r)),isNaN(n)?Cf:(r+=1,r+n>t.length?Ga:(t=t.slice(r,r+n),e.o=r+n,t)))}M.cancel=function(){this.J=!0,Nn(this)};function Os(e){e.Y=Date.now()+e.P,Af(e,e.P)}function Af(e,t){if(e.C!=null)throw Error("WatchDog timer not null");e.C=Ps(Jt(e.lb,e),t)}function vo(e){e.C&&(G.clearTimeout(e.C),e.C=null)}M.lb=function(){this.C=null;const e=Date.now();0<=e-this.Y?(Nw(this.j,this.B),this.L!=2&&(bs(),se(17)),Nn(this),this.s=2,es(this)):Af(this,this.Y-e)};function es(e){e.l.H==0||e.J||Jf(e.l,e)}function Nn(e){vo(e);var t=e.M;t&&typeof t.sa=="function"&&t.sa(),e.M=null,Gc(e.V),vf(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.sa())}function Wa(e,t){try{var n=e.l;if(n.H!=0&&(n.g==e||Qa(n.i,e))){if(!e.K&&Qa(n.i,e)&&n.H==3){try{var r=n.Ja.g.parse(t)}catch{r=null}if(Array.isArray(r)&&r.length==3){var s=r;if(s[0]==0){t:if(!n.u){if(n.g)if(n.g.G+3e3<e.G)Ai(n),To(n);else break t;el(n),se(18)}}else n.Fa=s[1],0<n.Fa-n.V&&37500>s[2]&&n.G&&n.A==0&&!n.v&&(n.v=Ps(Jt(n.ib,n),6e3));if(1>=Uf(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else Rn(n,11)}else if((e.K||n.g==e)&&Ai(n),!ps(t))for(s=n.Ja.g.parse(t),t=0;t<s.length;t++){let l=s[t];if(n.V=l[0],l=l[1],n.H==2)if(l[0]=="c"){n.K=l[1],n.pa=l[2];const u=l[3];u!=null&&(n.ra=u,n.l.info("VER="+n.ra));const h=l[4];h!=null&&(n.Ga=h,n.l.info("SVER="+n.Ga));const f=l[5];f!=null&&typeof f=="number"&&0<f&&(r=1.5*f,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const m=e.g;if(m){const E=m.g?m.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(E){var i=r.i;i.g||E.indexOf("spdy")==-1&&E.indexOf("quic")==-1&&E.indexOf("h2")==-1||(i.j=i.l,i.g=new Set,i.h&&(Jc(i,i.h),i.h=null))}if(r.F){const v=m.g?m.g.getResponseHeader("X-HTTP-Session-Id"):null;v&&(r.Da=v,vt(r.I,r.F,v))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-e.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=e;if(r.wa=tp(r,r.J?r.pa:null,r.Y),o.K){Ff(r.i,o);var a=o,c=r.L;c&&a.setTimeout(c),a.C&&(vo(a),Os(a)),r.g=o}else Qf(r);0<n.j.length&&So(n)}else l[0]!="stop"&&l[0]!="close"||Rn(n,7);else n.H==3&&(l[0]=="stop"||l[0]=="close"?l[0]=="stop"?Rn(n,7):tl(n):l[0]!="noop"&&n.h&&n.h.Aa(l),n.A=0)}}bs(4)}catch{}}function Lw(e){if(e.Z&&typeof e.Z=="function")return e.Z();if(typeof Map<"u"&&e instanceof Map||typeof Set<"u"&&e instanceof Set)return Array.from(e.values());if(typeof e=="string")return e.split("");if(co(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}t=[],n=0;for(r in e)t[n++]=e[r];return t}function Ow(e){if(e.ta&&typeof e.ta=="function")return e.ta();if(!e.Z||typeof e.Z!="function"){if(typeof Map<"u"&&e instanceof Map)return Array.from(e.keys());if(!(typeof Set<"u"&&e instanceof Set)){if(co(e)||typeof e=="string"){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}function Df(e,t){if(e.forEach&&typeof e.forEach=="function")e.forEach(t,void 0);else if(co(e)||typeof e=="string")Array.prototype.forEach.call(e,t,void 0);else for(var n=Ow(e),r=Lw(e),s=r.length,i=0;i<s;i++)t.call(void 0,r[i],n&&n[i],e)}var Nf=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Uw(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),s=null;if(0<=r){var i=e[n].substring(0,r);s=e[n].substring(r+1)}else i=e[n];t(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}function Vn(e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof Vn){this.h=e.h,ki(this,e.j),this.s=e.s,this.g=e.g,xi(this,e.m),this.l=e.l;var t=e.i,n=new ws;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),Ou(this,n),this.o=e.o}else e&&(t=String(e).match(Nf))?(this.h=!1,ki(this,t[1]||"",!0),this.s=Gr(t[2]||""),this.g=Gr(t[3]||"",!0),xi(this,t[4]),this.l=Gr(t[5]||"",!0),Ou(this,t[6]||"",!0),this.o=Gr(t[7]||"")):(this.h=!1,this.i=new ws(null,this.h))}Vn.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Hr(t,Uu,!0),":");var n=this.g;return(n||t=="file")&&(e.push("//"),(t=this.s)&&e.push(Hr(t,Uu,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&e.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&e.push("/"),e.push(Hr(n,n.charAt(0)=="/"?jw:Vw,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",Hr(n,qw)),e.join("")};function Xe(e){return new Vn(e)}function ki(e,t,n){e.j=n?Gr(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function xi(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function Ou(e,t,n){t instanceof ws?(e.i=t,$w(e.i,e.h)):(n||(t=Hr(t,Bw)),e.i=new ws(t,e.h))}function vt(e,t,n){e.i.set(t,n)}function bo(e){return vt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Gr(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Hr(e,t,n){return typeof e=="string"?(e=encodeURI(e).replace(t,Fw),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Fw(e){return e=e.charCodeAt(0),"%"+(e>>4&15).toString(16)+(e&15).toString(16)}var Uu=/[#\/\?@]/g,Vw=/[#\?:]/g,jw=/[#\?]/g,Bw=/[#\?@]/g,qw=/#/g;function ws(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Tn(e){e.g||(e.g=new Map,e.h=0,e.i&&Uw(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}M=ws.prototype;M.add=function(e,t){Tn(this),this.i=null,e=Dr(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this};function Rf(e,t){Tn(e),t=Dr(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Pf(e,t){return Tn(e),t=Dr(e,t),e.g.has(t)}M.forEach=function(e,t){Tn(this),this.g.forEach(function(n,r){n.forEach(function(s){e.call(t,s,r,this)},this)},this)};M.ta=function(){Tn(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const s=e[r];for(let i=0;i<s.length;i++)n.push(t[r])}return n};M.Z=function(e){Tn(this);let t=[];if(typeof e=="string")Pf(this,e)&&(t=t.concat(this.g.get(Dr(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t};M.set=function(e,t){return Tn(this),this.i=null,e=Dr(this,e),Pf(this,e)&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this};M.get=function(e,t){return e?(e=this.Z(e),0<e.length?String(e[0]):t):t};function Mf(e,t,n){Rf(e,t),0<n.length&&(e.i=null,e.g.set(Dr(e,t),Uc(n)),e.h+=n.length)}M.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const i=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var s=i;o[r]!==""&&(s+="="+encodeURIComponent(String(o[r]))),e.push(s)}}return this.i=e.join("&")};function Dr(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function $w(e,t){t&&!e.j&&(Tn(e),e.i=null,e.g.forEach(function(n,r){var s=r.toLowerCase();r!=s&&(Rf(this,r),Mf(this,s,n))},e)),e.j=t}var zw=class{constructor(e,t){this.g=e,this.map=t}};function Lf(e){this.l=e||Kw,G.PerformanceNavigationTiming?(e=G.performance.getEntriesByType("navigation"),e=0<e.length&&(e[0].nextHopProtocol=="hq"||e[0].nextHopProtocol=="h2")):e=!!(G.g&&G.g.Ka&&G.g.Ka()&&G.g.Ka().dc),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Kw=10;function Of(e){return e.h?!0:e.g?e.g.size>=e.j:!1}function Uf(e){return e.h?1:e.g?e.g.size:0}function Qa(e,t){return e.h?e.h==t:e.g?e.g.has(t):!1}function Jc(e,t){e.g?e.g.add(t):e.h=t}function Ff(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}Lf.prototype.cancel=function(){if(this.i=Vf(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const e of this.g.values())e.cancel();this.g.clear()}};function Vf(e){if(e.h!=null)return e.i.concat(e.h.F);if(e.g!=null&&e.g.size!==0){let t=e.i;for(const n of e.g.values())t=t.concat(n.F);return t}return Uc(e.i)}var Gw=class{stringify(e){return G.JSON.stringify(e,void 0)}parse(e){return G.JSON.parse(e,void 0)}};function Hw(){this.g=new Gw}function Ww(e,t,n){const r=n||"";try{Df(e,function(s,i){let o=s;Ns(s)&&(o=zc(s)),t.push(r+i+"="+encodeURIComponent(o))})}catch(s){throw t.push(r+"type="+encodeURIComponent("_badmap")),s}}function Qw(e,t){const n=new po;if(G.Image){const r=new Image;r.onload=Zs(ei,n,r,"TestLoadImage: loaded",!0,t),r.onerror=Zs(ei,n,r,"TestLoadImage: error",!1,t),r.onabort=Zs(ei,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=Zs(ei,n,r,"TestLoadImage: timeout",!1,t),G.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}function ei(e,t,n,r,s){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,s(r)}catch{}}function wo(e){this.l=e.ec||null,this.j=e.ob||!1}Ot(wo,Wc);wo.prototype.g=function(){return new _o(this.l,this.j)};wo.prototype.i=function(e){return function(){return e}}({});function _o(e,t){Lt.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=Yc,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Ot(_o,Lt);var Yc=0;M=_o.prototype;M.open=function(e,t){if(this.readyState!=Yc)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,_s(this)};M.send=function(e){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||G).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))};M.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Us(this)),this.readyState=Yc};M.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,_s(this)),this.g&&(this.readyState=3,_s(this),this.g)))if(this.responseType==="arraybuffer")e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof G.ReadableStream<"u"&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;jf(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))};function jf(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}M.Xa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Us(this):_s(this),this.readyState==3&&jf(this)}};M.Za=function(e){this.g&&(this.response=this.responseText=e,Us(this))};M.Ya=function(e){this.g&&(this.response=e,Us(this))};M.ka=function(){this.g&&Us(this)};function Us(e){e.readyState=4,e.l=null,e.j=null,e.A=null,_s(e)}M.setRequestHeader=function(e,t){this.v.append(e,t)};M.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""};M.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join(`\r
`)};function _s(e){e.onreadystatechange&&e.onreadystatechange.call(e)}Object.defineProperty(_o.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(e){this.m=e?"include":"same-origin"}});var Xw=G.JSON.parse;function Ct(e){Lt.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Bf,this.L=this.M=!1}Ot(Ct,Lt);var Bf="",Jw=/^https?$/i,Yw=["POST","PUT"];M=Ct.prototype;M.Oa=function(e){this.M=e};M.ha=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Ka.g(),this.C=this.u?Lu(this.u):Lu(Ka),this.g.onreadystatechange=Jt(this.La,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(i){Fu(this,i);return}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(const i of r.keys())n.set(i,r.get(i));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(i=>i.toLowerCase()=="content-type"),s=G.FormData&&e instanceof G.FormData,!(0<=nf(Yw,t))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of n)this.g.setRequestHeader(i,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{zf(this),0<this.B&&((this.L=Zw(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Jt(this.ua,this)):this.A=Hc(this.ua,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(i){Fu(this,i)}};function Zw(e){return vr&&typeof e.timeout=="number"&&e.ontimeout!==void 0}M.ua=function(){typeof Oc<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,$t(this,"timeout"),this.abort(8))};function Fu(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,qf(e),Eo(e)}function qf(e){e.F||(e.F=!0,$t(e,"complete"),$t(e,"error"))}M.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,$t(this,"complete"),$t(this,"abort"),Eo(this))};M.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Eo(this,!0)),Ct.$.N.call(this)};M.La=function(){this.s||(this.G||this.v||this.l?$f(this):this.kb())};M.kb=function(){$f(this)};function $f(e){if(e.h&&typeof Oc<"u"&&(!e.C[1]||Me(e)!=4||e.da()!=2)){if(e.v&&Me(e)==4)Hc(e.La,0,e);else if($t(e,"readystatechange"),Me(e)==4){e.h=!1;try{const o=e.da();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break t;default:t=!1}var n;if(!(n=t)){var r;if(r=o===0){var s=String(e.I).match(Nf)[1]||null;!s&&G.self&&G.self.location&&(s=G.self.location.protocol.slice(0,-1)),r=!Jw.test(s?s.toLowerCase():"")}n=r}if(n)$t(e,"complete"),$t(e,"success");else{e.m=6;try{var i=2<Me(e)?e.g.statusText:""}catch{i=""}e.j=i+" ["+e.da()+"]",qf(e)}}finally{Eo(e)}}}}function Eo(e,t){if(e.g){zf(e);const n=e.g,r=e.C[0]?()=>{}:null;e.g=null,e.C=null,t||$t(e,"ready");try{n.onreadystatechange=r}catch{}}}function zf(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&(G.clearTimeout(e.A),e.A=null)}M.isActive=function(){return!!this.g};function Me(e){return e.g?e.g.readyState:0}M.da=function(){try{return 2<Me(this)?this.g.status:-1}catch{return-1}};M.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};M.Wa=function(e){if(this.g){var t=this.g.responseText;return e&&t.indexOf(e)==0&&(t=t.substring(e.length)),Xw(t)}};function Vu(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.K){case Bf:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch{return null}}function t_(e){const t={};e=(e.g&&2<=Me(e)&&e.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<e.length;r++){if(ps(e[r]))continue;var n=Cw(e[r]);const s=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();const i=t[s]||[];t[s]=i,i.push(n)}vw(t,function(r){return r.join(", ")})}M.Ia=function(){return this.m};M.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function Kf(e){let t="";return Vc(e,function(n,r){t+=r,t+=":",t+=n,t+=`\r
`}),t}function Zc(e,t,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=Kf(n),typeof e=="string"?n!=null&&encodeURIComponent(String(n)):vt(e,t,n))}function Br(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Gf(e){this.Ga=0,this.j=[],this.l=new po,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Br("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Br("baseRetryDelayMs",5e3,e),this.hb=Br("retryDelaySeedMs",1e4,e),this.eb=Br("forwardChannelMaxRetries",2,e),this.xa=Br("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.i=new Lf(e&&e.concurrentRequestLimit),this.Ja=new Hw,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.l.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.qa=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.qa=e.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}M=Gf.prototype;M.ra=8;M.H=1;function tl(e){if(Hf(e),e.H==3){var t=e.W++,n=Xe(e.I);if(vt(n,"SID",e.K),vt(n,"RID",t),vt(n,"TYPE","terminate"),Fs(e,n),t=new Ls(e,e.l,t),t.L=2,t.A=bo(Xe(n)),n=!1,G.navigator&&G.navigator.sendBeacon)try{n=G.navigator.sendBeacon(t.A.toString(),"")}catch{}!n&&G.Image&&(new Image().src=t.A,n=!0),n||(t.g=ep(t.l,null),t.g.ha(t.A)),t.G=Date.now(),Os(t)}Zf(e)}function To(e){e.g&&(nl(e),e.g.cancel(),e.g=null)}function Hf(e){To(e),e.u&&(G.clearTimeout(e.u),e.u=null),Ai(e),e.i.cancel(),e.m&&(typeof e.m=="number"&&G.clearTimeout(e.m),e.m=null)}function So(e){if(!Of(e.i)&&!e.m){e.m=!0;var t=e.Na;gs||mf(),ys||(gs(),ys=!0),Kc.add(t,e),e.C=0}}function e_(e,t){return Uf(e.i)>=e.i.j-(e.m?1:0)?!1:e.m?(e.j=t.F.concat(e.j),!0):e.H==1||e.H==2||e.C>=(e.cb?0:e.eb)?!1:(e.m=Ps(Jt(e.Na,e,t),Yf(e,e.C)),e.C++,!0)}M.Na=function(e){if(this.m)if(this.m=null,this.H==1){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;const s=new Ls(this,this.l,e);let i=this.s;if(this.U&&(i?(i=af(i),cf(i,this.U)):i=this.U),this.o!==null||this.O||(s.I=i,i=null),this.P)t:{for(var t=0,n=0;n<this.j.length;n++){e:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break e}r=void 0}if(r===void 0)break;if(t+=r,4096<t){t=n;break t}if(t===4096||n===this.j.length-1){t=n+1;break t}}t=1e3}else t=1e3;t=Wf(this,s,t),n=Xe(this.I),vt(n,"RID",e),vt(n,"CVER",22),this.F&&vt(n,"X-HTTP-Session-Id",this.F),Fs(this,n),i&&(this.O?t="headers="+encodeURIComponent(String(Kf(i)))+"&"+t:this.o&&Zc(n,this.o,i)),Jc(this.i,s),this.bb&&vt(n,"TYPE","init"),this.P?(vt(n,"$req",t),vt(n,"SID","null"),s.aa=!0,Ha(s,n,null)):Ha(s,n,t),this.H=2}}else this.H==3&&(e?ju(this,e):this.j.length==0||Of(this.i)||ju(this))};function ju(e,t){var n;t?n=t.m:n=e.W++;const r=Xe(e.I);vt(r,"SID",e.K),vt(r,"RID",n),vt(r,"AID",e.V),Fs(e,r),e.o&&e.s&&Zc(r,e.o,e.s),n=new Ls(e,e.l,n,e.C+1),e.o===null&&(n.I=e.s),t&&(e.j=t.F.concat(e.j)),t=Wf(e,n,1e3),n.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),Jc(e.i,n),Ha(n,r,t)}function Fs(e,t){e.na&&Vc(e.na,function(n,r){vt(t,r,n)}),e.h&&Df({},function(n,r){vt(t,r,n)})}function Wf(e,t,n){n=Math.min(e.j.length,n);var r=e.h?Jt(e.h.Va,e.h,e):null;t:{var s=e.j;let i=-1;for(;;){const o=["count="+n];i==-1?0<n?(i=s[0].g,o.push("ofs="+i)):i=0:o.push("ofs="+i);let a=!0;for(let c=0;c<n;c++){let l=s[c].g;const u=s[c].map;if(l-=i,0>l)i=Math.max(0,s[c].g-100),a=!1;else try{Ww(u,o,"req"+l+"_")}catch{r&&r(u)}}if(a){r=o.join("&");break t}}}return e=e.j.splice(0,n),t.F=e,r}function Qf(e){if(!e.g&&!e.u){e.ba=1;var t=e.Ma;gs||mf(),ys||(gs(),ys=!0),Kc.add(t,e),e.A=0}}function el(e){return e.g||e.u||3<=e.A?!1:(e.ba++,e.u=Ps(Jt(e.Ma,e),Yf(e,e.A)),e.A++,!0)}M.Ma=function(){if(this.u=null,Xf(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var e=2*this.S;this.l.info("BP detection timer enabled: "+e),this.B=Ps(Jt(this.jb,this),e)}};M.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,se(10),To(this),Xf(this))};function nl(e){e.B!=null&&(G.clearTimeout(e.B),e.B=null)}function Xf(e){e.g=new Ls(e,e.l,"rpc",e.ba),e.o===null&&(e.g.I=e.s),e.g.O=0;var t=Xe(e.wa);vt(t,"RID","rpc"),vt(t,"SID",e.K),vt(t,"AID",e.V),vt(t,"CI",e.G?"0":"1"),!e.G&&e.qa&&vt(t,"TO",e.qa),vt(t,"TYPE","xmlhttp"),Fs(e,t),e.o&&e.s&&Zc(t,e.o,e.s),e.L&&e.g.setTimeout(e.L);var n=e.g;e=e.pa,n.L=1,n.A=bo(Xe(t)),n.u=null,n.S=!0,If(n,e)}M.ib=function(){this.v!=null&&(this.v=null,To(this),el(this),se(19))};function Ai(e){e.v!=null&&(G.clearTimeout(e.v),e.v=null)}function Jf(e,t){var n=null;if(e.g==t){Ai(e),nl(e),e.g=null;var r=2}else if(Qa(e.i,t))n=t.F,Ff(e.i,t),r=1;else return;if(e.H!=0){if(t.i)if(r==1){n=t.u?t.u.length:0,t=Date.now()-t.G;var s=e.C;r=mo(),$t(r,new _f(r,n)),So(e)}else Qf(e);else if(s=t.s,s==3||s==0&&0<t.ca||!(r==1&&e_(e,t)||r==2&&el(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),s){case 1:Rn(e,5);break;case 4:Rn(e,10);break;case 3:Rn(e,6);break;default:Rn(e,2)}}}function Yf(e,t){let n=e.ab+Math.floor(Math.random()*e.hb);return e.isActive()||(n*=2),n*t}function Rn(e,t){if(e.l.info("Error code "+t),t==2){var n=null;e.h&&(n=null);var r=Jt(e.pb,e);n||(n=new Vn("//www.google.com/images/cleardot.gif"),G.location&&G.location.protocol=="http"||ki(n,"https"),bo(n)),Qw(n.toString(),r)}else se(2);e.H=0,e.h&&e.h.za(t),Zf(e),Hf(e)}M.pb=function(e){e?(this.l.info("Successfully pinged google.com"),se(2)):(this.l.info("Failed to ping google.com"),se(1))};function Zf(e){if(e.H=0,e.ma=[],e.h){const t=Vf(e.i);(t.length!=0||e.j.length!=0)&&(Nu(e.ma,t),Nu(e.ma,e.j),e.i.i.length=0,Uc(e.j),e.j.length=0),e.h.ya()}}function tp(e,t,n){var r=n instanceof Vn?Xe(n):new Vn(n);if(r.g!="")t&&(r.g=t+"."+r.g),xi(r,r.m);else{var s=G.location;r=s.protocol,t=t?t+"."+s.hostname:s.hostname,s=+s.port;var i=new Vn(null);r&&ki(i,r),t&&(i.g=t),s&&xi(i,s),n&&(i.l=n),r=i}return n=e.F,t=e.Da,n&&t&&vt(r,n,t),vt(r,"VER",e.ra),Fs(e,r),r}function ep(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return t=e.Ha&&!e.va?new Ct(new wo({ob:n})):new Ct(e.va),t.Oa(e.J),t}M.isActive=function(){return!!this.h&&this.h.isActive(this)};function np(){}M=np.prototype;M.Ba=function(){};M.Aa=function(){};M.za=function(){};M.ya=function(){};M.isActive=function(){return!0};M.Va=function(){};function Di(){if(vr&&!(10<=Number(pw)))throw Error("Environmental error: no available transport.")}Di.prototype.g=function(e,t){return new ue(e,t)};function ue(e,t){Lt.call(this),this.g=new Gf(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!ps(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!ps(t)&&(this.g.F=t,e=this.h,e!==null&&t in e&&(e=this.h,t in e&&delete e[t])),this.j=new Nr(this)}Ot(ue,Lt);ue.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,n=this.h||void 0;se(0),e.Y=t,e.na=n||{},e.G=e.aa,e.I=tp(e,null,e.Y),So(e)};ue.prototype.close=function(){tl(this.g)};ue.prototype.u=function(e){var t=this.g;if(typeof e=="string"){var n={};n.__data__=e,e=n}else this.v&&(n={},n.__data__=zc(e),e=n);t.j.push(new zw(t.fb++,e)),t.H==3&&So(t)};ue.prototype.N=function(){this.g.h=null,delete this.j,tl(this.g),delete this.g,ue.$.N.call(this)};function rp(e){Qc.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){t:{for(const n in t){e=n;break t}e=void 0}(this.i=e)&&(e=this.i,t=t!==null&&e in t?t[e]:void 0),this.data=t}else this.data=e}Ot(rp,Qc);function sp(){Xc.call(this),this.status=1}Ot(sp,Xc);function Nr(e){this.g=e}Ot(Nr,np);Nr.prototype.Ba=function(){$t(this.g,"a")};Nr.prototype.Aa=function(e){$t(this.g,new rp(e))};Nr.prototype.za=function(e){$t(this.g,new sp)};Nr.prototype.ya=function(){$t(this.g,"b")};function n_(){this.blockSize=-1}function Ie(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}Ot(Ie,n_);Ie.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function fa(e,t,n){n||(n=0);var r=Array(16);if(typeof t=="string")for(var s=0;16>s;++s)r[s]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(s=0;16>s;++s)r[s]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],s=e.g[2];var i=e.g[3],o=t+(i^n&(s^i))+r[0]+3614090360&4294967295;t=n+(o<<7&4294967295|o>>>25),o=i+(s^t&(n^s))+r[1]+3905402710&4294967295,i=t+(o<<12&4294967295|o>>>20),o=s+(n^i&(t^n))+r[2]+606105819&4294967295,s=i+(o<<17&4294967295|o>>>15),o=n+(t^s&(i^t))+r[3]+3250441966&4294967295,n=s+(o<<22&4294967295|o>>>10),o=t+(i^n&(s^i))+r[4]+4118548399&4294967295,t=n+(o<<7&4294967295|o>>>25),o=i+(s^t&(n^s))+r[5]+1200080426&4294967295,i=t+(o<<12&4294967295|o>>>20),o=s+(n^i&(t^n))+r[6]+2821735955&4294967295,s=i+(o<<17&4294967295|o>>>15),o=n+(t^s&(i^t))+r[7]+4249261313&4294967295,n=s+(o<<22&4294967295|o>>>10),o=t+(i^n&(s^i))+r[8]+1770035416&4294967295,t=n+(o<<7&4294967295|o>>>25),o=i+(s^t&(n^s))+r[9]+2336552879&4294967295,i=t+(o<<12&4294967295|o>>>20),o=s+(n^i&(t^n))+r[10]+4294925233&4294967295,s=i+(o<<17&4294967295|o>>>15),o=n+(t^s&(i^t))+r[11]+2304563134&4294967295,n=s+(o<<22&4294967295|o>>>10),o=t+(i^n&(s^i))+r[12]+1804603682&4294967295,t=n+(o<<7&4294967295|o>>>25),o=i+(s^t&(n^s))+r[13]+4254626195&4294967295,i=t+(o<<12&4294967295|o>>>20),o=s+(n^i&(t^n))+r[14]+2792965006&4294967295,s=i+(o<<17&4294967295|o>>>15),o=n+(t^s&(i^t))+r[15]+1236535329&4294967295,n=s+(o<<22&4294967295|o>>>10),o=t+(s^i&(n^s))+r[1]+4129170786&4294967295,t=n+(o<<5&4294967295|o>>>27),o=i+(n^s&(t^n))+r[6]+3225465664&4294967295,i=t+(o<<9&4294967295|o>>>23),o=s+(t^n&(i^t))+r[11]+643717713&4294967295,s=i+(o<<14&4294967295|o>>>18),o=n+(i^t&(s^i))+r[0]+3921069994&4294967295,n=s+(o<<20&4294967295|o>>>12),o=t+(s^i&(n^s))+r[5]+3593408605&4294967295,t=n+(o<<5&4294967295|o>>>27),o=i+(n^s&(t^n))+r[10]+38016083&4294967295,i=t+(o<<9&4294967295|o>>>23),o=s+(t^n&(i^t))+r[15]+3634488961&4294967295,s=i+(o<<14&4294967295|o>>>18),o=n+(i^t&(s^i))+r[4]+3889429448&4294967295,n=s+(o<<20&4294967295|o>>>12),o=t+(s^i&(n^s))+r[9]+568446438&4294967295,t=n+(o<<5&4294967295|o>>>27),o=i+(n^s&(t^n))+r[14]+3275163606&4294967295,i=t+(o<<9&4294967295|o>>>23),o=s+(t^n&(i^t))+r[3]+4107603335&4294967295,s=i+(o<<14&4294967295|o>>>18),o=n+(i^t&(s^i))+r[8]+1163531501&4294967295,n=s+(o<<20&4294967295|o>>>12),o=t+(s^i&(n^s))+r[13]+2850285829&4294967295,t=n+(o<<5&4294967295|o>>>27),o=i+(n^s&(t^n))+r[2]+4243563512&4294967295,i=t+(o<<9&4294967295|o>>>23),o=s+(t^n&(i^t))+r[7]+1735328473&4294967295,s=i+(o<<14&4294967295|o>>>18),o=n+(i^t&(s^i))+r[12]+2368359562&4294967295,n=s+(o<<20&4294967295|o>>>12),o=t+(n^s^i)+r[5]+4294588738&4294967295,t=n+(o<<4&4294967295|o>>>28),o=i+(t^n^s)+r[8]+2272392833&4294967295,i=t+(o<<11&4294967295|o>>>21),o=s+(i^t^n)+r[11]+1839030562&4294967295,s=i+(o<<16&4294967295|o>>>16),o=n+(s^i^t)+r[14]+4259657740&4294967295,n=s+(o<<23&4294967295|o>>>9),o=t+(n^s^i)+r[1]+2763975236&4294967295,t=n+(o<<4&4294967295|o>>>28),o=i+(t^n^s)+r[4]+1272893353&4294967295,i=t+(o<<11&4294967295|o>>>21),o=s+(i^t^n)+r[7]+4139469664&4294967295,s=i+(o<<16&4294967295|o>>>16),o=n+(s^i^t)+r[10]+3200236656&4294967295,n=s+(o<<23&4294967295|o>>>9),o=t+(n^s^i)+r[13]+681279174&4294967295,t=n+(o<<4&4294967295|o>>>28),o=i+(t^n^s)+r[0]+3936430074&4294967295,i=t+(o<<11&4294967295|o>>>21),o=s+(i^t^n)+r[3]+3572445317&4294967295,s=i+(o<<16&4294967295|o>>>16),o=n+(s^i^t)+r[6]+76029189&4294967295,n=s+(o<<23&4294967295|o>>>9),o=t+(n^s^i)+r[9]+3654602809&4294967295,t=n+(o<<4&4294967295|o>>>28),o=i+(t^n^s)+r[12]+3873151461&4294967295,i=t+(o<<11&4294967295|o>>>21),o=s+(i^t^n)+r[15]+530742520&4294967295,s=i+(o<<16&4294967295|o>>>16),o=n+(s^i^t)+r[2]+3299628645&4294967295,n=s+(o<<23&4294967295|o>>>9),o=t+(s^(n|~i))+r[0]+4096336452&4294967295,t=n+(o<<6&4294967295|o>>>26),o=i+(n^(t|~s))+r[7]+1126891415&4294967295,i=t+(o<<10&4294967295|o>>>22),o=s+(t^(i|~n))+r[14]+2878612391&4294967295,s=i+(o<<15&4294967295|o>>>17),o=n+(i^(s|~t))+r[5]+4237533241&4294967295,n=s+(o<<21&4294967295|o>>>11),o=t+(s^(n|~i))+r[12]+1700485571&4294967295,t=n+(o<<6&4294967295|o>>>26),o=i+(n^(t|~s))+r[3]+2399980690&4294967295,i=t+(o<<10&4294967295|o>>>22),o=s+(t^(i|~n))+r[10]+4293915773&4294967295,s=i+(o<<15&4294967295|o>>>17),o=n+(i^(s|~t))+r[1]+2240044497&4294967295,n=s+(o<<21&4294967295|o>>>11),o=t+(s^(n|~i))+r[8]+1873313359&4294967295,t=n+(o<<6&4294967295|o>>>26),o=i+(n^(t|~s))+r[15]+4264355552&4294967295,i=t+(o<<10&4294967295|o>>>22),o=s+(t^(i|~n))+r[6]+2734768916&4294967295,s=i+(o<<15&4294967295|o>>>17),o=n+(i^(s|~t))+r[13]+1309151649&4294967295,n=s+(o<<21&4294967295|o>>>11),o=t+(s^(n|~i))+r[4]+4149444226&4294967295,t=n+(o<<6&4294967295|o>>>26),o=i+(n^(t|~s))+r[11]+3174756917&4294967295,i=t+(o<<10&4294967295|o>>>22),o=s+(t^(i|~n))+r[2]+718787259&4294967295,s=i+(o<<15&4294967295|o>>>17),o=n+(i^(s|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(s+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+s&4294967295,e.g[3]=e.g[3]+i&4294967295}Ie.prototype.j=function(e,t){t===void 0&&(t=e.length);for(var n=t-this.blockSize,r=this.m,s=this.h,i=0;i<t;){if(s==0)for(;i<=n;)fa(this,e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<t;)if(r[s++]=e.charCodeAt(i++),s==this.blockSize){fa(this,r),s=0;break}}else for(;i<t;)if(r[s++]=e[i++],s==this.blockSize){fa(this,r),s=0;break}}this.h=s,this.i+=t};Ie.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=n&255,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};function ft(e,t){this.h=t;for(var n=[],r=!0,s=e.length-1;0<=s;s--){var i=e[s]|0;r&&i==t||(n[s]=i,r=!1)}this.g=n}var r_={};function rl(e){return-128<=e&&128>e?uw(e,function(t){return new ft([t|0],0>t?-1:0)}):new ft([e|0],0>e?-1:0)}function Le(e){if(isNaN(e)||!isFinite(e))return fr;if(0>e)return jt(Le(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=Xa;return new ft(t,0)}function ip(e,t){if(e.length==0)throw Error("number format error: empty string");if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(e.charAt(0)=="-")return jt(ip(e.substring(1),t));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=Le(Math.pow(t,8)),r=fr,s=0;s<e.length;s+=8){var i=Math.min(8,e.length-s),o=parseInt(e.substring(s,s+i),t);8>i?(i=Le(Math.pow(t,i)),r=r.R(i).add(Le(o))):(r=r.R(n),r=r.add(Le(o)))}return r}var Xa=4294967296,fr=rl(0),Ja=rl(1),Bu=rl(16777216);M=ft.prototype;M.ea=function(){if(me(this))return-jt(this).ea();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.D(n);e+=(0<=r?r:Xa+r)*t,t*=Xa}return e};M.toString=function(e){if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(Ge(this))return"0";if(me(this))return"-"+jt(this).toString(e);for(var t=Le(Math.pow(e,6)),n=this,r="";;){var s=Ri(n,t).g;n=Ni(n,s.R(t));var i=((0<n.g.length?n.g[0]:n.h)>>>0).toString(e);if(n=s,Ge(n))return i+r;for(;6>i.length;)i="0"+i;r=i+r}};M.D=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h};function Ge(e){if(e.h!=0)return!1;for(var t=0;t<e.g.length;t++)if(e.g[t]!=0)return!1;return!0}function me(e){return e.h==-1}M.X=function(e){return e=Ni(this,e),me(e)?-1:Ge(e)?0:1};function jt(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new ft(n,~e.h).add(Ja)}M.abs=function(){return me(this)?jt(this):this};M.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,s=0;s<=t;s++){var i=r+(this.D(s)&65535)+(e.D(s)&65535),o=(i>>>16)+(this.D(s)>>>16)+(e.D(s)>>>16);r=o>>>16,i&=65535,o&=65535,n[s]=o<<16|i}return new ft(n,n[n.length-1]&-2147483648?-1:0)};function Ni(e,t){return e.add(jt(t))}M.R=function(e){if(Ge(this)||Ge(e))return fr;if(me(this))return me(e)?jt(this).R(jt(e)):jt(jt(this).R(e));if(me(e))return jt(this.R(jt(e)));if(0>this.X(Bu)&&0>e.X(Bu))return Le(this.ea()*e.ea());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var s=0;s<e.g.length;s++){var i=this.D(r)>>>16,o=this.D(r)&65535,a=e.D(s)>>>16,c=e.D(s)&65535;n[2*r+2*s]+=o*c,ni(n,2*r+2*s),n[2*r+2*s+1]+=i*c,ni(n,2*r+2*s+1),n[2*r+2*s+1]+=o*a,ni(n,2*r+2*s+1),n[2*r+2*s+2]+=i*a,ni(n,2*r+2*s+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new ft(n,0)};function ni(e,t){for(;(e[t]&65535)!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function qr(e,t){this.g=e,this.h=t}function Ri(e,t){if(Ge(t))throw Error("division by zero");if(Ge(e))return new qr(fr,fr);if(me(e))return t=Ri(jt(e),t),new qr(jt(t.g),jt(t.h));if(me(t))return t=Ri(e,jt(t)),new qr(jt(t.g),t.h);if(30<e.g.length){if(me(e)||me(t))throw Error("slowDivide_ only works with positive integers.");for(var n=Ja,r=t;0>=r.X(e);)n=qu(n),r=qu(r);var s=Zn(n,1),i=Zn(r,1);for(r=Zn(r,2),n=Zn(n,2);!Ge(r);){var o=i.add(r);0>=o.X(e)&&(s=s.add(n),i=o),r=Zn(r,1),n=Zn(n,1)}return t=Ni(e,s.R(t)),new qr(s,t)}for(s=fr;0<=e.X(t);){for(n=Math.max(1,Math.floor(e.ea()/t.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),i=Le(n),o=i.R(t);me(o)||0<o.X(e);)n-=r,i=Le(n),o=i.R(t);Ge(i)&&(i=Ja),s=s.add(i),e=Ni(e,o)}return new qr(s,e)}M.gb=function(e){return Ri(this,e).h};M.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)&e.D(r);return new ft(n,this.h&e.h)};M.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)|e.D(r);return new ft(n,this.h|e.h)};M.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)^e.D(r);return new ft(n,this.h^e.h)};function qu(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.D(r)<<1|e.D(r-1)>>>31;return new ft(n,e.h)}function Zn(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,s=[],i=0;i<r;i++)s[i]=0<t?e.D(i+n)>>>t|e.D(i+n+1)<<32-t:e.D(i+n);return new ft(s,e.h)}Di.prototype.createWebChannel=Di.prototype.g;ue.prototype.send=ue.prototype.u;ue.prototype.open=ue.prototype.m;ue.prototype.close=ue.prototype.close;go.NO_ERROR=0;go.TIMEOUT=8;go.HTTP_ERROR=6;Ef.COMPLETE="complete";Tf.EventType=Ms;Ms.OPEN="a";Ms.CLOSE="b";Ms.ERROR="c";Ms.MESSAGE="d";Lt.prototype.listen=Lt.prototype.O;Ct.prototype.listenOnce=Ct.prototype.P;Ct.prototype.getLastError=Ct.prototype.Sa;Ct.prototype.getLastErrorCode=Ct.prototype.Ia;Ct.prototype.getStatus=Ct.prototype.da;Ct.prototype.getResponseJson=Ct.prototype.Wa;Ct.prototype.getResponseText=Ct.prototype.ja;Ct.prototype.send=Ct.prototype.ha;Ct.prototype.setWithCredentials=Ct.prototype.Oa;Ie.prototype.digest=Ie.prototype.l;Ie.prototype.reset=Ie.prototype.reset;Ie.prototype.update=Ie.prototype.j;ft.prototype.add=ft.prototype.add;ft.prototype.multiply=ft.prototype.R;ft.prototype.modulo=ft.prototype.gb;ft.prototype.compare=ft.prototype.X;ft.prototype.toNumber=ft.prototype.ea;ft.prototype.toString=ft.prototype.toString;ft.prototype.getBits=ft.prototype.D;ft.fromNumber=Le;ft.fromString=ip;var s_=function(){return new Di},i_=function(){return mo()},pa=go,o_=Ef,a_=Wn,$u={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},ri=Tf,c_=Ct,l_=Ie,pr=ft;const zu="@firebase/firestore";/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Wt{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Wt.UNAUTHENTICATED=new Wt(null),Wt.GOOGLE_CREDENTIALS=new Wt("google-credentials-uid"),Wt.FIRST_PARTY=new Wt("first-party-uid"),Wt.MOCK_USER=new Wt("mock-user");/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/let Rr="10.8.1";/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const $n=new Xd("@firebase/firestore");function $r(){return $n.logLevel}function P(e,...t){if($n.logLevel<=ct.DEBUG){const n=t.map(sl);$n.debug(`Firestore (${Rr}): ${e}`,...n)}}function je(e,...t){if($n.logLevel<=ct.ERROR){const n=t.map(sl);$n.error(`Firestore (${Rr}): ${e}`,...n)}}function br(e,...t){if($n.logLevel<=ct.WARN){const n=t.map(sl);$n.warn(`Firestore (${Rr}): ${e}`,...n)}}function sl(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(e)}catch{return e}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function H(e="Unexpected state"){const t=`FIRESTORE (${Rr}) INTERNAL ASSERTION FAILED: `+e;throw je(t),new Error(t)}function mt(e,t){e||H()}function Y(e,t){return e}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const C={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class j extends Ar{constructor(t,n){super(t,n),this.code=t,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class We{constructor(){this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class op{constructor(t,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class u_{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,n){t.enqueueRetryable(()=>n(Wt.UNAUTHENTICATED))}shutdown(){}}class h_{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,n){this.changeListener=n,t.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class d_{constructor(t){this.t=t,this.currentUser=Wt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,n){let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new We;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new We,t.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;t.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},a=c=>{P("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(P("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new We)}},0),o()}getToken(){const t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==t?(P("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(mt(typeof r.accessToken=="string"),new op(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return mt(t===null||typeof t=="string"),new Wt(t)}}class f_{constructor(t,n,r){this.l=t,this.h=n,this.P=r,this.type="FirstParty",this.user=Wt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class p_{constructor(t,n,r){this.l=t,this.h=n,this.P=r}getToken(){return Promise.resolve(new f_(this.l,this.h,this.P))}start(t,n){t.enqueueRetryable(()=>n(Wt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class m_{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class g_{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,n){const r=i=>{i.error!=null&&P("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,P("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{t.enqueueRetryable(()=>r(i))};const s=i=>{P("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):P("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(n=>n?(mt(typeof n.token=="string"),this.R=n.token,new m_(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function y_(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class ap{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/t.length)*t.length;let r="";for(;r.length<20;){const s=y_(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=t.charAt(s[i]%t.length))}return r}}function ut(e,t){return e<t?-1:e>t?1:0}function wr(e,t,n){return e.length===t.length&&e.every((r,s)=>n(r,t[s]))}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Nt{constructor(t,n){if(this.seconds=t,this.nanoseconds=n,n<0)throw new j(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new j(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<-62135596800)throw new j(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new j(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return Nt.fromMillis(Date.now())}static fromDate(t){return Nt.fromMillis(t.getTime())}static fromMillis(t){const n=Math.floor(t/1e3),r=Math.floor(1e6*(t-1e3*n));return new Nt(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?ut(this.nanoseconds,t.nanoseconds):ut(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Q{constructor(t){this.timestamp=t}static fromTimestamp(t){return new Q(t)}static min(){return new Q(new Nt(0,0))}static max(){return new Q(new Nt(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Es{constructor(t,n,r){n===void 0?n=0:n>t.length&&H(),r===void 0?r=t.length-n:r>t.length-n&&H(),this.segments=t,this.offset=n,this.len=r}get length(){return this.len}isEqual(t){return Es.comparator(this,t)===0}child(t){const n=this.segments.slice(this.offset,this.limit());return t instanceof Es?t.forEach(r=>{n.push(r)}):n.push(t),this.construct(n)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}forEach(t){for(let n=this.offset,r=this.limit();n<r;n++)t(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,n){const r=Math.min(t.length,n.length);for(let s=0;s<r;s++){const i=t.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return t.length<n.length?-1:t.length>n.length?1:0}}class _t extends Es{construct(t,n,r){return new _t(t,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const n=[];for(const r of t){if(r.indexOf("//")>=0)throw new j(C.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new _t(n)}static emptyPath(){return new _t([])}}const v_=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class qt extends Es{construct(t,n,r){return new qt(t,n,r)}static isValidIdentifier(t){return v_.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),qt.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new qt(["__name__"])}static fromServerFormat(t){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new j(C.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<t.length;){const a=t[s];if(a==="\\"){if(s+1===t.length)throw new j(C.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const c=t[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new j(C.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=c,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new j(C.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new qt(n)}static emptyPath(){return new qt([])}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class q{constructor(t){this.path=t}static fromPath(t){return new q(_t.fromString(t))}static fromName(t){return new q(_t.fromString(t).popFirst(5))}static empty(){return new q(_t.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&_t.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,n){return _t.comparator(t.path,n.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new q(new _t(t.slice()))}}function b_(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,s=Q.fromTimestamp(r===1e9?new Nt(n+1,0):new Nt(n,r));return new vn(s,q.empty(),t)}function w_(e){return new vn(e.readTime,e.key,-1)}class vn{constructor(t,n,r){this.readTime=t,this.documentKey=n,this.largestBatchId=r}static min(){return new vn(Q.min(),q.empty(),-1)}static max(){return new vn(Q.max(),q.empty(),-1)}}function __(e,t){let n=e.readTime.compareTo(t.readTime);return n!==0?n:(n=q.comparator(e.documentKey,t.documentKey),n!==0?n:ut(e.largestBatchId,t.largestBatchId))}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const E_="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class T_{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/async function Vs(e){if(e.code!==C.FAILED_PRECONDITION||e.message!==E_)throw e;P("LocalStore","Unexpectedly lost primary lease")}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class b{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(t){return this.next(void 0,t)}next(t,n){return this.callbackAttached&&H(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new b((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(t,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((t,n)=>{this.next(t,n)})}wrapUserFunction(t){try{const n=t();return n instanceof b?n:b.resolve(n)}catch(n){return b.reject(n)}}wrapSuccess(t,n){return t?this.wrapUserFunction(()=>t(n)):b.resolve(n)}wrapFailure(t,n){return t?this.wrapUserFunction(()=>t(n)):b.reject(n)}static resolve(t){return new b((n,r)=>{n(t)})}static reject(t){return new b((n,r)=>{r(t)})}static waitFor(t){return new b((n,r)=>{let s=0,i=0,o=!1;t.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(t){let n=b.resolve(!1);for(const r of t)n=n.next(s=>s?b.resolve(s):r());return n}static forEach(t,n){const r=[];return t.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(t,n){return new b((r,s)=>{const i=t.length,o=new Array(i);let a=0;for(let c=0;c<i;c++){const l=c;n(t[l]).next(u=>{o[l]=u,++a,a===i&&r(o)},u=>s(u))}})}static doWhile(t,n){return new b((r,s)=>{const i=()=>{t()===!0?n().next(()=>{i()},s):r()};i()})}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class il{constructor(t,n){this.action=t,this.transaction=n,this.aborted=!1,this.V=new We,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new ns(t,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const s=ol(r.target.error);this.V.reject(new ns(t,s))}}static open(t,n,r,s){try{return new il(n,t.transaction(s,r))}catch(i){throw new ns(n,i)}}get m(){return this.V.promise}abort(t){t&&this.V.reject(t),this.aborted||(P("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const t=this.transaction;this.aborted||typeof t.commit!="function"||t.commit()}store(t){const n=this.transaction.objectStore(t);return new C_(n)}}class Pn{constructor(t,n,r){this.name=t,this.version=n,this.p=r,Pn.S(Si())===12.2&&je("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(t){return P("SimpleDb","Removing database:",t),An(window.indexedDB.deleteDatabase(t)).toPromise()}static D(){if(!Wd())return!1;if(Pn.C())return!0;const t=Si(),n=Pn.S(t),r=0<n&&n<10,s=Pn.v(t),i=0<s&&s<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||r||i)}static C(){var t;return typeof process<"u"&&((t=process.__PRIVATE_env)===null||t===void 0?void 0:t.F)==="YES"}static M(t,n){return t.store(n)}static S(t){const n=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(t){const n=t.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}async O(t){return this.db||(P("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;n(o)},s.onblocked=()=>{r(new ns(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new j(C.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new j(C.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new ns(t,o))},s.onupgradeneeded=i=>{P("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.p.N(o,s.transaction,i.oldVersion,this.version).next(()=>{P("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.B&&(this.db.onversionchange=n=>this.B(n)),this.db}L(t){this.B=t,this.db&&(this.db.onversionchange=n=>t(n))}async runTransaction(t,n,r,s){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.O(t);const a=il.open(this.db,t,i?"readonly":"readwrite",r),c=s(a).next(l=>(a.g(),l)).catch(l=>(a.abort(l),b.reject(l))).toPromise();return c.catch(()=>{}),await a.m,c}catch(a){const c=a,l=c.name!=="FirebaseError"&&o<3;if(P("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}class S_{constructor(t){this.k=t,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(t){this.k=t}done(){this.q=!0}U(t){this.K=t}delete(){return An(this.k.delete())}}class ns extends j{constructor(t,n){super(C.UNAVAILABLE,`IndexedDB transaction '${t}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function js(e){return e.name==="IndexedDbTransactionError"}class C_{constructor(t){this.store=t}put(t,n){let r;return n!==void 0?(P("SimpleDb","PUT",this.store.name,t,n),r=this.store.put(n,t)):(P("SimpleDb","PUT",this.store.name,"<auto-key>",t),r=this.store.put(t)),An(r)}add(t){return P("SimpleDb","ADD",this.store.name,t,t),An(this.store.add(t))}get(t){return An(this.store.get(t)).next(n=>(n===void 0&&(n=null),P("SimpleDb","GET",this.store.name,t,n),n))}delete(t){return P("SimpleDb","DELETE",this.store.name,t),An(this.store.delete(t))}count(){return P("SimpleDb","COUNT",this.store.name),An(this.store.count())}W(t,n){const r=this.options(t,n),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new b((o,a)=>{i.onerror=c=>{a(c.target.error)},i.onsuccess=c=>{o(c.target.result)}})}{const i=this.cursor(r),o=[];return this.G(i,(a,c)=>{o.push(c)}).next(()=>o)}}j(t,n){const r=this.store.getAll(t,n===null?void 0:n);return new b((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}H(t,n){P("SimpleDb","DELETE ALL",this.store.name);const r=this.options(t,n);r.J=!1;const s=this.cursor(r);return this.G(s,(i,o,a)=>a.delete())}Y(t,n){let r;n?r=t:(r={},n=t);const s=this.cursor(r);return this.G(s,n)}Z(t){const n=this.cursor({});return new b((r,s)=>{n.onerror=i=>{const o=ol(i.target.error);s(o)},n.onsuccess=i=>{const o=i.target.result;o?t(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}G(t,n){const r=[];return new b((s,i)=>{t.onerror=o=>{i(o.target.error)},t.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const c=new S_(a),l=n(a.primaryKey,a.value,c);if(l instanceof b){const u=l.catch(h=>(c.done(),b.reject(h)));r.push(u)}c.isDone?s():c.$===null?a.continue():a.continue(c.$)}}).next(()=>b.waitFor(r))}options(t,n){let r;return t!==void 0&&(typeof t=="string"?r=t:n=t),{index:r,range:n}}cursor(t){let n="next";if(t.reverse&&(n="prev"),t.index){const r=this.store.index(t.index);return t.J?r.openKeyCursor(t.range,n):r.openCursor(t.range,n)}return this.store.openCursor(t.range,n)}}function An(e){return new b((t,n)=>{e.onsuccess=r=>{const s=r.target.result;t(s)},e.onerror=r=>{const s=ol(r.target.error);n(s)}})}let Ku=!1;function ol(e){const t=Pn.S(Si());if(t>=12.2&&t<13){const n="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(n)>=0){const r=new j("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Ku||(Ku=!0,setTimeout(()=>{throw r},0)),r}}return e}/**
* @license
* Copyright 2018 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class al{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=r=>this.se(r),this.oe=r=>n.writeSequenceNumber(r))}se(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.oe&&this.oe(t),t}}al._e=-1;function Co(e){return e==null}function Pi(e){return e===0&&1/e==-1/0}function I_(e){return typeof e=="number"&&Number.isInteger(e)&&!Pi(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function Gu(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Pr(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function cp(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Tt{constructor(t,n){this.comparator=t,this.root=n||Vt.EMPTY}insert(t,n){return new Tt(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,Vt.BLACK,null,null))}remove(t){return new Tt(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Vt.BLACK,null,null))}get(t){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(t,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(t){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(t,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((n,r)=>(t(n,r),!1))}toString(){const t=[];return this.inorderTraversal((n,r)=>(t.push(`${n}:${r}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new si(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new si(this.root,t,this.comparator,!1)}getReverseIterator(){return new si(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new si(this.root,t,this.comparator,!0)}}class si{constructor(t,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!t.isEmpty();)if(i=n?r(t.key,n):1,n&&s&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(i===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const n={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Vt{constructor(t,n,r,s,i){this.key=t,this.value=n,this.color=r??Vt.RED,this.left=s??Vt.EMPTY,this.right=i??Vt.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,n,r,s,i){return new Vt(t??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,n,r){let s=this;const i=r(t,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(t,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(t,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Vt.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,n){let r,s=this;if(n(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(t,s.key)===0){if(s.right.isEmpty())return Vt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Vt.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Vt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,n)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw H();const t=this.left.check();if(t!==this.right.check())throw H();return t+(this.isRed()?0:1)}}Vt.EMPTY=null,Vt.RED=!0,Vt.BLACK=!1;Vt.EMPTY=new class{constructor(){this.size=0}get key(){throw H()}get value(){throw H()}get color(){throw H()}get left(){throw H()}get right(){throw H()}copy(e,t,n,r,s){return this}insert(e,t,n){return new Vt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class zt{constructor(t){this.comparator=t,this.data=new Tt(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((n,r)=>(t(n),!1))}forEachInRange(t,n){const r=this.data.getIteratorFrom(t[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,t[1])>=0)return;n(s.key)}}forEachWhile(t,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!t(r.getNext().key))return}firstAfterOrEqual(t){const n=this.data.getIteratorFrom(t);return n.hasNext()?n.getNext().key:null}getIterator(){return new Hu(this.data.getIterator())}getIteratorFrom(t){return new Hu(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let n=this;return n.size<t.size&&(n=t,t=this),t.forEach(r=>{n=n.add(r)}),n}isEqual(t){if(!(t instanceof zt)||this.size!==t.size)return!1;const n=this.data.getIterator(),r=t.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(n=>{t.push(n)}),t}toString(){const t=[];return this.forEach(n=>t.push(n)),"SortedSet("+t.toString()+")"}copy(t){const n=new zt(this.comparator);return n.data=t,n}}class Hu{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Te{constructor(t){this.fields=t,t.sort(qt.comparator)}static empty(){return new Te([])}unionWith(t){let n=new zt(qt.comparator);for(const r of this.fields)n=n.add(r);for(const r of t)n=n.add(r);return new Te(n.toArray())}covers(t){for(const n of this.fields)if(n.isPrefixOf(t))return!0;return!1}isEqual(t){return wr(this.fields,t.fields,(n,r)=>n.isEqual(r))}}/**
* @license
* Copyright 2023 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class lp extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class te{constructor(t){this.binaryString=t}static fromBase64String(t){const n=function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new lp("Invalid base64 string: "+s):s}}(t);return new te(n)}static fromUint8Array(t){const n=function(r){let s="";for(let i=0;i<r.length;++i)s+=String.fromCharCode(r[i]);return s}(t);return new te(n)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return ut(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}te.EMPTY_BYTE_STRING=new te("");const k_=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function bn(e){if(mt(!!e),typeof e=="string"){let t=0;const n=k_.exec(e);if(mt(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),t=Number(s)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:kt(e.seconds),nanos:kt(e.nanos)}}function kt(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function zn(e){return typeof e=="string"?te.fromBase64String(e):te.fromUint8Array(e)}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function cl(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function ll(e){const t=e.mapValue.fields.__previous_value__;return cl(t)?ll(t):t}function Ts(e){const t=bn(e.mapValue.fields.__local_write_time__.timestampValue);return new Nt(t.seconds,t.nanos)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class x_{constructor(t,n,r,s,i,o,a,c,l){this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}}class Ss{constructor(t,n){this.projectId=t,this.database=n||"(default)"}static empty(){return new Ss("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(t){return t instanceof Ss&&t.projectId===this.projectId&&t.database===this.database}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const ii={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Kn(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?cl(e)?4:A_(e)?9007199254740991:10:H()}function Be(e,t){if(e===t)return!0;const n=Kn(e);if(n!==Kn(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Ts(e).isEqual(Ts(t));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const i=bn(r.timestampValue),o=bn(s.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(r,s){return zn(r.bytesValue).isEqual(zn(s.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(r,s){return kt(r.geoPointValue.latitude)===kt(s.geoPointValue.latitude)&&kt(r.geoPointValue.longitude)===kt(s.geoPointValue.longitude)}(e,t);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return kt(r.integerValue)===kt(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const i=kt(r.doubleValue),o=kt(s.doubleValue);return i===o?Pi(i)===Pi(o):isNaN(i)&&isNaN(o)}return!1}(e,t);case 9:return wr(e.arrayValue.values||[],t.arrayValue.values||[],Be);case 10:return function(r,s){const i=r.mapValue.fields||{},o=s.mapValue.fields||{};if(Gu(i)!==Gu(o))return!1;for(const a in i)if(i.hasOwnProperty(a)&&(o[a]===void 0||!Be(i[a],o[a])))return!1;return!0}(e,t);default:return H()}}function Cs(e,t){return(e.values||[]).find(n=>Be(n,t))!==void 0}function _r(e,t){if(e===t)return 0;const n=Kn(e),r=Kn(t);if(n!==r)return ut(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ut(e.booleanValue,t.booleanValue);case 2:return function(s,i){const o=kt(s.integerValue||s.doubleValue),a=kt(i.integerValue||i.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(e,t);case 3:return Wu(e.timestampValue,t.timestampValue);case 4:return Wu(Ts(e),Ts(t));case 5:return ut(e.stringValue,t.stringValue);case 6:return function(s,i){const o=zn(s),a=zn(i);return o.compareTo(a)}(e.bytesValue,t.bytesValue);case 7:return function(s,i){const o=s.split("/"),a=i.split("/");for(let c=0;c<o.length&&c<a.length;c++){const l=ut(o[c],a[c]);if(l!==0)return l}return ut(o.length,a.length)}(e.referenceValue,t.referenceValue);case 8:return function(s,i){const o=ut(kt(s.latitude),kt(i.latitude));return o!==0?o:ut(kt(s.longitude),kt(i.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(s,i){const o=s.values||[],a=i.values||[];for(let c=0;c<o.length&&c<a.length;++c){const l=_r(o[c],a[c]);if(l)return l}return ut(o.length,a.length)}(e.arrayValue,t.arrayValue);case 10:return function(s,i){if(s===ii.mapValue&&i===ii.mapValue)return 0;if(s===ii.mapValue)return 1;if(i===ii.mapValue)return-1;const o=s.fields||{},a=Object.keys(o),c=i.fields||{},l=Object.keys(c);a.sort(),l.sort();for(let u=0;u<a.length&&u<l.length;++u){const h=ut(a[u],l[u]);if(h!==0)return h;const f=_r(o[a[u]],c[l[u]]);if(f!==0)return f}return ut(a.length,l.length)}(e.mapValue,t.mapValue);default:throw H()}}function Wu(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return ut(e,t);const n=bn(e),r=bn(t),s=ut(n.seconds,r.seconds);return s!==0?s:ut(n.nanos,r.nanos)}function Er(e){return Ya(e)}function Ya(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(t){const n=bn(t);return`time(${n.seconds},${n.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(t){return zn(t).toBase64()}(e.bytesValue):"referenceValue"in e?function(t){return q.fromName(t).toString()}(e.referenceValue):"geoPointValue"in e?function(t){return`geo(${t.latitude},${t.longitude})`}(e.geoPointValue):"arrayValue"in e?function(t){let n="[",r=!0;for(const s of t.values||[])r?r=!1:n+=",",n+=Ya(s);return n+"]"}(e.arrayValue):"mapValue"in e?function(t){const n=Object.keys(t.fields||{}).sort();let r="{",s=!0;for(const i of n)s?s=!1:r+=",",r+=`${i}:${Ya(t.fields[i])}`;return r+"}"}(e.mapValue):H()}function Za(e){return!!e&&"integerValue"in e}function ul(e){return!!e&&"arrayValue"in e}function Qu(e){return!!e&&"nullValue"in e}function Xu(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function hi(e){return!!e&&"mapValue"in e}function rs(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Pr(e.mapValue.fields,(n,r)=>t.mapValue.fields[n]=rs(r)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=rs(e.arrayValue.values[n]);return t}return Object.assign({},e)}function A_(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class ge{constructor(t){this.value=t}static empty(){return new ge({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let n=this.value;for(let r=0;r<t.length-1;++r)if(n=(n.mapValue.fields||{})[t.get(r)],!hi(n))return null;return n=(n.mapValue.fields||{})[t.lastSegment()],n||null}}set(t,n){this.getFieldsMap(t.popLast())[t.lastSegment()]=rs(n)}setAll(t){let n=qt.emptyPath(),r={},s=[];t.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=rs(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(t){const n=this.field(t.popLast());hi(n)&&n.mapValue.fields&&delete n.mapValue.fields[t.lastSegment()]}isEqual(t){return Be(this.value,t.value)}getFieldsMap(t){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<t.length;++r){let s=n.mapValue.fields[t.get(r)];hi(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[t.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(t,n,r){Pr(n,(s,i)=>t[s]=i);for(const s of r)delete t[s]}clone(){return new ge(rs(this.value))}}function up(e){const t=[];return Pr(e.fields,(n,r)=>{const s=new qt([n]);if(hi(r)){const i=up(r.mapValue).fields;if(i.length===0)t.push(s);else for(const o of i)t.push(s.child(o))}else t.push(s)}),new Te(t)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Qt{constructor(t,n,r,s,i,o,a){this.key=t,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(t){return new Qt(t,0,Q.min(),Q.min(),Q.min(),ge.empty(),0)}static newFoundDocument(t,n,r,s){return new Qt(t,1,n,Q.min(),r,s,0)}static newNoDocument(t,n){return new Qt(t,2,n,Q.min(),Q.min(),ge.empty(),0)}static newUnknownDocument(t,n){return new Qt(t,3,n,Q.min(),Q.min(),ge.empty(),2)}convertToFoundDocument(t,n){return!this.createTime.isEqual(Q.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=ge.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=ge.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Q.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Qt&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Qt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Mi{constructor(t,n){this.position=t,this.inclusive=n}}function Ju(e,t,n){let r=0;for(let s=0;s<e.position.length;s++){const i=t[s],o=e.position[s];if(i.field.isKeyField()?r=q.comparator(q.fromName(o.referenceValue),n.key):r=_r(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Yu(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Be(e.position[n],t.position[n]))return!1;return!0}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Li{constructor(t,n="asc"){this.field=t,this.dir=n}}function D_(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class hp{}class Dt extends hp{constructor(t,n,r){super(),this.field=t,this.op=n,this.value=r}static create(t,n,r){return t.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(t,n,r):new R_(t,n,r):n==="array-contains"?new L_(t,r):n==="in"?new O_(t,r):n==="not-in"?new U_(t,r):n==="array-contains-any"?new F_(t,r):new Dt(t,n,r)}static createKeyFieldInFilter(t,n,r){return n==="in"?new P_(t,r):new M_(t,r)}matches(t){const n=t.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(_r(n,this.value)):n!==null&&Kn(this.value)===Kn(n)&&this.matchesComparison(_r(n,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return H()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class qe extends hp{constructor(t,n){super(),this.filters=t,this.op=n,this.ue=null}static create(t,n){return new qe(t,n)}matches(t){return dp(this)?this.filters.find(n=>!n.matches(t))===void 0:this.filters.find(n=>n.matches(t))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((t,n)=>t.concat(n.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function dp(e){return e.op==="and"}function fp(e){return N_(e)&&dp(e)}function N_(e){for(const t of e.filters)if(t instanceof qe)return!1;return!0}function tc(e){if(e instanceof Dt)return e.field.canonicalString()+e.op.toString()+Er(e.value);if(fp(e))return e.filters.map(t=>tc(t)).join(",");{const t=e.filters.map(n=>tc(n)).join(",");return`${e.op}(${t})`}}function pp(e,t){return e instanceof Dt?function(n,r){return r instanceof Dt&&n.op===r.op&&n.field.isEqual(r.field)&&Be(n.value,r.value)}(e,t):e instanceof qe?function(n,r){return r instanceof qe&&n.op===r.op&&n.filters.length===r.filters.length?n.filters.reduce((s,i,o)=>s&&pp(i,r.filters[o]),!0):!1}(e,t):void H()}function mp(e){return e instanceof Dt?function(t){return`${t.field.canonicalString()} ${t.op} ${Er(t.value)}`}(e):e instanceof qe?function(t){return t.op.toString()+" {"+t.getFilters().map(mp).join(" ,")+"}"}(e):"Filter"}class R_ extends Dt{constructor(t,n,r){super(t,n,r),this.key=q.fromName(r.referenceValue)}matches(t){const n=q.comparator(t.key,this.key);return this.matchesComparison(n)}}class P_ extends Dt{constructor(t,n){super(t,"in",n),this.keys=gp("in",n)}matches(t){return this.keys.some(n=>n.isEqual(t.key))}}class M_ extends Dt{constructor(t,n){super(t,"not-in",n),this.keys=gp("not-in",n)}matches(t){return!this.keys.some(n=>n.isEqual(t.key))}}function gp(e,t){var n;return(((n=t.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>q.fromName(r.referenceValue))}class L_ extends Dt{constructor(t,n){super(t,"array-contains",n)}matches(t){const n=t.data.field(this.field);return ul(n)&&Cs(n.arrayValue,this.value)}}class O_ extends Dt{constructor(t,n){super(t,"in",n)}matches(t){const n=t.data.field(this.field);return n!==null&&Cs(this.value.arrayValue,n)}}class U_ extends Dt{constructor(t,n){super(t,"not-in",n)}matches(t){if(Cs(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=t.data.field(this.field);return n!==null&&!Cs(this.value.arrayValue,n)}}class F_ extends Dt{constructor(t,n){super(t,"array-contains-any",n)}matches(t){const n=t.data.field(this.field);return!(!ul(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Cs(this.value.arrayValue,r))}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class V_{constructor(t,n=null,r=[],s=[],i=null,o=null,a=null){this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.ce=null}}function Zu(e,t=null,n=[],r=[],s=null,i=null,o=null){return new V_(e,t,n,r,s,i,o)}function hl(e){const t=Y(e);if(t.ce===null){let n=t.path.canonicalString();t.collectionGroup!==null&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(r=>tc(r)).join(","),n+="|ob:",n+=t.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Co(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(r=>Er(r)).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(r=>Er(r)).join(",")),t.ce=n}return t.ce}function dl(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!D_(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!pp(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Yu(e.startAt,t.startAt)&&Yu(e.endAt,t.endAt)}function ec(e){return q.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Io{constructor(t,n=null,r=[],s=[],i=null,o="F",a=null,c=null){this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=c,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function j_(e,t,n,r,s,i,o,a){return new Io(e,t,n,r,s,i,o,a)}function yp(e){return new Io(e)}function th(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function B_(e){return e.collectionGroup!==null}function ss(e){const t=Y(e);if(t.le===null){t.le=[];const n=new Set;for(const s of t.explicitOrderBy)t.le.push(s),n.add(s.field.canonicalString());const r=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(s){let i=new zt(qt.comparator);return s.filters.forEach(o=>{o.getFlattenedFilters().forEach(a=>{a.isInequality()&&(i=i.add(a.field))})}),i})(t).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||t.le.push(new Li(s,r))}),n.has(qt.keyField().canonicalString())||t.le.push(new Li(qt.keyField(),r))}return t.le}function Oe(e){const t=Y(e);return t.he||(t.he=q_(t,ss(e))),t.he}function q_(e,t){if(e.limitType==="F")return Zu(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Li(s.field,i)});const n=e.endAt?new Mi(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Mi(e.startAt.position,e.startAt.inclusive):null;return Zu(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function nc(e,t,n){return new Io(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function ko(e,t){return dl(Oe(e),Oe(t))&&e.limitType===t.limitType}function vp(e){return`${hl(Oe(e))}|lt:${e.limitType}`}function nr(e){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(r=>mp(r)).join(", ")}]`),Co(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(r=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(r)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(r=>Er(r)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(r=>Er(r)).join(",")),`Target(${n})`}(Oe(e))}; limitType=${e.limitType})`}function xo(e,t){return t.isFoundDocument()&&function(n,r){const s=r.key.path;return n.collectionGroup!==null?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):q.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(e,t)&&function(n,r){for(const s of ss(n))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(e,t)&&function(n,r){for(const s of n.filters)if(!s.matches(r))return!1;return!0}(e,t)&&function(n,r){return!(n.startAt&&!function(s,i,o){const a=Ju(s,i,o);return s.inclusive?a<=0:a<0}(n.startAt,ss(n),r)||n.endAt&&!function(s,i,o){const a=Ju(s,i,o);return s.inclusive?a>=0:a>0}(n.endAt,ss(n),r))}(e,t)}function $_(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function bp(e){return(t,n)=>{let r=!1;for(const s of ss(e)){const i=z_(s,t,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function z_(e,t,n){const r=e.field.isKeyField()?q.comparator(t.key,n.key):function(s,i,o){const a=i.data.field(s),c=o.data.field(s);return a!==null&&c!==null?_r(a,c):H()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return H()}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Mr{constructor(t,n){this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}get(t){const n=this.mapKeyFn(t),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,t))return i}}has(t){return this.get(t)!==void 0}set(t,n){const r=this.mapKeyFn(t),s=this.inner[r];if(s===void 0)return this.inner[r]=[[t,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],t))return void(s[i]=[t,n]);s.push([t,n]),this.innerSize++}delete(t){const n=this.mapKeyFn(t),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],t))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(t){Pr(this.inner,(n,r)=>{for(const[s,i]of r)t(s,i)})}isEmpty(){return cp(this.inner)}size(){return this.innerSize}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const K_=new Tt(q.comparator);function Je(){return K_}const wp=new Tt(q.comparator);function Wr(...e){let t=wp;for(const n of e)t=t.insert(n.key,n);return t}function _p(e){let t=wp;return e.forEach((n,r)=>t=t.insert(n,r.overlayedDocument)),t}function Mn(){return is()}function Ep(){return is()}function is(){return new Mr(e=>e.toString(),(e,t)=>e.isEqual(t))}const G_=new Tt(q.comparator),H_=new zt(q.comparator);function it(...e){let t=H_;for(const n of e)t=t.add(n);return t}const W_=new zt(ut);function Q_(){return W_}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function Tp(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Pi(t)?"-0":t}}function Sp(e){return{integerValue:""+e}}function X_(e,t){return I_(t)?Sp(t):Tp(e,t)}/**
* @license
* Copyright 2018 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Ao{constructor(){this._=void 0}}function J_(e,t,n){return e instanceof Oi?function(r,s){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&cl(s)&&(s=ll(s)),s&&(i.fields.__previous_value__=s),{mapValue:i}}(n,t):e instanceof Is?Ip(e,t):e instanceof ks?kp(e,t):function(r,s){const i=Cp(r,s),o=eh(i)+eh(r.Ie);return Za(i)&&Za(r.Ie)?Sp(o):Tp(r.serializer,o)}(e,t)}function Y_(e,t,n){return e instanceof Is?Ip(e,t):e instanceof ks?kp(e,t):n}function Cp(e,t){return e instanceof Ui?function(n){return Za(n)||function(r){return!!r&&"doubleValue"in r}(n)}(t)?t:{integerValue:0}:null}class Oi extends Ao{}class Is extends Ao{constructor(t){super(),this.elements=t}}function Ip(e,t){const n=xp(t);for(const r of e.elements)n.some(s=>Be(s,r))||n.push(r);return{arrayValue:{values:n}}}class ks extends Ao{constructor(t){super(),this.elements=t}}function kp(e,t){let n=xp(t);for(const r of e.elements)n=n.filter(s=>!Be(s,r));return{arrayValue:{values:n}}}class Ui extends Ao{constructor(t,n){super(),this.serializer=t,this.Ie=n}}function eh(e){return kt(e.integerValue||e.doubleValue)}function xp(e){return ul(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}function Z_(e,t){return e.field.isEqual(t.field)&&function(n,r){return n instanceof Is&&r instanceof Is||n instanceof ks&&r instanceof ks?wr(n.elements,r.elements,Be):n instanceof Ui&&r instanceof Ui?Be(n.Ie,r.Ie):n instanceof Oi&&r instanceof Oi}(e.transform,t.transform)}class t1{constructor(t,n){this.version=t,this.transformResults=n}}class Qe{constructor(t,n){this.updateTime=t,this.exists=n}static none(){return new Qe}static exists(t){return new Qe(void 0,t)}static updateTime(t){return new Qe(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function di(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class Do{}function Ap(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new Np(e.key,Qe.none()):new Bs(e.key,e.data,Qe.none());{const n=e.data,r=ge.empty();let s=new zt(qt.comparator);for(let i of t.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Qn(e.key,r,new Te(s.toArray()),Qe.none())}}function e1(e,t,n){e instanceof Bs?function(r,s,i){const o=r.value.clone(),a=rh(r.fieldTransforms,s,i.transformResults);o.setAll(a),s.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(e,t,n):e instanceof Qn?function(r,s,i){if(!di(r.precondition,s))return void s.convertToUnknownDocument(i.version);const o=rh(r.fieldTransforms,s,i.transformResults),a=s.data;a.setAll(Dp(r)),a.setAll(o),s.convertToFoundDocument(i.version,a).setHasCommittedMutations()}(e,t,n):function(r,s,i){s.convertToNoDocument(i.version).setHasCommittedMutations()}(0,t,n)}function os(e,t,n,r){return e instanceof Bs?function(s,i,o,a){if(!di(s.precondition,i))return o;const c=s.value.clone(),l=sh(s.fieldTransforms,a,i);return c.setAll(l),i.convertToFoundDocument(i.version,c).setHasLocalMutations(),null}(e,t,n,r):e instanceof Qn?function(s,i,o,a){if(!di(s.precondition,i))return o;const c=sh(s.fieldTransforms,a,i),l=i.data;return l.setAll(Dp(s)),l.setAll(c),i.convertToFoundDocument(i.version,l).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(u=>u.field))}(e,t,n,r):function(s,i,o){return di(s.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o}(e,t,n)}function n1(e,t){let n=null;for(const r of e.fieldTransforms){const s=t.data.field(r.field),i=Cp(r.transform,s||null);i!=null&&(n===null&&(n=ge.empty()),n.set(r.field,i))}return n||null}function nh(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&wr(n,r,(s,i)=>Z_(s,i))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Bs extends Do{constructor(t,n,r,s=[]){super(),this.key=t,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Qn extends Do{constructor(t,n,r,s,i=[]){super(),this.key=t,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Dp(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function rh(e,t,n){const r=new Map;mt(e.length===n.length);for(let s=0;s<n.length;s++){const i=e[s],o=i.transform,a=t.data.field(i.field);r.set(i.field,Y_(o,a,n[s]))}return r}function sh(e,t,n){const r=new Map;for(const s of e){const i=s.transform,o=n.data.field(s.field);r.set(s.field,J_(i,o,t))}return r}class Np extends Do{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class r1 extends Do{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class s1{constructor(t,n,r,s){this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(t,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(t.key)&&e1(i,t,r[s])}}applyToLocalView(t,n){for(const r of this.baseMutations)r.key.isEqual(t.key)&&(n=os(r,t,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(t.key)&&(n=os(r,t,n,this.localWriteTime));return n}applyToLocalDocumentSet(t,n){const r=Ep();return this.mutations.forEach(s=>{const i=t.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const c=Ap(o,a);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(Q.min())}),r}keys(){return this.mutations.reduce((t,n)=>t.add(n.key),it())}isEqual(t){return this.batchId===t.batchId&&wr(this.mutations,t.mutations,(n,r)=>nh(n,r))&&wr(this.baseMutations,t.baseMutations,(n,r)=>nh(n,r))}}class fl{constructor(t,n,r,s){this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(t,n,r){mt(t.mutations.length===r.length);let s=function(){return G_}();const i=t.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new fl(t,n,r,s)}}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class i1{constructor(t,n){this.largestBatchId=t,this.mutation=n}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class o1{constructor(t,n){this.count=t,this.unchangedNames=n}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var It,ot;function a1(e){switch(e){default:return H();case C.CANCELLED:case C.UNKNOWN:case C.DEADLINE_EXCEEDED:case C.RESOURCE_EXHAUSTED:case C.INTERNAL:case C.UNAVAILABLE:case C.UNAUTHENTICATED:return!1;case C.INVALID_ARGUMENT:case C.NOT_FOUND:case C.ALREADY_EXISTS:case C.PERMISSION_DENIED:case C.FAILED_PRECONDITION:case C.ABORTED:case C.OUT_OF_RANGE:case C.UNIMPLEMENTED:case C.DATA_LOSS:return!0}}function Rp(e){if(e===void 0)return je("GRPC error has no .code"),C.UNKNOWN;switch(e){case It.OK:return C.OK;case It.CANCELLED:return C.CANCELLED;case It.UNKNOWN:return C.UNKNOWN;case It.DEADLINE_EXCEEDED:return C.DEADLINE_EXCEEDED;case It.RESOURCE_EXHAUSTED:return C.RESOURCE_EXHAUSTED;case It.INTERNAL:return C.INTERNAL;case It.UNAVAILABLE:return C.UNAVAILABLE;case It.UNAUTHENTICATED:return C.UNAUTHENTICATED;case It.INVALID_ARGUMENT:return C.INVALID_ARGUMENT;case It.NOT_FOUND:return C.NOT_FOUND;case It.ALREADY_EXISTS:return C.ALREADY_EXISTS;case It.PERMISSION_DENIED:return C.PERMISSION_DENIED;case It.FAILED_PRECONDITION:return C.FAILED_PRECONDITION;case It.ABORTED:return C.ABORTED;case It.OUT_OF_RANGE:return C.OUT_OF_RANGE;case It.UNIMPLEMENTED:return C.UNIMPLEMENTED;case It.DATA_LOSS:return C.DATA_LOSS;default:return H()}}(ot=It||(It={}))[ot.OK=0]="OK",ot[ot.CANCELLED=1]="CANCELLED",ot[ot.UNKNOWN=2]="UNKNOWN",ot[ot.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ot[ot.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ot[ot.NOT_FOUND=5]="NOT_FOUND",ot[ot.ALREADY_EXISTS=6]="ALREADY_EXISTS",ot[ot.PERMISSION_DENIED=7]="PERMISSION_DENIED",ot[ot.UNAUTHENTICATED=16]="UNAUTHENTICATED",ot[ot.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ot[ot.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ot[ot.ABORTED=10]="ABORTED",ot[ot.OUT_OF_RANGE=11]="OUT_OF_RANGE",ot[ot.UNIMPLEMENTED=12]="UNIMPLEMENTED",ot[ot.INTERNAL=13]="INTERNAL",ot[ot.UNAVAILABLE=14]="UNAVAILABLE",ot[ot.DATA_LOSS=15]="DATA_LOSS";/**
* @license
* Copyright 2023 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function c1(){return new TextEncoder}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const l1=new pr([4294967295,4294967295],0);function ih(e){const t=c1().encode(e),n=new l_;return n.update(t),new Uint8Array(n.digest())}function oh(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),s=t.getUint32(8,!0),i=t.getUint32(12,!0);return[new pr([n,r],0),new pr([s,i],0)]}class pl{constructor(t,n,r){if(this.bitmap=t,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Qr(`Invalid padding: ${n}`);if(r<0)throw new Qr(`Invalid hash count: ${r}`);if(t.length>0&&this.hashCount===0)throw new Qr(`Invalid hash count: ${r}`);if(t.length===0&&n!==0)throw new Qr(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*t.length-n,this.Ee=pr.fromNumber(this.Te)}de(t,n,r){let s=t.add(n.multiply(pr.fromNumber(r)));return s.compare(l1)===1&&(s=new pr([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Ee).toNumber()}Ae(t){return(this.bitmap[Math.floor(t/8)]&1<<t%8)!=0}mightContain(t){if(this.Te===0)return!1;const n=ih(t),[r,s]=oh(n);for(let i=0;i<this.hashCount;i++){const o=this.de(r,s,i);if(!this.Ae(o))return!1}return!0}static create(t,n,r){const s=t%8==0?0:8-t%8,i=new Uint8Array(Math.ceil(t/8)),o=new pl(i,s,n);return r.forEach(a=>o.insert(a)),o}insert(t){if(this.Te===0)return;const n=ih(t),[r,s]=oh(n);for(let i=0;i<this.hashCount;i++){const o=this.de(r,s,i);this.Re(o)}}Re(t){const n=Math.floor(t/8),r=t%8;this.bitmap[n]|=1<<r}}class Qr extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class No{constructor(t,n,r,s,i){this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(t,n,r){const s=new Map;return s.set(t,qs.createSynthesizedTargetChangeForCurrentChange(t,n,r)),new No(Q.min(),s,new Tt(ut),Je(),it())}}class qs{constructor(t,n,r,s,i){this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(t,n,r){return new qs(r,n,it(),it(),it())}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class fi{constructor(t,n,r,s){this.Ve=t,this.removedTargetIds=n,this.key=r,this.me=s}}class Pp{constructor(t,n){this.targetId=t,this.fe=n}}class Mp{constructor(t,n,r=te.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=s}}class ah{constructor(){this.ge=0,this.pe=lh(),this.ye=te.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(t){t.approximateByteSize()>0&&(this.Se=!0,this.ye=t)}ve(){let t=it(),n=it(),r=it();return this.pe.forEach((s,i)=>{switch(i){case 0:t=t.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:H()}}),new qs(this.ye,this.we,t,n,r)}Fe(){this.Se=!1,this.pe=lh()}Me(t,n){this.Se=!0,this.pe=this.pe.insert(t,n)}xe(t){this.Se=!0,this.pe=this.pe.remove(t)}Oe(){this.ge+=1}Ne(){this.ge-=1,mt(this.ge>=0)}Be(){this.Se=!0,this.we=!0}}class u1{constructor(t){this.Le=t,this.ke=new Map,this.qe=Je(),this.Qe=ch(),this.Ke=new Tt(ut)}$e(t){for(const n of t.Ve)t.me&&t.me.isFoundDocument()?this.Ue(n,t.me):this.We(n,t.key,t.me);for(const n of t.removedTargetIds)this.We(n,t.key,t.me)}Ge(t){this.forEachTarget(t,n=>{const r=this.ze(n);switch(t.state){case 0:this.je(n)&&r.Ce(t.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(t.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(n);break;case 3:this.je(n)&&(r.Be(),r.Ce(t.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.Ce(t.resumeToken));break;default:H()}})}forEachTarget(t,n){t.targetIds.length>0?t.targetIds.forEach(n):this.ke.forEach((r,s)=>{this.je(s)&&n(s)})}Je(t){const n=t.targetId,r=t.fe.count,s=this.Ye(n);if(s){const i=s.target;if(ec(i))if(r===0){const o=new q(i.path);this.We(n,o,Qt.newNoDocument(o,Q.min()))}else mt(r===1);else{const o=this.Ze(n);if(o!==r){const a=this.Xe(t),c=a?this.et(a,t,o):1;if(c!==0){this.He(n);const l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,l)}}}}}Xe(t){const n=t.fe.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,a;try{o=zn(r).toUint8Array()}catch(c){if(c instanceof lp)return br("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new pl(o,s,i)}catch(c){return br(c instanceof Qr?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Te===0?null:a}et(t,n,r){return n.fe.count===r-this.rt(t,n.targetId)?0:2}rt(t,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Le.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;t.mightContain(a)||(this.We(n,i,null),s++)}),s}it(t){const n=new Map;this.ke.forEach((i,o)=>{const a=this.Ye(o);if(a){if(i.current&&ec(a.target)){const c=new q(a.target.path);this.qe.get(c)!==null||this.st(o,c)||this.We(o,c,Qt.newNoDocument(c,t))}i.De&&(n.set(o,i.ve()),i.Fe())}});let r=it();this.Qe.forEach((i,o)=>{let a=!0;o.forEachWhile(c=>{const l=this.Ye(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.qe.forEach((i,o)=>o.setReadTime(t));const s=new No(t,n,this.Ke,this.qe,r);return this.qe=Je(),this.Qe=ch(),this.Ke=new Tt(ut),s}Ue(t,n){if(!this.je(t))return;const r=this.st(t,n.key)?2:0;this.ze(t).Me(n.key,r),this.qe=this.qe.insert(n.key,n),this.Qe=this.Qe.insert(n.key,this.ot(n.key).add(t))}We(t,n,r){if(!this.je(t))return;const s=this.ze(t);this.st(t,n)?s.Me(n,1):s.xe(n),this.Qe=this.Qe.insert(n,this.ot(n).delete(t)),r&&(this.qe=this.qe.insert(n,r))}removeTarget(t){this.ke.delete(t)}Ze(t){const n=this.ze(t).ve();return this.Le.getRemoteKeysForTarget(t).size+n.addedDocuments.size-n.removedDocuments.size}Oe(t){this.ze(t).Oe()}ze(t){let n=this.ke.get(t);return n||(n=new ah,this.ke.set(t,n)),n}ot(t){let n=this.Qe.get(t);return n||(n=new zt(ut),this.Qe=this.Qe.insert(t,n)),n}je(t){const n=this.Ye(t)!==null;return n||P("WatchChangeAggregator","Detected inactive target",t),n}Ye(t){const n=this.ke.get(t);return n&&n.be?null:this.Le._t(t)}He(t){this.ke.set(t,new ah),this.Le.getRemoteKeysForTarget(t).forEach(n=>{this.We(t,n,null)})}st(t,n){return this.Le.getRemoteKeysForTarget(t).has(n)}}function ch(){return new Tt(q.comparator)}function lh(){return new Tt(q.comparator)}const h1={asc:"ASCENDING",desc:"DESCENDING"},d1={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},f1={and:"AND",or:"OR"};class p1{constructor(t,n){this.databaseId=t,this.useProto3Json=n}}function rc(e,t){return e.useProto3Json||Co(t)?t:{value:t}}function Fi(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Lp(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function m1(e,t){return Fi(e,t.toTimestamp())}function Ue(e){return mt(!!e),Q.fromTimestamp(function(t){const n=bn(t);return new Nt(n.seconds,n.nanos)}(e))}function ml(e,t){return sc(e,t).canonicalString()}function sc(e,t){const n=function(r){return new _t(["projects",r.projectId,"databases",r.database])}(e).child("documents");return t===void 0?n:n.child(t)}function Op(e){const t=_t.fromString(e);return mt(Bp(t)),t}function ic(e,t){return ml(e.databaseId,t.path)}function ma(e,t){const n=Op(t);if(n.get(1)!==e.databaseId.projectId)throw new j(C.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new j(C.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new q(Fp(n))}function Up(e,t){return ml(e.databaseId,t)}function g1(e){const t=Op(e);return t.length===4?_t.emptyPath():Fp(t)}function oc(e){return new _t(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Fp(e){return mt(e.length>4&&e.get(4)==="documents"),e.popFirst(5)}function uh(e,t,n){return{name:ic(e,t),fields:n.value.mapValue.fields}}function y1(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:H()}(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],i=function(c,l){return c.useProto3Json?(mt(l===void 0||typeof l=="string"),te.fromBase64String(l||"")):(mt(l===void 0||l instanceof Uint8Array),te.fromUint8Array(l||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(c){const l=c.code===void 0?C.UNKNOWN:Rp(c.code);return new j(l,c.message||"")}(o);n=new Mp(r,s,i,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const s=ma(e,r.document.name),i=Ue(r.document.updateTime),o=r.document.createTime?Ue(r.document.createTime):Q.min(),a=new ge({mapValue:{fields:r.document.fields}}),c=Qt.newFoundDocument(s,i,o,a),l=r.targetIds||[],u=r.removedTargetIds||[];n=new fi(l,u,c.key,c)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const s=ma(e,r.document),i=r.readTime?Ue(r.readTime):Q.min(),o=Qt.newNoDocument(s,i),a=r.removedTargetIds||[];n=new fi([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const s=ma(e,r.document),i=r.removedTargetIds||[];n=new fi([],i,s,null)}else{if(!("filter"in t))return H();{t.filter;const r=t.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new o1(s,i),a=r.targetId;n=new Pp(a,o)}}return n}function v1(e,t){let n;if(t instanceof Bs)n={update:uh(e,t.key,t.value)};else if(t instanceof Np)n={delete:ic(e,t.key)};else if(t instanceof Qn)n={update:uh(e,t.key,t.data),updateMask:k1(t.fieldMask)};else{if(!(t instanceof r1))return H();n={verify:ic(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(r=>function(s,i){const o=i.transform;if(o instanceof Oi)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Is)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof ks)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Ui)return{fieldPath:i.field.canonicalString(),increment:o.Ie};throw H()}(0,r))),t.precondition.isNone||(n.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:m1(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:H()}(e,t.precondition)),n}function b1(e,t){return e&&e.length>0?(mt(t!==void 0),e.map(n=>function(r,s){let i=r.updateTime?Ue(r.updateTime):Ue(s);return i.isEqual(Q.min())&&(i=Ue(s)),new t1(i,r.transformResults||[])}(n,t))):[]}function w1(e,t){return{documents:[Up(e,t.path)]}}function _1(e,t){const n={structuredQuery:{}},r=t.path;let s;t.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Up(e,s);const i=function(c){if(c.length!==0)return jp(qe.create(c,"and"))}(t.filters);i&&(n.structuredQuery.where=i);const o=function(c){if(c.length!==0)return c.map(l=>function(u){return{field:rr(u.field),direction:S1(u.dir)}}(l))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const a=rc(e,t.limit);return a!==null&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(t.endAt)),{ut:n,parent:s}}function E1(e){let t=g1(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){mt(r===1);const u=n.from[0];u.allDescendants?s=u.collectionId:t=t.child(u.collectionId)}let i=[];n.where&&(i=function(u){const h=Vp(u);return h instanceof qe&&fp(h)?h.getFilters():[h]}(n.where));let o=[];n.orderBy&&(o=function(u){return u.map(h=>function(f){return new Li(sr(f.field),function(m){switch(m){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(f.direction))}(h))}(n.orderBy));let a=null;n.limit&&(a=function(u){let h;return h=typeof u=="object"?u.value:u,Co(h)?null:h}(n.limit));let c=null;n.startAt&&(c=function(u){const h=!!u.before,f=u.values||[];return new Mi(f,h)}(n.startAt));let l=null;return n.endAt&&(l=function(u){const h=!u.before,f=u.values||[];return new Mi(f,h)}(n.endAt)),j_(t,s,o,i,a,"F",c,l)}function T1(e,t){const n=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return H()}}(t.purpose);return n==null?null:{"goog-listen-tags":n}}function Vp(e){return e.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=sr(t.unaryFilter.field);return Dt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const r=sr(t.unaryFilter.field);return Dt.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=sr(t.unaryFilter.field);return Dt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=sr(t.unaryFilter.field);return Dt.create(i,"!=",{nullValue:"NULL_VALUE"});default:return H()}}(e):e.fieldFilter!==void 0?function(t){return Dt.create(sr(t.fieldFilter.field),function(n){switch(n){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return H()}}(t.fieldFilter.op),t.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(t){return qe.create(t.compositeFilter.filters.map(n=>Vp(n)),function(n){switch(n){case"AND":return"and";case"OR":return"or";default:return H()}}(t.compositeFilter.op))}(e):H()}function S1(e){return h1[e]}function C1(e){return d1[e]}function I1(e){return f1[e]}function rr(e){return{fieldPath:e.canonicalString()}}function sr(e){return qt.fromServerFormat(e.fieldPath)}function jp(e){return e instanceof Dt?function(t){if(t.op==="=="){if(Xu(t.value))return{unaryFilter:{field:rr(t.field),op:"IS_NAN"}};if(Qu(t.value))return{unaryFilter:{field:rr(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Xu(t.value))return{unaryFilter:{field:rr(t.field),op:"IS_NOT_NAN"}};if(Qu(t.value))return{unaryFilter:{field:rr(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:rr(t.field),op:C1(t.op),value:t.value}}}(e):e instanceof qe?function(t){const n=t.getFilters().map(r=>jp(r));return n.length===1?n[0]:{compositeFilter:{op:I1(t.op),filters:n}}}(e):H()}function k1(e){const t=[];return e.fields.forEach(n=>t.push(n.canonicalString())),{fieldPaths:t}}function Bp(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class un{constructor(t,n,r,s,i=Q.min(),o=Q.min(),a=te.EMPTY_BYTE_STRING,c=null){this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(t){return new un(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,n){return new un(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new un(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new un(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class x1{constructor(t){this.ct=t}}function A1(e){const t=E1({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?nc(t,t.limit,"L"):t}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class D1{constructor(){this._n=new N1}addToCollectionParentIndex(t,n){return this._n.add(n),b.resolve()}getCollectionParents(t,n){return b.resolve(this._n.getEntries(n))}addFieldIndex(t,n){return b.resolve()}deleteFieldIndex(t,n){return b.resolve()}deleteAllFieldIndexes(t){return b.resolve()}createTargetIndexes(t,n){return b.resolve()}getDocumentsMatchingTarget(t,n){return b.resolve(null)}getIndexType(t,n){return b.resolve(0)}getFieldIndexes(t,n){return b.resolve([])}getNextCollectionGroupToUpdate(t){return b.resolve(null)}getMinOffset(t,n){return b.resolve(vn.min())}getMinOffsetFromCollectionGroup(t,n){return b.resolve(vn.min())}updateCollectionGroup(t,n,r){return b.resolve()}updateIndexEntries(t,n){return b.resolve()}}class N1{constructor(){this.index={}}add(t){const n=t.lastSegment(),r=t.popLast(),s=this.index[n]||new zt(_t.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(t){const n=t.lastSegment(),r=t.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(t){return(this.index[t]||new zt(_t.comparator)).toArray()}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Tr{constructor(t){this.On=t}next(){return this.On+=2,this.On}static Nn(){return new Tr(0)}static Bn(){return new Tr(-1)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class R1{constructor(){this.changes=new Mr(t=>t.toString(),(t,n)=>t.isEqual(n)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,n){this.assertNotApplied(),this.changes.set(t,Qt.newInvalidDocument(t).setReadTime(n))}getEntry(t,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?b.resolve(r):this.getFromCache(t,n)}getEntries(t,n){return this.getAllFromCache(t,n)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*//**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class P1{constructor(t,n){this.overlayedDocument=t,this.mutatedFields=n}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class M1{constructor(t,n,r,s){this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(t,n){let r=null;return this.documentOverlayCache.getOverlay(t,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(t,n))).next(s=>(r!==null&&os(r.mutation,s,Te.empty(),Nt.now()),s))}getDocuments(t,n){return this.remoteDocumentCache.getEntries(t,n).next(r=>this.getLocalViewOfDocuments(t,r,it()).next(()=>r))}getLocalViewOfDocuments(t,n,r=it()){const s=Mn();return this.populateOverlays(t,s,n).next(()=>this.computeViews(t,n,s,r).next(i=>{let o=Wr();return i.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(t,n){const r=Mn();return this.populateOverlays(t,r,n).next(()=>this.computeViews(t,n,r,it()))}populateOverlays(t,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(t,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(t,n,r,s){let i=Je();const o=is(),a=function(){return is()}();return n.forEach((c,l)=>{const u=r.get(l.key);s.has(l.key)&&(u===void 0||u.mutation instanceof Qn)?i=i.insert(l.key,l):u!==void 0?(o.set(l.key,u.mutation.getFieldMask()),os(u.mutation,l,u.mutation.getFieldMask(),Nt.now())):o.set(l.key,Te.empty())}),this.recalculateAndSaveOverlays(t,i).next(c=>(c.forEach((l,u)=>o.set(l,u)),n.forEach((l,u)=>{var h;return a.set(l,new P1(u,(h=o.get(l))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(t,n){const r=is();let s=new Tt((o,a)=>o-a),i=it();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,n).next(o=>{for(const a of o)a.keys().forEach(c=>{const l=n.get(c);if(l===null)return;let u=r.get(c)||Te.empty();u=a.applyToLocalView(l,u),r.set(c,u);const h=(s.get(a.batchId)||it()).add(c);s=s.insert(a.batchId,h)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),l=c.key,u=c.value,h=Ep();u.forEach(f=>{if(!i.has(f)){const m=Ap(n.get(f),r.get(f));m!==null&&h.set(f,m),i=i.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(t,l,h))}return b.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(t,n){return this.remoteDocumentCache.getEntries(t,n).next(r=>this.recalculateAndSaveOverlays(t,r))}getDocumentsMatchingQuery(t,n,r,s){return function(i){return q.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(t,n.path):B_(n)?this.getDocumentsMatchingCollectionGroupQuery(t,n,r,s):this.getDocumentsMatchingCollectionQuery(t,n,r,s)}getNextDocuments(t,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,n,r.largestBatchId,s-i.size):b.resolve(Mn());let a=-1,c=i;return o.next(l=>b.forEach(l,(u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),i.get(u)?b.resolve():this.remoteDocumentCache.getEntry(t,u).next(f=>{c=c.insert(u,f)}))).next(()=>this.populateOverlays(t,l,i)).next(()=>this.computeViews(t,c,l,it())).next(u=>({batchId:a,changes:_p(u)})))})}getDocumentsMatchingDocumentQuery(t,n){return this.getDocument(t,new q(n)).next(r=>{let s=Wr();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(t,n,r,s){const i=n.collectionGroup;let o=Wr();return this.indexManager.getCollectionParents(t,i).next(a=>b.forEach(a,c=>{const l=function(u,h){return new Io(h,null,u.explicitOrderBy.slice(),u.filters.slice(),u.limit,u.limitType,u.startAt,u.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(t,l,r,s).next(u=>{u.forEach((h,f)=>{o=o.insert(h,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(t,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(t,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(t,n,r,i,s))).next(o=>{i.forEach((c,l)=>{const u=l.getKey();o.get(u)===null&&(o=o.insert(u,Qt.newInvalidDocument(u)))});let a=Wr();return o.forEach((c,l)=>{const u=i.get(c);u!==void 0&&os(u.mutation,l,Te.empty(),Nt.now()),xo(n,l)&&(a=a.insert(c,l))}),a})}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class L1{constructor(t){this.serializer=t,this.cr=new Map,this.lr=new Map}getBundleMetadata(t,n){return b.resolve(this.cr.get(n))}saveBundleMetadata(t,n){return this.cr.set(n.id,function(r){return{id:r.id,version:r.version,createTime:Ue(r.createTime)}}(n)),b.resolve()}getNamedQuery(t,n){return b.resolve(this.lr.get(n))}saveNamedQuery(t,n){return this.lr.set(n.name,function(r){return{name:r.name,query:A1(r.bundledQuery),readTime:Ue(r.readTime)}}(n)),b.resolve()}}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class O1{constructor(){this.overlays=new Tt(q.comparator),this.hr=new Map}getOverlay(t,n){return b.resolve(this.overlays.get(n))}getOverlays(t,n){const r=Mn();return b.forEach(n,s=>this.getOverlay(t,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(t,n,r){return r.forEach((s,i)=>{this.ht(t,n,i)}),b.resolve()}removeOverlaysForBatchId(t,n,r){const s=this.hr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.hr.delete(r)),b.resolve()}getOverlaysForCollection(t,n,r){const s=Mn(),i=n.length+1,o=new q(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,l=c.getKey();if(!n.isPrefixOf(l.path))break;l.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return b.resolve(s)}getOverlaysForCollectionGroup(t,n,r,s){let i=new Tt((l,u)=>l-u);const o=this.overlays.getIterator();for(;o.hasNext();){const l=o.getNext().value;if(l.getKey().getCollectionGroup()===n&&l.largestBatchId>r){let u=i.get(l.largestBatchId);u===null&&(u=Mn(),i=i.insert(l.largestBatchId,u)),u.set(l.getKey(),l)}}const a=Mn(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,u)=>a.set(l,u)),!(a.size()>=s)););return b.resolve(a)}ht(t,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.hr.get(s.largestBatchId).delete(r.key);this.hr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new i1(n,r));let i=this.hr.get(n);i===void 0&&(i=it(),this.hr.set(n,i)),this.hr.set(n,i.add(r.key))}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class gl{constructor(){this.Pr=new zt(Mt.Ir),this.Tr=new zt(Mt.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(t,n){const r=new Mt(t,n);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(t,n){t.forEach(r=>this.addReference(r,n))}removeReference(t,n){this.Ar(new Mt(t,n))}Rr(t,n){t.forEach(r=>this.removeReference(r,n))}Vr(t){const n=new q(new _t([])),r=new Mt(n,t),s=new Mt(n,t+1),i=[];return this.Tr.forEachInRange([r,s],o=>{this.Ar(o),i.push(o.key)}),i}mr(){this.Pr.forEach(t=>this.Ar(t))}Ar(t){this.Pr=this.Pr.delete(t),this.Tr=this.Tr.delete(t)}gr(t){const n=new q(new _t([])),r=new Mt(n,t),s=new Mt(n,t+1);let i=it();return this.Tr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(t){const n=new Mt(t,0),r=this.Pr.firstAfterOrEqual(n);return r!==null&&t.isEqual(r.key)}}class Mt{constructor(t,n){this.key=t,this.pr=n}static Ir(t,n){return q.comparator(t.key,n.key)||ut(t.pr,n.pr)}static Er(t,n){return ut(t.pr,n.pr)||q.comparator(t.key,n.key)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class U1{constructor(t,n){this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.yr=1,this.wr=new zt(Mt.Ir)}checkEmpty(t){return b.resolve(this.mutationQueue.length===0)}addMutationBatch(t,n,r,s){const i=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new s1(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.wr=this.wr.add(new Mt(a.key,i)),this.indexManager.addToCollectionParentIndex(t,a.key.path.popLast());return b.resolve(o)}lookupMutationBatch(t,n){return b.resolve(this.Sr(n))}getNextMutationBatchAfterBatchId(t,n){const r=n+1,s=this.br(r),i=s<0?0:s;return b.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return b.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(t){return b.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,n){const r=new Mt(n,0),s=new Mt(n,Number.POSITIVE_INFINITY),i=[];return this.wr.forEachInRange([r,s],o=>{const a=this.Sr(o.pr);i.push(a)}),b.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(t,n){let r=new zt(ut);return n.forEach(s=>{const i=new Mt(s,0),o=new Mt(s,Number.POSITIVE_INFINITY);this.wr.forEachInRange([i,o],a=>{r=r.add(a.pr)})}),b.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(t,n){const r=n.path,s=r.length+1;let i=r;q.isDocumentKey(i)||(i=i.child(""));const o=new Mt(new q(i),0);let a=new zt(ut);return this.wr.forEachWhile(c=>{const l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===s&&(a=a.add(c.pr)),!0)},o),b.resolve(this.Dr(a))}Dr(t){const n=[];return t.forEach(r=>{const s=this.Sr(r);s!==null&&n.push(s)}),n}removeMutationBatch(t,n){mt(this.Cr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return b.forEach(n.mutations,s=>{const i=new Mt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)}).next(()=>{this.wr=r})}Mn(t){}containsKey(t,n){const r=new Mt(n,0),s=this.wr.firstAfterOrEqual(r);return b.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(t){return this.mutationQueue.length,b.resolve()}Cr(t,n){return this.br(t)}br(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Sr(t){const n=this.br(t);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class F1{constructor(t){this.vr=t,this.docs=function(){return new Tt(q.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.vr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())}removeEntry(t){const n=this.docs.get(t);n&&(this.docs=this.docs.remove(t),this.size-=n.size)}getEntry(t,n){const r=this.docs.get(n);return b.resolve(r?r.document.mutableCopy():Qt.newInvalidDocument(n))}getEntries(t,n){let r=Je();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Qt.newInvalidDocument(s))}),b.resolve(r)}getDocumentsMatchingQuery(t,n,r,s){let i=Je();const o=n.path,a=new q(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:l,value:{document:u}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||__(w_(u),r)<=0||(s.has(u.key)||xo(n,u))&&(i=i.insert(u.key,u.mutableCopy()))}return b.resolve(i)}getAllFromCollectionGroup(t,n,r,s){H()}Fr(t,n){return b.forEach(this.docs,r=>n(r))}newChangeBuffer(t){return new V1(this)}getSize(t){return b.resolve(this.size)}}class V1 extends R1{constructor(t){super(),this.ar=t}applyChanges(t){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.ar.addEntry(t,s)):this.ar.removeEntry(r)}),b.waitFor(n)}getFromCache(t,n){return this.ar.getEntry(t,n)}getAllFromCache(t,n){return this.ar.getEntries(t,n)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class j1{constructor(t){this.persistence=t,this.Mr=new Mr(n=>hl(n),dl),this.lastRemoteSnapshotVersion=Q.min(),this.highestTargetId=0,this.Or=0,this.Nr=new gl,this.targetCount=0,this.Br=Tr.Nn()}forEachTarget(t,n){return this.Mr.forEach((r,s)=>n(s)),b.resolve()}getLastRemoteSnapshotVersion(t){return b.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return b.resolve(this.Or)}allocateTargetId(t){return this.highestTargetId=this.Br.next(),b.resolve(this.highestTargetId)}setTargetsMetadata(t,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Or&&(this.Or=n),b.resolve()}qn(t){this.Mr.set(t.target,t);const n=t.targetId;n>this.highestTargetId&&(this.Br=new Tr(n),this.highestTargetId=n),t.sequenceNumber>this.Or&&(this.Or=t.sequenceNumber)}addTargetData(t,n){return this.qn(n),this.targetCount+=1,b.resolve()}updateTargetData(t,n){return this.qn(n),b.resolve()}removeTargetData(t,n){return this.Mr.delete(n.target),this.Nr.Vr(n.targetId),this.targetCount-=1,b.resolve()}removeTargets(t,n,r){let s=0;const i=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Mr.delete(o),i.push(this.removeMatchingKeysForTargetId(t,a.targetId)),s++)}),b.waitFor(i).next(()=>s)}getTargetCount(t){return b.resolve(this.targetCount)}getTargetData(t,n){const r=this.Mr.get(n)||null;return b.resolve(r)}addMatchingKeys(t,n,r){return this.Nr.dr(n,r),b.resolve()}removeMatchingKeys(t,n,r){this.Nr.Rr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(t,o))}),b.waitFor(i)}removeMatchingKeysForTargetId(t,n){return this.Nr.Vr(n),b.resolve()}getMatchingKeysForTargetId(t,n){const r=this.Nr.gr(n);return b.resolve(r)}containsKey(t,n){return b.resolve(this.Nr.containsKey(n))}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class B1{constructor(t,n){this.Lr={},this.overlays={},this.kr=new al(0),this.qr=!1,this.qr=!0,this.referenceDelegate=t(this),this.Qr=new j1(this),this.indexManager=new D1,this.remoteDocumentCache=function(r){return new F1(r)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new x1(n),this.$r=new L1(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let n=this.overlays[t.toKey()];return n||(n=new O1,this.overlays[t.toKey()]=n),n}getMutationQueue(t,n){let r=this.Lr[t.toKey()];return r||(r=new U1(n,this.referenceDelegate),this.Lr[t.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(t,n,r){P("MemoryPersistence","Starting transaction:",t);const s=new q1(this.kr.next());return this.referenceDelegate.Ur(),r(s).next(i=>this.referenceDelegate.Wr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Gr(t,n){return b.or(Object.values(this.Lr).map(r=>()=>r.containsKey(t,n)))}}class q1 extends T_{constructor(t){super(),this.currentSequenceNumber=t}}class yl{constructor(t){this.persistence=t,this.zr=new gl,this.jr=null}static Hr(t){return new yl(t)}get Jr(){if(this.jr)return this.jr;throw H()}addReference(t,n,r){return this.zr.addReference(r,n),this.Jr.delete(r.toString()),b.resolve()}removeReference(t,n,r){return this.zr.removeReference(r,n),this.Jr.add(r.toString()),b.resolve()}markPotentiallyOrphaned(t,n){return this.Jr.add(n.toString()),b.resolve()}removeTarget(t,n){this.zr.Vr(n.targetId).forEach(s=>this.Jr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,n.targetId).next(s=>{s.forEach(i=>this.Jr.add(i.toString()))}).next(()=>r.removeTargetData(t,n))}Ur(){this.jr=new Set}Wr(t){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return b.forEach(this.Jr,r=>{const s=q.fromPath(r);return this.Yr(t,s).next(i=>{i||n.removeEntry(s,Q.min())})}).next(()=>(this.jr=null,n.apply(t)))}updateLimboDocument(t,n){return this.Yr(t,n).next(r=>{r?this.Jr.delete(n.toString()):this.Jr.add(n.toString())})}Kr(t){return 0}Yr(t,n){return b.or([()=>b.resolve(this.zr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(t,n),()=>this.persistence.Gr(t,n)])}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class vl{constructor(t,n,r,s){this.targetId=t,this.fromCache=n,this.qi=r,this.Qi=s}static Ki(t,n){let r=it(),s=it();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new vl(t,n.fromCache,r,s)}}/**
* @license
* Copyright 2023 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class $1{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class z1{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return z0()?8:Pn.v(Si())>0?6:4}()}initialize(t,n){this.zi=t,this.indexManager=n,this.$i=!0}getDocumentsMatchingQuery(t,n,r,s){const i={result:null};return this.ji(t,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Hi(t,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new $1;return this.Ji(t,n,o).next(a=>{if(i.result=a,this.Ui)return this.Yi(t,n,o,a.size)})}).next(()=>i.result)}Yi(t,n,r,s){return r.documentReadCount<this.Wi?($r()<=ct.DEBUG&&P("QueryEngine","SDK will not create cache indexes for query:",nr(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),b.resolve()):($r()<=ct.DEBUG&&P("QueryEngine","Query:",nr(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Gi*s?($r()<=ct.DEBUG&&P("QueryEngine","The SDK decides to create cache indexes for query:",nr(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Oe(n))):b.resolve())}ji(t,n){if(th(n))return b.resolve(null);let r=Oe(n);return this.indexManager.getIndexType(t,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=nc(n,null,"F"),r=Oe(n)),this.indexManager.getDocumentsMatchingTarget(t,r).next(i=>{const o=it(...i);return this.zi.getDocuments(t,o).next(a=>this.indexManager.getMinOffset(t,r).next(c=>{const l=this.Zi(n,a);return this.Xi(n,l,o,c.readTime)?this.ji(t,nc(n,null,"F")):this.es(t,l,n,c)}))})))}Hi(t,n,r,s){return th(n)||s.isEqual(Q.min())?b.resolve(null):this.zi.getDocuments(t,r).next(i=>{const o=this.Zi(n,i);return this.Xi(n,o,r,s)?b.resolve(null):($r()<=ct.DEBUG&&P("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),nr(n)),this.es(t,o,n,b_(s,-1)).next(a=>a))})}Zi(t,n){let r=new zt(bp(t));return n.forEach((s,i)=>{xo(t,i)&&(r=r.add(i))}),r}Xi(t,n,r,s){if(t.limit===null)return!1;if(r.size!==n.size)return!0;const i=t.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ji(t,n,r){return $r()<=ct.DEBUG&&P("QueryEngine","Using full collection scan to execute query:",nr(n)),this.zi.getDocumentsMatchingQuery(t,n,vn.min(),r)}es(t,n,r,s){return this.zi.getDocumentsMatchingQuery(t,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class K1{constructor(t,n,r,s){this.persistence=t,this.ts=n,this.serializer=s,this.ns=new Tt(ut),this.rs=new Mr(i=>hl(i),dl),this.ss=new Map,this.os=t.getRemoteDocumentCache(),this.Qr=t.getTargetCache(),this.$r=t.getBundleCache(),this._s(r)}_s(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new M1(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>t.collect(n,this.ns))}}function G1(e,t,n,r){return new K1(e,t,n,r)}async function qp(e,t){const n=Y(e);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n._s(t),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let c=it();for(const l of s){o.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}for(const l of i){a.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}return n.localDocuments.getDocuments(r,c).next(l=>({us:l,removedBatchIds:o,addedBatchIds:a}))})})}function H1(e,t){const n=Y(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=t.batch.keys(),i=n.os.newChangeBuffer({trackRemovals:!0});return function(o,a,c,l){const u=c.batch,h=u.keys();let f=b.resolve();return h.forEach(m=>{f=f.next(()=>l.getEntry(a,m)).next(E=>{const v=c.docVersions.get(m);mt(v!==null),E.version.compareTo(v)<0&&(u.applyToRemoteDocument(E,c),E.isValidDocument()&&(E.setReadTime(c.commitVersion),l.addEntry(E)))})}),f.next(()=>o.mutationQueue.removeMutationBatch(a,u))}(n,r,t,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(o){let a=it();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(a=a.add(o.batch.mutations[c].key));return a}(t))).next(()=>n.localDocuments.getDocuments(r,s))})}function $p(e){const t=Y(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",n=>t.Qr.getLastRemoteSnapshotVersion(n))}function W1(e,t){const n=Y(e),r=t.snapshotVersion;let s=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.os.newChangeBuffer({trackRemovals:!0});s=n.ns;const a=[];t.targetChanges.forEach((u,h)=>{const f=s.get(h);if(!f)return;a.push(n.Qr.removeMatchingKeys(i,u.removedDocuments,h).next(()=>n.Qr.addMatchingKeys(i,u.addedDocuments,h)));let m=f.withSequenceNumber(i.currentSequenceNumber);t.targetMismatches.get(h)!==null?m=m.withResumeToken(te.EMPTY_BYTE_STRING,Q.min()).withLastLimboFreeSnapshotVersion(Q.min()):u.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(u.resumeToken,r)),s=s.insert(h,m),function(E,v,x){return E.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=3e8?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(f,m,u)&&a.push(n.Qr.updateTargetData(i,m))});let c=Je(),l=it();if(t.documentUpdates.forEach(u=>{t.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,u))}),a.push(Q1(i,o,t.documentUpdates).next(u=>{c=u.cs,l=u.ls})),!r.isEqual(Q.min())){const u=n.Qr.getLastRemoteSnapshotVersion(i).next(h=>n.Qr.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(u)}return b.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,l)).next(()=>c)}).then(i=>(n.ns=s,i))}function Q1(e,t,n){let r=it(),s=it();return n.forEach(i=>r=r.add(i)),t.getEntries(e,r).next(i=>{let o=Je();return n.forEach((a,c)=>{const l=i.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(s=s.add(a)),c.isNoDocument()&&c.version.isEqual(Q.min())?(t.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(t.addEntry(c),o=o.insert(a,c)):P("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{cs:o,ls:s}})}function X1(e,t){const n=Y(e);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(t===void 0&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,t)))}function J1(e,t){const n=Y(e);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Qr.getTargetData(r,t).next(i=>i?(s=i,b.resolve(s)):n.Qr.allocateTargetId(r).next(o=>(s=new un(t,o,"TargetPurposeListen",r.currentSequenceNumber),n.Qr.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.ns.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.ns=n.ns.insert(r.targetId,r),n.rs.set(t,r.targetId)),r})}async function ac(e,t,n){const r=Y(e),s=r.ns.get(t),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!js(o))throw o;P("LocalStore",`Failed to update sequence numbers for target ${t}: ${o}`)}r.ns=r.ns.remove(t),r.rs.delete(s.target)}function hh(e,t,n){const r=Y(e);let s=Q.min(),i=it();return r.persistence.runTransaction("Execute query","readwrite",o=>function(a,c,l){const u=Y(a),h=u.rs.get(l);return h!==void 0?b.resolve(u.ns.get(h)):u.Qr.getTargetData(c,l)}(r,o,Oe(t)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(o,a.targetId).next(c=>{i=c})}).next(()=>r.ts.getDocumentsMatchingQuery(o,t,n?s:Q.min(),n?i:it())).next(a=>(Y1(r,$_(t),a),{documents:a,hs:i})))}function Y1(e,t,n){let r=e.ss.get(t)||Q.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),e.ss.set(t,r)}class dh{constructor(){this.activeTargetIds=Q_()}As(t){this.activeTargetIds=this.activeTargetIds.add(t)}Rs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}ds(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Z1{constructor(){this.no=new dh,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,n,r){}addLocalQueryTarget(t){return this.no.As(t),this.ro[t]||"not-current"}updateQueryState(t,n,r){this.ro[t]=n}removeLocalQueryTarget(t){this.no.Rs(t)}isLocalQueryTarget(t){return this.no.activeTargetIds.has(t)}clearQueryState(t){delete this.ro[t]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(t){return this.no.activeTargetIds.has(t)}start(){return this.no=new dh,Promise.resolve()}handleUserChange(t,n,r){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class tE{io(t){}shutdown(){}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class fh{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(t){this.uo.push(t)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){P("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.uo)t(0)}ao(){P("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.uo)t(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
* @license
* Copyright 2023 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/let oi=null;function ga(){return oi===null?oi=function(){return 268435456+Math.round(2147483648*Math.random())}():oi++,"0x"+oi.toString(16)}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const eE={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class nE{constructor(t){this.lo=t.lo,this.ho=t.ho}Po(t){this.Io=t}To(t){this.Eo=t}onMessage(t){this.Ao=t}close(){this.ho()}send(t){this.lo(t)}Ro(){this.Io()}Vo(t){this.Eo(t)}mo(t){this.Ao(t)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Ht="WebChannelConnection";class rE extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const n=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.fo=n+"://"+t.host,this.po=`projects/${r}/databases/${s}`,this.yo=this.databaseId.database==="(default)"?`project_id=${r}`:`project_id=${r}&database_id=${s}`}get wo(){return!1}So(t,n,r,s,i){const o=ga(),a=this.bo(t,n.toUriEncodedString());P("RestConnection",`Sending RPC '${t}' ${o}:`,a,r);const c={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(c,s,i),this.Co(t,a,c,r).then(l=>(P("RestConnection",`Received RPC '${t}' ${o}: `,l),l),l=>{throw br("RestConnection",`RPC '${t}' ${o} failed with error: `,l,"url: ",a,"request:",r),l})}vo(t,n,r,s,i,o){return this.So(t,n,r,s,i)}Do(t,n,r){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Rr}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>t[i]=s),r&&r.headers.forEach((s,i)=>t[i]=s)}bo(t,n){const r=eE[t];return`${this.fo}/v1/${n}:${r}`}terminate(){}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Co(t,n,r,s){const i=ga();return new Promise((o,a)=>{const c=new c_;c.setWithCredentials(!0),c.listenOnce(o_.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case pa.NO_ERROR:const u=c.getResponseJson();P(Ht,`XHR for RPC '${t}' ${i} received:`,JSON.stringify(u)),o(u);break;case pa.TIMEOUT:P(Ht,`RPC '${t}' ${i} timed out`),a(new j(C.DEADLINE_EXCEEDED,"Request time out"));break;case pa.HTTP_ERROR:const h=c.getStatus();if(P(Ht,`RPC '${t}' ${i} failed with status:`,h,"response text:",c.getResponseText()),h>0){let f=c.getResponseJson();Array.isArray(f)&&(f=f[0]);const m=f==null?void 0:f.error;if(m&&m.status&&m.message){const E=function(v){const x=v.toLowerCase().replace(/_/g,"-");return Object.values(C).indexOf(x)>=0?x:C.UNKNOWN}(m.status);a(new j(E,m.message))}else a(new j(C.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new j(C.UNAVAILABLE,"Connection failed."));break;default:H()}}finally{P(Ht,`RPC '${t}' ${i} completed.`)}});const l=JSON.stringify(s);P(Ht,`RPC '${t}' ${i} sending request:`,s),c.send(n,"POST",l,r,15)})}Fo(t,n,r){const s=ga(),i=[this.fo,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=s_(),a=i_(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Do(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const u=i.join("");P(Ht,`Creating RPC '${t}' stream ${s}: ${u}`,c);const h=o.createWebChannel(u,c);let f=!1,m=!1;const E=new nE({lo:x=>{m?P(Ht,`Not sending because RPC '${t}' stream ${s} is closed:`,x):(f||(P(Ht,`Opening RPC '${t}' stream ${s} transport.`),h.open(),f=!0),P(Ht,`RPC '${t}' stream ${s} sending:`,x),h.send(x))},ho:()=>h.close()}),v=(x,F,w)=>{x.listen(F,_=>{try{w(_)}catch(y){setTimeout(()=>{throw y},0)}})};return v(h,ri.EventType.OPEN,()=>{m||P(Ht,`RPC '${t}' stream ${s} transport opened.`)}),v(h,ri.EventType.CLOSE,()=>{m||(m=!0,P(Ht,`RPC '${t}' stream ${s} transport closed`),E.Vo())}),v(h,ri.EventType.ERROR,x=>{m||(m=!0,br(Ht,`RPC '${t}' stream ${s} transport errored:`,x),E.Vo(new j(C.UNAVAILABLE,"The operation could not be completed")))}),v(h,ri.EventType.MESSAGE,x=>{var F;if(!m){const w=x.data[0];mt(!!w);const _=w,y=_.error||((F=_[0])===null||F===void 0?void 0:F.error);if(y){P(Ht,`RPC '${t}' stream ${s} received error:`,y);const $=y.status;let k=function(V){const tt=It[V];if(tt!==void 0)return Rp(tt)}($),R=y.message;k===void 0&&(k=C.INTERNAL,R="Unknown error status: "+$+" with message "+y.message),m=!0,E.Vo(new j(k,R)),h.close()}else P(Ht,`RPC '${t}' stream ${s} received:`,w),E.mo(w)}}),v(a,a_.STAT_EVENT,x=>{x.stat===$u.PROXY?P(Ht,`RPC '${t}' stream ${s} detected buffering proxy`):x.stat===$u.NOPROXY&&P(Ht,`RPC '${t}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{E.Ro()},0),E}}function ya(){return typeof document<"u"?document:null}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function Ro(e){return new p1(e,!0)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class zp{constructor(t,n,r=1e3,s=1.5,i=6e4){this.oi=t,this.timerId=n,this.Mo=r,this.xo=s,this.Oo=i,this.No=0,this.Bo=null,this.Lo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(t){this.cancel();const n=Math.floor(this.No+this.Qo()),r=Math.max(0,Date.now()-this.Lo),s=Math.max(0,n-r);s>0&&P("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.No} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Bo=this.oi.enqueueAfterDelay(this.timerId,s,()=>(this.Lo=Date.now(),t())),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){this.Bo!==null&&(this.Bo.skipDelay(),this.Bo=null)}cancel(){this.Bo!==null&&(this.Bo.cancel(),this.Bo=null)}Qo(){return(Math.random()-.5)*this.No}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Kp{constructor(t,n,r,s,i,o,a,c){this.oi=t,this.$o=r,this.Uo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new zp(t,n)}Ho(){return this.state===1||this.state===5||this.Jo()}Jo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Yo()}async stop(){this.Ho()&&await this.close(0)}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&this.Go===null&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,()=>this.e_()))}t_(t){this.n_(),this.stream.send(t)}async e_(){if(this.Jo())return this.close(0)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}async close(t,n){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,t!==4?this.jo.reset():n&&n.code===C.RESOURCE_EXHAUSTED?(je(n.toString()),je("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):n&&n.code===C.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.i_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.To(n)}i_(){}auth(){this.state=1;const t=this.s_(this.Wo),n=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Wo===n&&this.o_(r,s)},r=>{t(()=>{const s=new j(C.UNKNOWN,"Fetching auth token failed: "+r.message);return this.__(s)})})}o_(t,n){const r=this.s_(this.Wo);this.stream=this.a_(t,n),this.stream.Po(()=>{r(()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,()=>(this.Jo()&&(this.state=3),Promise.resolve())),this.listener.Po()))}),this.stream.To(s=>{r(()=>this.__(s))}),this.stream.onMessage(s=>{r(()=>this.onMessage(s))})}Yo(){this.state=5,this.jo.qo(async()=>{this.state=0,this.start()})}__(t){return P("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}s_(t){return n=>{this.oi.enqueueAndForget(()=>this.Wo===t?n():(P("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class sE extends Kp{constructor(t,n,r,s,i,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}a_(t,n){return this.connection.Fo("Listen",t,n)}onMessage(t){this.jo.reset();const n=y1(this.serializer,t),r=function(s){if(!("targetChange"in s))return Q.min();const i=s.targetChange;return i.targetIds&&i.targetIds.length?Q.min():i.readTime?Ue(i.readTime):Q.min()}(t);return this.listener.u_(n,r)}c_(t){const n={};n.database=oc(this.serializer),n.addTarget=function(s,i){let o;const a=i.target;if(o=ec(a)?{documents:w1(s,a)}:{query:_1(s,a).ut},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0){o.resumeToken=Lp(s,i.resumeToken);const c=rc(s,i.expectedCount);c!==null&&(o.expectedCount=c)}else if(i.snapshotVersion.compareTo(Q.min())>0){o.readTime=Fi(s,i.snapshotVersion.toTimestamp());const c=rc(s,i.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,t);const r=T1(this.serializer,t);r&&(n.labels=r),this.t_(n)}l_(t){const n={};n.database=oc(this.serializer),n.removeTarget=t,this.t_(n)}}class iE extends Kp{constructor(t,n,r,s,i,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(t,n){return this.connection.Fo("Write",t,n)}onMessage(t){if(mt(!!t.streamToken),this.lastStreamToken=t.streamToken,this.h_){this.jo.reset();const n=b1(t.writeResults,t.commitTime),r=Ue(t.commitTime);return this.listener.T_(r,n)}return mt(!t.writeResults||t.writeResults.length===0),this.h_=!0,this.listener.E_()}d_(){const t={};t.database=oc(this.serializer),this.t_(t)}I_(t){const n={streamToken:this.lastStreamToken,writes:t.map(r=>v1(this.serializer,r))};this.t_(n)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class oE extends class{}{constructor(t,n,r,s){super(),this.authCredentials=t,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.A_=!1}R_(){if(this.A_)throw new j(C.FAILED_PRECONDITION,"The client has already been terminated.")}So(t,n,r,s){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.So(t,sc(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new j(C.UNKNOWN,i.toString())})}vo(t,n,r,s,i){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.vo(t,sc(n,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new j(C.UNKNOWN,o.toString())})}terminate(){this.A_=!0,this.connection.terminate()}}class aE{constructor(t,n){this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){this.m_===0&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve())))}S_(t){this.state==="Online"?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.y_("Offline")))}set(t){this.b_(),this.m_=0,t==="Online"&&(this.g_=!1),this.y_(t)}y_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}w_(t){const n=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?(je(n),this.g_=!1):P("OnlineStateTracker",n)}b_(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class cE{constructor(t,n,r,s,i){this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=i,this.M_.io(o=>{r.enqueueAndForget(async()=>{Xn(this)&&(P("RemoteStore","Restarting streams for network reachability change."),await async function(a){const c=Y(a);c.v_.add(4),await $s(c),c.x_.set("Unknown"),c.v_.delete(4),await Po(c)}(this))})}),this.x_=new aE(r,s)}}async function Po(e){if(Xn(e))for(const t of e.F_)await t(!0)}async function $s(e){for(const t of e.F_)await t(!1)}function Gp(e,t){const n=Y(e);n.C_.has(t.targetId)||(n.C_.set(t.targetId,t),_l(n)?wl(n):Lr(n).Jo()&&bl(n,t))}function Hp(e,t){const n=Y(e),r=Lr(n);n.C_.delete(t),r.Jo()&&Wp(n,t),n.C_.size===0&&(r.Jo()?r.Xo():Xn(n)&&n.x_.set("Unknown"))}function bl(e,t){if(e.O_.Oe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Q.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Lr(e).c_(t)}function Wp(e,t){e.O_.Oe(t),Lr(e).l_(t)}function wl(e){e.O_=new u1({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),_t:t=>e.C_.get(t)||null,nt:()=>e.datastore.serializer.databaseId}),Lr(e).start(),e.x_.p_()}function _l(e){return Xn(e)&&!Lr(e).Ho()&&e.C_.size>0}function Xn(e){return Y(e).v_.size===0}function Qp(e){e.O_=void 0}async function lE(e){e.C_.forEach((t,n)=>{bl(e,t)})}async function uE(e,t){Qp(e),_l(e)?(e.x_.S_(t),wl(e)):e.x_.set("Unknown")}async function hE(e,t,n){if(e.x_.set("Online"),t instanceof Mp&&t.state===2&&t.cause)try{await async function(r,s){const i=s.cause;for(const o of s.targetIds)r.C_.has(o)&&(await r.remoteSyncer.rejectListen(o,i),r.C_.delete(o),r.O_.removeTarget(o))}(e,t)}catch(r){P("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),r),await Vi(e,r)}else if(t instanceof fi?e.O_.$e(t):t instanceof Pp?e.O_.Je(t):e.O_.Ge(t),!n.isEqual(Q.min()))try{const r=await $p(e.localStore);n.compareTo(r)>=0&&await function(s,i){const o=s.O_.it(i);return o.targetChanges.forEach((a,c)=>{if(a.resumeToken.approximateByteSize()>0){const l=s.C_.get(c);l&&s.C_.set(c,l.withResumeToken(a.resumeToken,i))}}),o.targetMismatches.forEach((a,c)=>{const l=s.C_.get(a);if(!l)return;s.C_.set(a,l.withResumeToken(te.EMPTY_BYTE_STRING,l.snapshotVersion)),Wp(s,a);const u=new un(l.target,a,c,l.sequenceNumber);bl(s,u)}),s.remoteSyncer.applyRemoteEvent(o)}(e,n)}catch(r){P("RemoteStore","Failed to raise snapshot:",r),await Vi(e,r)}}async function Vi(e,t,n){if(!js(t))throw t;e.v_.add(1),await $s(e),e.x_.set("Offline"),n||(n=()=>$p(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{P("RemoteStore","Retrying IndexedDB access"),await n(),e.v_.delete(1),await Po(e)})}function Xp(e,t){return t().catch(n=>Vi(e,n,t))}async function Mo(e){const t=Y(e),n=wn(t);let r=t.D_.length>0?t.D_[t.D_.length-1].batchId:-1;for(;dE(t);)try{const s=await X1(t.localStore,r);if(s===null){t.D_.length===0&&n.Xo();break}r=s.batchId,fE(t,s)}catch(s){await Vi(t,s)}Jp(t)&&Yp(t)}function dE(e){return Xn(e)&&e.D_.length<10}function fE(e,t){e.D_.push(t);const n=wn(e);n.Jo()&&n.P_&&n.I_(t.mutations)}function Jp(e){return Xn(e)&&!wn(e).Ho()&&e.D_.length>0}function Yp(e){wn(e).start()}async function pE(e){wn(e).d_()}async function mE(e){const t=wn(e);for(const n of e.D_)t.I_(n.mutations)}async function gE(e,t,n){const r=e.D_.shift(),s=fl.from(r,t,n);await Xp(e,()=>e.remoteSyncer.applySuccessfulWrite(s)),await Mo(e)}async function yE(e,t){t&&wn(e).P_&&await async function(n,r){if(function(s){return a1(s)&&s!==C.ABORTED}(r.code)){const s=n.D_.shift();wn(n).Zo(),await Xp(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,r)),await Mo(n)}}(e,t),Jp(e)&&Yp(e)}async function ph(e,t){const n=Y(e);n.asyncQueue.verifyOperationInProgress(),P("RemoteStore","RemoteStore received new credentials");const r=Xn(n);n.v_.add(3),await $s(n),r&&n.x_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.v_.delete(3),await Po(n)}async function vE(e,t){const n=Y(e);t?(n.v_.delete(2),await Po(n)):t||(n.v_.add(2),await $s(n),n.x_.set("Unknown"))}function Lr(e){return e.N_||(e.N_=function(t,n,r){const s=Y(t);return s.R_(),new sE(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(e.datastore,e.asyncQueue,{Po:lE.bind(null,e),To:uE.bind(null,e),u_:hE.bind(null,e)}),e.F_.push(async t=>{t?(e.N_.Zo(),_l(e)?wl(e):e.x_.set("Unknown")):(await e.N_.stop(),Qp(e))})),e.N_}function wn(e){return e.B_||(e.B_=function(t,n,r){const s=Y(t);return s.R_(),new iE(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(e.datastore,e.asyncQueue,{Po:pE.bind(null,e),To:yE.bind(null,e),E_:mE.bind(null,e),T_:gE.bind(null,e)}),e.F_.push(async t=>{t?(e.B_.Zo(),await Mo(e)):(await e.B_.stop(),e.D_.length>0&&(P("RemoteStore",`Stopping write stream with ${e.D_.length} pending writes`),e.D_=[]))})),e.B_}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class El{constructor(t,n,r,s,i){this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new We,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,n,r,s,i){const o=Date.now()+r,a=new El(t,n,o,s,i);return a.start(r),a}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new j(C.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Tl(e,t){if(je("AsyncQueue",`${t}: ${e}`),js(e))return new j(C.UNAVAILABLE,`${t}: ${e}`);throw e}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class mr{constructor(t){this.comparator=t?(n,r)=>t(n,r)||q.comparator(n.key,r.key):(n,r)=>q.comparator(n.key,r.key),this.keyedMap=Wr(),this.sortedSet=new Tt(this.comparator)}static emptySet(t){return new mr(t.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const n=this.keyedMap.get(t);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((n,r)=>(t(n),!1))}add(t){const n=this.delete(t.key);return n.copy(n.keyedMap.insert(t.key,t),n.sortedSet.insert(t,null))}delete(t){const n=this.get(t);return n?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(n)):this}isEqual(t){if(!(t instanceof mr)||this.size!==t.size)return!1;const n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const t=[];return this.forEach(n=>{t.push(n.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,n){const r=new mr;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class mh{constructor(){this.L_=new Tt(q.comparator)}track(t){const n=t.doc.key,r=this.L_.get(n);r?t.type!==0&&r.type===3?this.L_=this.L_.insert(n,t):t.type===3&&r.type!==1?this.L_=this.L_.insert(n,{type:r.type,doc:t.doc}):t.type===2&&r.type===2?this.L_=this.L_.insert(n,{type:2,doc:t.doc}):t.type===2&&r.type===0?this.L_=this.L_.insert(n,{type:0,doc:t.doc}):t.type===1&&r.type===0?this.L_=this.L_.remove(n):t.type===1&&r.type===2?this.L_=this.L_.insert(n,{type:1,doc:r.doc}):t.type===0&&r.type===1?this.L_=this.L_.insert(n,{type:2,doc:t.doc}):H():this.L_=this.L_.insert(n,t)}k_(){const t=[];return this.L_.inorderTraversal((n,r)=>{t.push(r)}),t}}class Sr{constructor(t,n,r,s,i,o,a,c,l){this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(t,n,r,s,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Sr(t,n,mr.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&ko(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const n=this.docChanges,r=t.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class bE{constructor(){this.q_=void 0,this.Q_=[]}}class wE{constructor(){this.queries=new Mr(t=>vp(t),ko),this.onlineState="Unknown",this.K_=new Set}}async function _E(e,t){const n=Y(e),r=t.query;let s=!1,i=n.queries.get(r);if(i||(s=!0,i=new bE),s)try{i.q_=await n.onListen(r)}catch(o){const a=Tl(o,`Initialization of query '${nr(t.query)}' failed`);return void t.onError(a)}n.queries.set(r,i),i.Q_.push(t),t.U_(n.onlineState),i.q_&&t.W_(i.q_)&&Sl(n)}async function EE(e,t){const n=Y(e),r=t.query;let s=!1;const i=n.queries.get(r);if(i){const o=i.Q_.indexOf(t);o>=0&&(i.Q_.splice(o,1),s=i.Q_.length===0)}if(s)return n.queries.delete(r),n.onUnlisten(r)}function TE(e,t){const n=Y(e);let r=!1;for(const s of t){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.Q_)a.W_(s)&&(r=!0);o.q_=s}}r&&Sl(n)}function SE(e,t,n){const r=Y(e),s=r.queries.get(t);if(s)for(const i of s.Q_)i.onError(n);r.queries.delete(t)}function Sl(e){e.K_.forEach(t=>{t.next()})}class CE{constructor(t,n,r){this.query=t,this.G_=n,this.z_=!1,this.j_=null,this.onlineState="Unknown",this.options=r||{}}W_(t){if(!this.options.includeMetadataChanges){const r=[];for(const s of t.docChanges)s.type!==3&&r.push(s);t=new Sr(t.query,t.docs,t.oldDocs,r,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let n=!1;return this.z_?this.H_(t)&&(this.G_.next(t),n=!0):this.J_(t,this.onlineState)&&(this.Y_(t),n=!0),this.j_=t,n}onError(t){this.G_.error(t)}U_(t){this.onlineState=t;let n=!1;return this.j_&&!this.z_&&this.J_(this.j_,t)&&(this.Y_(this.j_),n=!0),n}J_(t,n){if(!t.fromCache)return!0;const r=n!=="Offline";return(!this.options.Z_||!r)&&(!t.docs.isEmpty()||t.hasCachedResults||n==="Offline")}H_(t){if(t.docChanges.length>0)return!0;const n=this.j_&&this.j_.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Y_(t){t=Sr.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.z_=!0,this.G_.next(t)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Zp{constructor(t){this.key=t}}class tm{constructor(t){this.key=t}}class IE{constructor(t,n){this.query=t,this.oa=n,this._a=null,this.hasCachedResults=!1,this.current=!1,this.aa=it(),this.mutatedKeys=it(),this.ua=bp(t),this.ca=new mr(this.ua)}get la(){return this.oa}ha(t,n){const r=n?n.Pa:new mh,s=n?n.ca:this.ca;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,l=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal((u,h)=>{const f=s.get(u),m=xo(this.query,h)?h:null,E=!!f&&this.mutatedKeys.has(f.key),v=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let x=!1;f&&m?f.data.isEqual(m.data)?E!==v&&(r.track({type:3,doc:m}),x=!0):this.Ia(f,m)||(r.track({type:2,doc:m}),x=!0,(c&&this.ua(m,c)>0||l&&this.ua(m,l)<0)&&(a=!0)):!f&&m?(r.track({type:0,doc:m}),x=!0):f&&!m&&(r.track({type:1,doc:f}),x=!0,(c||l)&&(a=!0)),x&&(m?(o=o.add(m),i=v?i.add(u):i.delete(u)):(o=o.delete(u),i=i.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),i=i.delete(u.key),r.track({type:1,doc:u})}return{ca:o,Pa:r,Xi:a,mutatedKeys:i}}Ia(t,n){return t.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(t,n,r,s){const i=this.ca;this.ca=t.ca,this.mutatedKeys=t.mutatedKeys;const o=t.Pa.k_();o.sort((u,h)=>function(f,m){const E=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return H()}};return E(f)-E(m)}(u.type,h.type)||this.ua(u.doc,h.doc)),this.Ta(r),s=s!=null&&s;const a=n&&!s?this.Ea():[],c=this.aa.size===0&&this.current&&!s?1:0,l=c!==this._a;return this._a=c,o.length!==0||l?{snapshot:new Sr(this.query,t.ca,i,o,t.mutatedKeys,c===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),da:a}:{da:a}}U_(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({ca:this.ca,Pa:new mh,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{da:[]}}Aa(t){return!this.oa.has(t)&&!!this.ca.has(t)&&!this.ca.get(t).hasLocalMutations}Ta(t){t&&(t.addedDocuments.forEach(n=>this.oa=this.oa.add(n)),t.modifiedDocuments.forEach(n=>{}),t.removedDocuments.forEach(n=>this.oa=this.oa.delete(n)),this.current=t.current)}Ea(){if(!this.current)return[];const t=this.aa;this.aa=it(),this.ca.forEach(r=>{this.Aa(r.key)&&(this.aa=this.aa.add(r.key))});const n=[];return t.forEach(r=>{this.aa.has(r)||n.push(new tm(r))}),this.aa.forEach(r=>{t.has(r)||n.push(new Zp(r))}),n}Ra(t){this.oa=t.hs,this.aa=it();const n=this.ha(t.documents);return this.applyChanges(n,!0)}Va(){return Sr.fromInitialDocuments(this.query,this.ca,this.mutatedKeys,this._a===0,this.hasCachedResults)}}class kE{constructor(t,n,r){this.query=t,this.targetId=n,this.view=r}}class xE{constructor(t){this.key=t,this.ma=!1}}class AE{constructor(t,n,r,s,i,o){this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.fa={},this.ga=new Mr(a=>vp(a),ko),this.pa=new Map,this.ya=new Set,this.wa=new Tt(q.comparator),this.Sa=new Map,this.ba=new gl,this.Da={},this.Ca=new Map,this.va=Tr.Bn(),this.onlineState="Unknown",this.Fa=void 0}get isPrimaryClient(){return this.Fa===!0}}async function DE(e,t){const n=jE(e);let r,s;const i=n.ga.get(t);if(i)r=i.targetId,n.sharedClientState.addLocalQueryTarget(r),s=i.view.Va();else{const o=await J1(n.localStore,Oe(t)),a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,s=await NE(n,t,r,a==="current",o.resumeToken),n.isPrimaryClient&&Gp(n.remoteStore,o)}return s}async function NE(e,t,n,r,s){e.Ma=(h,f,m)=>async function(E,v,x,F){let w=v.view.ha(x);w.Xi&&(w=await hh(E.localStore,v.query,!1).then(({documents:k})=>v.view.ha(k,w)));const _=F&&F.targetChanges.get(v.targetId),y=F&&F.targetMismatches.get(v.targetId)!=null,$=v.view.applyChanges(w,E.isPrimaryClient,_,y);return yh(E,v.targetId,$.da),$.snapshot}(e,h,f,m);const i=await hh(e.localStore,t,!0),o=new IE(t,i.hs),a=o.ha(i.documents),c=qs.createSynthesizedTargetChangeForCurrentChange(n,r&&e.onlineState!=="Offline",s),l=o.applyChanges(a,e.isPrimaryClient,c);yh(e,n,l.da);const u=new kE(t,n,o);return e.ga.set(t,u),e.pa.has(n)?e.pa.get(n).push(t):e.pa.set(n,[t]),l.snapshot}async function RE(e,t){const n=Y(e),r=n.ga.get(t),s=n.pa.get(r.targetId);if(s.length>1)return n.pa.set(r.targetId,s.filter(i=>!ko(i,t))),void n.ga.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await ac(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),Hp(n.remoteStore,r.targetId),cc(n,r.targetId)}).catch(Vs)):(cc(n,r.targetId),await ac(n.localStore,r.targetId,!0))}async function PE(e,t,n){const r=BE(e);try{const s=await function(i,o){const a=Y(i),c=Nt.now(),l=o.reduce((f,m)=>f.add(m.key),it());let u,h;return a.persistence.runTransaction("Locally write mutations","readwrite",f=>{let m=Je(),E=it();return a.os.getEntries(f,l).next(v=>{m=v,m.forEach((x,F)=>{F.isValidDocument()||(E=E.add(x))})}).next(()=>a.localDocuments.getOverlayedDocuments(f,m)).next(v=>{u=v;const x=[];for(const F of o){const w=n1(F,u.get(F.key).overlayedDocument);w!=null&&x.push(new Qn(F.key,w,up(w.value.mapValue),Qe.exists(!0)))}return a.mutationQueue.addMutationBatch(f,c,x,o)}).next(v=>{h=v;const x=v.applyToLocalDocumentSet(u,E);return a.documentOverlayCache.saveOverlays(f,v.batchId,x)})}).then(()=>({batchId:h.batchId,changes:_p(u)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(s.batchId),function(i,o,a){let c=i.Da[i.currentUser.toKey()];c||(c=new Tt(ut)),c=c.insert(o,a),i.Da[i.currentUser.toKey()]=c}(r,s.batchId,n),await zs(r,s.changes),await Mo(r.remoteStore)}catch(s){const i=Tl(s,"Failed to persist write");n.reject(i)}}async function em(e,t){const n=Y(e);try{const r=await W1(n.localStore,t);t.targetChanges.forEach((s,i)=>{const o=n.Sa.get(i);o&&(mt(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.ma=!0:s.modifiedDocuments.size>0?mt(o.ma):s.removedDocuments.size>0&&(mt(o.ma),o.ma=!1))}),await zs(n,r,t)}catch(r){await Vs(r)}}function gh(e,t,n){const r=Y(e);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.ga.forEach((i,o)=>{const a=o.view.U_(t);a.snapshot&&s.push(a.snapshot)}),function(i,o){const a=Y(i);a.onlineState=o;let c=!1;a.queries.forEach((l,u)=>{for(const h of u.Q_)h.U_(o)&&(c=!0)}),c&&Sl(a)}(r.eventManager,t),s.length&&r.fa.u_(s),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function ME(e,t,n){const r=Y(e);r.sharedClientState.updateQueryState(t,"rejected",n);const s=r.Sa.get(t),i=s&&s.key;if(i){let o=new Tt(q.comparator);o=o.insert(i,Qt.newNoDocument(i,Q.min()));const a=it().add(i),c=new No(Q.min(),new Map,new Tt(ut),o,a);await em(r,c),r.wa=r.wa.remove(i),r.Sa.delete(t),Cl(r)}else await ac(r.localStore,t,!1).then(()=>cc(r,t,n)).catch(Vs)}async function LE(e,t){const n=Y(e),r=t.batch.batchId;try{const s=await H1(n.localStore,t);rm(n,r,null),nm(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await zs(n,s)}catch(s){await Vs(s)}}async function OE(e,t,n){const r=Y(e);try{const s=await function(i,o){const a=Y(i);return a.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let l;return a.mutationQueue.lookupMutationBatch(c,o).next(u=>(mt(u!==null),l=u.keys(),a.mutationQueue.removeMutationBatch(c,u))).next(()=>a.mutationQueue.performConsistencyCheck(c)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(c,l,o)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,l)).next(()=>a.localDocuments.getDocuments(c,l))})}(r.localStore,t);rm(r,t,n),nm(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await zs(r,s)}catch(s){await Vs(s)}}function nm(e,t){(e.Ca.get(t)||[]).forEach(n=>{n.resolve()}),e.Ca.delete(t)}function rm(e,t,n){const r=Y(e);let s=r.Da[r.currentUser.toKey()];if(s){const i=s.get(t);i&&(n?i.reject(n):i.resolve(),s=s.remove(t)),r.Da[r.currentUser.toKey()]=s}}function cc(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.pa.get(t))e.ga.delete(r),n&&e.fa.xa(r,n);e.pa.delete(t),e.isPrimaryClient&&e.ba.Vr(t).forEach(r=>{e.ba.containsKey(r)||sm(e,r)})}function sm(e,t){e.ya.delete(t.path.canonicalString());const n=e.wa.get(t);n!==null&&(Hp(e.remoteStore,n),e.wa=e.wa.remove(t),e.Sa.delete(n),Cl(e))}function yh(e,t,n){for(const r of n)r instanceof Zp?(e.ba.addReference(r.key,t),UE(e,r)):r instanceof tm?(P("SyncEngine","Document no longer in limbo: "+r.key),e.ba.removeReference(r.key,t),e.ba.containsKey(r.key)||sm(e,r.key)):H()}function UE(e,t){const n=t.key,r=n.path.canonicalString();e.wa.get(n)||e.ya.has(r)||(P("SyncEngine","New document in limbo: "+n),e.ya.add(r),Cl(e))}function Cl(e){for(;e.ya.size>0&&e.wa.size<e.maxConcurrentLimboResolutions;){const t=e.ya.values().next().value;e.ya.delete(t);const n=new q(_t.fromString(t)),r=e.va.next();e.Sa.set(r,new xE(n)),e.wa=e.wa.insert(n,r),Gp(e.remoteStore,new un(Oe(yp(n.path)),r,"TargetPurposeLimboResolution",al._e))}}async function zs(e,t,n){const r=Y(e),s=[],i=[],o=[];r.ga.isEmpty()||(r.ga.forEach((a,c)=>{o.push(r.Ma(c,t,n).then(l=>{if((l||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(c.targetId,l!=null&&l.fromCache?"not-current":"current"),l){s.push(l);const u=vl.Ki(c.targetId,l);i.push(u)}}))}),await Promise.all(o),r.fa.u_(s),await async function(a,c){const l=Y(a);try{await l.persistence.runTransaction("notifyLocalViewChanges","readwrite",u=>b.forEach(c,h=>b.forEach(h.qi,f=>l.persistence.referenceDelegate.addReference(u,h.targetId,f)).next(()=>b.forEach(h.Qi,f=>l.persistence.referenceDelegate.removeReference(u,h.targetId,f)))))}catch(u){if(!js(u))throw u;P("LocalStore","Failed to update sequence numbers: "+u)}for(const u of c){const h=u.targetId;if(!u.fromCache){const f=l.ns.get(h),m=f.snapshotVersion,E=f.withLastLimboFreeSnapshotVersion(m);l.ns=l.ns.insert(h,E)}}}(r.localStore,i))}async function FE(e,t){const n=Y(e);if(!n.currentUser.isEqual(t)){P("SyncEngine","User change. New user:",t.toKey());const r=await qp(n.localStore,t);n.currentUser=t,function(s,i){s.Ca.forEach(o=>{o.forEach(a=>{a.reject(new j(C.CANCELLED,i))})}),s.Ca.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),await zs(n,r.us)}}function VE(e,t){const n=Y(e),r=n.Sa.get(t);if(r&&r.ma)return it().add(r.key);{let s=it();const i=n.pa.get(t);if(!i)return s;for(const o of i){const a=n.ga.get(o);s=s.unionWith(a.view.la)}return s}}function jE(e){const t=Y(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=em.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=VE.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=ME.bind(null,t),t.fa.u_=TE.bind(null,t.eventManager),t.fa.xa=SE.bind(null,t.eventManager),t}function BE(e){const t=Y(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=LE.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=OE.bind(null,t),t}class vh{constructor(){this.synchronizeTabs=!1}async initialize(t){this.serializer=Ro(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),await this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)}createGarbageCollectionScheduler(t,n){return null}createIndexBackfillerScheduler(t,n){return null}createLocalStore(t){return G1(this.persistence,new z1,t.initialUser,this.serializer)}createPersistence(t){return new B1(yl.Hr,this.serializer)}createSharedClientState(t){return new Z1}async terminate(){var t,n;(t=this.gcScheduler)===null||t===void 0||t.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class qE{async initialize(t,n){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>gh(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=FE.bind(null,this.syncEngine),await vE(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new wE}()}createDatastore(t){const n=Ro(t.databaseInfo.databaseId),r=function(s){return new rE(s)}(t.databaseInfo);return function(s,i,o,a){return new oE(s,i,o,a)}(t.authCredentials,t.appCheckCredentials,r,n)}createRemoteStore(t){return function(n,r,s,i,o){return new cE(n,r,s,i,o)}(this.localStore,this.datastore,t.asyncQueue,n=>gh(this.syncEngine,n,0),function(){return fh.D()?new fh:new tE}())}createSyncEngine(t,n){return function(r,s,i,o,a,c,l){const u=new AE(r,s,i,o,a,c);return l&&(u.Fa=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,n)}async terminate(){var t;await async function(n){const r=Y(n);P("RemoteStore","RemoteStore shutting down."),r.v_.add(5),await $s(r),r.M_.shutdown(),r.x_.set("Unknown")}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate()}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*//**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class $E{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Ba(this.observer.next,t)}error(t){this.observer.error?this.Ba(this.observer.error,t):je("Uncaught Error in snapshot listener:",t.toString())}La(){this.muted=!0}Ba(t,n){this.muted||setTimeout(()=>{this.muted||t(n)},0)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class zE{constructor(t,n,r,s){this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Wt.UNAUTHENTICATED,this.clientId=ap.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async i=>{P("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(r,i=>(P("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new j(C.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new We;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(n){const r=Tl(n,"Failed to shutdown persistence");t.reject(r)}}),t.promise}}async function va(e,t){e.asyncQueue.verifyOperationInProgress(),P("FirestoreClient","Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async s=>{r.isEqual(s)||(await qp(t.localStore,s),r=s)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function bh(e,t){e.asyncQueue.verifyOperationInProgress();const n=await GE(e);P("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(r=>ph(t.remoteStore,r)),e.setAppCheckTokenChangeListener((r,s)=>ph(t.remoteStore,s)),e._onlineComponents=t}function KE(e){return e.name==="FirebaseError"?e.code===C.FAILED_PRECONDITION||e.code===C.UNIMPLEMENTED:!(typeof DOMException<"u"&&e instanceof DOMException)||e.code===22||e.code===20||e.code===11}async function GE(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){P("FirestoreClient","Using user provided OfflineComponentProvider");try{await va(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!KE(n))throw n;br("Error using user provided cache. Falling back to memory cache: "+n),await va(e,new vh)}}else P("FirestoreClient","Using default OfflineComponentProvider"),await va(e,new vh);return e._offlineComponents}async function im(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(P("FirestoreClient","Using user provided OnlineComponentProvider"),await bh(e,e._uninitializedComponentsProvider._online)):(P("FirestoreClient","Using default OnlineComponentProvider"),await bh(e,new qE))),e._onlineComponents}function HE(e){return im(e).then(t=>t.syncEngine)}async function WE(e){const t=await im(e),n=t.eventManager;return n.onListen=DE.bind(null,t.syncEngine),n.onUnlisten=RE.bind(null,t.syncEngine),n}function QE(e,t,n={}){const r=new We;return e.asyncQueue.enqueueAndForget(async()=>function(s,i,o,a,c){const l=new $E({next:h=>{i.enqueueAndForget(()=>EE(s,u)),h.fromCache&&a.source==="server"?c.reject(new j(C.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),u=new CE(o,l,{includeMetadataChanges:!0,Z_:!0});return _E(s,u)}(await WE(e),e.asyncQueue,t,n,r)),r.promise}/**
* @license
* Copyright 2023 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function om(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const wh=new Map;/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function am(e,t,n){if(!n)throw new j(C.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function XE(e,t,n,r){if(t===!0&&r===!0)throw new j(C.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function _h(e){if(!q.isDocumentKey(e))throw new j(C.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Eh(e){if(q.isDocumentKey(e))throw new j(C.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Il(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(n){return n.constructor?n.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":H()}function ji(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new j(C.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Il(e);throw new j(C.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Th{constructor(t){var n,r;if(t.host===void 0){if(t.ssl!==void 0)throw new j(C.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=(n=t.ssl)===null||n===void 0||n;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<1048576)throw new j(C.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}XE("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=om((r=t.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new j(C.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new j(C.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new j(C.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(n,r){return n.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Lo{constructor(t,n,r,s){this._authCredentials=t,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Th({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new j(C.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(t){if(this._settingsFrozen)throw new j(C.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Th(t),t.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new u_;switch(n.type){case"firstParty":return new p_(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new j(C.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const n=wh.get(t);n&&(P("ComponentProvider","Removing Datastore"),wh.delete(t),n.terminate())}(this),Promise.resolve()}}function JE(e,t,n,r={}){var s;const i=(e=ji(e,Lo))._getSettings(),o=`${t}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&br("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=Wt.MOCK_USER;else{a=q0(r.mockUserToken,(s=e._app)===null||s===void 0?void 0:s.options.projectId);const l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new j(C.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Wt(l)}e._authCredentials=new h_(new op(a,c))}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Oo{constructor(t,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=t}withConverter(t){return new Oo(this.firestore,t,this._query)}}class Ce{constructor(t,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new gn(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Ce(this.firestore,t,this._key)}}class gn extends Oo{constructor(t,n,r){super(t,n,yp(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Ce(this.firestore,null,new q(t))}withConverter(t){return new gn(this.firestore,t,this._path)}}function cm(e,t,...n){if(e=hs(e),am("collection","path",t),e instanceof Lo){const r=_t.fromString(t,...n);return Eh(r),new gn(e,null,r)}{if(!(e instanceof Ce||e instanceof gn))throw new j(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(_t.fromString(t,...n));return Eh(r),new gn(e.firestore,null,r)}}function YE(e,t,...n){if(e=hs(e),arguments.length===1&&(t=ap.newId()),am("doc","path",t),e instanceof Lo){const r=_t.fromString(t,...n);return _h(r),new Ce(e,null,new q(r))}{if(!(e instanceof Ce||e instanceof gn))throw new j(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(_t.fromString(t,...n));return _h(r),new Ce(e.firestore,e instanceof gn?e.converter:null,new q(r))}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class ZE{constructor(){this.Xa=Promise.resolve(),this.eu=[],this.tu=!1,this.nu=[],this.ru=null,this.iu=!1,this.su=!1,this.ou=[],this.jo=new zp(this,"async_queue_retry"),this._u=()=>{const n=ya();n&&P("AsyncQueue","Visibility state changed to "+n.visibilityState),this.jo.Ko()};const t=ya();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._u)}get isShuttingDown(){return this.tu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.au(),this.uu(t)}enterRestrictedMode(t){if(!this.tu){this.tu=!0,this.su=t||!1;const n=ya();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._u)}}enqueue(t){if(this.au(),this.tu)return new Promise(()=>{});const n=new We;return this.uu(()=>this.tu&&this.su?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.eu.push(t),this.cu()))}async cu(){if(this.eu.length!==0){try{await this.eu[0](),this.eu.shift(),this.jo.reset()}catch(t){if(!js(t))throw t;P("AsyncQueue","Operation failed with retryable error: "+t)}this.eu.length>0&&this.jo.qo(()=>this.cu())}}uu(t){const n=this.Xa.then(()=>(this.iu=!0,t().catch(r=>{this.ru=r,this.iu=!1;const s=function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),o}(r);throw je("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.iu=!1,r))));return this.Xa=n,n}enqueueAfterDelay(t,n,r){this.au(),this.ou.indexOf(t)>-1&&(n=0);const s=El.createAndSchedule(this,t,n,r,i=>this.lu(i));return this.nu.push(s),s}au(){this.ru&&H()}verifyOperationInProgress(){}async hu(){let t;do t=this.Xa,await t;while(t!==this.Xa)}Pu(t){for(const n of this.nu)if(n.timerId===t)return!0;return!1}Iu(t){return this.hu().then(()=>{this.nu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.nu)if(n.skipDelay(),t!=="all"&&n.timerId===t)break;return this.hu()})}Tu(t){this.ou.push(t)}lu(t){const n=this.nu.indexOf(t);this.nu.splice(n,1)}}class kl extends Lo{constructor(t,n,r,s){super(t,n,r,s),this.type="firestore",this._queue=function(){return new ZE}(),this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||um(this),this._firestoreClient.terminate()}}function tT(e,t){const n=typeof e=="object"?e:Hb(),r=typeof e=="string"?e:t||"(default)",s=$b(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=j0("firestore");i&&JE(s,...i)}return s}function lm(e){return e._firestoreClient||um(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function um(e){var t,n,r;const s=e._freezeSettings(),i=function(o,a,c,l){return new x_(o,a,c,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,om(l.experimentalLongPollingOptions),l.useFetchStreams)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,s);e._firestoreClient=new zE(e._authCredentials,e._appCheckCredentials,e._queue,i),!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:s.localCache.kind,_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider})}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Cr{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Cr(te.fromBase64String(t))}catch(n){throw new j(C.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(t){return new Cr(te.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class xl{constructor(...t){for(let n=0;n<t.length;++n)if(t[n].length===0)throw new j(C.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new qt(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class hm{constructor(t){this._methodName=t}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Al{constructor(t,n){if(!isFinite(t)||t<-90||t>90)throw new j(C.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new j(C.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return ut(this._lat,t._lat)||ut(this._long,t._long)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const eT=/^__.*__$/;class nT{constructor(t,n,r){this.data=t,this.fieldMask=n,this.fieldTransforms=r}toMutation(t,n){return this.fieldMask!==null?new Qn(t,this.data,this.fieldMask,n,this.fieldTransforms):new Bs(t,this.data,n,this.fieldTransforms)}}function dm(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw H()}}class Dl{constructor(t,n,r,s,i,o){this.settings=t,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Eu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get du(){return this.settings.du}Au(t){return new Dl(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ru(t){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(t),s=this.Au({path:r,Vu:!1});return s.mu(t),s}fu(t){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(t),s=this.Au({path:r,Vu:!1});return s.Eu(),s}gu(t){return this.Au({path:void 0,Vu:!0})}pu(t){return Bi(t,this.settings.methodName,this.settings.yu||!1,this.path,this.settings.wu)}contains(t){return this.fieldMask.find(n=>t.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>t.isPrefixOf(n.field))!==void 0}Eu(){if(this.path)for(let t=0;t<this.path.length;t++)this.mu(this.path.get(t))}mu(t){if(t.length===0)throw this.pu("Document fields must not be empty");if(dm(this.du)&&eT.test(t))throw this.pu('Document fields cannot begin and end with "__"')}}class rT{constructor(t,n,r){this.databaseId=t,this.ignoreUndefinedProperties=n,this.serializer=r||Ro(t)}Su(t,n,r,s=!1){return new Dl({du:t,methodName:n,wu:r,path:qt.emptyPath(),Vu:!1,yu:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function sT(e){const t=e._freezeSettings(),n=Ro(e._databaseId);return new rT(e._databaseId,!!t.ignoreUndefinedProperties,n)}function iT(e,t,n,r,s,i={}){const o=e.Su(i.merge||i.mergeFields?2:0,t,n,s);gm("Data must be an object, but it was:",o,r);const a=pm(r,o);let c,l;if(i.merge)c=new Te(o.fieldMask),l=o.fieldTransforms;else if(i.mergeFields){const u=[];for(const h of i.mergeFields){const f=oT(t,h,n);if(!o.contains(f))throw new j(C.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);cT(u,f)||u.push(f)}c=new Te(u),l=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,l=o.fieldTransforms;return new nT(new ge(a),c,l)}function fm(e,t){if(mm(e=hs(e)))return gm("Unsupported field value:",t,e),pm(e,t);if(e instanceof hm)return function(n,r){if(!dm(r.du))throw r.pu(`${n._methodName}() can only be used with update() and set()`);if(!r.path)throw r.pu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Vu&&t.du!==4)throw t.pu("Nested arrays are not supported");return function(n,r){const s=[];let i=0;for(const o of n){let a=fm(o,r.gu(i));a==null&&(a={nullValue:"NULL_VALUE"}),s.push(a),i++}return{arrayValue:{values:s}}}(e,t)}return function(n,r){if((n=hs(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return X_(r.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=Nt.fromDate(n);return{timestampValue:Fi(r.serializer,s)}}if(n instanceof Nt){const s=new Nt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Fi(r.serializer,s)}}if(n instanceof Al)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Cr)return{bytesValue:Lp(r.serializer,n._byteString)};if(n instanceof Ce){const s=r.databaseId,i=n.firestore._databaseId;if(!i.isEqual(s))throw r.pu(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:ml(n.firestore._databaseId||r.databaseId,n._key.path)}}throw r.pu(`Unsupported field value: ${Il(n)}`)}(e,t)}function pm(e,t){const n={};return cp(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Pr(e,(r,s)=>{const i=fm(s,t.Ru(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function mm(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof Nt||e instanceof Al||e instanceof Cr||e instanceof Ce||e instanceof hm)}function gm(e,t,n){if(!mm(n)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(n)){const r=Il(n);throw r==="an object"?t.pu(e+" a custom object"):t.pu(e+" "+r)}}function oT(e,t,n){if((t=hs(t))instanceof xl)return t._internalPath;if(typeof t=="string")return ym(e,t);throw Bi("Field path arguments must be of type string or ",e,!1,void 0,n)}const aT=new RegExp("[~\\*/\\[\\]]");function ym(e,t,n){if(t.search(aT)>=0)throw Bi(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new xl(...t.split("."))._internalPath}catch{throw Bi(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function Bi(e,t,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new j(C.INVALID_ARGUMENT,a+e+c)}function cT(e,t){return e.some(n=>n.isEqual(t))}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class vm{constructor(t,n,r,s,i){this._firestore=t,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ce(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new lT(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const n=this._document.data.field(bm("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n)}}}class lT extends vm{data(){return super.data()}}function bm(e,t){return typeof t=="string"?ym(e,t):t instanceof xl?t._internalPath:t._delegate._internalPath}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function uT(e){if(e.limitType==="L"&&e.explicitOrderBy.length===0)throw new j(C.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class hT{convertValue(t,n="none"){switch(Kn(t)){case 0:return null;case 1:return t.booleanValue;case 2:return kt(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,n);case 5:return t.stringValue;case 6:return this.convertBytes(zn(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,n);case 10:return this.convertObject(t.mapValue,n);default:throw H()}}convertObject(t,n){return this.convertObjectMap(t.fields,n)}convertObjectMap(t,n="none"){const r={};return Pr(t,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertGeoPoint(t){return new Al(kt(t.latitude),kt(t.longitude))}convertArray(t,n){return(t.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(t,n){switch(n){case"previous":const r=ll(t);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Ts(t));default:return null}}convertTimestamp(t){const n=bn(t);return new Nt(n.seconds,n.nanos)}convertDocumentKey(t,n){const r=_t.fromString(t);mt(Bp(r));const s=new Ss(r.get(1),r.get(3)),i=new q(r.popFirst(5));return s.isEqual(n)||je(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function dT(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class ai{constructor(t,n){this.hasPendingWrites=t,this.fromCache=n}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class fT extends vm{constructor(t,n,r,s,i,o){super(t,n,r,s,o),this._firestore=t,this._firestoreImpl=t,this.metadata=i}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const n=new pi(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,n={}){if(this._document){const r=this._document.data.field(bm("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class pi extends fT{data(t={}){return super.data(t)}}class pT{constructor(t,n,r,s){this._firestore=t,this._userDataWriter=n,this._snapshot=s,this.metadata=new ai(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const t=[];return this.forEach(n=>t.push(n)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,n){this._snapshot.docs.forEach(r=>{t.call(n,new pi(this._firestore,this._userDataWriter,r.key,r,new ai(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const n=!!t.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new j(C.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let i=0;return r._snapshot.docChanges.map(o=>{const a=new pi(r._firestore,r._userDataWriter,o.doc.key,o.doc,new ai(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);return o.doc,{type:"added",doc:a,oldIndex:-1,newIndex:i++}})}{let i=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const a=new pi(r._firestore,r._userDataWriter,o.doc.key,o.doc,new ai(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);let c=-1,l=-1;return o.type!==0&&(c=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),o.type!==1&&(i=i.add(o.doc),l=i.indexOf(o.doc.key)),{type:mT(o.type),doc:a,oldIndex:c,newIndex:l}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function mT(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return H()}}class gT extends hT{constructor(t){super(),this.firestore=t}convertBytes(t){return new Cr(t)}convertReference(t){const n=this.convertDocumentKey(t,this.firestore._databaseId);return new Ce(this.firestore,null,n)}}function yT(e){e=ji(e,Oo);const t=ji(e.firestore,kl),n=lm(t),r=new gT(t);return uT(e._query),QE(n,e._query).then(s=>new pT(t,r,e,s))}function vT(e,t){const n=ji(e.firestore,kl),r=YE(e),s=dT(e.converter,t);return bT(n,[iT(sT(e.firestore),"addDoc",r._key,s,e.converter!==null,{}).toMutation(r._key,Qe.exists(!1))]).then(()=>r)}function bT(e,t){return function(n,r){const s=new We;return n.asyncQueue.enqueueAndForget(async()=>PE(await HE(n),r,s)),s.promise}(lm(e),t)}(function(e,t=!0){(function(n){Rr=n})(Gb),Ii(new ds("firestore",(n,{instanceIdentifier:r,options:s})=>{const i=n.getProvider("app").getImmediate(),o=new kl(new d_(n.getProvider("auth-internal")),new g_(n.getProvider("app-check-internal")),function(a,c){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new j(C.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ss(a.options.projectId,c)}(i,r),i);return s=Object.assign({useFetchStreams:t},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),dr(zu,"4.4.3",e),dr(zu,"4.4.3","esm2017")})();const ke=e=>(wg("data-v-374f591c"),e=e(),_g(),e),wT={class:"card-creator"},_T={class:"card-creator__wrapper"},ET={class:"card-creator__editor"},TT=ke(()=>L("h1",{class:"card-creator-type-card__title"},"Тип",-1)),ST={class:"card-creator__type-card card-creator-type-card"},CT={class:"card-creator__type"},IT=ke(()=>L("h2",{class:"card-creator-type-card__title"},"Тип создаваемой карты:",-1)),kT={class:"card-creator__act"},xT=ke(()=>L("h2",{class:"card-creator-type-card__title"},"Для какого акта:",-1)),AT={class:"card-creator__name-card"},DT=ke(()=>L("h2",{class:"card-creator-type-card__title"},"Название",-1)),NT=ke(()=>L("h1",{class:"card-creator-type-card__title"},"Верхний путь",-1)),RT={class:"card-creator__texts"},PT={class:"card-creator__name-card"},MT=ke(()=>L("h2",{class:"card-creator-type-card__title"},"Название и доп сложность",-1)),LT={class:"card-creator__path-row"},OT=["checked"],UT={class:"card-creator__name-card"},FT=ke(()=>L("h2",{class:"card-creator-type-card__title"},"Награды",-1)),VT={class:"card-creator__rewards card-creator__rewards--top"},jT=ke(()=>L("h1",{class:"card-creator-type-card__title"},"Нижний путь",-1)),BT={class:"card-creator__texts"},qT={class:"card-creator__name-card"},$T=ke(()=>L("h2",{class:"card-creator-type-card__title"},"Нижний путь",-1)),zT={class:"card-creator__path-row"},KT=["checked"],GT={class:"card-creator__name-card"},HT=ke(()=>L("h2",{class:"card-creator-type-card__title"},"Награды",-1)),WT={class:"card-creator__rewards card-creator__rewards--top"},QT={class:"card-creator__difficulty card-creator-difficulty"},XT=ke(()=>L("h1",{class:"card-creator-type-card__title"},"Сложность и руны",-1)),JT={class:"card-creator-difficulty__runes"},YT={class:"card-creator__preview"},ZT={class:"card-creator__zoom"},tS=Ye({__name:"CardCreator",emits:["openBook"],setup(e){const t=Fn("client"),n=Fn("db"),r=dt({type:0,act:0,name:"",topPath:{name:"",extraDifficulty:0,rewards:[],isDark:!1},botPath:{name:"",extraDifficulty:0,rewards:[],isDark:!1},difficulty:{value:0,runes:[]},imageUrl:null,imageBlob:null,imageId:null});Un(r,()=>console.log("CARD: ",Z(r)),{immediate:!0,deep:!0});const s=dt(6),i=k=>{+k==6&&(r.value.type=+k)};dt(0);const o=k=>r.value.act=+k,a=Pt(()=>s.value!==null?Ei[s.value]:null);Pt(()=>Z(s)===0),Pt(()=>Z(s)===0),Pt(()=>Z(s)===0),Pt(()=>Z(s)===0),Pt(()=>Z(s)===0),Pt(()=>Z(s)===0),Pt(()=>Z(s)===0),Pt(()=>Z(s)===0),Pt(()=>Z(s)===0),Pt(()=>Z(s)===0);const c=dt(""),l=dt(null);dt(""),dt(""),dt(""),dt([]);const u=k=>{r.value.difficulty.runes.includes(+k)?r.value.difficulty.runes=r.value.difficulty.runes.filter(R=>R!==+k):r.value.difficulty.runes.push(+k)},h=dt([]),f=dt([]);Un([h,f],()=>console.log(Z(h),Z(f)),{immediate:!0,deep:!0});const m=k=>{r.value.topPath.rewards.find(R=>R.id==k)?r.value.topPath.rewards=[...Z(r).topPath.rewards.filter(R=>R.id!==k)]:r.value.topPath.rewards.push({id:k,count:null})},E=k=>{console.log(Z(h)),r.value.botPath.rewards.find(R=>R.id==k)?r.value.botPath.rewards=[...Z(r).botPath.rewards.filter(R=>R.id!==k)]:r.value.botPath.rewards.push({id:k,count:null})},v=k=>{switch(k){case"top":r.value.topPath.isDark=!r.value.topPath.isDark;break;case"bot":r.value.botPath.isDark=!r.value.botPath.isDark;break;default:return}};dt(0),dt(0),dt(0);const x=dt(100),F=k=>{k.deltaY===-100?x.value<150&&(x.value+=5):x.value>100&&(x.value-=5)},w=()=>{c.value="",l.value=null},_=k=>{r.value.imageUrl=k.previewUrl,r.value.imageBlob=k.imageContainer},y=async()=>{try{console.log("uploading...");const k=await t.uploadFile(Z(r).imageBlob);r.value.imageId=k.uuid}catch(k){console.log(k)}},$=async()=>{await y();try{const k=await vT(cm(n,"cards"),JSON.parse(JSON.stringify(Z(r))))}catch(k){console.error("Error adding document: ",k)}};return Un(a,()=>console.log(a)),(k,R)=>(X(),ht("div",wT,[L("div",_T,[L("div",ET,[L("div",null,[TT,L("div",ST,[L("div",CT,[IT,ne(yu,{items:Z(Ei),selected:r.value.type,onSelect:i},null,8,["items","selected"])]),L("div",kT,[xT,ne(yu,{items:Z(xc),selected:r.value.act,onSelect:o},null,8,["items","selected"])]),L("div",AT,[DT,ne(ea,{min:"0",max:"30",text:r.value.name,"onUpdate:text":R[0]||(R[0]=V=>r.value.name=V)},null,8,["text"])])])]),L("div",null,[NT,L("div",RT,[L("div",PT,[MT,L("div",LT,[ne(ea,{min:"0",max:"30",text:r.value.topPath.name,"onUpdate:text":R[1]||(R[1]=V=>r.value.topPath.name=V)},null,8,["text"]),ir(L("input",{text:"number",type:"number",class:"card-creator-difficulty__points",min:"0",max:"5","onUpdate:modelValue":R[2]||(R[2]=V=>r.value.topPath.extraDifficulty=V)},null,512),[[Ys,r.value.topPath.extraDifficulty]]),L("input",{type:"checkbox",class:"card-creator__checkbox",checked:r.value.topPath.isDark,onChange:R[3]||(R[3]=V=>v("top"))},null,40,OT)])]),L("div",UT,[FT,L("div",VT,[(X(!0),ht(At,null,fn(Z(Ne),(V,tt)=>(X(),ve(na,{items:Z(Ne),id:tt,allowedCount:!!V.count&&r.value.topPath.rewards.find(rt=>rt===+tt),checked:r.value.topPath.rewards.find(rt=>rt==tt),onToggle:rt=>m(tt)},null,8,["items","id","allowedCount","checked","onToggle"]))),256))])])])]),L("div",null,[jT,L("div",BT,[L("div",qT,[$T,L("div",zT,[ne(ea,{text:r.value.botPath.name,"onUpdate:text":R[4]||(R[4]=V=>r.value.botPath.name=V),min:"0",max:"30"},null,8,["text"]),ir(L("input",{type:"number",class:"card-creator-difficulty__points",min:"0",max:"5","onUpdate:modelValue":R[5]||(R[5]=V=>r.value.botPath.extraDifficulty=V)},null,512),[[Ys,r.value.botPath.extraDifficulty]]),L("input",{type:"checkbox",class:"card-creator__checkbox",checked:r.value.botPath.isDark,onChange:R[6]||(R[6]=V=>v("bot"))},null,40,KT)])]),L("div",GT,[HT,L("div",WT,[(X(!0),ht(At,null,fn(Z(Ne),(V,tt)=>(X(),ve(na,{items:Z(Ne),id:tt,allowedCount:!!V.count&&r.value.botPath.rewards.find(rt=>rt===+tt),checked:r.value.botPath.rewards.find(rt=>rt==tt),onToggle:rt=>E(tt)},null,8,["items","id","allowedCount","checked","onToggle"]))),256))])])])]),L("div",QT,[XT,L("div",JT,[ir(L("input",{type:"number",class:"card-creator-difficulty__points card-creator-difficulty__points--mr","onUpdate:modelValue":R[7]||(R[7]=V=>r.value.difficulty.value=V),min:"0",minlength:"0",max:"20",maxlength:"20"},null,512),[[Ys,r.value.difficulty.value]]),(X(!0),ht(At,null,fn(Z(Pa),(V,tt)=>(X(),ve(na,{id:tt,items:Z(Pa),checked:r.value.difficulty.runes.includes(+tt),onToggle:rt=>u(+tt),disabled:!r.value.difficulty.runes.includes(+tt)&&r.value.difficulty.runes.length===2},null,8,["id","items","checked","onToggle","disabled"]))),256))])])]),L("div",YT,[a.value?(X(),ve(zd,{key:0,class:"card-creator__preview-card",width:a.value.cardSize.width,height:a.value.cardSize.height,backImg:a.value.backImg,act:r.value.act,frontImg:r.value.imageUrl,onOnImageParse:_,topPath:r.value.topPath.name,botPath:r.value.botPath.name,difficulty:r.value.difficulty.value,cardName:r.value.name,challengeRunes:r.value.difficulty.runes,zoom:x.value,topPathExtraDif:r.value.topPath.extraDifficulty,botPathExtraDif:r.value.botPath.extraDifficulty,topRewards:r.value.topPath.rewards,botRewards:r.value.botPath.rewards,card:r.value,onWheel:F},null,8,["width","height","backImg","act","frontImg","topPath","botPath","difficulty","cardName","challengeRunes","zoom","topPathExtraDif","botPathExtraDif","topRewards","botRewards","card"])):le("",!0),c.value?(X(),ht("button",{key:1,class:"card-creator__clear-image",onClick:w}," Изменить ")):le("",!0),L("div",ZT,[ir(L("input",{type:"range",name:"zoom",id:"zoom",min:"100",max:"150",step:"5","onUpdate:modelValue":R[8]||(R[8]=V=>x.value=V),onWheel:F},null,544),[[Ys,x.value]])]),L("button",{class:"card-creator__apply",onClick:$}," Создать "),L("button",{class:"card-creator__book-open",onClick:R[9]||(R[9]=V=>k.$emit("openBook"))}," Открыть книгу карт ")])])]))}}),eS=tn(tS,[["__scopeId","data-v-374f591c"]]);var nS="firebase",rS="10.8.1";/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/dr(nS,rS,"app");const sS={apiKey:"AIzaSyBoyp3aAQvqSUc0XCWouNfoOiVXeLrhQOk",authDomain:"cards-adventure.firebaseapp.com",projectId:"cards-adventure",storageBucket:"cards-adventure.appspot.com",messagingSenderId:"1039014346368",appId:"1:1039014346368:web:1773de44f0ee2f1618f065"},iS={class:"book"},oS={key:0,class:"book__container"},aS={key:1},cS=Ye({__name:"Book",emits:["close"],setup(e,{emit:t}){const n=t,r=Fn("db"),s=dt([]),i=()=>n("close");return Sc(async()=>{try{const o=await yT(cm(r,"cards"));s.value=o.docs.map(a=>a.data()),console.log(s)}catch(o){console.log(o)}}),(o,a)=>{const c=nd("outclick");return ir((X(),ht("div",iS,[s.value.length?(X(),ht("div",oS,[(X(!0),ht(At,null,fn(s.value,l=>(X(),ve(zd,{class:"book__card",book:!0,"top-path-extra-dif":l.topPath.extraDifficulty,"card-name":l.name,"top-rewards":l.topPath.rewards,zoom:100,"challenge-runes":l.difficulty.runes,difficulty:l.difficulty.value,"back-img":Z(xc)[l.act].backImage,act:l.act,"front-img":l.imageId,"top-path":l.topPath.name,"bot-path-extra-dif":l.botPath.extraDifficulty,width:Z(Ei)[l.type].cardSize.width,height:Z(Ei)[l.type].cardSize.height,"bot-path":l.botPath.name,"bot-rewards":l.botPath.rewards,card:l},null,8,["top-path-extra-dif","card-name","top-rewards","challenge-runes","difficulty","back-img","act","front-img","top-path","bot-path-extra-dif","width","height","bot-path","bot-rewards","card"]))),256))])):(X(),ht("h1",aS,"Loading..."))])),[[c,i]])}}}),lS=tn(cS,[["__scopeId","data-v-09443ea5"]]),uS={},hS={class:"version"};function dS(e,t){return X(),ht("span",hS," v 0.1 (26.03.24) ")}const fS=tn(uS,[["render",dS],["__scopeId","data-v-535e47e0"]]),pS=Ye({__name:"App",setup(e){const t=Zd(sS),n=tT(t),r=new $d({publicKey:"10a6fd7ad4acb396dfe1"}),s=dt(!1),i=()=>s.value=!Z(s);return ka("client",r),ka("db",n),(o,a)=>(X(),ht(At,null,[(X(),ve(Og,null,[s.value?le("",!0):(X(),ve(eS,{key:0,onOpenBook:i}))],1024)),s.value?(X(),ve(lS,{key:0,onClose:i})):le("",!0),ne(fS)],64))}}),mS=tn(pS,[["__scopeId","data-v-d34413fe"]]);class gS{static install(t){let n=()=>{};t.directive("outclick",{mounted(r,s){const{value:i}=s;n=o=>{o.composedPath().includes(r)||i()},window.addEventListener("click",n,{capture:!0})},unmounted(){window.removeEventListener("click",n,{capture:!0})}}),t.directive("autoheight",{mounted(r){if(!r)return;const s=document.createElement("p"),i=getComputedStyle(r);s.style.fontSize=i.fontSize,s.style.fontWeight=i.fontWeight,s.style.lineHeight=i.lineHeight,s.style.fontFamily=i.fontFamily,s.style.fontStyle=i.fontStyle,s.style.fontStretch=i.fontStretch,s.style.margin=i.margin,s.style.padding=i.padding,s.style.border=i.border,s.style.outline=i.outline,document.body.append(s);let o=0;const a=c=>{s.innerText=c.target.value;const l=c.target.value.length;let u;c.inputType==="insertLineBreak"||o>l?u=r.scrollHeight:(u=s.offsetHeight,console.log(u)),r.style.height=`${u>42?u:42}px`,o=l};r.addEventListener("input",a)}}),t.directive("focus",{mounted(r){r.focus()},beforeUnmount(){}})}}const wm=Jy(mS);wm.use(nv()).use(gS);wm.mount("#app");
