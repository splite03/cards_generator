var Am=Object.defineProperty;var bm=(e,t,n)=>t in e?Am(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Z=(e,t,n)=>(bm(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();/**
* @vue/shared v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function lc(e,t){const n=new Set(e.split(","));return t?r=>n.has(r.toLowerCase()):r=>n.has(r)}const _t={},cr=[],_e=()=>{},Rm=()=>!1,zi=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),uc=e=>e.startsWith("onUpdate:"),Kt=Object.assign,hc=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},Sm=Object.prototype.hasOwnProperty,at=(e,t)=>Sm.call(e,t),K=Array.isArray,lr=e=>Ss(e)==="[object Map]",bh=e=>Ss(e)==="[object Set]",Cm=e=>Ss(e)==="[object RegExp]",Y=e=>typeof e=="function",Ct=e=>typeof e=="string",Sr=e=>typeof e=="symbol",Tt=e=>e!==null&&typeof e=="object",Rh=e=>(Tt(e)||Y(e))&&Y(e.then)&&Y(e.catch),Sh=Object.prototype.toString,Ss=e=>Sh.call(e),Pm=e=>Ss(e).slice(8,-1),Ch=e=>Ss(e)==="[object Object]",fc=e=>Ct(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Qr=lc(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),qi=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},Vm=/-(\w)/g,Ue=qi(e=>e.replace(Vm,(t,n)=>n?n.toUpperCase():"")),Dm=/\B([A-Z])/g,Cr=qi(e=>e.replace(Dm,"-$1").toLowerCase()),Hi=qi(e=>e.charAt(0).toUpperCase()+e.slice(1)),$o=qi(e=>e?`on${Hi(e)}`:""),gn=(e,t)=>!Object.is(e,t),ur=(e,t)=>{for(let n=0;n<e.length;n++)e[n](t)},gi=(e,t,n)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:n})},va=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let Ml;const Ph=()=>Ml||(Ml=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function pe(e){if(K(e)){const t={};for(let n=0;n<e.length;n++){const r=e[n],s=Ct(r)?Om(r):pe(r);if(s)for(const i in s)t[i]=s[i]}return t}else if(Ct(e)||Tt(e))return e}const xm=/;(?![^(]*\))/g,km=/:([^]+)/,Nm=/\/\*[^]*?\*\//g;function Om(e){const t={};return e.replace(Nm,"").split(xm).forEach(n=>{if(n){const r=n.split(km);r.length>1&&(t[r[0].trim()]=r[1].trim())}}),t}function Ft(e){let t="";if(Ct(e))t=e;else if(K(e))for(let n=0;n<e.length;n++){const r=Ft(e[n]);r&&(t+=r+" ")}else if(Tt(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}const Mm="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Lm=lc(Mm);function Vh(e){return!!e||e===""}const Ve=e=>Ct(e)?e:e==null?"":K(e)||Tt(e)&&(e.toString===Sh||!Y(e.toString))?JSON.stringify(e,Dh,2):String(e),Dh=(e,t)=>t&&t.__v_isRef?Dh(e,t.value):lr(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[r,s],i)=>(n[jo(r,i)+" =>"]=s,n),{})}:bh(t)?{[`Set(${t.size})`]:[...t.values()].map(n=>jo(n))}:Sr(t)?jo(t):Tt(t)&&!K(t)&&!Ch(t)?String(t):t,jo=(e,t="")=>{var n;return Sr(e)?`Symbol(${(n=e.description)!=null?n:t})`:e};/**
* @vue/reactivity v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Te;class xh{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this.parent=Te,!t&&Te&&(this.index=(Te.scopes||(Te.scopes=[])).push(this)-1)}get active(){return this._active}run(t){if(this._active){const n=Te;try{return Te=this,t()}finally{Te=n}}}on(){Te=this}off(){Te=this.parent}stop(t){if(this._active){let n,r;for(n=0,r=this.effects.length;n<r;n++)this.effects[n].stop();for(n=0,r=this.cleanups.length;n<r;n++)this.cleanups[n]();if(this.scopes)for(n=0,r=this.scopes.length;n<r;n++)this.scopes[n].stop(!0);if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0,this._active=!1}}}function Fm(e){return new xh(e)}function Um(e,t=Te){t&&t.active&&t.effects.push(e)}function Bm(){return Te}let Mn;class dc{constructor(t,n,r,s){this.fn=t,this.trigger=n,this.scheduler=r,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,Um(this,s)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,Wn();for(let t=0;t<this._depsLength;t++){const n=this.deps[t];if(n.computed&&($m(n.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),Gn()}return this._dirtyLevel>=4}set dirty(t){this._dirtyLevel=t?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let t=un,n=Mn;try{return un=!0,Mn=this,this._runnings++,Ll(this),this.fn()}finally{Fl(this),this._runnings--,Mn=n,un=t}}stop(){var t;this.active&&(Ll(this),Fl(this),(t=this.onStop)==null||t.call(this),this.active=!1)}}function $m(e){return e.value}function Ll(e){e._trackId++,e._depsLength=0}function Fl(e){if(e.deps.length>e._depsLength){for(let t=e._depsLength;t<e.deps.length;t++)kh(e.deps[t],e);e.deps.length=e._depsLength}}function kh(e,t){const n=e.get(t);n!==void 0&&t._trackId!==n&&(e.delete(t),e.size===0&&e.cleanup())}let un=!0,Ea=0;const Nh=[];function Wn(){Nh.push(un),un=!1}function Gn(){const e=Nh.pop();un=e===void 0?!0:e}function pc(){Ea++}function mc(){for(Ea--;!Ea&&Ta.length;)Ta.shift()()}function Oh(e,t,n){if(t.get(e)!==e._trackId){t.set(e,e._trackId);const r=e.deps[e._depsLength];r!==t?(r&&kh(r,e),e.deps[e._depsLength++]=t):e._depsLength++}}const Ta=[];function Mh(e,t,n){pc();for(const r of e.keys()){let s;r._dirtyLevel<t&&(s??(s=e.get(r)===r._trackId))&&(r._shouldSchedule||(r._shouldSchedule=r._dirtyLevel===0),r._dirtyLevel=t),r._shouldSchedule&&(s??(s=e.get(r)===r._trackId))&&(r.trigger(),(!r._runnings||r.allowRecurse)&&r._dirtyLevel!==2&&(r._shouldSchedule=!1,r.scheduler&&Ta.push(r.scheduler)))}mc()}const Lh=(e,t)=>{const n=new Map;return n.cleanup=e,n.computed=t,n},_i=new WeakMap,Ln=Symbol(""),wa=Symbol("");function oe(e,t,n){if(un&&Mn){let r=_i.get(e);r||_i.set(e,r=new Map);let s=r.get(n);s||r.set(n,s=Lh(()=>r.delete(n))),Oh(Mn,s)}}function We(e,t,n,r,s,i){const o=_i.get(e);if(!o)return;let a=[];if(t==="clear")a=[...o.values()];else if(n==="length"&&K(e)){const c=Number(r);o.forEach((l,u)=>{(u==="length"||!Sr(u)&&u>=c)&&a.push(l)})}else switch(n!==void 0&&a.push(o.get(n)),t){case"add":K(e)?fc(n)&&a.push(o.get("length")):(a.push(o.get(Ln)),lr(e)&&a.push(o.get(wa)));break;case"delete":K(e)||(a.push(o.get(Ln)),lr(e)&&a.push(o.get(wa)));break;case"set":lr(e)&&a.push(o.get(Ln));break}pc();for(const c of a)c&&Mh(c,4);mc()}function jm(e,t){var n;return(n=_i.get(e))==null?void 0:n.get(t)}const zm=lc("__proto__,__v_isRef,__isVue"),Fh=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Sr)),Ul=qm();function qm(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...n){const r=lt(this);for(let i=0,o=this.length;i<o;i++)oe(r,"get",i+"");const s=r[t](...n);return s===-1||s===!1?r[t](...n.map(lt)):s}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...n){Wn(),pc();const r=lt(this)[t].apply(this,n);return mc(),Gn(),r}}),e}function Hm(e){const t=lt(this);return oe(t,"has",e),t.hasOwnProperty(e)}class Uh{constructor(t=!1,n=!1){this._isReadonly=t,this._isShallow=n}get(t,n,r){const s=this._isReadonly,i=this._isShallow;if(n==="__v_isReactive")return!s;if(n==="__v_isReadonly")return s;if(n==="__v_isShallow")return i;if(n==="__v_raw")return r===(s?i?sg:zh:i?jh:$h).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(r)?t:void 0;const o=K(t);if(!s){if(o&&at(Ul,n))return Reflect.get(Ul,n,r);if(n==="hasOwnProperty")return Hm}const a=Reflect.get(t,n,r);return(Sr(n)?Fh.has(n):zm(n))||(s||oe(t,"get",n),i)?a:Zt(a)?o&&fc(n)?a:a.value:Tt(a)?s?qh(a):yc(a):a}}class Bh extends Uh{constructor(t=!1){super(!1,t)}set(t,n,r,s){let i=t[n];if(!this._isShallow){const c=_r(i);if(!yi(r)&&!_r(r)&&(i=lt(i),r=lt(r)),!K(t)&&Zt(i)&&!Zt(r))return c?!1:(i.value=r,!0)}const o=K(t)&&fc(n)?Number(n)<t.length:at(t,n),a=Reflect.set(t,n,r,s);return t===lt(s)&&(o?gn(r,i)&&We(t,"set",n,r):We(t,"add",n,r)),a}deleteProperty(t,n){const r=at(t,n);t[n];const s=Reflect.deleteProperty(t,n);return s&&r&&We(t,"delete",n,void 0),s}has(t,n){const r=Reflect.has(t,n);return(!Sr(n)||!Fh.has(n))&&oe(t,"has",n),r}ownKeys(t){return oe(t,"iterate",K(t)?"length":Ln),Reflect.ownKeys(t)}}class Km extends Uh{constructor(t=!1){super(!0,t)}set(t,n){return!0}deleteProperty(t,n){return!0}}const Wm=new Bh,Gm=new Km,Qm=new Bh(!0),gc=e=>e,Ki=e=>Reflect.getPrototypeOf(e);function Ws(e,t,n=!1,r=!1){e=e.__v_raw;const s=lt(e),i=lt(t);n||(gn(t,i)&&oe(s,"get",t),oe(s,"get",i));const{has:o}=Ki(s),a=r?gc:n?Tc:os;if(o.call(s,t))return a(e.get(t));if(o.call(s,i))return a(e.get(i));e!==s&&e.get(t)}function Gs(e,t=!1){const n=this.__v_raw,r=lt(n),s=lt(e);return t||(gn(e,s)&&oe(r,"has",e),oe(r,"has",s)),e===s?n.has(e):n.has(e)||n.has(s)}function Qs(e,t=!1){return e=e.__v_raw,!t&&oe(lt(e),"iterate",Ln),Reflect.get(e,"size",e)}function Bl(e){e=lt(e);const t=lt(this);return Ki(t).has.call(t,e)||(t.add(e),We(t,"add",e,e)),this}function $l(e,t){t=lt(t);const n=lt(this),{has:r,get:s}=Ki(n);let i=r.call(n,e);i||(e=lt(e),i=r.call(n,e));const o=s.call(n,e);return n.set(e,t),i?gn(t,o)&&We(n,"set",e,t):We(n,"add",e,t),this}function jl(e){const t=lt(this),{has:n,get:r}=Ki(t);let s=n.call(t,e);s||(e=lt(e),s=n.call(t,e)),r&&r.call(t,e);const i=t.delete(e);return s&&We(t,"delete",e,void 0),i}function zl(){const e=lt(this),t=e.size!==0,n=e.clear();return t&&We(e,"clear",void 0,void 0),n}function Xs(e,t){return function(r,s){const i=this,o=i.__v_raw,a=lt(o),c=t?gc:e?Tc:os;return!e&&oe(a,"iterate",Ln),o.forEach((l,u)=>r.call(s,c(l),c(u),i))}}function Ys(e,t,n){return function(...r){const s=this.__v_raw,i=lt(s),o=lr(i),a=e==="entries"||e===Symbol.iterator&&o,c=e==="keys"&&o,l=s[e](...r),u=n?gc:t?Tc:os;return!t&&oe(i,"iterate",c?wa:Ln),{next(){const{value:h,done:f}=l.next();return f?{value:h,done:f}:{value:a?[u(h[0]),u(h[1])]:u(h),done:f}},[Symbol.iterator](){return this}}}}function sn(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function Xm(){const e={get(i){return Ws(this,i)},get size(){return Qs(this)},has:Gs,add:Bl,set:$l,delete:jl,clear:zl,forEach:Xs(!1,!1)},t={get(i){return Ws(this,i,!1,!0)},get size(){return Qs(this)},has:Gs,add:Bl,set:$l,delete:jl,clear:zl,forEach:Xs(!1,!0)},n={get(i){return Ws(this,i,!0)},get size(){return Qs(this,!0)},has(i){return Gs.call(this,i,!0)},add:sn("add"),set:sn("set"),delete:sn("delete"),clear:sn("clear"),forEach:Xs(!0,!1)},r={get(i){return Ws(this,i,!0,!0)},get size(){return Qs(this,!0)},has(i){return Gs.call(this,i,!0)},add:sn("add"),set:sn("set"),delete:sn("delete"),clear:sn("clear"),forEach:Xs(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(i=>{e[i]=Ys(i,!1,!1),n[i]=Ys(i,!0,!1),t[i]=Ys(i,!1,!0),r[i]=Ys(i,!0,!0)}),[e,n,t,r]}const[Ym,Jm,Zm,tg]=Xm();function _c(e,t){const n=t?e?tg:Zm:e?Jm:Ym;return(r,s,i)=>s==="__v_isReactive"?!e:s==="__v_isReadonly"?e:s==="__v_raw"?r:Reflect.get(at(n,s)&&s in r?n:r,s,i)}const eg={get:_c(!1,!1)},ng={get:_c(!1,!0)},rg={get:_c(!0,!1)},$h=new WeakMap,jh=new WeakMap,zh=new WeakMap,sg=new WeakMap;function ig(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function og(e){return e.__v_skip||!Object.isExtensible(e)?0:ig(Pm(e))}function yc(e){return _r(e)?e:vc(e,!1,Wm,eg,$h)}function ag(e){return vc(e,!1,Qm,ng,jh)}function qh(e){return vc(e,!0,Gm,rg,zh)}function vc(e,t,n,r,s){if(!Tt(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const i=s.get(e);if(i)return i;const o=og(e);if(o===0)return e;const a=new Proxy(e,o===2?r:n);return s.set(e,a),a}function hr(e){return _r(e)?hr(e.__v_raw):!!(e&&e.__v_isReactive)}function _r(e){return!!(e&&e.__v_isReadonly)}function yi(e){return!!(e&&e.__v_isShallow)}function Hh(e){return hr(e)||_r(e)}function lt(e){const t=e&&e.__v_raw;return t?lt(t):e}function Ec(e){return Object.isExtensible(e)&&gi(e,"__v_skip",!0),e}const os=e=>Tt(e)?yc(e):e,Tc=e=>Tt(e)?qh(e):e;class Kh{constructor(t,n,r,s){this.getter=t,this._setter=n,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new dc(()=>t(this._value),()=>li(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!s,this.__v_isReadonly=r}get value(){const t=lt(this);return(!t._cacheable||t.effect.dirty)&&gn(t._value,t._value=t.effect.run())&&li(t,4),Wh(t),t.effect._dirtyLevel>=2&&li(t,2),t._value}set value(t){this._setter(t)}get _dirty(){return this.effect.dirty}set _dirty(t){this.effect.dirty=t}}function cg(e,t,n=!1){let r,s;const i=Y(e);return i?(r=e,s=_e):(r=e.get,s=e.set),new Kh(r,s,i||!s,n)}function Wh(e){var t;un&&Mn&&(e=lt(e),Oh(Mn,(t=e.dep)!=null?t:e.dep=Lh(()=>e.dep=void 0,e instanceof Kh?e:void 0)))}function li(e,t=4,n){e=lt(e);const r=e.dep;r&&Mh(r,t)}function Zt(e){return!!(e&&e.__v_isRef===!0)}function ft(e){return lg(e,!1)}function lg(e,t){return Zt(e)?e:new ug(e,t)}class ug{constructor(t,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?t:lt(t),this._value=n?t:os(t)}get value(){return Wh(this),this._value}set value(t){const n=this.__v_isShallow||yi(t)||_r(t);t=n?t:lt(t),gn(t,this._rawValue)&&(this._rawValue=t,this._value=n?t:os(t),li(this,4))}}function tt(e){return Zt(e)?e.value:e}const hg={get:(e,t,n)=>tt(Reflect.get(e,t,n)),set:(e,t,n,r)=>{const s=e[t];return Zt(s)&&!Zt(n)?(s.value=n,!0):Reflect.set(e,t,n,r)}};function Gh(e){return hr(e)?e:new Proxy(e,hg)}function Qh(e){const t=K(e)?new Array(e.length):{};for(const n in e)t[n]=Yh(e,n);return t}class fg{constructor(t,n,r){this._object=t,this._key=n,this._defaultValue=r,this.__v_isRef=!0}get value(){const t=this._object[this._key];return t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}get dep(){return jm(lt(this._object),this._key)}}class dg{constructor(t){this._getter=t,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function Xh(e,t,n){return Zt(e)?e:Y(e)?new dg(e):Tt(e)&&arguments.length>1?Yh(e,t,n):ft(e)}function Yh(e,t,n){const r=e[t];return Zt(r)?r:new fg(e,t,n)}/**
* @vue/runtime-core v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function hn(e,t,n,r){try{return r?e(...r):e()}catch(s){Wi(s,t,n)}}function Ae(e,t,n,r){if(Y(e)){const i=hn(e,t,n,r);return i&&Rh(i)&&i.catch(o=>{Wi(o,t,n)}),i}const s=[];for(let i=0;i<e.length;i++)s.push(Ae(e[i],t,n,r));return s}function Wi(e,t,n,r=!0){const s=t?t.vnode:null;if(t){let i=t.parent;const o=t.proxy,a=`https://vuejs.org/error-reference/#runtime-${n}`;for(;i;){const l=i.ec;if(l){for(let u=0;u<l.length;u++)if(l[u](e,o,a)===!1)return}i=i.parent}const c=t.appContext.config.errorHandler;if(c){hn(c,null,10,[e,o,a]);return}}pg(e,n,s,r)}function pg(e,t,n,r=!0){console.error(e)}let as=!1,Ia=!1;const Xt=[];let ke=0;const fr=[];let on=null,Pn=0;const Jh=Promise.resolve();let wc=null;function mg(e){const t=wc||Jh;return e?t.then(this?e.bind(this):e):t}function gg(e){let t=ke+1,n=Xt.length;for(;t<n;){const r=t+n>>>1,s=Xt[r],i=cs(s);i<e||i===e&&s.pre?t=r+1:n=r}return t}function Ic(e){(!Xt.length||!Xt.includes(e,as&&e.allowRecurse?ke+1:ke))&&(e.id==null?Xt.push(e):Xt.splice(gg(e.id),0,e),Zh())}function Zh(){!as&&!Ia&&(Ia=!0,wc=Jh.then(ef))}function _g(e){const t=Xt.indexOf(e);t>ke&&Xt.splice(t,1)}function yg(e){K(e)?fr.push(...e):(!on||!on.includes(e,e.allowRecurse?Pn+1:Pn))&&fr.push(e),Zh()}function ql(e,t,n=as?ke+1:0){for(;n<Xt.length;n++){const r=Xt[n];if(r&&r.pre){if(e&&r.id!==e.uid)continue;Xt.splice(n,1),n--,r()}}}function tf(e){if(fr.length){const t=[...new Set(fr)].sort((n,r)=>cs(n)-cs(r));if(fr.length=0,on){on.push(...t);return}for(on=t,Pn=0;Pn<on.length;Pn++)on[Pn]();on=null,Pn=0}}const cs=e=>e.id==null?1/0:e.id,vg=(e,t)=>{const n=cs(e)-cs(t);if(n===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return n};function ef(e){Ia=!1,as=!0,Xt.sort(vg);try{for(ke=0;ke<Xt.length;ke++){const t=Xt[ke];t&&t.active!==!1&&hn(t,null,14)}}finally{ke=0,Xt.length=0,tf(),as=!1,wc=null,(Xt.length||fr.length)&&ef()}}function Eg(e,t,...n){if(e.isUnmounted)return;const r=e.vnode.props||_t;let s=n;const i=t.startsWith("update:"),o=i&&t.slice(7);if(o&&o in r){const u=`${o==="modelValue"?"model":o}Modifiers`,{number:h,trim:f}=r[u]||_t;f&&(s=n.map(m=>Ct(m)?m.trim():m)),h&&(s=n.map(va))}let a,c=r[a=$o(t)]||r[a=$o(Ue(t))];!c&&i&&(c=r[a=$o(Cr(t))]),c&&Ae(c,e,6,s);const l=r[a+"Once"];if(l){if(!e.emitted)e.emitted={};else if(e.emitted[a])return;e.emitted[a]=!0,Ae(l,e,6,s)}}function nf(e,t,n=!1){const r=t.emitsCache,s=r.get(e);if(s!==void 0)return s;const i=e.emits;let o={},a=!1;if(!Y(e)){const c=l=>{const u=nf(l,t,!0);u&&(a=!0,Kt(o,u))};!n&&t.mixins.length&&t.mixins.forEach(c),e.extends&&c(e.extends),e.mixins&&e.mixins.forEach(c)}return!i&&!a?(Tt(e)&&r.set(e,null),null):(K(i)?i.forEach(c=>o[c]=null):Kt(o,i),Tt(e)&&r.set(e,o),o)}function Gi(e,t){return!e||!zi(t)?!1:(t=t.slice(2).replace(/Once$/,""),at(e,t[0].toLowerCase()+t.slice(1))||at(e,Cr(t))||at(e,t))}let re=null,Qi=null;function vi(e){const t=re;return re=e,Qi=e&&e.type.__scopeId||null,t}function Tg(e){Qi=e}function wg(){Qi=null}function Ig(e,t=re,n){if(!t||e._n)return e;const r=(...s)=>{r._d&&eu(-1);const i=vi(t);let o;try{o=e(...s)}finally{vi(i),r._d&&eu(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function zo(e){const{type:t,vnode:n,proxy:r,withProxy:s,props:i,propsOptions:[o],slots:a,attrs:c,emit:l,render:u,renderCache:h,data:f,setupState:m,ctx:R,inheritAttrs:T}=e;let w,L;const v=vi(e);try{if(n.shapeFlag&4){const _=s||r,q=_;w=De(u.call(q,_,h,i,m,f,R)),L=c}else{const _=t;w=De(_.length>1?_(i,{attrs:c,slots:a,emit:l}):_(i,null)),L=t.props?c:Ag(c)}}catch(_){Zr.length=0,Wi(_,e,1),w=ne($n)}let y=w;if(L&&T!==!1){const _=Object.keys(L),{shapeFlag:q}=y;_.length&&q&7&&(o&&_.some(uc)&&(L=bg(L,o)),y=jn(y,L))}return n.dirs&&(y=jn(y),y.dirs=y.dirs?y.dirs.concat(n.dirs):n.dirs),n.transition&&(y.transition=n.transition),w=y,vi(v),w}const Ag=e=>{let t;for(const n in e)(n==="class"||n==="style"||zi(n))&&((t||(t={}))[n]=e[n]);return t},bg=(e,t)=>{const n={};for(const r in e)(!uc(r)||!(r.slice(9)in t))&&(n[r]=e[r]);return n};function Rg(e,t,n){const{props:r,children:s,component:i}=e,{props:o,children:a,patchFlag:c}=t,l=i.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&c>=0){if(c&1024)return!0;if(c&16)return r?Hl(r,o,l):!!o;if(c&8){const u=t.dynamicProps;for(let h=0;h<u.length;h++){const f=u[h];if(o[f]!==r[f]&&!Gi(l,f))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?Hl(r,o,l):!0:!!o;return!1}function Hl(e,t,n){const r=Object.keys(t);if(r.length!==Object.keys(e).length)return!0;for(let s=0;s<r.length;s++){const i=r[s];if(t[i]!==e[i]&&!Gi(n,i))return!0}return!1}function Sg({vnode:e,parent:t},n){for(;t;){const r=t.subTree;if(r.suspense&&r.suspense.activeBranch===e&&(r.el=e.el),r===e)(e=t.vnode).el=n,t=t.parent;else break}}const Cg="components",Pg="directives",Vg=Symbol.for("v-ndc");function rf(e){return Dg(Pg,e)}function Dg(e,t,n=!0,r=!1){const s=re||jt;if(s){const i=s.type;if(e===Cg){const a=Da(i,!1);if(a&&(a===t||a===Ue(t)||a===Hi(Ue(t))))return i}const o=Kl(s[e]||i[e],t)||Kl(s.appContext[e],t);return!o&&r?i:o}}function Kl(e,t){return e&&(e[t]||e[Ue(t)]||e[Hi(Ue(t))])}const sf=e=>e.__isSuspense;function xg(e,t){t&&t.pendingBranch?K(e)?t.effects.push(...e):t.effects.push(e):yg(e)}const kg=Symbol.for("v-scx"),Ng=()=>Un(kg),Js={};function Fn(e,t,n){return of(e,t,n)}function of(e,t,{immediate:n,deep:r,flush:s,once:i,onTrack:o,onTrigger:a}=_t){if(t&&i){const S=t;t=(...D)=>{S(...D),q()}}const c=jt,l=S=>r===!0?S:Dn(S,r===!1?1:void 0);let u,h=!1,f=!1;if(Zt(e)?(u=()=>e.value,h=yi(e)):hr(e)?(u=()=>l(e),h=!0):K(e)?(f=!0,h=e.some(S=>hr(S)||yi(S)),u=()=>e.map(S=>{if(Zt(S))return S.value;if(hr(S))return l(S);if(Y(S))return hn(S,c,2)})):Y(e)?t?u=()=>hn(e,c,2):u=()=>(m&&m(),Ae(e,c,3,[R])):u=_e,t&&r){const S=u;u=()=>Dn(S())}let m,R=S=>{m=y.onStop=()=>{hn(S,c,4),m=y.onStop=void 0}},T;if(Zi)if(R=_e,t?n&&Ae(t,c,3,[u(),f?[]:void 0,R]):u(),s==="sync"){const S=Ng();T=S.__watcherHandles||(S.__watcherHandles=[])}else return _e;let w=f?new Array(e.length).fill(Js):Js;const L=()=>{if(!(!y.active||!y.dirty))if(t){const S=y.run();(r||h||(f?S.some((D,U)=>gn(D,w[U])):gn(S,w)))&&(m&&m(),Ae(t,c,3,[S,w===Js?void 0:f&&w[0]===Js?[]:w,R]),w=S)}else y.run()};L.allowRecurse=!!t;let v;s==="sync"?v=L:s==="post"?v=()=>Ut(L,c&&c.suspense):(L.pre=!0,c&&(L.id=c.uid),v=()=>Ic(L));const y=new dc(u,_e,v),_=Bm(),q=()=>{y.stop(),_&&hc(_.effects,y)};return t?n?L():w=y.run():s==="post"?Ut(y.run.bind(y),c&&c.suspense):y.run(),T&&T.push(q),q}function Og(e,t,n){const r=this.proxy,s=Ct(e)?e.includes(".")?af(r,e):()=>r[e]:e.bind(r,r);let i;Y(t)?i=t:(i=t.handler,n=t);const o=Cs(this),a=of(s,i.bind(r),n);return o(),a}function af(e,t){const n=t.split(".");return()=>{let r=e;for(let s=0;s<n.length&&r;s++)r=r[n[s]];return r}}function Dn(e,t,n=0,r){if(!Tt(e)||e.__v_skip)return e;if(t&&t>0){if(n>=t)return e;n++}if(r=r||new Set,r.has(e))return e;if(r.add(e),Zt(e))Dn(e.value,t,n,r);else if(K(e))for(let s=0;s<e.length;s++)Dn(e[s],t,n,r);else if(bh(e)||lr(e))e.forEach(s=>{Dn(s,t,n,r)});else if(Ch(e))for(const s in e)Dn(e[s],t,n,r);return e}function or(e,t){if(re===null)return e;const n=to(re)||re.proxy,r=e.dirs||(e.dirs=[]);for(let s=0;s<t.length;s++){let[i,o,a,c=_t]=t[s];i&&(Y(i)&&(i={mounted:i,updated:i}),i.deep&&Dn(o),r.push({dir:i,instance:n,value:o,oldValue:void 0,arg:a,modifiers:c}))}return e}function bn(e,t,n,r){const s=e.dirs,i=t&&t.dirs;for(let o=0;o<s.length;o++){const a=s[o];i&&(a.oldValue=i[o].value);let c=a.dir[r];c&&(Wn(),Ae(c,n,8,[e.el,a,e,t]),Gn())}}function cf(e,t){e.shapeFlag&6&&e.component?cf(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}/*! #__NO_SIDE_EFFECTS__ */function Je(e,t){return Y(e)?Kt({name:e.name},t,{setup:e}):e}const Xr=e=>!!e.type.__asyncLoader,lf=e=>e.type.__isKeepAlive,Mg={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(e,{slots:t}){const n=y_(),r=n.ctx;if(!r.renderer)return()=>{const v=t.default&&t.default();return v&&v.length===1?v[0]:v};const s=new Map,i=new Set;let o=null;const a=n.suspense,{renderer:{p:c,m:l,um:u,o:{createElement:h}}}=r,f=h("div");r.activate=(v,y,_,q,S)=>{const D=v.component;l(v,y,_,0,a),c(D.vnode,v,y,_,D,a,q,v.slotScopeIds,S),Ut(()=>{D.isDeactivated=!1,D.a&&ur(D.a);const U=v.props&&v.props.onVnodeMounted;U&&de(U,D.parent,v)},a)},r.deactivate=v=>{const y=v.component;l(v,f,null,1,a),Ut(()=>{y.da&&ur(y.da);const _=v.props&&v.props.onVnodeUnmounted;_&&de(_,y.parent,v),y.isDeactivated=!0},a)};function m(v){qo(v),u(v,n,a,!0)}function R(v){s.forEach((y,_)=>{const q=Da(y.type);q&&(!v||!v(q))&&T(_)})}function T(v){const y=s.get(v);!o||!er(y,o)?m(y):o&&qo(o),s.delete(v),i.delete(v)}Fn(()=>[e.include,e.exclude],([v,y])=>{v&&R(_=>zr(v,_)),y&&R(_=>!zr(y,_))},{flush:"post",deep:!0});let w=null;const L=()=>{w!=null&&s.set(w,Ho(n.subTree))};return Ac(L),hf(L),ff(()=>{s.forEach(v=>{const{subTree:y,suspense:_}=n,q=Ho(y);if(v.type===q.type&&v.key===q.key){qo(q);const S=q.component.da;S&&Ut(S,_);return}m(v)})}),()=>{if(w=null,!t.default)return null;const v=t.default(),y=v[0];if(v.length>1)return o=null,v;if(!Af(y)||!(y.shapeFlag&4)&&!(y.shapeFlag&128))return o=null,y;let _=Ho(y);const q=_.type,S=Da(Xr(_)?_.type.__asyncResolved||{}:q),{include:D,exclude:U,max:nt}=e;if(D&&(!S||!zr(D,S))||U&&S&&zr(U,S))return o=_,y;const et=_.key==null?q:_.key,At=s.get(et);return _.el&&(_=jn(_),y.shapeFlag&128&&(y.ssContent=_)),w=et,At?(_.el=At.el,_.component=At.component,_.transition&&cf(_,_.transition),_.shapeFlag|=512,i.delete(et),i.add(et)):(i.add(et),nt&&i.size>parseInt(nt,10)&&T(i.values().next().value)),_.shapeFlag|=256,o=_,sf(y.type)?y:_}}},Lg=Mg;function zr(e,t){return K(e)?e.some(n=>zr(n,t)):Ct(e)?e.split(",").includes(t):Cm(e)?e.test(t):!1}function Fg(e,t){uf(e,"a",t)}function Ug(e,t){uf(e,"da",t)}function uf(e,t,n=jt){const r=e.__wdc||(e.__wdc=()=>{let s=n;for(;s;){if(s.isDeactivated)return;s=s.parent}return e()});if(Xi(t,r,n),n){let s=n.parent;for(;s&&s.parent;)lf(s.parent.vnode)&&Bg(r,t,n,s),s=s.parent}}function Bg(e,t,n,r){const s=Xi(t,e,r,!0);df(()=>{hc(r[t],s)},n)}function qo(e){e.shapeFlag&=-257,e.shapeFlag&=-513}function Ho(e){return e.shapeFlag&128?e.ssContent:e}function Xi(e,t,n=jt,r=!1){if(n){const s=n[e]||(n[e]=[]),i=t.__weh||(t.__weh=(...o)=>{if(n.isUnmounted)return;Wn();const a=Cs(n),c=Ae(t,n,e,o);return a(),Gn(),c});return r?s.unshift(i):s.push(i),i}}const Ze=e=>(t,n=jt)=>(!Zi||e==="sp")&&Xi(e,(...r)=>t(...r),n),$g=Ze("bm"),Ac=Ze("m"),jg=Ze("bu"),hf=Ze("u"),ff=Ze("bum"),df=Ze("um"),zg=Ze("sp"),qg=Ze("rtg"),Hg=Ze("rtc");function Kg(e,t=jt){Xi("ec",e,t)}function fn(e,t,n,r){let s;const i=n&&n[r];if(K(e)||Ct(e)){s=new Array(e.length);for(let o=0,a=e.length;o<a;o++)s[o]=t(e[o],o,void 0,i&&i[o])}else if(typeof e=="number"){s=new Array(e);for(let o=0;o<e;o++)s[o]=t(o+1,o,void 0,i&&i[o])}else if(Tt(e))if(e[Symbol.iterator])s=Array.from(e,(o,a)=>t(o,a,void 0,i&&i[a]));else{const o=Object.keys(e);s=new Array(o.length);for(let a=0,c=o.length;a<c;a++){const l=o[a];s[a]=t(e[l],l,a,i&&i[a])}}else s=[];return n&&(n[r]=s),s}const Aa=e=>e?Sf(e)?to(e)||e.proxy:Aa(e.parent):null,Yr=Kt(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Aa(e.parent),$root:e=>Aa(e.root),$emit:e=>e.emit,$options:e=>bc(e),$forceUpdate:e=>e.f||(e.f=()=>{e.effect.dirty=!0,Ic(e.update)}),$nextTick:e=>e.n||(e.n=mg.bind(e.proxy)),$watch:e=>Og.bind(e)}),Ko=(e,t)=>e!==_t&&!e.__isScriptSetup&&at(e,t),Wg={get({_:e},t){const{ctx:n,setupState:r,data:s,props:i,accessCache:o,type:a,appContext:c}=e;let l;if(t[0]!=="$"){const m=o[t];if(m!==void 0)switch(m){case 1:return r[t];case 2:return s[t];case 4:return n[t];case 3:return i[t]}else{if(Ko(r,t))return o[t]=1,r[t];if(s!==_t&&at(s,t))return o[t]=2,s[t];if((l=e.propsOptions[0])&&at(l,t))return o[t]=3,i[t];if(n!==_t&&at(n,t))return o[t]=4,n[t];ba&&(o[t]=0)}}const u=Yr[t];let h,f;if(u)return t==="$attrs"&&oe(e,"get",t),u(e);if((h=a.__cssModules)&&(h=h[t]))return h;if(n!==_t&&at(n,t))return o[t]=4,n[t];if(f=c.config.globalProperties,at(f,t))return f[t]},set({_:e},t,n){const{data:r,setupState:s,ctx:i}=e;return Ko(s,t)?(s[t]=n,!0):r!==_t&&at(r,t)?(r[t]=n,!0):at(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(i[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:r,appContext:s,propsOptions:i}},o){let a;return!!n[o]||e!==_t&&at(e,o)||Ko(t,o)||(a=i[0])&&at(a,o)||at(r,o)||at(Yr,o)||at(s.config.globalProperties,o)},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:at(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function Wl(e){return K(e)?e.reduce((t,n)=>(t[n]=null,t),{}):e}let ba=!0;function Gg(e){const t=bc(e),n=e.proxy,r=e.ctx;ba=!1,t.beforeCreate&&Gl(t.beforeCreate,e,"bc");const{data:s,computed:i,methods:o,watch:a,provide:c,inject:l,created:u,beforeMount:h,mounted:f,beforeUpdate:m,updated:R,activated:T,deactivated:w,beforeDestroy:L,beforeUnmount:v,destroyed:y,unmounted:_,render:q,renderTracked:S,renderTriggered:D,errorCaptured:U,serverPrefetch:nt,expose:et,inheritAttrs:At,components:ve,directives:rn,filters:Lr}=t;if(l&&Qg(l,r,null),o)for(const wt in o){const mt=o[wt];Y(mt)&&(r[wt]=mt.bind(n))}if(s){const wt=s.call(n,n);Tt(wt)&&(e.data=yc(wt))}if(ba=!0,i)for(const wt in i){const mt=i[wt],In=Y(mt)?mt.bind(n,n):Y(mt.get)?mt.get.bind(n,n):_e,Hs=!Y(mt)&&Y(mt.set)?mt.set.bind(n):_e,An=kt({get:In,set:Hs});Object.defineProperty(r,wt,{enumerable:!0,configurable:!0,get:()=>An.value,set:Ce=>An.value=Ce})}if(a)for(const wt in a)pf(a[wt],r,n,wt);if(c){const wt=Y(c)?c.call(n):c;Reflect.ownKeys(wt).forEach(mt=>{Sa(mt,wt[mt])})}u&&Gl(u,e,"c");function Lt(wt,mt){K(mt)?mt.forEach(In=>wt(In.bind(n))):mt&&wt(mt.bind(n))}if(Lt($g,h),Lt(Ac,f),Lt(jg,m),Lt(hf,R),Lt(Fg,T),Lt(Ug,w),Lt(Kg,U),Lt(Hg,S),Lt(qg,D),Lt(ff,v),Lt(df,_),Lt(zg,nt),K(et))if(et.length){const wt=e.exposed||(e.exposed={});et.forEach(mt=>{Object.defineProperty(wt,mt,{get:()=>n[mt],set:In=>n[mt]=In})})}else e.exposed||(e.exposed={});q&&e.render===_e&&(e.render=q),At!=null&&(e.inheritAttrs=At),ve&&(e.components=ve),rn&&(e.directives=rn)}function Qg(e,t,n=_e){K(e)&&(e=Ra(e));for(const r in e){const s=e[r];let i;Tt(s)?"default"in s?i=Un(s.from||r,s.default,!0):i=Un(s.from||r):i=Un(s),Zt(i)?Object.defineProperty(t,r,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):t[r]=i}}function Gl(e,t,n){Ae(K(e)?e.map(r=>r.bind(t.proxy)):e.bind(t.proxy),t,n)}function pf(e,t,n,r){const s=r.includes(".")?af(n,r):()=>n[r];if(Ct(e)){const i=t[e];Y(i)&&Fn(s,i)}else if(Y(e))Fn(s,e.bind(n));else if(Tt(e))if(K(e))e.forEach(i=>pf(i,t,n,r));else{const i=Y(e.handler)?e.handler.bind(n):t[e.handler];Y(i)&&Fn(s,i,e)}}function bc(e){const t=e.type,{mixins:n,extends:r}=t,{mixins:s,optionsCache:i,config:{optionMergeStrategies:o}}=e.appContext,a=i.get(t);let c;return a?c=a:!s.length&&!n&&!r?c=t:(c={},s.length&&s.forEach(l=>Ei(c,l,o,!0)),Ei(c,t,o)),Tt(t)&&i.set(t,c),c}function Ei(e,t,n,r=!1){const{mixins:s,extends:i}=t;i&&Ei(e,i,n,!0),s&&s.forEach(o=>Ei(e,o,n,!0));for(const o in t)if(!(r&&o==="expose")){const a=Xg[o]||n&&n[o];e[o]=a?a(e[o],t[o]):t[o]}return e}const Xg={data:Ql,props:Xl,emits:Xl,methods:qr,computed:qr,beforeCreate:ee,created:ee,beforeMount:ee,mounted:ee,beforeUpdate:ee,updated:ee,beforeDestroy:ee,beforeUnmount:ee,destroyed:ee,unmounted:ee,activated:ee,deactivated:ee,errorCaptured:ee,serverPrefetch:ee,components:qr,directives:qr,watch:Jg,provide:Ql,inject:Yg};function Ql(e,t){return t?e?function(){return Kt(Y(e)?e.call(this,this):e,Y(t)?t.call(this,this):t)}:t:e}function Yg(e,t){return qr(Ra(e),Ra(t))}function Ra(e){if(K(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function ee(e,t){return e?[...new Set([].concat(e,t))]:t}function qr(e,t){return e?Kt(Object.create(null),e,t):t}function Xl(e,t){return e?K(e)&&K(t)?[...new Set([...e,...t])]:Kt(Object.create(null),Wl(e),Wl(t??{})):t}function Jg(e,t){if(!e)return t;if(!t)return e;const n=Kt(Object.create(null),e);for(const r in t)n[r]=ee(e[r],t[r]);return n}function mf(){return{app:null,config:{isNativeTag:Rm,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Zg=0;function t_(e,t){return function(r,s=null){Y(r)||(r=Kt({},r)),s!=null&&!Tt(s)&&(s=null);const i=mf(),o=new WeakSet;let a=!1;const c=i.app={_uid:Zg++,_component:r,_props:s,_container:null,_context:i,_instance:null,version:A_,get config(){return i.config},set config(l){},use(l,...u){return o.has(l)||(l&&Y(l.install)?(o.add(l),l.install(c,...u)):Y(l)&&(o.add(l),l(c,...u))),c},mixin(l){return i.mixins.includes(l)||i.mixins.push(l),c},component(l,u){return u?(i.components[l]=u,c):i.components[l]},directive(l,u){return u?(i.directives[l]=u,c):i.directives[l]},mount(l,u,h){if(!a){const f=ne(r,s);return f.appContext=i,h===!0?h="svg":h===!1&&(h=void 0),u&&t?t(f,l):e(f,l,h),a=!0,c._container=l,l.__vue_app__=c,to(f.component)||f.component.proxy}},unmount(){a&&(e(null,c._container),delete c._container.__vue_app__)},provide(l,u){return i.provides[l]=u,c},runWithContext(l){const u=Jr;Jr=c;try{return l()}finally{Jr=u}}};return c}}let Jr=null;function Sa(e,t){if(jt){let n=jt.provides;const r=jt.parent&&jt.parent.provides;r===n&&(n=jt.provides=Object.create(r)),n[e]=t}}function Un(e,t,n=!1){const r=jt||re;if(r||Jr){const s=r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:Jr._context.provides;if(s&&e in s)return s[e];if(arguments.length>1)return n&&Y(t)?t.call(r&&r.proxy):t}}function e_(e,t,n,r=!1){const s={},i={};gi(i,Ji,1),e.propsDefaults=Object.create(null),gf(e,t,s,i);for(const o in e.propsOptions[0])o in s||(s[o]=void 0);n?e.props=r?s:ag(s):e.type.props?e.props=s:e.props=i,e.attrs=i}function n_(e,t,n,r){const{props:s,attrs:i,vnode:{patchFlag:o}}=e,a=lt(s),[c]=e.propsOptions;let l=!1;if((r||o>0)&&!(o&16)){if(o&8){const u=e.vnode.dynamicProps;for(let h=0;h<u.length;h++){let f=u[h];if(Gi(e.emitsOptions,f))continue;const m=t[f];if(c)if(at(i,f))m!==i[f]&&(i[f]=m,l=!0);else{const R=Ue(f);s[R]=Ca(c,a,R,m,e,!1)}else m!==i[f]&&(i[f]=m,l=!0)}}}else{gf(e,t,s,i)&&(l=!0);let u;for(const h in a)(!t||!at(t,h)&&((u=Cr(h))===h||!at(t,u)))&&(c?n&&(n[h]!==void 0||n[u]!==void 0)&&(s[h]=Ca(c,a,h,void 0,e,!0)):delete s[h]);if(i!==a)for(const h in i)(!t||!at(t,h))&&(delete i[h],l=!0)}l&&We(e,"set","$attrs")}function gf(e,t,n,r){const[s,i]=e.propsOptions;let o=!1,a;if(t)for(let c in t){if(Qr(c))continue;const l=t[c];let u;s&&at(s,u=Ue(c))?!i||!i.includes(u)?n[u]=l:(a||(a={}))[u]=l:Gi(e.emitsOptions,c)||(!(c in r)||l!==r[c])&&(r[c]=l,o=!0)}if(i){const c=lt(n),l=a||_t;for(let u=0;u<i.length;u++){const h=i[u];n[h]=Ca(s,c,h,l[h],e,!at(l,h))}}return o}function Ca(e,t,n,r,s,i){const o=e[n];if(o!=null){const a=at(o,"default");if(a&&r===void 0){const c=o.default;if(o.type!==Function&&!o.skipFactory&&Y(c)){const{propsDefaults:l}=s;if(n in l)r=l[n];else{const u=Cs(s);r=l[n]=c.call(null,t),u()}}else r=c}o[0]&&(i&&!a?r=!1:o[1]&&(r===""||r===Cr(n))&&(r=!0))}return r}function _f(e,t,n=!1){const r=t.propsCache,s=r.get(e);if(s)return s;const i=e.props,o={},a=[];let c=!1;if(!Y(e)){const u=h=>{c=!0;const[f,m]=_f(h,t,!0);Kt(o,f),m&&a.push(...m)};!n&&t.mixins.length&&t.mixins.forEach(u),e.extends&&u(e.extends),e.mixins&&e.mixins.forEach(u)}if(!i&&!c)return Tt(e)&&r.set(e,cr),cr;if(K(i))for(let u=0;u<i.length;u++){const h=Ue(i[u]);Yl(h)&&(o[h]=_t)}else if(i)for(const u in i){const h=Ue(u);if(Yl(h)){const f=i[u],m=o[h]=K(f)||Y(f)?{type:f}:Kt({},f);if(m){const R=tu(Boolean,m.type),T=tu(String,m.type);m[0]=R>-1,m[1]=T<0||R<T,(R>-1||at(m,"default"))&&a.push(h)}}}const l=[o,a];return Tt(e)&&r.set(e,l),l}function Yl(e){return e[0]!=="$"&&!Qr(e)}function Jl(e){return e===null?"null":typeof e=="function"?e.name||"":typeof e=="object"&&e.constructor&&e.constructor.name||""}function Zl(e,t){return Jl(e)===Jl(t)}function tu(e,t){return K(t)?t.findIndex(n=>Zl(n,e)):Y(t)&&Zl(t,e)?0:-1}const yf=e=>e[0]==="_"||e==="$stable",Rc=e=>K(e)?e.map(De):[De(e)],r_=(e,t,n)=>{if(t._n)return t;const r=Ig((...s)=>Rc(t(...s)),n);return r._c=!1,r},vf=(e,t,n)=>{const r=e._ctx;for(const s in e){if(yf(s))continue;const i=e[s];if(Y(i))t[s]=r_(s,i,r);else if(i!=null){const o=Rc(i);t[s]=()=>o}}},Ef=(e,t)=>{const n=Rc(t);e.slots.default=()=>n},s_=(e,t)=>{if(e.vnode.shapeFlag&32){const n=t._;n?(e.slots=lt(t),gi(t,"_",n)):vf(t,e.slots={})}else e.slots={},t&&Ef(e,t);gi(e.slots,Ji,1)},i_=(e,t,n)=>{const{vnode:r,slots:s}=e;let i=!0,o=_t;if(r.shapeFlag&32){const a=t._;a?n&&a===1?i=!1:(Kt(s,t),!n&&a===1&&delete s._):(i=!t.$stable,vf(t,s)),o=t}else t&&(Ef(e,t),o={default:1});if(i)for(const a in s)!yf(a)&&o[a]==null&&delete s[a]};function Pa(e,t,n,r,s=!1){if(K(e)){e.forEach((f,m)=>Pa(f,t&&(K(t)?t[m]:t),n,r,s));return}if(Xr(r)&&!s)return;const i=r.shapeFlag&4?to(r.component)||r.component.proxy:r.el,o=s?null:i,{i:a,r:c}=e,l=t&&t.r,u=a.refs===_t?a.refs={}:a.refs,h=a.setupState;if(l!=null&&l!==c&&(Ct(l)?(u[l]=null,at(h,l)&&(h[l]=null)):Zt(l)&&(l.value=null)),Y(c))hn(c,a,12,[o,u]);else{const f=Ct(c),m=Zt(c);if(f||m){const R=()=>{if(e.f){const T=f?at(h,c)?h[c]:u[c]:c.value;s?K(T)&&hc(T,i):K(T)?T.includes(i)||T.push(i):f?(u[c]=[i],at(h,c)&&(h[c]=u[c])):(c.value=[i],e.k&&(u[e.k]=c.value))}else f?(u[c]=o,at(h,c)&&(h[c]=o)):m&&(c.value=o,e.k&&(u[e.k]=o))};o?(R.id=-1,Ut(R,n)):R()}}}const Ut=xg;function o_(e){return a_(e)}function a_(e,t){const n=Ph();n.__VUE__=!0;const{insert:r,remove:s,patchProp:i,createElement:o,createText:a,createComment:c,setText:l,setElementText:u,parentNode:h,nextSibling:f,setScopeId:m=_e,insertStaticContent:R}=e,T=(d,p,g,I=null,A=null,V=null,O=void 0,P=null,x=!!p.dynamicChildren)=>{if(d===p)return;d&&!er(d,p)&&(I=Ks(d),Ce(d,A,V,!0),d=null),p.patchFlag===-2&&(x=!1,p.dynamicChildren=null);const{type:C,ref:F,shapeFlag:z}=p;switch(C){case Yi:w(d,p,g,I);break;case $n:L(d,p,g,I);break;case Go:d==null&&v(p,g,I,O);break;case Pt:ve(d,p,g,I,A,V,O,P,x);break;default:z&1?q(d,p,g,I,A,V,O,P,x):z&6?rn(d,p,g,I,A,V,O,P,x):(z&64||z&128)&&C.process(d,p,g,I,A,V,O,P,x,Jn)}F!=null&&A&&Pa(F,d&&d.ref,V,p||d,!p)},w=(d,p,g,I)=>{if(d==null)r(p.el=a(p.children),g,I);else{const A=p.el=d.el;p.children!==d.children&&l(A,p.children)}},L=(d,p,g,I)=>{d==null?r(p.el=c(p.children||""),g,I):p.el=d.el},v=(d,p,g,I)=>{[d.el,d.anchor]=R(d.children,p,g,I,d.el,d.anchor)},y=({el:d,anchor:p},g,I)=>{let A;for(;d&&d!==p;)A=f(d),r(d,g,I),d=A;r(p,g,I)},_=({el:d,anchor:p})=>{let g;for(;d&&d!==p;)g=f(d),s(d),d=g;s(p)},q=(d,p,g,I,A,V,O,P,x)=>{p.type==="svg"?O="svg":p.type==="math"&&(O="mathml"),d==null?S(p,g,I,A,V,O,P,x):nt(d,p,A,V,O,P,x)},S=(d,p,g,I,A,V,O,P)=>{let x,C;const{props:F,shapeFlag:z,transition:$,dirs:G}=d;if(x=d.el=o(d.type,V,F&&F.is,F),z&8?u(x,d.children):z&16&&U(d.children,x,null,I,A,Wo(d,V),O,P),G&&bn(d,null,I,"created"),D(x,d,d.scopeId,O,I),F){for(const pt in F)pt!=="value"&&!Qr(pt)&&i(x,pt,null,F[pt],V,d.children,I,A,He);"value"in F&&i(x,"value",null,F.value,V),(C=F.onVnodeBeforeMount)&&de(C,I,d)}G&&bn(d,null,I,"beforeMount");const st=c_(A,$);st&&$.beforeEnter(x),r(x,p,g),((C=F&&F.onVnodeMounted)||st||G)&&Ut(()=>{C&&de(C,I,d),st&&$.enter(x),G&&bn(d,null,I,"mounted")},A)},D=(d,p,g,I,A)=>{if(g&&m(d,g),I)for(let V=0;V<I.length;V++)m(d,I[V]);if(A){let V=A.subTree;if(p===V){const O=A.vnode;D(d,O,O.scopeId,O.slotScopeIds,A.parent)}}},U=(d,p,g,I,A,V,O,P,x=0)=>{for(let C=x;C<d.length;C++){const F=d[C]=P?an(d[C]):De(d[C]);T(null,F,p,g,I,A,V,O,P)}},nt=(d,p,g,I,A,V,O)=>{const P=p.el=d.el;let{patchFlag:x,dynamicChildren:C,dirs:F}=p;x|=d.patchFlag&16;const z=d.props||_t,$=p.props||_t;let G;if(g&&Rn(g,!1),(G=$.onVnodeBeforeUpdate)&&de(G,g,p,d),F&&bn(p,d,g,"beforeUpdate"),g&&Rn(g,!0),C?et(d.dynamicChildren,C,P,g,I,Wo(p,A),V):O||mt(d,p,P,null,g,I,Wo(p,A),V,!1),x>0){if(x&16)At(P,p,z,$,g,I,A);else if(x&2&&z.class!==$.class&&i(P,"class",null,$.class,A),x&4&&i(P,"style",z.style,$.style,A),x&8){const st=p.dynamicProps;for(let pt=0;pt<st.length;pt++){const vt=st[pt],xt=z[vt],Ee=$[vt];(Ee!==xt||vt==="value")&&i(P,vt,xt,Ee,A,d.children,g,I,He)}}x&1&&d.children!==p.children&&u(P,p.children)}else!O&&C==null&&At(P,p,z,$,g,I,A);((G=$.onVnodeUpdated)||F)&&Ut(()=>{G&&de(G,g,p,d),F&&bn(p,d,g,"updated")},I)},et=(d,p,g,I,A,V,O)=>{for(let P=0;P<p.length;P++){const x=d[P],C=p[P],F=x.el&&(x.type===Pt||!er(x,C)||x.shapeFlag&70)?h(x.el):g;T(x,C,F,null,I,A,V,O,!0)}},At=(d,p,g,I,A,V,O)=>{if(g!==I){if(g!==_t)for(const P in g)!Qr(P)&&!(P in I)&&i(d,P,g[P],null,O,p.children,A,V,He);for(const P in I){if(Qr(P))continue;const x=I[P],C=g[P];x!==C&&P!=="value"&&i(d,P,C,x,O,p.children,A,V,He)}"value"in I&&i(d,"value",g.value,I.value,O)}},ve=(d,p,g,I,A,V,O,P,x)=>{const C=p.el=d?d.el:a(""),F=p.anchor=d?d.anchor:a("");let{patchFlag:z,dynamicChildren:$,slotScopeIds:G}=p;G&&(P=P?P.concat(G):G),d==null?(r(C,g,I),r(F,g,I),U(p.children||[],g,F,A,V,O,P,x)):z>0&&z&64&&$&&d.dynamicChildren?(et(d.dynamicChildren,$,g,A,V,O,P),(p.key!=null||A&&p===A.subTree)&&Tf(d,p,!0)):mt(d,p,g,F,A,V,O,P,x)},rn=(d,p,g,I,A,V,O,P,x)=>{p.slotScopeIds=P,d==null?p.shapeFlag&512?A.ctx.activate(p,g,I,O,x):Lr(p,g,I,A,V,O,x):qs(d,p,x)},Lr=(d,p,g,I,A,V,O)=>{const P=d.component=__(d,I,A);if(lf(d)&&(P.ctx.renderer=Jn),v_(P),P.asyncDep){if(A&&A.registerDep(P,Lt),!d.el){const x=P.subTree=ne($n);L(null,x,p,g)}}else Lt(P,d,p,g,A,V,O)},qs=(d,p,g)=>{const I=p.component=d.component;if(Rg(d,p,g))if(I.asyncDep&&!I.asyncResolved){wt(I,p,g);return}else I.next=p,_g(I.update),I.effect.dirty=!0,I.update();else p.el=d.el,I.vnode=p},Lt=(d,p,g,I,A,V,O)=>{const P=()=>{if(d.isMounted){let{next:F,bu:z,u:$,parent:G,vnode:st}=d;{const Zn=wf(d);if(Zn){F&&(F.el=st.el,wt(d,F,O)),Zn.asyncDep.then(()=>{d.isUnmounted||P()});return}}let pt=F,vt;Rn(d,!1),F?(F.el=st.el,wt(d,F,O)):F=st,z&&ur(z),(vt=F.props&&F.props.onVnodeBeforeUpdate)&&de(vt,G,F,st),Rn(d,!0);const xt=zo(d),Ee=d.subTree;d.subTree=xt,T(Ee,xt,h(Ee.el),Ks(Ee),d,A,V),F.el=xt.el,pt===null&&Sg(d,xt.el),$&&Ut($,A),(vt=F.props&&F.props.onVnodeUpdated)&&Ut(()=>de(vt,G,F,st),A)}else{let F;const{el:z,props:$}=p,{bm:G,m:st,parent:pt}=d,vt=Xr(p);if(Rn(d,!1),G&&ur(G),!vt&&(F=$&&$.onVnodeBeforeMount)&&de(F,pt,p),Rn(d,!0),z&&Bo){const xt=()=>{d.subTree=zo(d),Bo(z,d.subTree,d,A,null)};vt?p.type.__asyncLoader().then(()=>!d.isUnmounted&&xt()):xt()}else{const xt=d.subTree=zo(d);T(null,xt,g,I,d,A,V),p.el=xt.el}if(st&&Ut(st,A),!vt&&(F=$&&$.onVnodeMounted)){const xt=p;Ut(()=>de(F,pt,xt),A)}(p.shapeFlag&256||pt&&Xr(pt.vnode)&&pt.vnode.shapeFlag&256)&&d.a&&Ut(d.a,A),d.isMounted=!0,p=g=I=null}},x=d.effect=new dc(P,_e,()=>Ic(C),d.scope),C=d.update=()=>{x.dirty&&x.run()};C.id=d.uid,Rn(d,!0),C()},wt=(d,p,g)=>{p.component=d;const I=d.vnode.props;d.vnode=p,d.next=null,n_(d,p.props,I,g),i_(d,p.children,g),Wn(),ql(d),Gn()},mt=(d,p,g,I,A,V,O,P,x=!1)=>{const C=d&&d.children,F=d?d.shapeFlag:0,z=p.children,{patchFlag:$,shapeFlag:G}=p;if($>0){if($&128){Hs(C,z,g,I,A,V,O,P,x);return}else if($&256){In(C,z,g,I,A,V,O,P,x);return}}G&8?(F&16&&He(C,A,V),z!==C&&u(g,z)):F&16?G&16?Hs(C,z,g,I,A,V,O,P,x):He(C,A,V,!0):(F&8&&u(g,""),G&16&&U(z,g,I,A,V,O,P,x))},In=(d,p,g,I,A,V,O,P,x)=>{d=d||cr,p=p||cr;const C=d.length,F=p.length,z=Math.min(C,F);let $;for($=0;$<z;$++){const G=p[$]=x?an(p[$]):De(p[$]);T(d[$],G,g,null,A,V,O,P,x)}C>F?He(d,A,V,!0,!1,z):U(p,g,I,A,V,O,P,x,z)},Hs=(d,p,g,I,A,V,O,P,x)=>{let C=0;const F=p.length;let z=d.length-1,$=F-1;for(;C<=z&&C<=$;){const G=d[C],st=p[C]=x?an(p[C]):De(p[C]);if(er(G,st))T(G,st,g,null,A,V,O,P,x);else break;C++}for(;C<=z&&C<=$;){const G=d[z],st=p[$]=x?an(p[$]):De(p[$]);if(er(G,st))T(G,st,g,null,A,V,O,P,x);else break;z--,$--}if(C>z){if(C<=$){const G=$+1,st=G<F?p[G].el:I;for(;C<=$;)T(null,p[C]=x?an(p[C]):De(p[C]),g,st,A,V,O,P,x),C++}}else if(C>$)for(;C<=z;)Ce(d[C],A,V,!0),C++;else{const G=C,st=C,pt=new Map;for(C=st;C<=$;C++){const ce=p[C]=x?an(p[C]):De(p[C]);ce.key!=null&&pt.set(ce.key,C)}let vt,xt=0;const Ee=$-st+1;let Zn=!1,kl=0;const Fr=new Array(Ee);for(C=0;C<Ee;C++)Fr[C]=0;for(C=G;C<=z;C++){const ce=d[C];if(xt>=Ee){Ce(ce,A,V,!0);continue}let Pe;if(ce.key!=null)Pe=pt.get(ce.key);else for(vt=st;vt<=$;vt++)if(Fr[vt-st]===0&&er(ce,p[vt])){Pe=vt;break}Pe===void 0?Ce(ce,A,V,!0):(Fr[Pe-st]=C+1,Pe>=kl?kl=Pe:Zn=!0,T(ce,p[Pe],g,null,A,V,O,P,x),xt++)}const Nl=Zn?l_(Fr):cr;for(vt=Nl.length-1,C=Ee-1;C>=0;C--){const ce=st+C,Pe=p[ce],Ol=ce+1<F?p[ce+1].el:I;Fr[C]===0?T(null,Pe,g,Ol,A,V,O,P,x):Zn&&(vt<0||C!==Nl[vt]?An(Pe,g,Ol,2):vt--)}}},An=(d,p,g,I,A=null)=>{const{el:V,type:O,transition:P,children:x,shapeFlag:C}=d;if(C&6){An(d.component.subTree,p,g,I);return}if(C&128){d.suspense.move(p,g,I);return}if(C&64){O.move(d,p,g,Jn);return}if(O===Pt){r(V,p,g);for(let z=0;z<x.length;z++)An(x[z],p,g,I);r(d.anchor,p,g);return}if(O===Go){y(d,p,g);return}if(I!==2&&C&1&&P)if(I===0)P.beforeEnter(V),r(V,p,g),Ut(()=>P.enter(V),A);else{const{leave:z,delayLeave:$,afterLeave:G}=P,st=()=>r(V,p,g),pt=()=>{z(V,()=>{st(),G&&G()})};$?$(V,st,pt):pt()}else r(V,p,g)},Ce=(d,p,g,I=!1,A=!1)=>{const{type:V,props:O,ref:P,children:x,dynamicChildren:C,shapeFlag:F,patchFlag:z,dirs:$}=d;if(P!=null&&Pa(P,null,g,d,!0),F&256){p.ctx.deactivate(d);return}const G=F&1&&$,st=!Xr(d);let pt;if(st&&(pt=O&&O.onVnodeBeforeUnmount)&&de(pt,p,d),F&6)Im(d.component,g,I);else{if(F&128){d.suspense.unmount(g,I);return}G&&bn(d,null,p,"beforeUnmount"),F&64?d.type.remove(d,p,g,A,Jn,I):C&&(V!==Pt||z>0&&z&64)?He(C,p,g,!1,!0):(V===Pt&&z&384||!A&&F&16)&&He(x,p,g),I&&Dl(d)}(st&&(pt=O&&O.onVnodeUnmounted)||G)&&Ut(()=>{pt&&de(pt,p,d),G&&bn(d,null,p,"unmounted")},g)},Dl=d=>{const{type:p,el:g,anchor:I,transition:A}=d;if(p===Pt){wm(g,I);return}if(p===Go){_(d);return}const V=()=>{s(g),A&&!A.persisted&&A.afterLeave&&A.afterLeave()};if(d.shapeFlag&1&&A&&!A.persisted){const{leave:O,delayLeave:P}=A,x=()=>O(g,V);P?P(d.el,V,x):x()}else V()},wm=(d,p)=>{let g;for(;d!==p;)g=f(d),s(d),d=g;s(p)},Im=(d,p,g)=>{const{bum:I,scope:A,update:V,subTree:O,um:P}=d;I&&ur(I),A.stop(),V&&(V.active=!1,Ce(O,d,p,g)),P&&Ut(P,p),Ut(()=>{d.isUnmounted=!0},p),p&&p.pendingBranch&&!p.isUnmounted&&d.asyncDep&&!d.asyncResolved&&d.suspenseId===p.pendingId&&(p.deps--,p.deps===0&&p.resolve())},He=(d,p,g,I=!1,A=!1,V=0)=>{for(let O=V;O<d.length;O++)Ce(d[O],p,g,I,A)},Ks=d=>d.shapeFlag&6?Ks(d.component.subTree):d.shapeFlag&128?d.suspense.next():f(d.anchor||d.el);let Fo=!1;const xl=(d,p,g)=>{d==null?p._vnode&&Ce(p._vnode,null,null,!0):T(p._vnode||null,d,p,null,null,null,g),Fo||(Fo=!0,ql(),tf(),Fo=!1),p._vnode=d},Jn={p:T,um:Ce,m:An,r:Dl,mt:Lr,mc:U,pc:mt,pbc:et,n:Ks,o:e};let Uo,Bo;return t&&([Uo,Bo]=t(Jn)),{render:xl,hydrate:Uo,createApp:t_(xl,Uo)}}function Wo({type:e,props:t},n){return n==="svg"&&e==="foreignObject"||n==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:n}function Rn({effect:e,update:t},n){e.allowRecurse=t.allowRecurse=n}function c_(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function Tf(e,t,n=!1){const r=e.children,s=t.children;if(K(r)&&K(s))for(let i=0;i<r.length;i++){const o=r[i];let a=s[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[i]=an(s[i]),a.el=o.el),n||Tf(o,a)),a.type===Yi&&(a.el=o.el)}}function l_(e){const t=e.slice(),n=[0];let r,s,i,o,a;const c=e.length;for(r=0;r<c;r++){const l=e[r];if(l!==0){if(s=n[n.length-1],e[s]<l){t[r]=s,n.push(r);continue}for(i=0,o=n.length-1;i<o;)a=i+o>>1,e[n[a]]<l?i=a+1:o=a;l<e[n[i]]&&(i>0&&(t[r]=n[i-1]),n[i]=r)}}for(i=n.length,o=n[i-1];i-- >0;)n[i]=o,o=t[o];return n}function wf(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:wf(t)}const u_=e=>e.__isTeleport,Pt=Symbol.for("v-fgt"),Yi=Symbol.for("v-txt"),$n=Symbol.for("v-cmt"),Go=Symbol.for("v-stc"),Zr=[];let we=null;function X(e=!1){Zr.push(we=e?null:[])}function h_(){Zr.pop(),we=Zr[Zr.length-1]||null}let ls=1;function eu(e){ls+=e}function If(e){return e.dynamicChildren=ls>0?we||cr:null,h_(),ls>0&&we&&we.push(e),e}function ht(e,t,n,r,s,i){return If(M(e,t,n,r,s,i,!0))}function ye(e,t,n,r,s){return If(ne(e,t,n,r,s,!0))}function Af(e){return e?e.__v_isVNode===!0:!1}function er(e,t){return e.type===t.type&&e.key===t.key}const Ji="__vInternal",bf=({key:e})=>e??null,ui=({ref:e,ref_key:t,ref_for:n})=>(typeof e=="number"&&(e=""+e),e!=null?Ct(e)||Zt(e)||Y(e)?{i:re,r:e,k:t,f:!!n}:e:null);function M(e,t=null,n=null,r=0,s=null,i=e===Pt?0:1,o=!1,a=!1){const c={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&bf(t),ref:t&&ui(t),scopeId:Qi,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:re};return a?(Sc(c,n),i&128&&e.normalize(c)):n&&(c.shapeFlag|=Ct(n)?8:16),ls>0&&!o&&we&&(c.patchFlag>0||i&6)&&c.patchFlag!==32&&we.push(c),c}const ne=f_;function f_(e,t=null,n=null,r=0,s=null,i=!1){if((!e||e===Vg)&&(e=$n),Af(e)){const a=jn(e,t,!0);return n&&Sc(a,n),ls>0&&!i&&we&&(a.shapeFlag&6?we[we.indexOf(e)]=a:we.push(a)),a.patchFlag|=-2,a}if(I_(e)&&(e=e.__vccOpts),t){t=d_(t);let{class:a,style:c}=t;a&&!Ct(a)&&(t.class=Ft(a)),Tt(c)&&(Hh(c)&&!K(c)&&(c=Kt({},c)),t.style=pe(c))}const o=Ct(e)?1:sf(e)?128:u_(e)?64:Tt(e)?4:Y(e)?2:0;return M(e,t,n,r,s,o,i,!0)}function d_(e){return e?Hh(e)||Ji in e?Kt({},e):e:null}function jn(e,t,n=!1){const{props:r,ref:s,patchFlag:i,children:o}=e,a=t?p_(r||{},t):r;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:a,key:a&&bf(a),ref:t&&t.ref?n&&s?K(s)?s.concat(ui(t)):[s,ui(t)]:ui(t):s,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:o,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Pt?i===-1?16:i|16:i,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&jn(e.ssContent),ssFallback:e.ssFallback&&jn(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce}}function Rf(e=" ",t=0){return ne(Yi,null,e,t)}function le(e="",t=!1){return t?(X(),ye($n,null,e)):ne($n,null,e)}function De(e){return e==null||typeof e=="boolean"?ne($n):K(e)?ne(Pt,null,e.slice()):typeof e=="object"?an(e):ne(Yi,null,String(e))}function an(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:jn(e)}function Sc(e,t){let n=0;const{shapeFlag:r}=e;if(t==null)t=null;else if(K(t))n=16;else if(typeof t=="object")if(r&65){const s=t.default;s&&(s._c&&(s._d=!1),Sc(e,s()),s._c&&(s._d=!0));return}else{n=32;const s=t._;!s&&!(Ji in t)?t._ctx=re:s===3&&re&&(re.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else Y(t)?(t={default:t,_ctx:re},n=32):(t=String(t),r&64?(n=16,t=[Rf(t)]):n=8);e.children=t,e.shapeFlag|=n}function p_(...e){const t={};for(let n=0;n<e.length;n++){const r=e[n];for(const s in r)if(s==="class")t.class!==r.class&&(t.class=Ft([t.class,r.class]));else if(s==="style")t.style=pe([t.style,r.style]);else if(zi(s)){const i=t[s],o=r[s];o&&i!==o&&!(K(i)&&i.includes(o))&&(t[s]=i?[].concat(i,o):o)}else s!==""&&(t[s]=r[s])}return t}function de(e,t,n,r=null){Ae(e,t,7,[n,r])}const m_=mf();let g_=0;function __(e,t,n){const r=e.type,s=(t?t.appContext:e.appContext)||m_,i={uid:g_++,vnode:e,type:r,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,scope:new xh(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:_f(r,s),emitsOptions:nf(r,s),emit:null,emitted:null,propsDefaults:_t,inheritAttrs:r.inheritAttrs,ctx:_t,data:_t,props:_t,attrs:_t,slots:_t,refs:_t,setupState:_t,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=t?t.root:i,i.emit=Eg.bind(null,i),e.ce&&e.ce(i),i}let jt=null;const y_=()=>jt||re;let Ti,Va;{const e=Ph(),t=(n,r)=>{let s;return(s=e[n])||(s=e[n]=[]),s.push(r),i=>{s.length>1?s.forEach(o=>o(i)):s[0](i)}};Ti=t("__VUE_INSTANCE_SETTERS__",n=>jt=n),Va=t("__VUE_SSR_SETTERS__",n=>Zi=n)}const Cs=e=>{const t=jt;return Ti(e),e.scope.on(),()=>{e.scope.off(),Ti(t)}},nu=()=>{jt&&jt.scope.off(),Ti(null)};function Sf(e){return e.vnode.shapeFlag&4}let Zi=!1;function v_(e,t=!1){t&&Va(t);const{props:n,children:r}=e.vnode,s=Sf(e);e_(e,n,s,t),s_(e,r);const i=s?E_(e,t):void 0;return t&&Va(!1),i}function E_(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=Ec(new Proxy(e.ctx,Wg));const{setup:r}=n;if(r){const s=e.setupContext=r.length>1?w_(e):null,i=Cs(e);Wn();const o=hn(r,e,0,[e.props,s]);if(Gn(),i(),Rh(o)){if(o.then(nu,nu),t)return o.then(a=>{ru(e,a,t)}).catch(a=>{Wi(a,e,0)});e.asyncDep=o}else ru(e,o,t)}else Cf(e,t)}function ru(e,t,n){Y(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Tt(t)&&(e.setupState=Gh(t)),Cf(e,n)}let su;function Cf(e,t,n){const r=e.type;if(!e.render){if(!t&&su&&!r.render){const s=r.template||bc(e).template;if(s){const{isCustomElement:i,compilerOptions:o}=e.appContext.config,{delimiters:a,compilerOptions:c}=r,l=Kt(Kt({isCustomElement:i,delimiters:a},o),c);r.render=su(s,l)}}e.render=r.render||_e}{const s=Cs(e);Wn();try{Gg(e)}finally{Gn(),s()}}}function T_(e){return e.attrsProxy||(e.attrsProxy=new Proxy(e.attrs,{get(t,n){return oe(e,"get","$attrs"),t[n]}}))}function w_(e){const t=n=>{e.exposed=n||{}};return{get attrs(){return T_(e)},slots:e.slots,emit:e.emit,expose:t}}function to(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(Gh(Ec(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in Yr)return Yr[n](e)},has(t,n){return n in t||n in Yr}}))}function Da(e,t=!0){return Y(e)?e.displayName||e.name:e.name||t&&e.__name}function I_(e){return Y(e)&&"__vccOpts"in e}const kt=(e,t)=>cg(e,t,Zi),A_="3.4.21";/**
* @vue/runtime-dom v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const b_="http://www.w3.org/2000/svg",R_="http://www.w3.org/1998/Math/MathML",cn=typeof document<"u"?document:null,iu=cn&&cn.createElement("template"),S_={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,r)=>{const s=t==="svg"?cn.createElementNS(b_,e):t==="mathml"?cn.createElementNS(R_,e):cn.createElement(e,n?{is:n}:void 0);return e==="select"&&r&&r.multiple!=null&&s.setAttribute("multiple",r.multiple),s},createText:e=>cn.createTextNode(e),createComment:e=>cn.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>cn.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,r,s,i){const o=n?n.previousSibling:t.lastChild;if(s&&(s===i||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),n),!(s===i||!(s=s.nextSibling)););else{iu.innerHTML=r==="svg"?`<svg>${e}</svg>`:r==="mathml"?`<math>${e}</math>`:e;const a=iu.content;if(r==="svg"||r==="mathml"){const c=a.firstChild;for(;c.firstChild;)a.appendChild(c.firstChild);a.removeChild(c)}t.insertBefore(a,n)}return[o?o.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},C_=Symbol("_vtc");function P_(e,t,n){const r=e[C_];r&&(t=(t?[t,...r]:[...r]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}const ou=Symbol("_vod"),V_=Symbol("_vsh"),D_=Symbol(""),x_=/(^|;)\s*display\s*:/;function k_(e,t,n){const r=e.style,s=Ct(n);let i=!1;if(n&&!s){if(t)if(Ct(t))for(const o of t.split(";")){const a=o.slice(0,o.indexOf(":")).trim();n[a]==null&&hi(r,a,"")}else for(const o in t)n[o]==null&&hi(r,o,"");for(const o in n)o==="display"&&(i=!0),hi(r,o,n[o])}else if(s){if(t!==n){const o=r[D_];o&&(n+=";"+o),r.cssText=n,i=x_.test(n)}}else t&&e.removeAttribute("style");ou in e&&(e[ou]=i?r.display:"",e[V_]&&(r.display="none"))}const au=/\s*!important$/;function hi(e,t,n){if(K(n))n.forEach(r=>hi(e,t,r));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const r=N_(e,t);au.test(n)?e.setProperty(Cr(r),n.replace(au,""),"important"):e[r]=n}}const cu=["Webkit","Moz","ms"],Qo={};function N_(e,t){const n=Qo[t];if(n)return n;let r=Ue(t);if(r!=="filter"&&r in e)return Qo[t]=r;r=Hi(r);for(let s=0;s<cu.length;s++){const i=cu[s]+r;if(i in e)return Qo[t]=i}return t}const lu="http://www.w3.org/1999/xlink";function O_(e,t,n,r,s){if(r&&t.startsWith("xlink:"))n==null?e.removeAttributeNS(lu,t.slice(6,t.length)):e.setAttributeNS(lu,t,n);else{const i=Lm(t);n==null||i&&!Vh(n)?e.removeAttribute(t):e.setAttribute(t,i?"":n)}}function M_(e,t,n,r,s,i,o){if(t==="innerHTML"||t==="textContent"){r&&o(r,s,i),e[t]=n??"";return}const a=e.tagName;if(t==="value"&&a!=="PROGRESS"&&!a.includes("-")){const l=a==="OPTION"?e.getAttribute("value")||"":e.value,u=n??"";(l!==u||!("_value"in e))&&(e.value=u),n==null&&e.removeAttribute(t),e._value=n;return}let c=!1;if(n===""||n==null){const l=typeof e[t];l==="boolean"?n=Vh(n):n==null&&l==="string"?(n="",c=!0):l==="number"&&(n=0,c=!0)}try{e[t]=n}catch{}c&&e.removeAttribute(t)}function nr(e,t,n,r){e.addEventListener(t,n,r)}function L_(e,t,n,r){e.removeEventListener(t,n,r)}const uu=Symbol("_vei");function F_(e,t,n,r,s=null){const i=e[uu]||(e[uu]={}),o=i[t];if(r&&o)o.value=r;else{const[a,c]=U_(t);if(r){const l=i[t]=j_(r,s);nr(e,a,l,c)}else o&&(L_(e,a,o,c),i[t]=void 0)}}const hu=/(?:Once|Passive|Capture)$/;function U_(e){let t;if(hu.test(e)){t={};let r;for(;r=e.match(hu);)e=e.slice(0,e.length-r[0].length),t[r[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Cr(e.slice(2)),t]}let Xo=0;const B_=Promise.resolve(),$_=()=>Xo||(B_.then(()=>Xo=0),Xo=Date.now());function j_(e,t){const n=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=n.attached)return;Ae(z_(r,n.value),t,5,[r])};return n.value=e,n.attached=$_(),n}function z_(e,t){if(K(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(r=>s=>!s._stopped&&r&&r(s))}else return t}const fu=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,q_=(e,t,n,r,s,i,o,a,c)=>{const l=s==="svg";t==="class"?P_(e,r,l):t==="style"?k_(e,n,r):zi(t)?uc(t)||F_(e,t,n,r,o):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):H_(e,t,r,l))?M_(e,t,r,i,o,a,c):(t==="true-value"?e._trueValue=r:t==="false-value"&&(e._falseValue=r),O_(e,t,r,l))};function H_(e,t,n,r){if(r)return!!(t==="innerHTML"||t==="textContent"||t in e&&fu(t)&&Y(n));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const s=e.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return fu(t)&&Ct(n)?!1:t in e}const du=e=>{const t=e.props["onUpdate:modelValue"]||!1;return K(t)?n=>ur(t,n):t};function K_(e){e.target.composing=!0}function pu(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Yo=Symbol("_assign"),Zs={created(e,{modifiers:{lazy:t,trim:n,number:r}},s){e[Yo]=du(s);const i=r||s.props&&s.props.type==="number";nr(e,t?"change":"input",o=>{if(o.target.composing)return;let a=e.value;n&&(a=a.trim()),i&&(a=va(a)),e[Yo](a)}),n&&nr(e,"change",()=>{e.value=e.value.trim()}),t||(nr(e,"compositionstart",K_),nr(e,"compositionend",pu),nr(e,"change",pu))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,modifiers:{lazy:n,trim:r,number:s}},i){if(e[Yo]=du(i),e.composing)return;const o=s||e.type==="number"?va(e.value):e.value,a=t??"";o!==a&&(document.activeElement===e&&e.type!=="range"&&(n||r&&e.value.trim()===a)||(e.value=a))}},W_=["ctrl","shift","alt","meta"],G_={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>W_.some(n=>e[`${n}Key`]&&!t.includes(n))},Q_=(e,t)=>{const n=e._withMods||(e._withMods={}),r=t.join(".");return n[r]||(n[r]=(s,...i)=>{for(let o=0;o<t.length;o++){const a=G_[t[o]];if(a&&a(s,t))return}return e(s,...i)})},X_=Kt({patchProp:q_},S_);let mu;function Y_(){return mu||(mu=o_(X_))}const J_=(...e)=>{const t=Y_().createApp(...e),{mount:n}=t;return t.mount=r=>{const s=ty(r);if(!s)return;const i=t._component;!Y(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.innerHTML="";const o=n(s,!1,Z_(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},t};function Z_(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function ty(e){return Ct(e)?document.querySelector(e):e}var ey=!1;/*!
 * pinia v2.1.7
 * (c) 2023 Eduardo San Martin Morote
 * @license MIT
 */const ny=Symbol();var gu;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(gu||(gu={}));function ry(){const e=Fm(!0),t=e.run(()=>ft({}));let n=[],r=[];const s=Ec({install(i){s._a=i,i.provide(ny,s),i.config.globalProperties.$pinia=s,r.forEach(o=>n.push(o)),r=[]},use(i){return!this._a&&!ey?r.push(i):n.push(i),this},_p:n,_a:null,_e:e,_s:new Map,state:t});return s}const sy={class:"select"},iy={class:"select__selected"},oy={key:0,class:"select__dropdown"},ay=["onClick"],cy=["src"],ly=Je({__name:"Select",props:{items:{},selected:{}},emits:["select"],setup(e,{emit:t}){const n=e,{selected:r,items:s}=Qh(n),i=t,o=()=>c.value=!1,a=()=>c.value=!c.value,c=ft(!1),l=kt(()=>{var h;return r.value!==null?((h=s.value[+r.value])==null?void 0:h.name)??"None":"None"}),u=({name:h},f)=>{i("select",f),o()};return(h,f)=>{const m=rf("outclick");return X(),ht("div",sy,[M("div",{class:Ft(["select__wrapper",{"select__wrapper--opened":c.value}])},[M("button",{class:"select__toggle",onClick:Q_(a,["stop"])},[M("span",iy,Ve(l.value),1),M("img",{class:Ft(["select__triangle",{"select__triangle--opened":c.value}]),src:"https://ucarecdn.com/a77ee644-5f48-43c6-9cb4-f620fd73761b/",alt:"triangle"},null,2)]),c.value?or((X(),ht("div",oy,[(X(!0),ht(Pt,null,fn(tt(s),(R,T)=>(X(),ht("span",{class:Ft(["select__item",{"select__item--selected":l.value===R.name}]),onClick:w=>u(R,T)},[R.ico?(X(),ht("img",{key:0,class:"select__ico",src:`https://ucarecdn.com/${R.ico}/`,alt:"ico"},null,8,cy)):le("",!0),Rf(" "+Ve(R.name||"Err"),1)],10,ay))),256))])),[[m,o]]):le("",!0)],2)])}}}),tn=(e,t)=>{const n=e.__vccOpts||e;for(const[r,s]of t)n[r]=s;return n},_u=tn(ly,[["__scopeId","data-v-6b1eb29d"]]),Cc={0:{name:"Акт 1",backImg:"560b1c31-47cf-40aa-b0e3-181223034459",ico:"5efc700f-ce8c-4b66-8721-8e4794bca980"},1:{name:"Акт 2",backImg:"32e1da0c-2eb1-4fec-81e9-55dd61e9c7a7",ico:"db3b09d0-a84f-4b50-865b-667a412100da"},2:{name:"Акт 3",backImg:"71ebb5c6-b7b0-4619-bbef-fa078d885a99",ico:"19474701-7c1c-4263-8abc-103210ffc0be"}};function yu(e){return Object.prototype.toString.call(e)==="[object Object]"}const uy=/\W|_/g;function hy(e){return e.split(uy).map((t,n)=>t.charAt(0)[n>0?"toUpperCase":"toLowerCase"]()+t.slice(1)).join("")}function vu(e,{ignoreKeys:t}={ignoreKeys:[]}){return Array.isArray(e)?e.map(n=>qe(n,{ignoreKeys:t})):e}function qe(e,{ignoreKeys:t}={ignoreKeys:[]}){if(Array.isArray(e))return vu(e,{ignoreKeys:t});if(!yu(e))return e;const n={};for(const r of Object.keys(e)){let s=e[r];if(t.includes(r)){n[r]=s;continue}yu(s)?s=qe(s,{ignoreKeys:t}):Array.isArray(s)&&(s=vu(s,{ignoreKeys:t})),n[hy(r)]=s}return n}const fy=e=>new Promise(t=>setTimeout(t,e));function dy({libraryName:e,libraryVersion:t,userAgent:n,publicKey:r="",integration:s=""}){const i="JavaScript";if(typeof n=="string")return n;if(typeof n=="function")return n({publicKey:r,libraryName:e,libraryVersion:t,languageName:i,integration:s});const o=[e,t,r].filter(Boolean).join("/"),a=[i,s].filter(Boolean).join("; ");return`${o} (${a})`}const py={factor:2,time:100};function my(e,t=py){let n=0;function r(s){const i=Math.round(t.time*t.factor**n);return s({attempt:n,retry:a=>fy(a??i).then(()=>(n+=1,r(s)))})}return r(e)}class Pc extends Error{}class eo extends Pc{constructor(n){super();Z(this,"originalProgressEvent");this.name="NetworkError",this.message="Network error",Object.setPrototypeOf(this,eo.prototype),this.originalProgressEvent=n}}const no=(e,t)=>{e&&(e.aborted?Promise.resolve().then(t):e.addEventListener("abort",()=>t(),{once:!0}))};class yr extends Pc{constructor(n="Request canceled"){super(n);Z(this,"isCancel",!0);this.name="CancelError",Object.setPrototypeOf(this,yr.prototype)}}const gy=500,Pf=({check:e,interval:t=gy,timeout:n,signal:r})=>new Promise((s,i)=>{let o,a;no(r,()=>{o&&clearTimeout(o),i(new yr("Poll cancelled"))}),n&&(a=setTimeout(()=>{o&&clearTimeout(o),i(new yr("Timed out"))},n));const c=()=>{try{Promise.resolve(e(r)).then(l=>{l?(a&&clearTimeout(a),s(l)):o=setTimeout(c,t)}).catch(l=>{a&&clearTimeout(a),i(l)})}catch(l){a&&clearTimeout(a),i(l)}};o=setTimeout(c,0)}),rt={baseCDN:"https://ucarecdn.com",baseURL:"https://upload.uploadcare.com",maxContentLength:50*1024*1024,retryThrottledRequestMaxTimes:1,retryNetworkErrorMaxTimes:3,multipartMinFileSize:25*1024*1024,multipartChunkSize:5*1024*1024,multipartMinLastPartSize:1024*1024,maxConcurrentRequests:4,pollingTimeoutMilliseconds:1e4,pusherKey:"79ae88bd931ea68464d9"},ro="application/octet-stream",Vf="original",en=({method:e,url:t,data:n,headers:r={},signal:s,onProgress:i})=>new Promise((o,a)=>{const c=new XMLHttpRequest,l=(e==null?void 0:e.toUpperCase())||"GET";let u=!1;c.open(l,t,!0),r&&Object.entries(r).forEach(h=>{const[f,m]=h;typeof m<"u"&&!Array.isArray(m)&&c.setRequestHeader(f,m)}),c.responseType="text",no(s,()=>{u=!0,c.abort(),a(new yr)}),c.onload=()=>{if(c.status!=200)a(new Error(`Error ${c.status}: ${c.statusText}`));else{const h={method:l,url:t,data:n,headers:r||void 0,signal:s,onProgress:i},f=c.getAllResponseHeaders().trim().split(/[\r\n]+/),m={};f.forEach(function(w){const L=w.split(": "),v=L.shift(),y=L.join(": ");v&&typeof v<"u"&&(m[v]=y)});const R=c.response,T=c.status;o({request:h,data:R,headers:m,status:T})}},c.onerror=h=>{u||a(new eo(h))},i&&typeof i=="function"&&(c.upload.onprogress=h=>{h.lengthComputable?i({isComputable:!0,value:h.loaded/h.total}):i({isComputable:!1})}),n?c.send(n):c.send()});function _y(e,...t){return e}const yy=({name:e})=>e?[e]:[],vy=_y;var Ey=()=>new FormData;const Df=e=>!1,so=e=>typeof Blob<"u"&&e instanceof Blob,io=e=>typeof File<"u"&&e instanceof File,oo=e=>!!e&&typeof e=="object"&&!Array.isArray(e)&&"uri"in e&&typeof e.uri=="string",Pr=e=>so(e)||io(e)||Df()||oo(e),Ty=e=>typeof e=="string"||typeof e=="number"||typeof e>"u",wy=e=>!!e&&typeof e=="object"&&!Array.isArray(e),Iy=e=>!!e&&typeof e=="object"&&"data"in e&&Pr(e.data);function xf(e,t,n){if(Array.isArray(n))for(const r of n)xf(e,`${t}[]`,r);else if(Iy(n)){const{name:r,contentType:s}=n,i=vy(n.data,r,s??ro),o=yy({name:r,contentType:s});e.push([t,i,...o])}else if(wy(n))for(const[r,s]of Object.entries(n))typeof s<"u"&&e.push([`${t}[${r}]`,String(s)]);else Ty(n)&&n&&e.push([t,n.toString()])}function Ay(e){const t=[];for(const[n,r]of Object.entries(e))xf(t,n,r);return t}function ao(e){const t=Ey(),n=Ay(e);for(const r of n){const[s,i,...o]=r;t.append(s,i,...o)}return t}class ae extends Pc{constructor(n,r,s,i,o){super();Z(this,"code");Z(this,"request");Z(this,"response");Z(this,"headers");this.name="UploadError",this.message=n,this.code=r,this.request=s,this.response=i,this.headers=o,Object.setPrototypeOf(this,ae.prototype)}}const by=e=>{const t=new URLSearchParams;for(const[n,r]of Object.entries(e))r&&typeof r=="object"&&!Array.isArray(r)?Object.entries(r).filter(s=>s[1]??!1).forEach(s=>t.set(`${n}[${s[0]}]`,String(s[1]))):Array.isArray(r)?r.forEach(s=>{t.append(`${n}[]`,s)}):typeof r=="string"&&r?t.set(n,r):typeof r=="number"&&t.set(n,r.toString());return t.toString()},Be=(e,t,n)=>{const r=new URL(e);return r.pathname=(r.pathname+t).replace("//","/"),n&&(r.search=by(n)),r.toString()};var Ry="6.14.1";const Sy="UploadcareUploadClient",Cy=Ry;function En(e){return dy({libraryName:Sy,libraryVersion:Cy,...e})}const Py="RequestThrottledError",Eu=15e3,Vy=1e3;function Dy(e){const{headers:t}=e||{};if(!t||typeof t["retry-after"]!="string")return Eu;const n=parseInt(t["retry-after"],10);return Number.isFinite(n)?n*1e3:Eu}function nn(e,t){const{retryThrottledRequestMaxTimes:n,retryNetworkErrorMaxTimes:r}=t;return my(({attempt:s,retry:i})=>e().catch(o=>{if("response"in o&&(o==null?void 0:o.code)===Py&&s<n)return i(Dy(o));if(o instanceof eo&&s<r)return i((s+1)*Vy);throw o}))}const kf=e=>{let t="";return(so(e)||io(e)||oo(e))&&(t=e.type),t||ro},Nf=e=>{let t="";return io(e)&&e.name?t=e.name:so(e)||Df()?t="":oo(e)&&e.name&&(t=e.name),t||Vf};function Vc(e){return typeof e>"u"||e==="auto"?"auto":e?"1":"0"}function Of(e,{publicKey:t,fileName:n,contentType:r,baseURL:s=rt.baseURL,secureSignature:i,secureExpire:o,store:a,signal:c,onProgress:l,source:u="local",integration:h,userAgent:f,retryThrottledRequestMaxTimes:m=rt.retryThrottledRequestMaxTimes,retryNetworkErrorMaxTimes:R=rt.retryNetworkErrorMaxTimes,metadata:T}){return nn(()=>en({method:"POST",url:Be(s,"/base/",{jsonerrors:1}),headers:{"X-UC-User-Agent":En({publicKey:t,integration:h,userAgent:f})},data:ao({file:{data:e,name:n||Nf(e),contentType:r||kf(e)},UPLOADCARE_PUB_KEY:t,UPLOADCARE_STORE:Vc(a),signature:i,expire:o,source:u,metadata:T}),signal:c,onProgress:l}).then(({data:w,headers:L,request:v})=>{const y=qe(JSON.parse(w));if("error"in y)throw new ae(y.error.content,y.error.errorCode,v,y,L);return y}),{retryNetworkErrorMaxTimes:R,retryThrottledRequestMaxTimes:m})}var xa;(function(e){e.Token="token",e.FileInfo="file_info"})(xa||(xa={}));function Mf(e,{publicKey:t,baseURL:n=rt.baseURL,store:r,fileName:s,checkForUrlDuplicates:i,saveUrlForRecurrentUploads:o,secureSignature:a,secureExpire:c,source:l="url",signal:u,integration:h,userAgent:f,retryThrottledRequestMaxTimes:m=rt.retryThrottledRequestMaxTimes,retryNetworkErrorMaxTimes:R=rt.retryNetworkErrorMaxTimes,metadata:T}){return nn(()=>en({method:"POST",headers:{"X-UC-User-Agent":En({publicKey:t,integration:h,userAgent:f})},url:Be(n,"/from_url/",{jsonerrors:1,pub_key:t,source_url:e,store:Vc(r),filename:s,check_URL_duplicates:i?1:void 0,save_URL_duplicates:o?1:void 0,signature:a,expire:c,source:l,metadata:T}),signal:u}).then(({data:w,headers:L,request:v})=>{const y=qe(JSON.parse(w));if("error"in y)throw new ae(y.error.content,y.error.errorCode,v,y,L);return y}),{retryNetworkErrorMaxTimes:R,retryThrottledRequestMaxTimes:m})}var ie;(function(e){e.Unknown="unknown",e.Waiting="waiting",e.Progress="progress",e.Error="error",e.Success="success"})(ie||(ie={}));const xy=e=>"status"in e&&e.status===ie.Error;function Lf(e,{publicKey:t,baseURL:n=rt.baseURL,signal:r,integration:s,userAgent:i,retryThrottledRequestMaxTimes:o=rt.retryThrottledRequestMaxTimes,retryNetworkErrorMaxTimes:a=rt.retryNetworkErrorMaxTimes}={}){return nn(()=>en({method:"GET",headers:t?{"X-UC-User-Agent":En({publicKey:t,integration:s,userAgent:i})}:void 0,url:Be(n,"/from_url/status/",{jsonerrors:1,token:e}),signal:r}).then(({data:c,headers:l,request:u})=>{const h=qe(JSON.parse(c));if("error"in h&&!xy(h))throw new ae(h.error.content,h.error.errorCode,u,h,l);return h}),{retryNetworkErrorMaxTimes:a,retryThrottledRequestMaxTimes:o})}function Ff(e,{publicKey:t,baseURL:n=rt.baseURL,jsonpCallback:r,secureSignature:s,secureExpire:i,signal:o,source:a,integration:c,userAgent:l,retryThrottledRequestMaxTimes:u=rt.retryThrottledRequestMaxTimes,retryNetworkErrorMaxTimes:h=rt.retryNetworkErrorMaxTimes}){return nn(()=>en({method:"POST",headers:{"X-UC-User-Agent":En({publicKey:t,integration:c,userAgent:l})},url:Be(n,"/group/",{jsonerrors:1}),data:ao({files:e,callback:r,pub_key:t,signature:s,expire:i,source:a}),signal:o}).then(({data:f,headers:m,request:R})=>{const T=qe(JSON.parse(f));if("error"in T)throw new ae(T.error.content,T.error.errorCode,R,T,m);return T}),{retryNetworkErrorMaxTimes:h,retryThrottledRequestMaxTimes:u})}function ky(e,{publicKey:t,baseURL:n=rt.baseURL,signal:r,source:s,integration:i,userAgent:o,retryThrottledRequestMaxTimes:a=rt.retryThrottledRequestMaxTimes,retryNetworkErrorMaxTimes:c=rt.retryNetworkErrorMaxTimes}){return nn(()=>en({method:"GET",headers:{"X-UC-User-Agent":En({publicKey:t,integration:i,userAgent:o})},url:Be(n,"/group/info/",{jsonerrors:1,pub_key:t,group_id:e,source:s}),signal:r}).then(({data:l,headers:u,request:h})=>{const f=qe(JSON.parse(l));if("error"in f)throw new ae(f.error.content,f.error.errorCode,h,f,u);return f}),{retryThrottledRequestMaxTimes:a,retryNetworkErrorMaxTimes:c})}function Dc(e,{publicKey:t,baseURL:n=rt.baseURL,signal:r,source:s,integration:i,userAgent:o,retryThrottledRequestMaxTimes:a=rt.retryThrottledRequestMaxTimes,retryNetworkErrorMaxTimes:c=rt.retryNetworkErrorMaxTimes}){return nn(()=>en({method:"GET",headers:{"X-UC-User-Agent":En({publicKey:t,integration:i,userAgent:o})},url:Be(n,"/info/",{jsonerrors:1,pub_key:t,file_id:e,source:s}),signal:r}).then(({data:l,headers:u,request:h})=>{const f=qe(JSON.parse(l));if("error"in f)throw new ae(f.error.content,f.error.errorCode,h,f,u);return f}),{retryThrottledRequestMaxTimes:a,retryNetworkErrorMaxTimes:c})}function Uf(e,{publicKey:t,contentType:n,fileName:r,multipartChunkSize:s=rt.multipartChunkSize,baseURL:i="",secureSignature:o,secureExpire:a,store:c,signal:l,source:u="local",integration:h,userAgent:f,retryThrottledRequestMaxTimes:m=rt.retryThrottledRequestMaxTimes,retryNetworkErrorMaxTimes:R=rt.retryNetworkErrorMaxTimes,metadata:T}){return nn(()=>en({method:"POST",url:Be(i,"/multipart/start/",{jsonerrors:1}),headers:{"X-UC-User-Agent":En({publicKey:t,integration:h,userAgent:f})},data:ao({filename:r||Vf,size:e,content_type:n||ro,part_size:s,UPLOADCARE_STORE:Vc(c),UPLOADCARE_PUB_KEY:t,signature:o,expire:a,source:u,metadata:T}),signal:l}).then(({data:w,headers:L,request:v})=>{const y=qe(JSON.parse(w));if("error"in y)throw new ae(y.error.content,y.error.errorCode,v,y,L);return y.parts=Object.keys(y.parts).map(_=>y.parts[Number(_)]),y}),{retryThrottledRequestMaxTimes:m,retryNetworkErrorMaxTimes:R})}function Bf(e,t,{contentType:n,signal:r,onProgress:s,retryThrottledRequestMaxTimes:i=rt.retryThrottledRequestMaxTimes,retryNetworkErrorMaxTimes:o=rt.retryNetworkErrorMaxTimes}){return nn(()=>en({method:"PUT",url:t,data:e,onProgress:s,signal:r,headers:{"Content-Type":n||ro}}).then(a=>(s&&s({isComputable:!0,value:1}),a)).then(({status:a})=>({code:a})),{retryThrottledRequestMaxTimes:i,retryNetworkErrorMaxTimes:o})}function $f(e,{publicKey:t,baseURL:n=rt.baseURL,source:r="local",signal:s,integration:i,userAgent:o,retryThrottledRequestMaxTimes:a=rt.retryThrottledRequestMaxTimes,retryNetworkErrorMaxTimes:c=rt.retryNetworkErrorMaxTimes}){return nn(()=>en({method:"POST",url:Be(n,"/multipart/complete/",{jsonerrors:1}),headers:{"X-UC-User-Agent":En({publicKey:t,integration:i,userAgent:o})},data:ao({uuid:e,UPLOADCARE_PUB_KEY:t,source:r}),signal:s}).then(({data:l,headers:u,request:h})=>{const f=qe(JSON.parse(l));if("error"in f)throw new ae(f.error.content,f.error.errorCode,h,f,u);return f}),{retryThrottledRequestMaxTimes:a,retryNetworkErrorMaxTimes:c})}function co(e,{publicKey:t,baseURL:n,source:r,integration:s,userAgent:i,retryThrottledRequestMaxTimes:o,retryNetworkErrorMaxTimes:a,signal:c,onProgress:l}){return Pf({check:u=>Dc(e,{publicKey:t,baseURL:n,signal:u,source:r,integration:s,userAgent:i,retryThrottledRequestMaxTimes:o,retryNetworkErrorMaxTimes:a}).then(h=>h.isReady?h:(l&&l({isComputable:!0,value:1}),!1)),signal:c})}function Ny(e){return"defaultEffects"in e}class Ps{constructor(t,{baseCDN:n=rt.baseCDN,fileName:r}={}){Z(this,"uuid");Z(this,"name",null);Z(this,"size",null);Z(this,"isStored",null);Z(this,"isImage",null);Z(this,"mimeType",null);Z(this,"cdnUrl",null);Z(this,"s3Url",null);Z(this,"originalFilename",null);Z(this,"imageInfo",null);Z(this,"videoInfo",null);Z(this,"contentInfo",null);Z(this,"metadata",null);Z(this,"s3Bucket",null);Z(this,"defaultEffects",null);const{uuid:s,s3Bucket:i}=t,o=Be(n,`${s}/`),a=i?Be(`https://${i}.s3.amazonaws.com/`,`${s}/${t.filename}`):null;this.uuid=s,this.name=r||t.filename,this.size=t.size,this.isStored=t.isStored,this.isImage=t.isImage,this.mimeType=t.mimeType,this.cdnUrl=o,this.originalFilename=t.originalFilename,this.imageInfo=t.imageInfo,this.videoInfo=t.videoInfo,this.contentInfo=t.contentInfo,this.metadata=t.metadata||null,this.s3Bucket=i||null,this.s3Url=a,Ny(t)&&(this.defaultEffects=t.defaultEffects)}}const Oy=(e,{publicKey:t,fileName:n,baseURL:r,secureSignature:s,secureExpire:i,store:o,contentType:a,signal:c,onProgress:l,source:u,integration:h,userAgent:f,retryThrottledRequestMaxTimes:m,retryNetworkErrorMaxTimes:R,baseCDN:T,metadata:w})=>Of(e,{publicKey:t,fileName:n,contentType:a,baseURL:r,secureSignature:s,secureExpire:i,store:o,signal:c,onProgress:l,source:u,integration:h,userAgent:f,retryThrottledRequestMaxTimes:m,retryNetworkErrorMaxTimes:R,metadata:w}).then(({file:L})=>co(L,{publicKey:t,baseURL:r,source:u,integration:h,userAgent:f,retryThrottledRequestMaxTimes:m,retryNetworkErrorMaxTimes:R,onProgress:l,signal:c})).then(L=>new Ps(L,{baseCDN:T})),My=(e,{publicKey:t,fileName:n,baseURL:r,signal:s,onProgress:i,source:o,integration:a,userAgent:c,retryThrottledRequestMaxTimes:l,retryNetworkErrorMaxTimes:u,baseCDN:h})=>Dc(e,{publicKey:t,baseURL:r,signal:s,source:o,integration:a,userAgent:c,retryThrottledRequestMaxTimes:l,retryNetworkErrorMaxTimes:u}).then(f=>new Ps(f,{baseCDN:h,fileName:n})).then(f=>(i&&i({isComputable:!0,value:1}),f)),Ly=(e,{signal:t}={})=>{let n=null,r=null;const s=e.map(()=>new AbortController),i=o=>()=>{r=o,s.forEach((a,c)=>c!==o&&a.abort())};return no(t,()=>{s.forEach(o=>o.abort())}),Promise.all(e.map((o,a)=>{const c=i(a);return Promise.resolve().then(()=>o({stopRace:c,signal:s[a].signal})).then(l=>(c(),l)).catch(l=>(n=l,null))})).then(o=>{if(r===null)throw n;return o[r]})};var Fy=window.WebSocket;class Uy{constructor(){Z(this,"events",Object.create({}))}emit(t,n){var r;(r=this.events[t])==null||r.forEach(s=>s(n))}on(t,n){this.events[t]=this.events[t]||[],this.events[t].push(n)}off(t,n){n?this.events[t]=this.events[t].filter(r=>r!==n):this.events[t]=[]}}const By=(e,t)=>e==="success"?{status:ie.Success,...t}:e==="progress"?{status:ie.Progress,...t}:{status:ie.Error,...t};class $y{constructor(t,n=3e4){Z(this,"key");Z(this,"disconnectTime");Z(this,"ws");Z(this,"queue",[]);Z(this,"isConnected",!1);Z(this,"subscribers",0);Z(this,"emmitter",new Uy);Z(this,"disconnectTimeoutId",null);this.key=t,this.disconnectTime=n}connect(){if(this.disconnectTimeoutId&&clearTimeout(this.disconnectTimeoutId),!this.isConnected&&!this.ws){const t=`wss://ws.pusherapp.com/app/${this.key}?protocol=5&client=js&version=1.12.2`;this.ws=new Fy(t),this.ws.addEventListener("error",n=>{this.emmitter.emit("error",new Error(n.message))}),this.emmitter.on("connected",()=>{this.isConnected=!0,this.queue.forEach(n=>this.send(n.event,n.data)),this.queue=[]}),this.ws.addEventListener("message",n=>{const r=JSON.parse(n.data.toString());switch(r.event){case"pusher:connection_established":{this.emmitter.emit("connected",void 0);break}case"pusher:ping":{this.send("pusher:pong",{});break}case"progress":case"success":case"fail":this.emmitter.emit(r.channel,By(r.event,JSON.parse(r.data)))}})}}disconnect(){const t=()=>{var n;(n=this.ws)==null||n.close(),this.ws=void 0,this.isConnected=!1};this.disconnectTime?this.disconnectTimeoutId=setTimeout(()=>{t()},this.disconnectTime):t()}send(t,n){var s;const r=JSON.stringify({event:t,data:n});(s=this.ws)==null||s.send(r)}subscribe(t,n){this.subscribers+=1,this.connect();const r=`task-status-${t}`,s={event:"pusher:subscribe",data:{channel:r}};this.emmitter.on(r,n),this.isConnected?this.send(s.event,s.data):this.queue.push(s)}unsubscribe(t){this.subscribers-=1;const n=`task-status-${t}`,r={event:"pusher:unsubscribe",data:{channel:n}};this.emmitter.off(n),this.isConnected?this.send(r.event,r.data):this.queue=this.queue.filter(s=>s.data.channel!==n),this.subscribers===0&&this.disconnect()}onError(t){return this.emmitter.on("error",t),()=>this.emmitter.off("error",t)}}let Jo=null;const xc=e=>{if(!Jo){const t=typeof window>"u"?0:3e4;Jo=new $y(e,t)}return Jo},jy=e=>{xc(e).connect()};function zy({token:e,publicKey:t,baseURL:n,integration:r,userAgent:s,retryThrottledRequestMaxTimes:i,retryNetworkErrorMaxTimes:o,onProgress:a,signal:c}){return Pf({check:l=>Lf(e,{publicKey:t,baseURL:n,integration:r,userAgent:s,retryThrottledRequestMaxTimes:i,retryNetworkErrorMaxTimes:o,signal:l}).then(u=>{switch(u.status){case ie.Error:return new ae(u.error,u.errorCode);case ie.Waiting:return!1;case ie.Unknown:return new ae(`Token "${e}" was not found.`);case ie.Progress:return a&&(u.total==="unknown"?a({isComputable:!1}):a({isComputable:!0,value:u.done/u.total})),!1;case ie.Success:return a&&a({isComputable:!0,value:u.done/u.total}),u;default:throw new Error("Unknown status")}}),signal:c})}const qy=({token:e,pusherKey:t,signal:n,onProgress:r})=>new Promise((s,i)=>{const o=xc(t),a=o.onError(i),c=()=>{a(),o.unsubscribe(e)};no(n,()=>{c(),i(new yr("pusher cancelled"))}),o.subscribe(e,l=>{switch(l.status){case ie.Progress:{r&&(l.total==="unknown"?r({isComputable:!1}):r({isComputable:!0,value:l.done/l.total}));break}case ie.Success:{c(),r&&r({isComputable:!0,value:l.done/l.total}),s(l);break}case ie.Error:c(),i(new ae(l.msg,l.error_code))}})}),Hy=(e,{publicKey:t,fileName:n,baseURL:r,baseCDN:s,checkForUrlDuplicates:i,saveUrlForRecurrentUploads:o,secureSignature:a,secureExpire:c,store:l,signal:u,onProgress:h,source:f,integration:m,userAgent:R,retryThrottledRequestMaxTimes:T,pusherKey:w=rt.pusherKey,metadata:L})=>Promise.resolve(jy(w)).then(()=>Mf(e,{publicKey:t,fileName:n,baseURL:r,checkForUrlDuplicates:i,saveUrlForRecurrentUploads:o,secureSignature:a,secureExpire:c,store:l,signal:u,source:f,integration:m,userAgent:R,retryThrottledRequestMaxTimes:T,metadata:L})).catch(v=>{const y=xc(w);return y==null||y.disconnect(),Promise.reject(v)}).then(v=>v.type===xa.FileInfo?v:Ly([({signal:y})=>zy({token:v.token,publicKey:t,baseURL:r,integration:m,userAgent:R,retryThrottledRequestMaxTimes:T,onProgress:h,signal:y}),({signal:y})=>qy({token:v.token,pusherKey:w,signal:y,onProgress:h})],{signal:u})).then(v=>{if(v instanceof ae)throw v;return v}).then(v=>co(v.uuid,{publicKey:t,baseURL:r,integration:m,userAgent:R,retryThrottledRequestMaxTimes:T,onProgress:h,signal:u})).then(v=>new Ps(v,{baseCDN:s})),Zo=new WeakMap,Ky=async e=>{if(Zo.has(e))return Zo.get(e);const t=await fetch(e.uri).then(n=>n.blob());return Zo.set(e,t),t},jf=async e=>{if(io(e)||so(e))return e.size;if(oo(e))return(await Ky(e)).size;throw new Error("Unknown file type. Cannot determine file size.")},Wy=(e,t=rt.multipartMinFileSize)=>e>=t,zf=e=>{const t="[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}",n=new RegExp(t);return!Pr(e)&&n.test(e)},kc=e=>{const t="^(?:\\w+:)?\\/\\/([^\\s\\.]+\\.\\S{2}|localhost[\\:?\\d]*)\\S*$",n=new RegExp(t);return!Pr(e)&&n.test(e)},Gy=(e,t)=>new Promise((n,r)=>{const s=[];let i=!1,o=t.length;const a=[...t],c=()=>{const l=t.length-a.length,u=a.shift();u&&u().then(h=>{i||(s[l]=h,o-=1,o?c():n(s))}).catch(h=>{i=!0,r(h)})};for(let l=0;l<e;l++)c()}),Qy=(e,t,n,r)=>{const s=r*t,i=Math.min(s+r,n);return e.slice(s,i)},Xy=async(e,t,n)=>r=>Qy(e,r,t,n),Yy=(e,t,{publicKey:n,contentType:r,onProgress:s,signal:i,integration:o,retryThrottledRequestMaxTimes:a,retryNetworkErrorMaxTimes:c})=>Bf(e,t,{publicKey:n,contentType:r,onProgress:s,signal:i,integration:o,retryThrottledRequestMaxTimes:a,retryNetworkErrorMaxTimes:c}),Jy=async(e,{publicKey:t,fileName:n,fileSize:r,baseURL:s,secureSignature:i,secureExpire:o,store:a,signal:c,onProgress:l,source:u,integration:h,userAgent:f,retryThrottledRequestMaxTimes:m,retryNetworkErrorMaxTimes:R,contentType:T,multipartChunkSize:w=rt.multipartChunkSize,maxConcurrentRequests:L=rt.maxConcurrentRequests,baseCDN:v,metadata:y})=>{const _=r??await jf(e);let q;const S=(D,U)=>{if(!l)return;q||(q=Array(D).fill(0));const nt=et=>et.reduce((At,ve)=>At+ve,0);return et=>{et.isComputable&&(q[U]=et.value,l({isComputable:!0,value:nt(q)/D}))}};return T||(T=kf(e)),Uf(_,{publicKey:t,contentType:T,fileName:n||Nf(e),baseURL:s,secureSignature:i,secureExpire:o,store:a,signal:c,source:u,integration:h,userAgent:f,retryThrottledRequestMaxTimes:m,retryNetworkErrorMaxTimes:R,metadata:y}).then(async({uuid:D,parts:U})=>{const nt=await Xy(e,_,w);return Promise.all([D,Gy(L,U.map((et,At)=>()=>Yy(nt(At),et,{publicKey:t,contentType:T,onProgress:S(U.length,At),signal:c,integration:h,retryThrottledRequestMaxTimes:m,retryNetworkErrorMaxTimes:R})))])}).then(([D])=>$f(D,{publicKey:t,baseURL:s,source:u,integration:h,userAgent:f,retryThrottledRequestMaxTimes:m,retryNetworkErrorMaxTimes:R})).then(D=>D.isReady?D:co(D.uuid,{publicKey:t,baseURL:s,source:u,integration:h,userAgent:f,retryThrottledRequestMaxTimes:m,retryNetworkErrorMaxTimes:R,onProgress:l,signal:c})).then(D=>new Ps(D,{baseCDN:v}))};async function qf(e,{publicKey:t,fileName:n,baseURL:r=rt.baseURL,secureSignature:s,secureExpire:i,store:o,signal:a,onProgress:c,source:l,integration:u,userAgent:h,retryThrottledRequestMaxTimes:f,retryNetworkErrorMaxTimes:m,contentType:R,multipartMinFileSize:T,multipartChunkSize:w,maxConcurrentRequests:L,baseCDN:v=rt.baseCDN,checkForUrlDuplicates:y,saveUrlForRecurrentUploads:_,pusherKey:q,metadata:S}){if(Pr(e)){const D=await jf(e);return Wy(D,T)?Jy(e,{publicKey:t,contentType:R,multipartChunkSize:w,fileSize:D,fileName:n,baseURL:r,secureSignature:s,secureExpire:i,store:o,signal:a,onProgress:c,source:l,integration:u,userAgent:h,maxConcurrentRequests:L,retryThrottledRequestMaxTimes:f,retryNetworkErrorMaxTimes:m,baseCDN:v,metadata:S}):Oy(e,{publicKey:t,fileName:n,contentType:R,baseURL:r,secureSignature:s,secureExpire:i,store:o,signal:a,onProgress:c,source:l,integration:u,userAgent:h,retryThrottledRequestMaxTimes:f,retryNetworkErrorMaxTimes:m,baseCDN:v,metadata:S})}if(kc(e))return Hy(e,{publicKey:t,fileName:n,baseURL:r,baseCDN:v,checkForUrlDuplicates:y,saveUrlForRecurrentUploads:_,secureSignature:s,secureExpire:i,store:o,signal:a,onProgress:c,source:l,integration:u,userAgent:h,retryThrottledRequestMaxTimes:f,retryNetworkErrorMaxTimes:m,pusherKey:q,metadata:S});if(zf(e))return My(e,{publicKey:t,fileName:n,baseURL:r,signal:a,onProgress:c,source:l,integration:u,userAgent:h,retryThrottledRequestMaxTimes:f,retryNetworkErrorMaxTimes:m,baseCDN:v});throw new TypeError(`File uploading from "${e}" is not supported`)}class Zy{constructor(t,{baseCDN:n=rt.baseCDN}={}){Z(this,"uuid");Z(this,"filesCount");Z(this,"totalSize");Z(this,"isStored");Z(this,"isImage");Z(this,"cdnUrl");Z(this,"files");Z(this,"createdAt");Z(this,"storedAt",null);this.uuid=t.id,this.filesCount=t.filesCount;const r=t.files.filter(Boolean);this.totalSize=Object.values(r).reduce((s,i)=>s+i.size,0),this.isStored=!!t.datetimeStored,this.isImage=!!Object.values(r).filter(s=>s.isImage).length,this.cdnUrl=t.cdnUrl,this.files=r.map(s=>new Ps(s,{baseCDN:n})),this.createdAt=t.datetimeCreated,this.storedAt=t.datetimeStored}}const tv=e=>{for(const t of e)if(!Pr(t))return!1;return!0},ev=e=>{for(const t of e)if(!zf(t))return!1;return!0},nv=e=>{for(const t of e)if(!kc(t))return!1;return!0};function rv(e,{publicKey:t,fileName:n,baseURL:r=rt.baseURL,secureSignature:s,secureExpire:i,store:o,signal:a,onProgress:c,source:l,integration:u,userAgent:h,retryThrottledRequestMaxTimes:f,retryNetworkErrorMaxTimes:m,contentType:R,multipartChunkSize:T=rt.multipartChunkSize,baseCDN:w=rt.baseCDN,checkForUrlDuplicates:L,saveUrlForRecurrentUploads:v,jsonpCallback:y}){if(!tv(e)&&!nv(e)&&!ev(e))throw new TypeError(`Group uploading from "${e}" is not supported`);let _,q=!0;const S=e.length,D=(U,nt)=>{if(!c)return;_||(_=Array(U).fill(0));const et=At=>At.reduce((ve,rn)=>ve+rn)/U;return At=>{if(!At.isComputable||!q){q=!1,c({isComputable:!1});return}_[nt]=At.value,c({isComputable:!0,value:et(_)})}};return Promise.all(e.map((U,nt)=>Pr(U)||kc(U)?qf(U,{publicKey:t,fileName:n,baseURL:r,secureSignature:s,secureExpire:i,store:o,signal:a,onProgress:D(S,nt),source:l,integration:u,userAgent:h,retryThrottledRequestMaxTimes:f,retryNetworkErrorMaxTimes:m,contentType:R,multipartChunkSize:T,baseCDN:w,checkForUrlDuplicates:L,saveUrlForRecurrentUploads:v}).then(et=>et.uuid):U)).then(U=>Ff(U,{publicKey:t,baseURL:r,jsonpCallback:y,secureSignature:s,secureExpire:i,signal:a,source:l,integration:u,userAgent:h,retryThrottledRequestMaxTimes:f,retryNetworkErrorMaxTimes:m}).then(nt=>new Zy(nt,{baseCDN:w})).then(nt=>(c&&c({isComputable:!0,value:1}),nt)))}const he=(e,t)=>({...t,...e});class Hf{constructor(t){Z(this,"settings");this.settings=Object.assign({},rt,t)}updateSettings(t){this.settings=Object.assign(this.settings,t)}getSettings(){return this.settings}base(t,n={}){const r=this.getSettings();return Of(t,he(n,r))}info(t,n={}){const r=this.getSettings();return Dc(t,he(n,r))}fromUrl(t,n={}){const r=this.getSettings();return Mf(t,he(n,r))}fromUrlStatus(t,n={}){const r=this.getSettings();return Lf(t,he(n,r))}group(t,n={}){const r=this.getSettings();return Ff(t,he(n,r))}groupInfo(t,n={}){const r=this.getSettings();return ky(t,he(n,r))}multipartStart(t,n={}){const r=this.getSettings();return Uf(t,he(n,r))}multipartUpload(t,n,r={}){const s=this.getSettings();return Bf(t,n,he(r,s))}multipartComplete(t,n={}){const r=this.getSettings();return $f(t,he(n,r))}uploadFile(t,n={}){const r=this.getSettings();return qf(t,he(n,r))}uploadFileGroup(t,n={}){const r=this.getSettings();return rv(t,he(n,r))}isReadyPoll(t,n={}){const r=this.getSettings();return co(t,he(n,r))}}const sv={class:"image-loader"},iv={class:"image-loader__wrapper"},ov={class:"image-loader__input"},av=["src"],cv={class:"image-loader__text"},lv={key:0,class:"image-loader__text"},uv=Je({__name:"ImageLoader",props:{sizeRecommended:{}},emits:["onImageParse"],setup(e,{emit:t}){const n=t;new Hf({publicKey:"10a6fd7ad4acb396dfe1"});const r=({target:c})=>{const l=c.files[0];if(l){const u=new FileReader;u.onload=h=>{const f=new Blob([h.target.result]);s.value=f,i.value=URL.createObjectURL(f),n("onImageParse",{previewUrl:i.value,imageContainer:s.value})},u.readAsArrayBuffer(l)}},s=ft(void 0),i=ft(void 0),o=kt(()=>i.value?"https://ucarecdn.com/2908aae4-53b5-4798-b58f-c21797b07a97/":"https://ucarecdn.com/e8e68b20-7640-4abf-b79a-1d805e5f84b1/"),a=kt(()=>i.value?"Редактировать":"Выбрать");return ft(void 0),(c,l)=>(X(),ht("div",sv,[M("div",iv,[M("label",ov,[M("img",{class:"image-loader__symbol",src:o.value},null,8,av),M("span",cv,Ve(a.value),1),c.sizeRecommended?(X(),ht("p",lv,Ve(c.$props.sizeRecommended),1)):le("",!0),M("input",{type:"file",accept:"image/png, image/jpg, image/jpeg",alt:"what?",onChange:r},null,32)])])]))}}),ka={0:{name:"Сила",img:"a692c434-c29e-4214-9b48-f920e7773dee",ico:""},1:{name:"Телосложение",img:"b185335d-0538-47ab-b95d-c911b1952c5b",ico:""},2:{name:"Интеллект",img:"b1ebd4cf-6386-4f13-a688-695399822e56",ico:""},3:{name:"Мудрость",img:"7ed9b0d3-b3fa-459a-801f-4704586a10b0",ico:""},4:{name:"Обаяние",img:"55adbf0d-2025-42fd-a6dc-cf1c4196c48e",ico:""},5:{name:"Ловкость",img:"91206445-133b-4599-a0b9-ef2a487eea05",ico:""}},fe=26,Ur=26,xe={0:{name:"Сила",img:"a692c434-c29e-4214-9b48-f920e7773dee",ico:""},1:{name:"Телосложение",img:"b185335d-0538-47ab-b95d-c911b1952c5b",ico:""},2:{name:"Интеллект",img:"b1ebd4cf-6386-4f13-a688-695399822e56",ico:""},3:{name:"Мудрость",img:"7ed9b0d3-b3fa-459a-801f-4704586a10b0",ico:""},4:{name:"Обаяние",img:"55adbf0d-2025-42fd-a6dc-cf1c4196c48e",ico:""},5:{name:"Ловкость",img:"91206445-133b-4599-a0b9-ef2a487eea05",ico:""},6:{name:"Карта Героя",img:"9e24d935-6617-4d6f-a3e1-8ee9496e8579",ico:"",width:Ur-2,count:"out"},7:{name:"Карта Анти-Героя",img:"cd2c363b-18be-4f60-8ba0-993bfedf204e",ico:"",width:Ur-2,count:"out"},8:{name:"Триумф",img:"3a0a39fa-1484-4962-af36-4bf501e71ef0",ico:"",width:Ur,count:"in"},9:{name:"Трагедия",img:"5a331c0b-b0b2-43de-a073-1876796b07b5",ico:"",width:Ur,count:"in"},10:{name:"Опыт",img:"e25883b3-7949-49e1-826f-d371c00f2db3",ico:"",width:Ur,count:"in"},11:{name:"Путь справедливости",img:"ec9ddfe0-8215-4865-80d4-810ac7a6c1ca",ico:"",height:fe,width:fe-1},12:{name:"Путь познания",img:"0b14e189-34ec-4471-9908-366e89bf4d5e",ico:"",height:fe,width:fe-1},13:{name:"Путь короны",img:"04a6d945-c604-4619-abc3-89fb85c467ac",ico:"",height:fe,width:fe-1},14:{name:"Путь зла",img:"fe71328a-b575-41ae-b518-2caca7617f37",ico:"",height:fe,width:fe-1},15:{name:"Путь святости",img:"91df25e9-825f-46d9-9cb1-c0ce79976f94",ico:"",height:fe,width:fe-1},16:{name:"Путь приоды",img:"cfd55f90-970f-46eb-8a48-04a70ff3113e",ico:"",height:fe,width:fe-1}},hv={class:"reward"},fv=["src","alt"],dv=Je({__name:"Reward",props:{id:{}},setup(e){const n=Xh(e,"id");return kt(()=>{switch(n.value){case 0:case 1:case 2:case 3:case 4:case 5:return!0;default:return!1}}),(r,s)=>(X(),ht("div",hv,[M("img",{class:"reward__image",src:`https://ucarecdn.com/${tt(xe)[n.value].img}/`,alt:tt(xe)[n.value].name,style:pe(`
				max-height: ${tt(xe)[n.value].height??30}px;
				height: ${tt(xe)[n.value].height??30}px;
				max-width: ${tt(xe)[n.value].width??28}px;
				width: ${tt(xe)[n.value].width??28}px;
			`)},null,12,fv)]))}}),Tu=tn(dv,[["__scopeId","data-v-de5a2131"]]),pv=["data-noimg"],mv={class:"card-header__text"},gv={class:"card-path__rewards",ref:"topRew"},_v={class:"card-header__text"},yv={class:"card-path__rewards",ref:"botRew"},vv={class:"card__name card-challenge"},Ev={class:"card-challenge__difficulty"},Tv={key:0,class:"card-challenge__gap"},wv={key:0,class:"card-challenge__gap"},Iv={class:"card-challenge__name"},Av=Je({__name:"Card",props:{book:{type:Boolean},height:{},width:{},act:{},backImg:{},frontImg:{},topPath:{},botPath:{},cardName:{},difficulty:{},challengeRunes:{},zoom:{},topPathExtraDif:{},botPathExtraDif:{},topRewards:{},botRewards:{},card:{}},emits:["onImageParse"],setup(e){const t=e,n=Xh(t,"frontImg"),{act:r,botPath:s,topPath:i,book:o}=Qh(t),a=ft(0),c=ft(0),l=ft(!1),u=ft(!1),h=ft(!1),f=ft(!1),m=kt(()=>{switch(r.value){case 0:case 1:case 2:return Cc[r.value].backImg;default:return""}}),R=ft("topPathEl"),T=kt(()=>{var _;if(i.value.length)return((_=R.value)==null?void 0:_.offsetHeight)+15});console.log(T);const w=_=>{if(u.value||f.value||h.value||!n.value||o.value)return;const q=_.offsetX,S=_.offsetY,D=_.target.offsetHeight,U=_.target.offsetWidth,nt=15,et=15,At=D/2,ve=U/2,rn=At/et,Lr=ve/nt,qs=(q-ve)/Lr,Lt=(S-At)/rn;a.value===0&&c.value===0&&(u.value=!0,setTimeout(()=>{u.value=!1},100)),c.value=qs,a.value=Lt},L=()=>{o.value||(l.value=!0)},v=()=>{l.value=!1,a.value=0,c.value=0},y=()=>{if(!(f.value||!n.value)){if(v(),h.value){h.value=!1,f.value=!0,setTimeout(()=>{f.value=!1,u.value=!1,l.value=!0},500);return}h.value=!h.value,f.value=!f.value,setTimeout(()=>{f.value=!1,u.value=!1,l.value=!0},500)}};return(_,q)=>{var S,D;return X(),ht("div",{class:"card",onMousemove:w,onMouseout:v,onMouseenter:L,onClick:y,"data-noimg":!n.value,style:pe(`
			transform: scale(${_.zoom/100});
		`)},[M("div",{class:Ft(["card__wrapper",{"card__wrapper--faced":f.value,"card__wrapper--outed":!l.value||u.value}]),style:pe(`
				height: ${_.$props.height??10}px;
				width: ${_.$props.width??10}px;
				transform: rotateX(${a.value}deg) rotateY(${h.value?"180":-c.value}deg);
			`)},[M("div",{class:Ft(["card__front",{"card__front--flipped":f.value}]),style:pe(`
			        background: url('${_.card.imageId?`https://ucarecdn.com/${_.card.imageId}/`:_.card.imageUrl}') no-repeat center/cover;
			     `)},[M("div",{class:Ft(["card__path card__path--top card-path",{"card__path--extra":_.topPathExtraDif,"card__path--dark":_.card.topPath.isDark}]),ref_key:"topPathEl",ref:R},[M("span",mv,[_.topPathExtraDif?(X(),ht("span",{key:0,class:Ft(["card-challenge__difficulty card-challenge__difficulty--extra",{"card__path--dark":_.card.topPath.isDark}])}," +"+Ve(_.topPathExtraDif),3)):le("",!0),M("span",{class:Ft({"card-challenge__name--dark":_.card.topPath.isDark}),style:pe(`
									width: calc(100% - ${((S=_.$refs.topRew)==null?void 0:S.offsetWidth)+43}px);
								`)},Ve(tt(i)),7)]),M("div",gv,[(X(!0),ht(Pt,null,fn(_.card.topPath.rewards,U=>(X(),ye(Tu,{class:Ft({"card__path--dark":_.card.topPath.isDark}),id:U.id},null,8,["class","id"]))),256))],512)],2),M("div",{class:Ft(["card__path card__path--bottom card-path",{"card__path--extra":_.botPathExtraDif,"card__path--dark":_.card.botPath.isDark}])},[M("span",_v,[_.botPathExtraDif?(X(),ht("span",{key:0,class:Ft(["card-challenge__difficulty card-challenge__difficulty--extra",{"card__path--dark":_.card.botPath.isDark}])}," +"+Ve(_.botPathExtraDif),3)):le("",!0),M("span",{class:Ft({"card-challenge__name--dark":_.card.botPath.isDark}),style:pe(`
									width: calc(100% - ${((D=_.$refs.botRew)==null?void 0:D.offsetWidth)+43}px);
								`)},Ve(tt(s)),7)]),M("div",yv,[(X(!0),ht(Pt,null,fn(_.card.botPath.rewards,U=>(X(),ye(Tu,{class:Ft({"card__path--dark":_.card.botPath.isDark}),id:U.id},null,8,["class","id"]))),256))],512)],2),M("div",vv,[M("div",{class:"card-challenge__rotated",style:pe(`top: ${T.value}px;`)},[M("div",Ev,Ve(_.difficulty),1),(_.challengeRunes||[]).length!==0?(X(),ht("div",Tv)):le("",!0),(X(!0),ht(Pt,null,fn(_.challengeRunes||[],(U,nt)=>(X(),ht(Pt,null,[M("div",{class:"card-challenge__rune",style:pe(`
									background: url('https://ucarecdn.com/${tt(ka)[U].img}/') no-repeat center/contain;
								`)},null,4),nt!==(_.challengeRunes||[]).length-1?(X(),ht("div",wv)):le("",!0)],64))),256)),M("span",Iv,Ve(_.cardName),1)],4)])],6),n.value?le("",!0):(X(),ye(uv,{key:0,class:"card__image-loader",onOnImageParse:q[0]||(q[0]=U=>_.$emit("onImageParse",U)),"size-recommended":`${_.$props.height}x${_.$props.width}`},null,8,["size-recommended"]))],6),M("div",{class:Ft(["card__back",{"card__back--flipped":h.value}]),style:pe(`
		        background: url('https://ucarecdn.com/${_.$props.backImg||m.value}/') no-repeat center/cover;
		     `)},null,6)],44,pv)}}}),Kf=tn(Av,[["__scopeId","data-v-9e51fc53"]]),wi=300,Sn={height:wi*1.72,width:wi},ta={height:wi*1.38,width:wi},Ii={0:{name:"Происхождение",img:"",ico:"e3245314-af5c-4464-8d6d-a390503a3aab",backImg:"aefa057a-2202-493b-a298-a661c0707fab",cardSize:Sn},1:{name:"Мотивация",img:"",ico:"4a372f73-d2a1-4f63-8e67-c9521953fbb1",backImg:"0458b31e-e350-49b7-a729-dedf1fa4d583",cardSize:Sn},2:{name:"Судьба",img:"",ico:"1ebde30a-5f86-48c5-b69f-5c946ea59de8",backImg:"2eddf5db-f2b7-420a-a49b-e057d675b872",cardSize:Sn},3:{name:"Карта Героя",img:"",ico:"af14f0cd-42e8-42cc-b36f-c2482ba7aa1b",backImg:"2980073f-66d0-4e20-aa04-3d399d56e937",cardSize:ta},4:{name:"Карта Антигероя",img:"",ico:"4cd045a9-ded3-4330-bc8c-7052accc7653",backImg:"3efb750a-54e0-4841-bd39-0dfd64ad072a",cardSize:ta},5:{name:"Карта Черты",img:"",ico:"5efc700f-ce8c-4b66-8721-8e4794bca980",backImg:null,cardSize:Sn},6:{name:"Испытание",img:"",ico:"db3b09d0-a84f-4b50-865b-667a412100da",backImg:null,cardSize:Sn},7:{name:"Злодей",img:"",ico:"19474701-7c1c-4263-8abc-103210ffc0be",backImg:null,cardSize:Sn},8:{name:"Злодейское дияние",img:"",ico:"ed81f971-0a43-4ec3-a1a6-48e5602f5d5b",backImg:"8a967fcd-b493-4323-8f0c-65cdd491fab7",cardSize:ta},9:{name:"Союзник",img:"",ico:"5542f8ed-b522-4f86-9d1a-97d5a5cecff7",backImg:null,cardSize:Sn}},bv=["min","max","minlength","maxlength","value"],Rv=Je({__name:"Input",props:{max:{},min:{},text:{}},emits:["update:text"],setup(e,{emit:t}){return(n,r)=>(X(),ht("input",{class:"custom-input",type:"text",min:n.$props.min,max:n.$props.max,minlength:n.$props.min,maxlength:n.$props.max,value:n.$props.text,onInput:r[0]||(r[0]=s=>n.$emit("update:text",s.target.value))},null,40,bv))}}),ea=tn(Rv,[["__scopeId","data-v-b14928bf"]]),Sv={class:"rune-checkbox"},Cv=["checked","disabled"],Pv=["src","data-type"],Vv={key:0,class:"rune-checkbox__count",type:"number",max:"10",min:"0"},Dv=Je({__name:"RuneCheckbox",props:{checked:{type:Boolean},id:{},disabled:{type:Boolean},items:{},allowedCount:{type:Boolean}},emits:["toggle"],setup(e){return(t,n)=>(X(),ht("label",Sv,[M("input",{type:"checkbox",checked:t.$props.checked,id:"123",onChange:n[0]||(n[0]=r=>t.$emit("toggle",t.id)),disabled:t.disabled},null,40,Cv),M("img",{src:`https://ucarecdn.com/${t.items[t.id].img}/`,alt:"rune","data-type":t.id},null,8,Pv),t.allowedCount?(X(),ht("input",Vv)):le("",!0)]))}}),na=tn(Dv,[["__scopeId","data-v-0c319c42"]]);var wu={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wf=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let s=e.charCodeAt(r);s<128?t[n++]=s:s<2048?(t[n++]=s>>6|192,t[n++]=s&63|128):(s&64512)===55296&&r+1<e.length&&(e.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(e.charCodeAt(++r)&1023),t[n++]=s>>18|240,t[n++]=s>>12&63|128,t[n++]=s>>6&63|128,t[n++]=s&63|128):(t[n++]=s>>12|224,t[n++]=s>>6&63|128,t[n++]=s&63|128)}return t},xv=function(e){const t=[];let n=0,r=0;for(;n<e.length;){const s=e[n++];if(s<128)t[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=e[n++];t[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=e[n++],o=e[n++],a=e[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;t[r++]=String.fromCharCode(55296+(c>>10)),t[r++]=String.fromCharCode(56320+(c&1023))}else{const i=e[n++],o=e[n++];t[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return t.join("")},Gf={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<e.length;s+=3){const i=e[s],o=s+1<e.length,a=o?e[s+1]:0,c=s+2<e.length,l=c?e[s+2]:0,u=i>>2,h=(i&3)<<4|a>>4;let f=(a&15)<<2|l>>6,m=l&63;c||(m=64,o||(f=64)),r.push(n[u],n[h],n[f],n[m])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Wf(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):xv(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<e.length;){const i=n[e.charAt(s++)],a=s<e.length?n[e.charAt(s)]:0;++s;const l=s<e.length?n[e.charAt(s)]:64;++s;const h=s<e.length?n[e.charAt(s)]:64;if(++s,i==null||a==null||l==null||h==null)throw new kv;const f=i<<2|a>>4;if(r.push(f),l!==64){const m=a<<4&240|l>>2;if(r.push(m),h!==64){const R=l<<6&192|h;r.push(R)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class kv extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Nv=function(e){const t=Wf(e);return Gf.encodeByteArray(t,!0)},Ai=function(e){return Nv(e).replace(/\./g,"")},Ov=function(e){try{return Gf.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mv(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lv=()=>Mv().__FIREBASE_DEFAULTS__,Fv=()=>{if(typeof process>"u"||typeof wu>"u")return;const e=wu.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},Uv=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&Ov(e[1]);return t&&JSON.parse(t)},Nc=()=>{try{return Lv()||Fv()||Uv()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},Bv=e=>{var t,n;return(n=(t=Nc())===null||t===void 0?void 0:t.emulatorHosts)===null||n===void 0?void 0:n[e]},$v=e=>{const t=Bv(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return t[0]==="["?[t.substring(1,n-1),r]:[t.substring(0,n),r]},Qf=()=>{var e;return(e=Nc())===null||e===void 0?void 0:e.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jv{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}wrapCallback(t){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(n):t(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zv(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=t||"demo-project",s=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Ai(JSON.stringify(n)),Ai(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bi(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function qv(){var e;const t=(e=Nc())===null||e===void 0?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Hv(){return!qv()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Xf(){try{return typeof indexedDB=="object"}catch{return!1}}function Kv(){return new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;t(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){t(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wv="FirebaseError";class Vr extends Error{constructor(t,n,r){super(n),this.code=t,this.customData=r,this.name=Wv,Object.setPrototypeOf(this,Vr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Yf.prototype.create)}}class Yf{constructor(t,n,r){this.service=t,this.serviceName=n,this.errors=r}create(t,...n){const r=n[0]||{},s=`${this.service}/${t}`,i=this.errors[t],o=i?Gv(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Vr(s,a,r)}}function Gv(e,t){return e.replace(Qv,(n,r)=>{const s=t[r];return s!=null?String(s):`<${r}?>`})}const Qv=/\{\$([^}]+)}/g;function Na(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const s of n){if(!r.includes(s))return!1;const i=e[s],o=t[s];if(Iu(i)&&Iu(o)){if(!Na(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Iu(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function us(e){return e&&e._delegate?e._delegate:e}class hs{constructor(t,n,r){this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cn="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xv{constructor(t,n){this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){const r=new jv;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(t){var n;const r=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),s=(n=t==null?void 0:t.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(Jv(t))try{this.getOrInitializeService({instanceIdentifier:Cn})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(t=Cn){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...t.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=Cn){return this.instances.has(t)}getOptions(t=Cn){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:n={}}=t,r=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(t,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(t),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&t(o,s),()=>{i.delete(t)}}invokeOnInitCallbacks(t,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(t,n)}catch{}}getOrInitializeService({instanceIdentifier:t,options:n={}}){let r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Yv(t),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch{}return r||null}normalizeInstanceIdentifier(t=Cn){return this.component?this.component.multipleInstances?t:Cn:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Yv(e){return e===Cn?void 0:e}function Jv(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zv{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const n=this.getProvider(t.name);if(n.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);n.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const n=new Xv(t,this);return this.providers.set(t,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ct;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(ct||(ct={}));const tE={debug:ct.DEBUG,verbose:ct.VERBOSE,info:ct.INFO,warn:ct.WARN,error:ct.ERROR,silent:ct.SILENT},eE=ct.INFO,nE={[ct.DEBUG]:"log",[ct.VERBOSE]:"log",[ct.INFO]:"info",[ct.WARN]:"warn",[ct.ERROR]:"error"},rE=(e,t,...n)=>{if(t<e.logLevel)return;const r=new Date().toISOString(),s=nE[t];if(s)console[s](`[${r}]  ${e.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Jf{constructor(t){this.name=t,this._logLevel=eE,this._logHandler=rE,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in ct))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?tE[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,ct.DEBUG,...t),this._logHandler(this,ct.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,ct.VERBOSE,...t),this._logHandler(this,ct.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,ct.INFO,...t),this._logHandler(this,ct.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,ct.WARN,...t),this._logHandler(this,ct.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,ct.ERROR,...t),this._logHandler(this,ct.ERROR,...t)}}const sE=(e,t)=>t.some(n=>e instanceof n);let Au,bu;function iE(){return Au||(Au=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function oE(){return bu||(bu=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Zf=new WeakMap,Oa=new WeakMap,td=new WeakMap,ra=new WeakMap,Oc=new WeakMap;function aE(e){const t=new Promise((n,r)=>{const s=()=>{e.removeEventListener("success",i),e.removeEventListener("error",o)},i=()=>{n(dn(e.result)),s()},o=()=>{r(e.error),s()};e.addEventListener("success",i),e.addEventListener("error",o)});return t.then(n=>{n instanceof IDBCursor&&Zf.set(n,e)}).catch(()=>{}),Oc.set(t,e),t}function cE(e){if(Oa.has(e))return;const t=new Promise((n,r)=>{const s=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",o),e.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(e.error||new DOMException("AbortError","AbortError")),s()};e.addEventListener("complete",i),e.addEventListener("error",o),e.addEventListener("abort",o)});Oa.set(e,t)}let Ma={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return Oa.get(e);if(t==="objectStoreNames")return e.objectStoreNames||td.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return dn(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function lE(e){Ma=e(Ma)}function uE(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...n){const r=e.call(sa(this),t,...n);return td.set(r,t.sort?t.sort():[t]),dn(r)}:oE().includes(e)?function(...t){return e.apply(sa(this),t),dn(Zf.get(this))}:function(...t){return dn(e.apply(sa(this),t))}}function hE(e){return typeof e=="function"?uE(e):(e instanceof IDBTransaction&&cE(e),sE(e,iE())?new Proxy(e,Ma):e)}function dn(e){if(e instanceof IDBRequest)return aE(e);if(ra.has(e))return ra.get(e);const t=hE(e);return t!==e&&(ra.set(e,t),Oc.set(t,e)),t}const sa=e=>Oc.get(e);function fE(e,t,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(e,t),a=dn(o);return r&&o.addEventListener("upgradeneeded",c=>{r(dn(o.result),c.oldVersion,c.newVersion,dn(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),a.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",l=>s(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}const dE=["get","getKey","getAll","getAllKeys","count"],pE=["put","add","delete","clear"],ia=new Map;function Ru(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(ia.get(t))return ia.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,s=pE.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||dE.includes(n)))return;const i=async function(o,...a){const c=this.transaction(o,s?"readwrite":"readonly");let l=c.store;return r&&(l=l.index(a.shift())),(await Promise.all([l[n](...a),s&&c.done]))[0]};return ia.set(t,i),i}lE(e=>({...e,get:(t,n,r)=>Ru(t,n)||e.get(t,n,r),has:(t,n)=>!!Ru(t,n)||e.has(t,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mE{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(gE(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function gE(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const La="@firebase/app",Su="0.9.28";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zn=new Jf("@firebase/app"),_E="@firebase/app-compat",yE="@firebase/analytics-compat",vE="@firebase/analytics",EE="@firebase/app-check-compat",TE="@firebase/app-check",wE="@firebase/auth",IE="@firebase/auth-compat",AE="@firebase/database",bE="@firebase/database-compat",RE="@firebase/functions",SE="@firebase/functions-compat",CE="@firebase/installations",PE="@firebase/installations-compat",VE="@firebase/messaging",DE="@firebase/messaging-compat",xE="@firebase/performance",kE="@firebase/performance-compat",NE="@firebase/remote-config",OE="@firebase/remote-config-compat",ME="@firebase/storage",LE="@firebase/storage-compat",FE="@firebase/firestore",UE="@firebase/firestore-compat",BE="firebase",$E="10.8.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fa="[DEFAULT]",jE={[La]:"fire-core",[_E]:"fire-core-compat",[vE]:"fire-analytics",[yE]:"fire-analytics-compat",[TE]:"fire-app-check",[EE]:"fire-app-check-compat",[wE]:"fire-auth",[IE]:"fire-auth-compat",[AE]:"fire-rtdb",[bE]:"fire-rtdb-compat",[RE]:"fire-fn",[SE]:"fire-fn-compat",[CE]:"fire-iid",[PE]:"fire-iid-compat",[VE]:"fire-fcm",[DE]:"fire-fcm-compat",[xE]:"fire-perf",[kE]:"fire-perf-compat",[NE]:"fire-rc",[OE]:"fire-rc-compat",[ME]:"fire-gcs",[LE]:"fire-gcs-compat",[FE]:"fire-fst",[UE]:"fire-fst-compat","fire-js":"fire-js",[BE]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ri=new Map,Ua=new Map;function zE(e,t){try{e.container.addComponent(t)}catch(n){zn.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Si(e){const t=e.name;if(Ua.has(t))return zn.debug(`There were multiple attempts to register component ${t}.`),!1;Ua.set(t,e);for(const n of Ri.values())zE(n,e);return!0}function qE(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HE={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},pn=new Yf("app","Firebase",HE);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KE{constructor(t,n,r){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new hs("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw pn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WE=$E;function ed(e,t={}){let n=e;typeof t!="object"&&(t={name:t});const r=Object.assign({name:Fa,automaticDataCollectionEnabled:!1},t),s=r.name;if(typeof s!="string"||!s)throw pn.create("bad-app-name",{appName:String(s)});if(n||(n=Qf()),!n)throw pn.create("no-options");const i=Ri.get(s);if(i){if(Na(n,i.options)&&Na(r,i.config))return i;throw pn.create("duplicate-app",{appName:s})}const o=new Zv(s);for(const c of Ua.values())o.addComponent(c);const a=new KE(n,r,o);return Ri.set(s,a),a}function GE(e=Fa){const t=Ri.get(e);if(!t&&e===Fa&&Qf())return ed();if(!t)throw pn.create("no-app",{appName:e});return t}function dr(e,t,n){var r;let s=(r=jE[e])!==null&&r!==void 0?r:e;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=t.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${t}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${t}" contains illegal characters (whitespace or "/")`),zn.warn(a.join(" "));return}Si(new hs(`${s}-version`,()=>({library:s,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QE="firebase-heartbeat-database",XE=1,fs="firebase-heartbeat-store";let oa=null;function nd(){return oa||(oa=fE(QE,XE,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(fs)}catch(n){console.warn(n)}}}}).catch(e=>{throw pn.create("idb-open",{originalErrorMessage:e.message})})),oa}async function YE(e){try{const n=(await nd()).transaction(fs),r=await n.objectStore(fs).get(rd(e));return await n.done,r}catch(t){if(t instanceof Vr)zn.warn(t.message);else{const n=pn.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});zn.warn(n.message)}}}async function Cu(e,t){try{const r=(await nd()).transaction(fs,"readwrite");await r.objectStore(fs).put(t,rd(e)),await r.done}catch(n){if(n instanceof Vr)zn.warn(n.message);else{const r=pn.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});zn.warn(r.message)}}}function rd(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JE=1024,ZE=30*24*60*60*1e3;class tT{constructor(t){this.container=t,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new nT(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var t,n;const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Pu();if(!(((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)))return this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=ZE}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var t;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Pu(),{heartbeatsToSend:r,unsentEntries:s}=eT(this._heartbeatsCache.heartbeats),i=Ai(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function Pu(){return new Date().toISOString().substring(0,10)}function eT(e,t=JE){const n=[];let r=e.slice();for(const s of e){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Vu(n)>t){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Vu(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class nT{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Xf()?Kv().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await YE(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Cu(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Cu(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...t.heartbeats]})}else return}}function Vu(e){return Ai(JSON.stringify({version:2,heartbeats:e})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rT(e){Si(new hs("platform-logger",t=>new mE(t),"PRIVATE")),Si(new hs("heartbeat",t=>new tT(t),"PRIVATE")),dr(La,Su,e),dr(La,Su,"esm2017"),dr("fire-js","")}rT("");var sT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},N,Mc=Mc||{},W=sT||self;function lo(e){var t=typeof e;return t=t!="object"?t:e?Array.isArray(e)?"array":t:"null",t=="array"||t=="object"&&typeof e.length=="number"}function Vs(e){var t=typeof e;return t=="object"&&e!=null||t=="function"}function iT(e){return Object.prototype.hasOwnProperty.call(e,aa)&&e[aa]||(e[aa]=++oT)}var aa="closure_uid_"+(1e9*Math.random()>>>0),oT=0;function aT(e,t,n){return e.call.apply(e.bind,arguments)}function cT(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,r),e.apply(t,s)}}return function(){return e.apply(t,arguments)}}function Yt(e,t,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Yt=aT:Yt=cT,Yt.apply(null,arguments)}function ti(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),e.apply(this,r)}}function Mt(e,t){function n(){}n.prototype=t.prototype,e.$=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.ac=function(r,s,i){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return t.prototype[s].apply(r,o)}}function Tn(){this.s=this.s,this.o=this.o}var lT=0;Tn.prototype.s=!1;Tn.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),lT!=0)&&iT(this)};Tn.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const sd=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if(typeof e=="string")return typeof t!="string"||t.length!=1?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function Lc(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function Du(e,t){for(let n=1;n<arguments.length;n++){const r=arguments[n];if(lo(r)){const s=e.length||0,i=r.length||0;e.length=s+i;for(let o=0;o<i;o++)e[s+o]=r[o]}else e.push(r)}}function Jt(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}Jt.prototype.h=function(){this.defaultPrevented=!0};var uT=function(){if(!W.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const n=()=>{};W.addEventListener("test",n,t),W.removeEventListener("test",n,t)}catch{}return e}();function ds(e){return/^[\s\xa0]*$/.test(e)}function uo(){var e=W.navigator;return e&&(e=e.userAgent)?e:""}function Ne(e){return uo().indexOf(e)!=-1}function Fc(e){return Fc[" "](e),e}Fc[" "]=function(){};function hT(e,t){var n=rw;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}var fT=Ne("Opera"),vr=Ne("Trident")||Ne("MSIE"),id=Ne("Edge"),Ba=id||vr,od=Ne("Gecko")&&!(uo().toLowerCase().indexOf("webkit")!=-1&&!Ne("Edge"))&&!(Ne("Trident")||Ne("MSIE"))&&!Ne("Edge"),dT=uo().toLowerCase().indexOf("webkit")!=-1&&!Ne("Edge");function ad(){var e=W.document;return e?e.documentMode:void 0}var $a;t:{var ca="",la=function(){var e=uo();if(od)return/rv:([^\);]+)(\)|;)/.exec(e);if(id)return/Edge\/([\d\.]+)/.exec(e);if(vr)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e);if(dT)return/WebKit\/(\S+)/.exec(e);if(fT)return/(?:Version)[ \/]?(\S+)/.exec(e)}();if(la&&(ca=la?la[1]:""),vr){var ua=ad();if(ua!=null&&ua>parseFloat(ca)){$a=String(ua);break t}}$a=ca}var ja;if(W.document&&vr){var xu=ad();ja=xu||parseInt($a,10)||void 0}else ja=void 0;var pT=ja;function ps(e,t){if(Jt.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(od){t:{try{Fc(t.nodeName);var s=!0;break t}catch{}s=!1}s||(t=null)}}else n=="mouseover"?t=e.fromElement:n=="mouseout"&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=e.clientX!==void 0?e.clientX:e.pageX,this.clientY=e.clientY!==void 0?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=typeof e.pointerType=="string"?e.pointerType:mT[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&ps.$.h.call(this)}}Mt(ps,Jt);var mT={2:"touch",3:"pen",4:"mouse"};ps.prototype.h=function(){ps.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var Ds="closure_listenable_"+(1e6*Math.random()|0),gT=0;function _T(e,t,n,r,s){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.la=s,this.key=++gT,this.fa=this.ia=!1}function ho(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function Uc(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function yT(e,t){for(const n in e)t.call(void 0,e[n],n,e)}function cd(e){const t={};for(const n in e)t[n]=e[n];return t}const ku="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ld(e,t){let n,r;for(let s=1;s<arguments.length;s++){r=arguments[s];for(n in r)e[n]=r[n];for(let i=0;i<ku.length;i++)n=ku[i],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function fo(e){this.src=e,this.g={},this.h=0}fo.prototype.add=function(e,t,n,r,s){var i=e.toString();e=this.g[i],e||(e=this.g[i]=[],this.h++);var o=qa(e,t,r,s);return-1<o?(t=e[o],n||(t.ia=!1)):(t=new _T(t,this.src,i,!!r,s),t.ia=n,e.push(t)),t};function za(e,t){var n=t.type;if(n in e.g){var r=e.g[n],s=sd(r,t),i;(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(ho(t),e.g[n].length==0&&(delete e.g[n],e.h--))}}function qa(e,t,n,r){for(var s=0;s<e.length;++s){var i=e[s];if(!i.fa&&i.listener==t&&i.capture==!!n&&i.la==r)return s}return-1}var Bc="closure_lm_"+(1e6*Math.random()|0),ha={};function ud(e,t,n,r,s){if(r&&r.once)return fd(e,t,n,r,s);if(Array.isArray(t)){for(var i=0;i<t.length;i++)ud(e,t[i],n,r,s);return null}return n=zc(n),e&&e[Ds]?e.O(t,n,Vs(r)?!!r.capture:!!r,s):hd(e,t,n,!1,r,s)}function hd(e,t,n,r,s,i){if(!t)throw Error("Invalid event type");var o=Vs(s)?!!s.capture:!!s,a=jc(e);if(a||(e[Bc]=a=new fo(e)),n=a.add(t,n,r,o,i),n.proxy)return n;if(r=vT(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)uT||(s=o),s===void 0&&(s=!1),e.addEventListener(t.toString(),r,s);else if(e.attachEvent)e.attachEvent(pd(t.toString()),r);else if(e.addListener&&e.removeListener)e.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function vT(){function e(n){return t.call(e.src,e.listener,n)}const t=ET;return e}function fd(e,t,n,r,s){if(Array.isArray(t)){for(var i=0;i<t.length;i++)fd(e,t[i],n,r,s);return null}return n=zc(n),e&&e[Ds]?e.P(t,n,Vs(r)?!!r.capture:!!r,s):hd(e,t,n,!0,r,s)}function dd(e,t,n,r,s){if(Array.isArray(t))for(var i=0;i<t.length;i++)dd(e,t[i],n,r,s);else r=Vs(r)?!!r.capture:!!r,n=zc(n),e&&e[Ds]?(e=e.i,t=String(t).toString(),t in e.g&&(i=e.g[t],n=qa(i,n,r,s),-1<n&&(ho(i[n]),Array.prototype.splice.call(i,n,1),i.length==0&&(delete e.g[t],e.h--)))):e&&(e=jc(e))&&(t=e.g[t.toString()],e=-1,t&&(e=qa(t,n,r,s)),(n=-1<e?t[e]:null)&&$c(n))}function $c(e){if(typeof e!="number"&&e&&!e.fa){var t=e.src;if(t&&t[Ds])za(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(pd(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=jc(t))?(za(n,e),n.h==0&&(n.src=null,t[Bc]=null)):ho(e)}}}function pd(e){return e in ha?ha[e]:ha[e]="on"+e}function ET(e,t){if(e.fa)e=!0;else{t=new ps(t,this);var n=e.listener,r=e.la||e.src;e.ia&&$c(e),e=n.call(r,t)}return e}function jc(e){return e=e[Bc],e instanceof fo?e:null}var fa="__closure_events_fn_"+(1e9*Math.random()>>>0);function zc(e){return typeof e=="function"?e:(e[fa]||(e[fa]=function(t){return e.handleEvent(t)}),e[fa])}function Ot(){Tn.call(this),this.i=new fo(this),this.S=this,this.J=null}Mt(Ot,Tn);Ot.prototype[Ds]=!0;Ot.prototype.removeEventListener=function(e,t,n,r){dd(this,e,t,n,r)};function qt(e,t){var n,r=e.J;if(r)for(n=[];r;r=r.J)n.push(r);if(e=e.S,r=t.type||t,typeof t=="string")t=new Jt(t,e);else if(t instanceof Jt)t.target=t.target||e;else{var s=t;t=new Jt(r,e),ld(t,s)}if(s=!0,n)for(var i=n.length-1;0<=i;i--){var o=t.g=n[i];s=ei(o,r,!0,t)&&s}if(o=t.g=e,s=ei(o,r,!0,t)&&s,s=ei(o,r,!1,t)&&s,n)for(i=0;i<n.length;i++)o=t.g=n[i],s=ei(o,r,!1,t)&&s}Ot.prototype.N=function(){if(Ot.$.N.call(this),this.i){var e=this.i,t;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)ho(n[r]);delete e.g[t],e.h--}}this.J=null};Ot.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)};Ot.prototype.P=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};function ei(e,t,n,r){if(t=e.i.g[String(t)],!t)return!0;t=t.concat();for(var s=!0,i=0;i<t.length;++i){var o=t[i];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&za(e.i,o),s=a.call(c,r)!==!1&&s}}return s&&!r.defaultPrevented}var qc=W.JSON.stringify;class TT{constructor(t,n){this.i=t,this.j=n,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}function wT(){var e=Hc;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}class IT{constructor(){this.h=this.g=null}add(t,n){const r=md.get();r.set(t,n),this.h?this.h.next=r:this.g=r,this.h=r}}var md=new TT(()=>new AT,e=>e.reset());class AT{constructor(){this.next=this.g=this.h=null}set(t,n){this.h=t,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function bT(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function RT(e){W.setTimeout(()=>{throw e},0)}let ms,gs=!1,Hc=new IT,gd=()=>{const e=W.Promise.resolve(void 0);ms=()=>{e.then(ST)}};var ST=()=>{for(var e;e=wT();){try{e.h.call(e.g)}catch(n){RT(n)}var t=md;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}gs=!1};function po(e,t){Ot.call(this),this.h=e||1,this.g=t||W,this.j=Yt(this.qb,this),this.l=Date.now()}Mt(po,Ot);N=po.prototype;N.ga=!1;N.T=null;N.qb=function(){if(this.ga){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),qt(this,"tick"),this.ga&&(Kc(this),this.start()))}};N.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function Kc(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}N.N=function(){po.$.N.call(this),Kc(this),delete this.g};function Wc(e,t,n){if(typeof e=="function")n&&(e=Yt(e,n));else if(e&&typeof e.handleEvent=="function")e=Yt(e.handleEvent,e);else throw Error("Invalid listener argument");return 2147483647<Number(t)?-1:W.setTimeout(e,t||0)}function _d(e){e.g=Wc(()=>{e.g=null,e.i&&(e.i=!1,_d(e))},e.j);const t=e.h;e.h=null,e.m.apply(null,t)}class CT extends Tn{constructor(t,n){super(),this.m=t,this.j=n,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:_d(this)}N(){super.N(),this.g&&(W.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function _s(e){Tn.call(this),this.h=e,this.g={}}Mt(_s,Tn);var Nu=[];function yd(e,t,n,r){Array.isArray(n)||(n&&(Nu[0]=n.toString()),n=Nu);for(var s=0;s<n.length;s++){var i=ud(t,n[s],r||e.handleEvent,!1,e.h||e);if(!i)break;e.g[i.key]=i}}function vd(e){Uc(e.g,function(t,n){this.g.hasOwnProperty(n)&&$c(t)},e),e.g={}}_s.prototype.N=function(){_s.$.N.call(this),vd(this)};_s.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function mo(){this.g=!0}mo.prototype.Ea=function(){this.g=!1};function PT(e,t,n,r,s,i){e.info(function(){if(e.g)if(i)for(var o="",a=i.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var u=l[0];l=l[1];var h=u.split("_");o=2<=h.length&&h[1]=="type"?o+(u+"="+l+"&"):o+(u+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+t+`
`+n+`
`+o})}function VT(e,t,n,r,s,i,o){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+t+`
`+n+`
`+i+" "+o})}function ar(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+xT(e,n)+(r?" "+r:"")})}function DT(e,t){e.info(function(){return"TIMEOUT: "+t})}mo.prototype.info=function(){};function xT(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n){for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if(i!="noop"&&i!="stop"&&i!="close")for(var o=1;o<s.length;o++)s[o]=""}}}}return qc(n)}catch{return t}}var Qn={},Ou=null;function go(){return Ou=Ou||new Ot}Qn.Ta="serverreachability";function Ed(e){Jt.call(this,Qn.Ta,e)}Mt(Ed,Jt);function ys(e){const t=go();qt(t,new Ed(t))}Qn.STAT_EVENT="statevent";function Td(e,t){Jt.call(this,Qn.STAT_EVENT,e),this.stat=t}Mt(Td,Jt);function se(e){const t=go();qt(t,new Td(t,e))}Qn.Ua="timingevent";function wd(e,t){Jt.call(this,Qn.Ua,e),this.size=t}Mt(wd,Jt);function xs(e,t){if(typeof e!="function")throw Error("Fn must not be null and must be a function");return W.setTimeout(function(){e()},t)}var _o={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Id={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Gc(){}Gc.prototype.h=null;function Mu(e){return e.h||(e.h=e.i())}function Ad(){}var ks={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Qc(){Jt.call(this,"d")}Mt(Qc,Jt);function Xc(){Jt.call(this,"c")}Mt(Xc,Jt);var Ha;function yo(){}Mt(yo,Gc);yo.prototype.g=function(){return new XMLHttpRequest};yo.prototype.i=function(){return{}};Ha=new yo;function Ns(e,t,n,r){this.l=e,this.j=t,this.m=n,this.W=r||1,this.U=new _s(this),this.P=kT,e=Ba?125:void 0,this.V=new po(e),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new bd}function bd(){this.i=null,this.g="",this.h=!1}var kT=45e3,Rd={},Ka={};N=Ns.prototype;N.setTimeout=function(e){this.P=e};function Wa(e,t,n){e.L=1,e.A=Eo(Xe(t)),e.u=n,e.S=!0,Sd(e,null)}function Sd(e,t){e.G=Date.now(),Os(e),e.B=Xe(e.A);var n=e.B,r=e.W;Array.isArray(r)||(r=[String(r)]),Od(n.i,"t",r),e.o=0,n=e.l.J,e.h=new bd,e.g=np(e.l,n?t:null,!e.u),0<e.O&&(e.M=new CT(Yt(e.Pa,e,e.g),e.O)),yd(e.U,e.g,"readystatechange",e.nb),t=e.I?cd(e.I):{},e.u?(e.v||(e.v="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.B,e.v,e.u,t)):(e.v="GET",e.g.ha(e.B,e.v,null,t)),ys(),PT(e.j,e.v,e.B,e.m,e.W,e.u)}N.nb=function(e){e=e.target;const t=this.M;t&&Oe(e)==3?t.l():this.Pa(e)};N.Pa=function(e){try{if(e==this.g)t:{const u=Oe(this.g);var t=this.g.Ia();const h=this.g.da();if(!(3>u)&&(u!=3||Ba||this.g&&(this.h.h||this.g.ja()||Bu(this.g)))){this.J||u!=4||t==7||(t==8||0>=h?ys(3):ys(2)),vo(this);var n=this.g.da();this.ca=n;e:if(Cd(this)){var r=Bu(this.g);e="";var s=r.length,i=Oe(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){xn(this),ts(this);var o="";break e}this.h.i=new W.TextDecoder}for(t=0;t<s;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:i&&t==s-1});r.length=0,this.h.g+=e,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,VT(this.j,this.v,this.B,this.m,this.W,u,n),this.i){if(this.aa&&!this.K){e:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ds(a)){var l=a;break e}}l=null}if(n=l)ar(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ga(this,n);else{this.i=!1,this.s=3,se(12),xn(this),ts(this);break t}}this.S?(Pd(this,u,o),Ba&&this.i&&u==3&&(yd(this.U,this.V,"tick",this.mb),this.V.start())):(ar(this.j,this.m,o,null),Ga(this,o)),u==4&&xn(this),this.i&&!this.J&&(u==4?Jd(this.l,this):(this.i=!1,Os(this)))}else tw(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.s=3,se(12)):(this.s=0,se(13)),xn(this),ts(this)}}}catch{}finally{}};function Cd(e){return e.g?e.v=="GET"&&e.L!=2&&e.l.Ha:!1}function Pd(e,t,n){let r=!0,s;for(;!e.J&&e.o<n.length;)if(s=NT(e,n),s==Ka){t==4&&(e.s=4,se(14),r=!1),ar(e.j,e.m,null,"[Incomplete Response]");break}else if(s==Rd){e.s=4,se(15),ar(e.j,e.m,n,"[Invalid Chunk]"),r=!1;break}else ar(e.j,e.m,s,null),Ga(e,s);Cd(e)&&e.o!=0&&(e.h.g=e.h.g.slice(e.o),e.o=0),t!=4||n.length!=0||e.h.h||(e.s=1,se(16),r=!1),e.i=e.i&&r,r?0<n.length&&!e.ba&&(e.ba=!0,t=e.l,t.g==e&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),nl(t),t.M=!0,se(11))):(ar(e.j,e.m,n,"[Invalid Chunked Response]"),xn(e),ts(e))}N.mb=function(){if(this.g){var e=Oe(this.g),t=this.g.ja();this.o<t.length&&(vo(this),Pd(this,e,t),this.i&&e!=4&&Os(this))}};function NT(e,t){var n=e.o,r=t.indexOf(`
`,n);return r==-1?Ka:(n=Number(t.substring(n,r)),isNaN(n)?Rd:(r+=1,r+n>t.length?Ka:(t=t.slice(r,r+n),e.o=r+n,t)))}N.cancel=function(){this.J=!0,xn(this)};function Os(e){e.Y=Date.now()+e.P,Vd(e,e.P)}function Vd(e,t){if(e.C!=null)throw Error("WatchDog timer not null");e.C=xs(Yt(e.lb,e),t)}function vo(e){e.C&&(W.clearTimeout(e.C),e.C=null)}N.lb=function(){this.C=null;const e=Date.now();0<=e-this.Y?(DT(this.j,this.B),this.L!=2&&(ys(),se(17)),xn(this),this.s=2,ts(this)):Vd(this,this.Y-e)};function ts(e){e.l.H==0||e.J||Jd(e.l,e)}function xn(e){vo(e);var t=e.M;t&&typeof t.sa=="function"&&t.sa(),e.M=null,Kc(e.V),vd(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.sa())}function Ga(e,t){try{var n=e.l;if(n.H!=0&&(n.g==e||Qa(n.i,e))){if(!e.K&&Qa(n.i,e)&&n.H==3){try{var r=n.Ja.g.parse(t)}catch{r=null}if(Array.isArray(r)&&r.length==3){var s=r;if(s[0]==0){t:if(!n.u){if(n.g)if(n.g.G+3e3<e.G)Vi(n),Ao(n);else break t;el(n),se(18)}}else n.Fa=s[1],0<n.Fa-n.V&&37500>s[2]&&n.G&&n.A==0&&!n.v&&(n.v=xs(Yt(n.ib,n),6e3));if(1>=Fd(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else kn(n,11)}else if((e.K||n.g==e)&&Vi(n),!ds(t))for(s=n.Ja.g.parse(t),t=0;t<s.length;t++){let l=s[t];if(n.V=l[0],l=l[1],n.H==2)if(l[0]=="c"){n.K=l[1],n.pa=l[2];const u=l[3];u!=null&&(n.ra=u,n.l.info("VER="+n.ra));const h=l[4];h!=null&&(n.Ga=h,n.l.info("SVER="+n.Ga));const f=l[5];f!=null&&typeof f=="number"&&0<f&&(r=1.5*f,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const m=e.g;if(m){const R=m.g?m.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(R){var i=r.i;i.g||R.indexOf("spdy")==-1&&R.indexOf("quic")==-1&&R.indexOf("h2")==-1||(i.j=i.l,i.g=new Set,i.h&&(Yc(i,i.h),i.h=null))}if(r.F){const T=m.g?m.g.getResponseHeader("X-HTTP-Session-Id"):null;T&&(r.Da=T,yt(r.I,r.F,T))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-e.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=e;if(r.wa=ep(r,r.J?r.pa:null,r.Y),o.K){Ud(r.i,o);var a=o,c=r.L;c&&a.setTimeout(c),a.C&&(vo(a),Os(a)),r.g=o}else Xd(r);0<n.j.length&&bo(n)}else l[0]!="stop"&&l[0]!="close"||kn(n,7);else n.H==3&&(l[0]=="stop"||l[0]=="close"?l[0]=="stop"?kn(n,7):tl(n):l[0]!="noop"&&n.h&&n.h.Aa(l),n.A=0)}}ys(4)}catch{}}function OT(e){if(e.Z&&typeof e.Z=="function")return e.Z();if(typeof Map<"u"&&e instanceof Map||typeof Set<"u"&&e instanceof Set)return Array.from(e.values());if(typeof e=="string")return e.split("");if(lo(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}t=[],n=0;for(r in e)t[n++]=e[r];return t}function MT(e){if(e.ta&&typeof e.ta=="function")return e.ta();if(!e.Z||typeof e.Z!="function"){if(typeof Map<"u"&&e instanceof Map)return Array.from(e.keys());if(!(typeof Set<"u"&&e instanceof Set)){if(lo(e)||typeof e=="string"){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}function Dd(e,t){if(e.forEach&&typeof e.forEach=="function")e.forEach(t,void 0);else if(lo(e)||typeof e=="string")Array.prototype.forEach.call(e,t,void 0);else for(var n=MT(e),r=OT(e),s=r.length,i=0;i<s;i++)t.call(void 0,r[i],n&&n[i],e)}var xd=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function LT(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),s=null;if(0<=r){var i=e[n].substring(0,r);s=e[n].substring(r+1)}else i=e[n];t(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}function Bn(e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof Bn){this.h=e.h,Ci(this,e.j),this.s=e.s,this.g=e.g,Pi(this,e.m),this.l=e.l;var t=e.i,n=new vs;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),Lu(this,n),this.o=e.o}else e&&(t=String(e).match(xd))?(this.h=!1,Ci(this,t[1]||"",!0),this.s=Hr(t[2]||""),this.g=Hr(t[3]||"",!0),Pi(this,t[4]),this.l=Hr(t[5]||"",!0),Lu(this,t[6]||"",!0),this.o=Hr(t[7]||"")):(this.h=!1,this.i=new vs(null,this.h))}Bn.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Kr(t,Fu,!0),":");var n=this.g;return(n||t=="file")&&(e.push("//"),(t=this.s)&&e.push(Kr(t,Fu,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&e.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&e.push("/"),e.push(Kr(n,n.charAt(0)=="/"?BT:UT,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",Kr(n,jT)),e.join("")};function Xe(e){return new Bn(e)}function Ci(e,t,n){e.j=n?Hr(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Pi(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function Lu(e,t,n){t instanceof vs?(e.i=t,zT(e.i,e.h)):(n||(t=Kr(t,$T)),e.i=new vs(t,e.h))}function yt(e,t,n){e.i.set(t,n)}function Eo(e){return yt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Hr(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Kr(e,t,n){return typeof e=="string"?(e=encodeURI(e).replace(t,FT),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function FT(e){return e=e.charCodeAt(0),"%"+(e>>4&15).toString(16)+(e&15).toString(16)}var Fu=/[#\/\?@]/g,UT=/[#\?:]/g,BT=/[#\?]/g,$T=/[#\?@]/g,jT=/#/g;function vs(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function wn(e){e.g||(e.g=new Map,e.h=0,e.i&&LT(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}N=vs.prototype;N.add=function(e,t){wn(this),this.i=null,e=Dr(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this};function kd(e,t){wn(e),t=Dr(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Nd(e,t){return wn(e),t=Dr(e,t),e.g.has(t)}N.forEach=function(e,t){wn(this),this.g.forEach(function(n,r){n.forEach(function(s){e.call(t,s,r,this)},this)},this)};N.ta=function(){wn(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const s=e[r];for(let i=0;i<s.length;i++)n.push(t[r])}return n};N.Z=function(e){wn(this);let t=[];if(typeof e=="string")Nd(this,e)&&(t=t.concat(this.g.get(Dr(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t};N.set=function(e,t){return wn(this),this.i=null,e=Dr(this,e),Nd(this,e)&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this};N.get=function(e,t){return e?(e=this.Z(e),0<e.length?String(e[0]):t):t};function Od(e,t,n){kd(e,t),0<n.length&&(e.i=null,e.g.set(Dr(e,t),Lc(n)),e.h+=n.length)}N.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const i=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var s=i;o[r]!==""&&(s+="="+encodeURIComponent(String(o[r]))),e.push(s)}}return this.i=e.join("&")};function Dr(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function zT(e,t){t&&!e.j&&(wn(e),e.i=null,e.g.forEach(function(n,r){var s=r.toLowerCase();r!=s&&(kd(this,r),Od(this,s,n))},e)),e.j=t}var qT=class{constructor(e,t){this.g=e,this.map=t}};function Md(e){this.l=e||HT,W.PerformanceNavigationTiming?(e=W.performance.getEntriesByType("navigation"),e=0<e.length&&(e[0].nextHopProtocol=="hq"||e[0].nextHopProtocol=="h2")):e=!!(W.g&&W.g.Ka&&W.g.Ka()&&W.g.Ka().dc),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var HT=10;function Ld(e){return e.h?!0:e.g?e.g.size>=e.j:!1}function Fd(e){return e.h?1:e.g?e.g.size:0}function Qa(e,t){return e.h?e.h==t:e.g?e.g.has(t):!1}function Yc(e,t){e.g?e.g.add(t):e.h=t}function Ud(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}Md.prototype.cancel=function(){if(this.i=Bd(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const e of this.g.values())e.cancel();this.g.clear()}};function Bd(e){if(e.h!=null)return e.i.concat(e.h.F);if(e.g!=null&&e.g.size!==0){let t=e.i;for(const n of e.g.values())t=t.concat(n.F);return t}return Lc(e.i)}var KT=class{stringify(e){return W.JSON.stringify(e,void 0)}parse(e){return W.JSON.parse(e,void 0)}};function WT(){this.g=new KT}function GT(e,t,n){const r=n||"";try{Dd(e,function(s,i){let o=s;Vs(s)&&(o=qc(s)),t.push(r+i+"="+encodeURIComponent(o))})}catch(s){throw t.push(r+"type="+encodeURIComponent("_badmap")),s}}function QT(e,t){const n=new mo;if(W.Image){const r=new Image;r.onload=ti(ni,n,r,"TestLoadImage: loaded",!0,t),r.onerror=ti(ni,n,r,"TestLoadImage: error",!1,t),r.onabort=ti(ni,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=ti(ni,n,r,"TestLoadImage: timeout",!1,t),W.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}function ni(e,t,n,r,s){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,s(r)}catch{}}function To(e){this.l=e.ec||null,this.j=e.ob||!1}Mt(To,Gc);To.prototype.g=function(){return new wo(this.l,this.j)};To.prototype.i=function(e){return function(){return e}}({});function wo(e,t){Ot.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=Jc,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Mt(wo,Ot);var Jc=0;N=wo.prototype;N.open=function(e,t){if(this.readyState!=Jc)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,Es(this)};N.send=function(e){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||W).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))};N.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ms(this)),this.readyState=Jc};N.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Es(this)),this.g&&(this.readyState=3,Es(this),this.g)))if(this.responseType==="arraybuffer")e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof W.ReadableStream<"u"&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;$d(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))};function $d(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}N.Xa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Ms(this):Es(this),this.readyState==3&&$d(this)}};N.Za=function(e){this.g&&(this.response=this.responseText=e,Ms(this))};N.Ya=function(e){this.g&&(this.response=e,Ms(this))};N.ka=function(){this.g&&Ms(this)};function Ms(e){e.readyState=4,e.l=null,e.j=null,e.A=null,Es(e)}N.setRequestHeader=function(e,t){this.v.append(e,t)};N.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""};N.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join(`\r
`)};function Es(e){e.onreadystatechange&&e.onreadystatechange.call(e)}Object.defineProperty(wo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(e){this.m=e?"include":"same-origin"}});var XT=W.JSON.parse;function bt(e){Ot.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=jd,this.L=this.M=!1}Mt(bt,Ot);var jd="",YT=/^https?$/i,JT=["POST","PUT"];N=bt.prototype;N.Oa=function(e){this.M=e};N.ha=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Ha.g(),this.C=this.u?Mu(this.u):Mu(Ha),this.g.onreadystatechange=Yt(this.La,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(i){Uu(this,i);return}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(const i of r.keys())n.set(i,r.get(i));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(i=>i.toLowerCase()=="content-type"),s=W.FormData&&e instanceof W.FormData,!(0<=sd(JT,t))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of n)this.g.setRequestHeader(i,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Hd(this),0<this.B&&((this.L=ZT(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Yt(this.ua,this)):this.A=Wc(this.ua,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(i){Uu(this,i)}};function ZT(e){return vr&&typeof e.timeout=="number"&&e.ontimeout!==void 0}N.ua=function(){typeof Mc<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,qt(this,"timeout"),this.abort(8))};function Uu(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,zd(e),Io(e)}function zd(e){e.F||(e.F=!0,qt(e,"complete"),qt(e,"error"))}N.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,qt(this,"complete"),qt(this,"abort"),Io(this))};N.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Io(this,!0)),bt.$.N.call(this)};N.La=function(){this.s||(this.G||this.v||this.l?qd(this):this.kb())};N.kb=function(){qd(this)};function qd(e){if(e.h&&typeof Mc<"u"&&(!e.C[1]||Oe(e)!=4||e.da()!=2)){if(e.v&&Oe(e)==4)Wc(e.La,0,e);else if(qt(e,"readystatechange"),Oe(e)==4){e.h=!1;try{const o=e.da();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break t;default:t=!1}var n;if(!(n=t)){var r;if(r=o===0){var s=String(e.I).match(xd)[1]||null;!s&&W.self&&W.self.location&&(s=W.self.location.protocol.slice(0,-1)),r=!YT.test(s?s.toLowerCase():"")}n=r}if(n)qt(e,"complete"),qt(e,"success");else{e.m=6;try{var i=2<Oe(e)?e.g.statusText:""}catch{i=""}e.j=i+" ["+e.da()+"]",zd(e)}}finally{Io(e)}}}}function Io(e,t){if(e.g){Hd(e);const n=e.g,r=e.C[0]?()=>{}:null;e.g=null,e.C=null,t||qt(e,"ready");try{n.onreadystatechange=r}catch{}}}function Hd(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&(W.clearTimeout(e.A),e.A=null)}N.isActive=function(){return!!this.g};function Oe(e){return e.g?e.g.readyState:0}N.da=function(){try{return 2<Oe(this)?this.g.status:-1}catch{return-1}};N.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};N.Wa=function(e){if(this.g){var t=this.g.responseText;return e&&t.indexOf(e)==0&&(t=t.substring(e.length)),XT(t)}};function Bu(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.K){case jd:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch{return null}}function tw(e){const t={};e=(e.g&&2<=Oe(e)&&e.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<e.length;r++){if(ds(e[r]))continue;var n=bT(e[r]);const s=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();const i=t[s]||[];t[s]=i,i.push(n)}yT(t,function(r){return r.join(", ")})}N.Ia=function(){return this.m};N.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function Kd(e){let t="";return Uc(e,function(n,r){t+=r,t+=":",t+=n,t+=`\r
`}),t}function Zc(e,t,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=Kd(n),typeof e=="string"?n!=null&&encodeURIComponent(String(n)):yt(e,t,n))}function Br(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Wd(e){this.Ga=0,this.j=[],this.l=new mo,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Br("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Br("baseRetryDelayMs",5e3,e),this.hb=Br("retryDelaySeedMs",1e4,e),this.eb=Br("forwardChannelMaxRetries",2,e),this.xa=Br("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.i=new Md(e&&e.concurrentRequestLimit),this.Ja=new WT,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.l.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.qa=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.qa=e.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}N=Wd.prototype;N.ra=8;N.H=1;function tl(e){if(Gd(e),e.H==3){var t=e.W++,n=Xe(e.I);if(yt(n,"SID",e.K),yt(n,"RID",t),yt(n,"TYPE","terminate"),Ls(e,n),t=new Ns(e,e.l,t),t.L=2,t.A=Eo(Xe(n)),n=!1,W.navigator&&W.navigator.sendBeacon)try{n=W.navigator.sendBeacon(t.A.toString(),"")}catch{}!n&&W.Image&&(new Image().src=t.A,n=!0),n||(t.g=np(t.l,null),t.g.ha(t.A)),t.G=Date.now(),Os(t)}tp(e)}function Ao(e){e.g&&(nl(e),e.g.cancel(),e.g=null)}function Gd(e){Ao(e),e.u&&(W.clearTimeout(e.u),e.u=null),Vi(e),e.i.cancel(),e.m&&(typeof e.m=="number"&&W.clearTimeout(e.m),e.m=null)}function bo(e){if(!Ld(e.i)&&!e.m){e.m=!0;var t=e.Na;ms||gd(),gs||(ms(),gs=!0),Hc.add(t,e),e.C=0}}function ew(e,t){return Fd(e.i)>=e.i.j-(e.m?1:0)?!1:e.m?(e.j=t.F.concat(e.j),!0):e.H==1||e.H==2||e.C>=(e.cb?0:e.eb)?!1:(e.m=xs(Yt(e.Na,e,t),Zd(e,e.C)),e.C++,!0)}N.Na=function(e){if(this.m)if(this.m=null,this.H==1){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;const s=new Ns(this,this.l,e);let i=this.s;if(this.U&&(i?(i=cd(i),ld(i,this.U)):i=this.U),this.o!==null||this.O||(s.I=i,i=null),this.P)t:{for(var t=0,n=0;n<this.j.length;n++){e:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break e}r=void 0}if(r===void 0)break;if(t+=r,4096<t){t=n;break t}if(t===4096||n===this.j.length-1){t=n+1;break t}}t=1e3}else t=1e3;t=Qd(this,s,t),n=Xe(this.I),yt(n,"RID",e),yt(n,"CVER",22),this.F&&yt(n,"X-HTTP-Session-Id",this.F),Ls(this,n),i&&(this.O?t="headers="+encodeURIComponent(String(Kd(i)))+"&"+t:this.o&&Zc(n,this.o,i)),Yc(this.i,s),this.bb&&yt(n,"TYPE","init"),this.P?(yt(n,"$req",t),yt(n,"SID","null"),s.aa=!0,Wa(s,n,null)):Wa(s,n,t),this.H=2}}else this.H==3&&(e?$u(this,e):this.j.length==0||Ld(this.i)||$u(this))};function $u(e,t){var n;t?n=t.m:n=e.W++;const r=Xe(e.I);yt(r,"SID",e.K),yt(r,"RID",n),yt(r,"AID",e.V),Ls(e,r),e.o&&e.s&&Zc(r,e.o,e.s),n=new Ns(e,e.l,n,e.C+1),e.o===null&&(n.I=e.s),t&&(e.j=t.F.concat(e.j)),t=Qd(e,n,1e3),n.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),Yc(e.i,n),Wa(n,r,t)}function Ls(e,t){e.na&&Uc(e.na,function(n,r){yt(t,r,n)}),e.h&&Dd({},function(n,r){yt(t,r,n)})}function Qd(e,t,n){n=Math.min(e.j.length,n);var r=e.h?Yt(e.h.Va,e.h,e):null;t:{var s=e.j;let i=-1;for(;;){const o=["count="+n];i==-1?0<n?(i=s[0].g,o.push("ofs="+i)):i=0:o.push("ofs="+i);let a=!0;for(let c=0;c<n;c++){let l=s[c].g;const u=s[c].map;if(l-=i,0>l)i=Math.max(0,s[c].g-100),a=!1;else try{GT(u,o,"req"+l+"_")}catch{r&&r(u)}}if(a){r=o.join("&");break t}}}return e=e.j.splice(0,n),t.F=e,r}function Xd(e){if(!e.g&&!e.u){e.ba=1;var t=e.Ma;ms||gd(),gs||(ms(),gs=!0),Hc.add(t,e),e.A=0}}function el(e){return e.g||e.u||3<=e.A?!1:(e.ba++,e.u=xs(Yt(e.Ma,e),Zd(e,e.A)),e.A++,!0)}N.Ma=function(){if(this.u=null,Yd(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var e=2*this.S;this.l.info("BP detection timer enabled: "+e),this.B=xs(Yt(this.jb,this),e)}};N.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,se(10),Ao(this),Yd(this))};function nl(e){e.B!=null&&(W.clearTimeout(e.B),e.B=null)}function Yd(e){e.g=new Ns(e,e.l,"rpc",e.ba),e.o===null&&(e.g.I=e.s),e.g.O=0;var t=Xe(e.wa);yt(t,"RID","rpc"),yt(t,"SID",e.K),yt(t,"AID",e.V),yt(t,"CI",e.G?"0":"1"),!e.G&&e.qa&&yt(t,"TO",e.qa),yt(t,"TYPE","xmlhttp"),Ls(e,t),e.o&&e.s&&Zc(t,e.o,e.s),e.L&&e.g.setTimeout(e.L);var n=e.g;e=e.pa,n.L=1,n.A=Eo(Xe(t)),n.u=null,n.S=!0,Sd(n,e)}N.ib=function(){this.v!=null&&(this.v=null,Ao(this),el(this),se(19))};function Vi(e){e.v!=null&&(W.clearTimeout(e.v),e.v=null)}function Jd(e,t){var n=null;if(e.g==t){Vi(e),nl(e),e.g=null;var r=2}else if(Qa(e.i,t))n=t.F,Ud(e.i,t),r=1;else return;if(e.H!=0){if(t.i)if(r==1){n=t.u?t.u.length:0,t=Date.now()-t.G;var s=e.C;r=go(),qt(r,new wd(r,n)),bo(e)}else Xd(e);else if(s=t.s,s==3||s==0&&0<t.ca||!(r==1&&ew(e,t)||r==2&&el(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),s){case 1:kn(e,5);break;case 4:kn(e,10);break;case 3:kn(e,6);break;default:kn(e,2)}}}function Zd(e,t){let n=e.ab+Math.floor(Math.random()*e.hb);return e.isActive()||(n*=2),n*t}function kn(e,t){if(e.l.info("Error code "+t),t==2){var n=null;e.h&&(n=null);var r=Yt(e.pb,e);n||(n=new Bn("//www.google.com/images/cleardot.gif"),W.location&&W.location.protocol=="http"||Ci(n,"https"),Eo(n)),QT(n.toString(),r)}else se(2);e.H=0,e.h&&e.h.za(t),tp(e),Gd(e)}N.pb=function(e){e?(this.l.info("Successfully pinged google.com"),se(2)):(this.l.info("Failed to ping google.com"),se(1))};function tp(e){if(e.H=0,e.ma=[],e.h){const t=Bd(e.i);(t.length!=0||e.j.length!=0)&&(Du(e.ma,t),Du(e.ma,e.j),e.i.i.length=0,Lc(e.j),e.j.length=0),e.h.ya()}}function ep(e,t,n){var r=n instanceof Bn?Xe(n):new Bn(n);if(r.g!="")t&&(r.g=t+"."+r.g),Pi(r,r.m);else{var s=W.location;r=s.protocol,t=t?t+"."+s.hostname:s.hostname,s=+s.port;var i=new Bn(null);r&&Ci(i,r),t&&(i.g=t),s&&Pi(i,s),n&&(i.l=n),r=i}return n=e.F,t=e.Da,n&&t&&yt(r,n,t),yt(r,"VER",e.ra),Ls(e,r),r}function np(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return t=e.Ha&&!e.va?new bt(new To({ob:n})):new bt(e.va),t.Oa(e.J),t}N.isActive=function(){return!!this.h&&this.h.isActive(this)};function rp(){}N=rp.prototype;N.Ba=function(){};N.Aa=function(){};N.za=function(){};N.ya=function(){};N.isActive=function(){return!0};N.Va=function(){};function Di(){if(vr&&!(10<=Number(pT)))throw Error("Environmental error: no available transport.")}Di.prototype.g=function(e,t){return new ue(e,t)};function ue(e,t){Ot.call(this),this.g=new Wd(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!ds(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!ds(t)&&(this.g.F=t,e=this.h,e!==null&&t in e&&(e=this.h,t in e&&delete e[t])),this.j=new xr(this)}Mt(ue,Ot);ue.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,n=this.h||void 0;se(0),e.Y=t,e.na=n||{},e.G=e.aa,e.I=ep(e,null,e.Y),bo(e)};ue.prototype.close=function(){tl(this.g)};ue.prototype.u=function(e){var t=this.g;if(typeof e=="string"){var n={};n.__data__=e,e=n}else this.v&&(n={},n.__data__=qc(e),e=n);t.j.push(new qT(t.fb++,e)),t.H==3&&bo(t)};ue.prototype.N=function(){this.g.h=null,delete this.j,tl(this.g),delete this.g,ue.$.N.call(this)};function sp(e){Qc.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){t:{for(const n in t){e=n;break t}e=void 0}(this.i=e)&&(e=this.i,t=t!==null&&e in t?t[e]:void 0),this.data=t}else this.data=e}Mt(sp,Qc);function ip(){Xc.call(this),this.status=1}Mt(ip,Xc);function xr(e){this.g=e}Mt(xr,rp);xr.prototype.Ba=function(){qt(this.g,"a")};xr.prototype.Aa=function(e){qt(this.g,new sp(e))};xr.prototype.za=function(e){qt(this.g,new ip)};xr.prototype.ya=function(){qt(this.g,"b")};function nw(){this.blockSize=-1}function Re(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}Mt(Re,nw);Re.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function da(e,t,n){n||(n=0);var r=Array(16);if(typeof t=="string")for(var s=0;16>s;++s)r[s]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(s=0;16>s;++s)r[s]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],s=e.g[2];var i=e.g[3],o=t+(i^n&(s^i))+r[0]+3614090360&4294967295;t=n+(o<<7&4294967295|o>>>25),o=i+(s^t&(n^s))+r[1]+3905402710&4294967295,i=t+(o<<12&4294967295|o>>>20),o=s+(n^i&(t^n))+r[2]+606105819&4294967295,s=i+(o<<17&4294967295|o>>>15),o=n+(t^s&(i^t))+r[3]+3250441966&4294967295,n=s+(o<<22&4294967295|o>>>10),o=t+(i^n&(s^i))+r[4]+4118548399&4294967295,t=n+(o<<7&4294967295|o>>>25),o=i+(s^t&(n^s))+r[5]+1200080426&4294967295,i=t+(o<<12&4294967295|o>>>20),o=s+(n^i&(t^n))+r[6]+2821735955&4294967295,s=i+(o<<17&4294967295|o>>>15),o=n+(t^s&(i^t))+r[7]+4249261313&4294967295,n=s+(o<<22&4294967295|o>>>10),o=t+(i^n&(s^i))+r[8]+1770035416&4294967295,t=n+(o<<7&4294967295|o>>>25),o=i+(s^t&(n^s))+r[9]+2336552879&4294967295,i=t+(o<<12&4294967295|o>>>20),o=s+(n^i&(t^n))+r[10]+4294925233&4294967295,s=i+(o<<17&4294967295|o>>>15),o=n+(t^s&(i^t))+r[11]+2304563134&4294967295,n=s+(o<<22&4294967295|o>>>10),o=t+(i^n&(s^i))+r[12]+1804603682&4294967295,t=n+(o<<7&4294967295|o>>>25),o=i+(s^t&(n^s))+r[13]+4254626195&4294967295,i=t+(o<<12&4294967295|o>>>20),o=s+(n^i&(t^n))+r[14]+2792965006&4294967295,s=i+(o<<17&4294967295|o>>>15),o=n+(t^s&(i^t))+r[15]+1236535329&4294967295,n=s+(o<<22&4294967295|o>>>10),o=t+(s^i&(n^s))+r[1]+4129170786&4294967295,t=n+(o<<5&4294967295|o>>>27),o=i+(n^s&(t^n))+r[6]+3225465664&4294967295,i=t+(o<<9&4294967295|o>>>23),o=s+(t^n&(i^t))+r[11]+643717713&4294967295,s=i+(o<<14&4294967295|o>>>18),o=n+(i^t&(s^i))+r[0]+3921069994&4294967295,n=s+(o<<20&4294967295|o>>>12),o=t+(s^i&(n^s))+r[5]+3593408605&4294967295,t=n+(o<<5&4294967295|o>>>27),o=i+(n^s&(t^n))+r[10]+38016083&4294967295,i=t+(o<<9&4294967295|o>>>23),o=s+(t^n&(i^t))+r[15]+3634488961&4294967295,s=i+(o<<14&4294967295|o>>>18),o=n+(i^t&(s^i))+r[4]+3889429448&4294967295,n=s+(o<<20&4294967295|o>>>12),o=t+(s^i&(n^s))+r[9]+568446438&4294967295,t=n+(o<<5&4294967295|o>>>27),o=i+(n^s&(t^n))+r[14]+3275163606&4294967295,i=t+(o<<9&4294967295|o>>>23),o=s+(t^n&(i^t))+r[3]+4107603335&4294967295,s=i+(o<<14&4294967295|o>>>18),o=n+(i^t&(s^i))+r[8]+1163531501&4294967295,n=s+(o<<20&4294967295|o>>>12),o=t+(s^i&(n^s))+r[13]+2850285829&4294967295,t=n+(o<<5&4294967295|o>>>27),o=i+(n^s&(t^n))+r[2]+4243563512&4294967295,i=t+(o<<9&4294967295|o>>>23),o=s+(t^n&(i^t))+r[7]+1735328473&4294967295,s=i+(o<<14&4294967295|o>>>18),o=n+(i^t&(s^i))+r[12]+2368359562&4294967295,n=s+(o<<20&4294967295|o>>>12),o=t+(n^s^i)+r[5]+4294588738&4294967295,t=n+(o<<4&4294967295|o>>>28),o=i+(t^n^s)+r[8]+2272392833&4294967295,i=t+(o<<11&4294967295|o>>>21),o=s+(i^t^n)+r[11]+1839030562&4294967295,s=i+(o<<16&4294967295|o>>>16),o=n+(s^i^t)+r[14]+4259657740&4294967295,n=s+(o<<23&4294967295|o>>>9),o=t+(n^s^i)+r[1]+2763975236&4294967295,t=n+(o<<4&4294967295|o>>>28),o=i+(t^n^s)+r[4]+1272893353&4294967295,i=t+(o<<11&4294967295|o>>>21),o=s+(i^t^n)+r[7]+4139469664&4294967295,s=i+(o<<16&4294967295|o>>>16),o=n+(s^i^t)+r[10]+3200236656&4294967295,n=s+(o<<23&4294967295|o>>>9),o=t+(n^s^i)+r[13]+681279174&4294967295,t=n+(o<<4&4294967295|o>>>28),o=i+(t^n^s)+r[0]+3936430074&4294967295,i=t+(o<<11&4294967295|o>>>21),o=s+(i^t^n)+r[3]+3572445317&4294967295,s=i+(o<<16&4294967295|o>>>16),o=n+(s^i^t)+r[6]+76029189&4294967295,n=s+(o<<23&4294967295|o>>>9),o=t+(n^s^i)+r[9]+3654602809&4294967295,t=n+(o<<4&4294967295|o>>>28),o=i+(t^n^s)+r[12]+3873151461&4294967295,i=t+(o<<11&4294967295|o>>>21),o=s+(i^t^n)+r[15]+530742520&4294967295,s=i+(o<<16&4294967295|o>>>16),o=n+(s^i^t)+r[2]+3299628645&4294967295,n=s+(o<<23&4294967295|o>>>9),o=t+(s^(n|~i))+r[0]+4096336452&4294967295,t=n+(o<<6&4294967295|o>>>26),o=i+(n^(t|~s))+r[7]+1126891415&4294967295,i=t+(o<<10&4294967295|o>>>22),o=s+(t^(i|~n))+r[14]+2878612391&4294967295,s=i+(o<<15&4294967295|o>>>17),o=n+(i^(s|~t))+r[5]+4237533241&4294967295,n=s+(o<<21&4294967295|o>>>11),o=t+(s^(n|~i))+r[12]+1700485571&4294967295,t=n+(o<<6&4294967295|o>>>26),o=i+(n^(t|~s))+r[3]+2399980690&4294967295,i=t+(o<<10&4294967295|o>>>22),o=s+(t^(i|~n))+r[10]+4293915773&4294967295,s=i+(o<<15&4294967295|o>>>17),o=n+(i^(s|~t))+r[1]+2240044497&4294967295,n=s+(o<<21&4294967295|o>>>11),o=t+(s^(n|~i))+r[8]+1873313359&4294967295,t=n+(o<<6&4294967295|o>>>26),o=i+(n^(t|~s))+r[15]+4264355552&4294967295,i=t+(o<<10&4294967295|o>>>22),o=s+(t^(i|~n))+r[6]+2734768916&4294967295,s=i+(o<<15&4294967295|o>>>17),o=n+(i^(s|~t))+r[13]+1309151649&4294967295,n=s+(o<<21&4294967295|o>>>11),o=t+(s^(n|~i))+r[4]+4149444226&4294967295,t=n+(o<<6&4294967295|o>>>26),o=i+(n^(t|~s))+r[11]+3174756917&4294967295,i=t+(o<<10&4294967295|o>>>22),o=s+(t^(i|~n))+r[2]+718787259&4294967295,s=i+(o<<15&4294967295|o>>>17),o=n+(i^(s|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(s+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+s&4294967295,e.g[3]=e.g[3]+i&4294967295}Re.prototype.j=function(e,t){t===void 0&&(t=e.length);for(var n=t-this.blockSize,r=this.m,s=this.h,i=0;i<t;){if(s==0)for(;i<=n;)da(this,e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<t;)if(r[s++]=e.charCodeAt(i++),s==this.blockSize){da(this,r),s=0;break}}else for(;i<t;)if(r[s++]=e[i++],s==this.blockSize){da(this,r),s=0;break}}this.h=s,this.i+=t};Re.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=n&255,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};function dt(e,t){this.h=t;for(var n=[],r=!0,s=e.length-1;0<=s;s--){var i=e[s]|0;r&&i==t||(n[s]=i,r=!1)}this.g=n}var rw={};function rl(e){return-128<=e&&128>e?hT(e,function(t){return new dt([t|0],0>t?-1:0)}):new dt([e|0],0>e?-1:0)}function Me(e){if(isNaN(e)||!isFinite(e))return pr;if(0>e)return $t(Me(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=Xa;return new dt(t,0)}function op(e,t){if(e.length==0)throw Error("number format error: empty string");if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(e.charAt(0)=="-")return $t(op(e.substring(1),t));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=Me(Math.pow(t,8)),r=pr,s=0;s<e.length;s+=8){var i=Math.min(8,e.length-s),o=parseInt(e.substring(s,s+i),t);8>i?(i=Me(Math.pow(t,i)),r=r.R(i).add(Me(o))):(r=r.R(n),r=r.add(Me(o)))}return r}var Xa=4294967296,pr=rl(0),Ya=rl(1),ju=rl(16777216);N=dt.prototype;N.ea=function(){if(me(this))return-$t(this).ea();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.D(n);e+=(0<=r?r:Xa+r)*t,t*=Xa}return e};N.toString=function(e){if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(Ke(this))return"0";if(me(this))return"-"+$t(this).toString(e);for(var t=Me(Math.pow(e,6)),n=this,r="";;){var s=ki(n,t).g;n=xi(n,s.R(t));var i=((0<n.g.length?n.g[0]:n.h)>>>0).toString(e);if(n=s,Ke(n))return i+r;for(;6>i.length;)i="0"+i;r=i+r}};N.D=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h};function Ke(e){if(e.h!=0)return!1;for(var t=0;t<e.g.length;t++)if(e.g[t]!=0)return!1;return!0}function me(e){return e.h==-1}N.X=function(e){return e=xi(this,e),me(e)?-1:Ke(e)?0:1};function $t(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new dt(n,~e.h).add(Ya)}N.abs=function(){return me(this)?$t(this):this};N.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,s=0;s<=t;s++){var i=r+(this.D(s)&65535)+(e.D(s)&65535),o=(i>>>16)+(this.D(s)>>>16)+(e.D(s)>>>16);r=o>>>16,i&=65535,o&=65535,n[s]=o<<16|i}return new dt(n,n[n.length-1]&-2147483648?-1:0)};function xi(e,t){return e.add($t(t))}N.R=function(e){if(Ke(this)||Ke(e))return pr;if(me(this))return me(e)?$t(this).R($t(e)):$t($t(this).R(e));if(me(e))return $t(this.R($t(e)));if(0>this.X(ju)&&0>e.X(ju))return Me(this.ea()*e.ea());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var s=0;s<e.g.length;s++){var i=this.D(r)>>>16,o=this.D(r)&65535,a=e.D(s)>>>16,c=e.D(s)&65535;n[2*r+2*s]+=o*c,ri(n,2*r+2*s),n[2*r+2*s+1]+=i*c,ri(n,2*r+2*s+1),n[2*r+2*s+1]+=o*a,ri(n,2*r+2*s+1),n[2*r+2*s+2]+=i*a,ri(n,2*r+2*s+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new dt(n,0)};function ri(e,t){for(;(e[t]&65535)!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function $r(e,t){this.g=e,this.h=t}function ki(e,t){if(Ke(t))throw Error("division by zero");if(Ke(e))return new $r(pr,pr);if(me(e))return t=ki($t(e),t),new $r($t(t.g),$t(t.h));if(me(t))return t=ki(e,$t(t)),new $r($t(t.g),t.h);if(30<e.g.length){if(me(e)||me(t))throw Error("slowDivide_ only works with positive integers.");for(var n=Ya,r=t;0>=r.X(e);)n=zu(n),r=zu(r);var s=tr(n,1),i=tr(r,1);for(r=tr(r,2),n=tr(n,2);!Ke(r);){var o=i.add(r);0>=o.X(e)&&(s=s.add(n),i=o),r=tr(r,1),n=tr(n,1)}return t=xi(e,s.R(t)),new $r(s,t)}for(s=pr;0<=e.X(t);){for(n=Math.max(1,Math.floor(e.ea()/t.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),i=Me(n),o=i.R(t);me(o)||0<o.X(e);)n-=r,i=Me(n),o=i.R(t);Ke(i)&&(i=Ya),s=s.add(i),e=xi(e,o)}return new $r(s,e)}N.gb=function(e){return ki(this,e).h};N.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)&e.D(r);return new dt(n,this.h&e.h)};N.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)|e.D(r);return new dt(n,this.h|e.h)};N.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)^e.D(r);return new dt(n,this.h^e.h)};function zu(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.D(r)<<1|e.D(r-1)>>>31;return new dt(n,e.h)}function tr(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,s=[],i=0;i<r;i++)s[i]=0<t?e.D(i+n)>>>t|e.D(i+n+1)<<32-t:e.D(i+n);return new dt(s,e.h)}Di.prototype.createWebChannel=Di.prototype.g;ue.prototype.send=ue.prototype.u;ue.prototype.open=ue.prototype.m;ue.prototype.close=ue.prototype.close;_o.NO_ERROR=0;_o.TIMEOUT=8;_o.HTTP_ERROR=6;Id.COMPLETE="complete";Ad.EventType=ks;ks.OPEN="a";ks.CLOSE="b";ks.ERROR="c";ks.MESSAGE="d";Ot.prototype.listen=Ot.prototype.O;bt.prototype.listenOnce=bt.prototype.P;bt.prototype.getLastError=bt.prototype.Sa;bt.prototype.getLastErrorCode=bt.prototype.Ia;bt.prototype.getStatus=bt.prototype.da;bt.prototype.getResponseJson=bt.prototype.Wa;bt.prototype.getResponseText=bt.prototype.ja;bt.prototype.send=bt.prototype.ha;bt.prototype.setWithCredentials=bt.prototype.Oa;Re.prototype.digest=Re.prototype.l;Re.prototype.reset=Re.prototype.reset;Re.prototype.update=Re.prototype.j;dt.prototype.add=dt.prototype.add;dt.prototype.multiply=dt.prototype.R;dt.prototype.modulo=dt.prototype.gb;dt.prototype.compare=dt.prototype.X;dt.prototype.toNumber=dt.prototype.ea;dt.prototype.toString=dt.prototype.toString;dt.prototype.getBits=dt.prototype.D;dt.fromNumber=Me;dt.fromString=op;var sw=function(){return new Di},iw=function(){return go()},pa=_o,ow=Id,aw=Qn,qu={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},si=Ad,cw=bt,lw=Re,mr=dt;const Hu="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Gt.UNAUTHENTICATED=new Gt(null),Gt.GOOGLE_CREDENTIALS=new Gt("google-credentials-uid"),Gt.FIRST_PARTY=new Gt("first-party-uid"),Gt.MOCK_USER=new Gt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kr="10.8.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qn=new Jf("@firebase/firestore");function jr(){return qn.logLevel}function k(e,...t){if(qn.logLevel<=ct.DEBUG){const n=t.map(sl);qn.debug(`Firestore (${kr}): ${e}`,...n)}}function $e(e,...t){if(qn.logLevel<=ct.ERROR){const n=t.map(sl);qn.error(`Firestore (${kr}): ${e}`,...n)}}function Er(e,...t){if(qn.logLevel<=ct.WARN){const n=t.map(sl);qn.warn(`Firestore (${kr}): ${e}`,...n)}}function sl(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H(e="Unexpected state"){const t=`FIRESTORE (${kr}) INTERNAL ASSERTION FAILED: `+e;throw $e(t),new Error(t)}function gt(e,t){e||H()}function J(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class B extends Vr{constructor(t,n){super(t,n),this.code=t,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ge{constructor(){this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap{constructor(t,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class uw{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,n){t.enqueueRetryable(()=>n(Gt.UNAUTHENTICATED))}shutdown(){}}class hw{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,n){this.changeListener=n,t.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class fw{constructor(t){this.t=t,this.currentUser=Gt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,n){let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new Ge;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Ge,t.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;t.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},a=c=>{k("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(k("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Ge)}},0),o()}getToken(){const t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==t?(k("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(gt(typeof r.accessToken=="string"),new ap(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return gt(t===null||typeof t=="string"),new Gt(t)}}class dw{constructor(t,n,r){this.l=t,this.h=n,this.P=r,this.type="FirstParty",this.user=Gt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class pw{constructor(t,n,r){this.l=t,this.h=n,this.P=r}getToken(){return Promise.resolve(new dw(this.l,this.h,this.P))}start(t,n){t.enqueueRetryable(()=>n(Gt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class mw{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class gw{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,n){const r=i=>{i.error!=null&&k("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,k("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{t.enqueueRetryable(()=>r(i))};const s=i=>{k("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):k("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(n=>n?(gt(typeof n.token=="string"),this.R=n.token,new mw(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _w(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cp{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/t.length)*t.length;let r="";for(;r.length<20;){const s=_w(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=t.charAt(s[i]%t.length))}return r}}function ut(e,t){return e<t?-1:e>t?1:0}function Tr(e,t,n){return e.length===t.length&&e.every((r,s)=>n(r,t[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{constructor(t,n){if(this.seconds=t,this.nanoseconds=n,n<0)throw new B(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new B(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<-62135596800)throw new B(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new B(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return Dt.fromMillis(Date.now())}static fromDate(t){return Dt.fromMillis(t.getTime())}static fromMillis(t){const n=Math.floor(t/1e3),r=Math.floor(1e6*(t-1e3*n));return new Dt(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?ut(this.nanoseconds,t.nanoseconds):ut(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q{constructor(t){this.timestamp=t}static fromTimestamp(t){return new Q(t)}static min(){return new Q(new Dt(0,0))}static max(){return new Q(new Dt(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts{constructor(t,n,r){n===void 0?n=0:n>t.length&&H(),r===void 0?r=t.length-n:r>t.length-n&&H(),this.segments=t,this.offset=n,this.len=r}get length(){return this.len}isEqual(t){return Ts.comparator(this,t)===0}child(t){const n=this.segments.slice(this.offset,this.limit());return t instanceof Ts?t.forEach(r=>{n.push(r)}):n.push(t),this.construct(n)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}forEach(t){for(let n=this.offset,r=this.limit();n<r;n++)t(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,n){const r=Math.min(t.length,n.length);for(let s=0;s<r;s++){const i=t.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return t.length<n.length?-1:t.length>n.length?1:0}}class Et extends Ts{construct(t,n,r){return new Et(t,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const n=[];for(const r of t){if(r.indexOf("//")>=0)throw new B(b.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Et(n)}static emptyPath(){return new Et([])}}const yw=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class zt extends Ts{construct(t,n,r){return new zt(t,n,r)}static isValidIdentifier(t){return yw.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),zt.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new zt(["__name__"])}static fromServerFormat(t){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new B(b.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<t.length;){const a=t[s];if(a==="\\"){if(s+1===t.length)throw new B(b.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const c=t[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new B(b.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=c,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new B(b.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new zt(n)}static emptyPath(){return new zt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j{constructor(t){this.path=t}static fromPath(t){return new j(Et.fromString(t))}static fromName(t){return new j(Et.fromString(t).popFirst(5))}static empty(){return new j(Et.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&Et.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,n){return Et.comparator(t.path,n.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new j(new Et(t.slice()))}}function vw(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,s=Q.fromTimestamp(r===1e9?new Dt(n+1,0):new Dt(n,r));return new _n(s,j.empty(),t)}function Ew(e){return new _n(e.readTime,e.key,-1)}class _n{constructor(t,n,r){this.readTime=t,this.documentKey=n,this.largestBatchId=r}static min(){return new _n(Q.min(),j.empty(),-1)}static max(){return new _n(Q.max(),j.empty(),-1)}}function Tw(e,t){let n=e.readTime.compareTo(t.readTime);return n!==0?n:(n=j.comparator(e.documentKey,t.documentKey),n!==0?n:ut(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ww="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Iw{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fs(e){if(e.code!==b.FAILED_PRECONDITION||e.message!==ww)throw e;k("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(t){return this.next(void 0,t)}next(t,n){return this.callbackAttached&&H(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new E((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(t,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((t,n)=>{this.next(t,n)})}wrapUserFunction(t){try{const n=t();return n instanceof E?n:E.resolve(n)}catch(n){return E.reject(n)}}wrapSuccess(t,n){return t?this.wrapUserFunction(()=>t(n)):E.resolve(n)}wrapFailure(t,n){return t?this.wrapUserFunction(()=>t(n)):E.reject(n)}static resolve(t){return new E((n,r)=>{n(t)})}static reject(t){return new E((n,r)=>{r(t)})}static waitFor(t){return new E((n,r)=>{let s=0,i=0,o=!1;t.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(t){let n=E.resolve(!1);for(const r of t)n=n.next(s=>s?E.resolve(s):r());return n}static forEach(t,n){const r=[];return t.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(t,n){return new E((r,s)=>{const i=t.length,o=new Array(i);let a=0;for(let c=0;c<i;c++){const l=c;n(t[l]).next(u=>{o[l]=u,++a,a===i&&r(o)},u=>s(u))}})}static doWhile(t,n){return new E((r,s)=>{const i=()=>{t()===!0?n().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il{constructor(t,n){this.action=t,this.transaction=n,this.aborted=!1,this.V=new Ge,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new es(t,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const s=ol(r.target.error);this.V.reject(new es(t,s))}}static open(t,n,r,s){try{return new il(n,t.transaction(s,r))}catch(i){throw new es(n,i)}}get m(){return this.V.promise}abort(t){t&&this.V.reject(t),this.aborted||(k("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const t=this.transaction;this.aborted||typeof t.commit!="function"||t.commit()}store(t){const n=this.transaction.objectStore(t);return new bw(n)}}class Nn{constructor(t,n,r){this.name=t,this.version=n,this.p=r,Nn.S(bi())===12.2&&$e("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(t){return k("SimpleDb","Removing database:",t),Vn(window.indexedDB.deleteDatabase(t)).toPromise()}static D(){if(!Xf())return!1;if(Nn.C())return!0;const t=bi(),n=Nn.S(t),r=0<n&&n<10,s=Nn.v(t),i=0<s&&s<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||r||i)}static C(){var t;return typeof process<"u"&&((t=process.__PRIVATE_env)===null||t===void 0?void 0:t.F)==="YES"}static M(t,n){return t.store(n)}static S(t){const n=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(t){const n=t.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}async O(t){return this.db||(k("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;n(o)},s.onblocked=()=>{r(new es(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new B(b.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new B(b.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new es(t,o))},s.onupgradeneeded=i=>{k("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.p.N(o,s.transaction,i.oldVersion,this.version).next(()=>{k("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.B&&(this.db.onversionchange=n=>this.B(n)),this.db}L(t){this.B=t,this.db&&(this.db.onversionchange=n=>t(n))}async runTransaction(t,n,r,s){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.O(t);const a=il.open(this.db,t,i?"readonly":"readwrite",r),c=s(a).next(l=>(a.g(),l)).catch(l=>(a.abort(l),E.reject(l))).toPromise();return c.catch(()=>{}),await a.m,c}catch(a){const c=a,l=c.name!=="FirebaseError"&&o<3;if(k("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}class Aw{constructor(t){this.k=t,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(t){this.k=t}done(){this.q=!0}U(t){this.K=t}delete(){return Vn(this.k.delete())}}class es extends B{constructor(t,n){super(b.UNAVAILABLE,`IndexedDB transaction '${t}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Us(e){return e.name==="IndexedDbTransactionError"}class bw{constructor(t){this.store=t}put(t,n){let r;return n!==void 0?(k("SimpleDb","PUT",this.store.name,t,n),r=this.store.put(n,t)):(k("SimpleDb","PUT",this.store.name,"<auto-key>",t),r=this.store.put(t)),Vn(r)}add(t){return k("SimpleDb","ADD",this.store.name,t,t),Vn(this.store.add(t))}get(t){return Vn(this.store.get(t)).next(n=>(n===void 0&&(n=null),k("SimpleDb","GET",this.store.name,t,n),n))}delete(t){return k("SimpleDb","DELETE",this.store.name,t),Vn(this.store.delete(t))}count(){return k("SimpleDb","COUNT",this.store.name),Vn(this.store.count())}W(t,n){const r=this.options(t,n),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new E((o,a)=>{i.onerror=c=>{a(c.target.error)},i.onsuccess=c=>{o(c.target.result)}})}{const i=this.cursor(r),o=[];return this.G(i,(a,c)=>{o.push(c)}).next(()=>o)}}j(t,n){const r=this.store.getAll(t,n===null?void 0:n);return new E((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}H(t,n){k("SimpleDb","DELETE ALL",this.store.name);const r=this.options(t,n);r.J=!1;const s=this.cursor(r);return this.G(s,(i,o,a)=>a.delete())}Y(t,n){let r;n?r=t:(r={},n=t);const s=this.cursor(r);return this.G(s,n)}Z(t){const n=this.cursor({});return new E((r,s)=>{n.onerror=i=>{const o=ol(i.target.error);s(o)},n.onsuccess=i=>{const o=i.target.result;o?t(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}G(t,n){const r=[];return new E((s,i)=>{t.onerror=o=>{i(o.target.error)},t.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const c=new Aw(a),l=n(a.primaryKey,a.value,c);if(l instanceof E){const u=l.catch(h=>(c.done(),E.reject(h)));r.push(u)}c.isDone?s():c.$===null?a.continue():a.continue(c.$)}}).next(()=>E.waitFor(r))}options(t,n){let r;return t!==void 0&&(typeof t=="string"?r=t:n=t),{index:r,range:n}}cursor(t){let n="next";if(t.reverse&&(n="prev"),t.index){const r=this.store.index(t.index);return t.J?r.openKeyCursor(t.range,n):r.openCursor(t.range,n)}return this.store.openCursor(t.range,n)}}function Vn(e){return new E((t,n)=>{e.onsuccess=r=>{const s=r.target.result;t(s)},e.onerror=r=>{const s=ol(r.target.error);n(s)}})}let Ku=!1;function ol(e){const t=Nn.S(bi());if(t>=12.2&&t<13){const n="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(n)>=0){const r=new B("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Ku||(Ku=!0,setTimeout(()=>{throw r},0)),r}}return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=r=>this.se(r),this.oe=r=>n.writeSequenceNumber(r))}se(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.oe&&this.oe(t),t}}al._e=-1;function Ro(e){return e==null}function Ni(e){return e===0&&1/e==-1/0}function Rw(e){return typeof e=="number"&&Number.isInteger(e)&&!Ni(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wu(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Nr(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function lp(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(t,n){this.comparator=t,this.root=n||Bt.EMPTY}insert(t,n){return new It(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,Bt.BLACK,null,null))}remove(t){return new It(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Bt.BLACK,null,null))}get(t){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(t,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(t){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(t,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((n,r)=>(t(n,r),!1))}toString(){const t=[];return this.inorderTraversal((n,r)=>(t.push(`${n}:${r}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new ii(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new ii(this.root,t,this.comparator,!1)}getReverseIterator(){return new ii(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new ii(this.root,t,this.comparator,!0)}}class ii{constructor(t,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!t.isEmpty();)if(i=n?r(t.key,n):1,n&&s&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(i===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const n={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Bt{constructor(t,n,r,s,i){this.key=t,this.value=n,this.color=r??Bt.RED,this.left=s??Bt.EMPTY,this.right=i??Bt.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,n,r,s,i){return new Bt(t??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,n,r){let s=this;const i=r(t,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(t,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(t,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Bt.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,n){let r,s=this;if(n(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(t,s.key)===0){if(s.right.isEmpty())return Bt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Bt.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Bt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,n)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw H();const t=this.left.check();if(t!==this.right.check())throw H();return t+(this.isRed()?0:1)}}Bt.EMPTY=null,Bt.RED=!0,Bt.BLACK=!1;Bt.EMPTY=new class{constructor(){this.size=0}get key(){throw H()}get value(){throw H()}get color(){throw H()}get left(){throw H()}get right(){throw H()}copy(t,n,r,s,i){return this}insert(t,n,r){return new Bt(t,n)}remove(t,n){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(t){this.comparator=t,this.data=new It(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((n,r)=>(t(n),!1))}forEachInRange(t,n){const r=this.data.getIteratorFrom(t[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,t[1])>=0)return;n(s.key)}}forEachWhile(t,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!t(r.getNext().key))return}firstAfterOrEqual(t){const n=this.data.getIteratorFrom(t);return n.hasNext()?n.getNext().key:null}getIterator(){return new Gu(this.data.getIterator())}getIteratorFrom(t){return new Gu(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let n=this;return n.size<t.size&&(n=t,t=this),t.forEach(r=>{n=n.add(r)}),n}isEqual(t){if(!(t instanceof Ht)||this.size!==t.size)return!1;const n=this.data.getIterator(),r=t.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(n=>{t.push(n)}),t}toString(){const t=[];return this.forEach(n=>t.push(n)),"SortedSet("+t.toString()+")"}copy(t){const n=new Ht(this.comparator);return n.data=t,n}}class Gu{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ie{constructor(t){this.fields=t,t.sort(zt.comparator)}static empty(){return new Ie([])}unionWith(t){let n=new Ht(zt.comparator);for(const r of this.fields)n=n.add(r);for(const r of t)n=n.add(r);return new Ie(n.toArray())}covers(t){for(const n of this.fields)if(n.isPrefixOf(t))return!0;return!1}isEqual(t){return Tr(this.fields,t.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class up extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class te{constructor(t){this.binaryString=t}static fromBase64String(t){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new up("Invalid base64 string: "+i):i}}(t);return new te(n)}static fromUint8Array(t){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(t);return new te(n)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return ut(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}te.EMPTY_BYTE_STRING=new te("");const Sw=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function yn(e){if(gt(!!e),typeof e=="string"){let t=0;const n=Sw.exec(e);if(gt(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),t=Number(s)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:St(e.seconds),nanos:St(e.nanos)}}function St(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function Hn(e){return typeof e=="string"?te.fromBase64String(e):te.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cl(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function ll(e){const t=e.mapValue.fields.__previous_value__;return cl(t)?ll(t):t}function ws(e){const t=yn(e.mapValue.fields.__local_write_time__.timestampValue);return new Dt(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cw{constructor(t,n,r,s,i,o,a,c,l){this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}}class Is{constructor(t,n){this.projectId=t,this.database=n||"(default)"}static empty(){return new Is("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(t){return t instanceof Is&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oi={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Kn(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?cl(e)?4:Pw(e)?9007199254740991:10:H()}function je(e,t){if(e===t)return!0;const n=Kn(e);if(n!==Kn(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return ws(e).isEqual(ws(t));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=yn(s.timestampValue),a=yn(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(s,i){return Hn(s.bytesValue).isEqual(Hn(i.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(s,i){return St(s.geoPointValue.latitude)===St(i.geoPointValue.latitude)&&St(s.geoPointValue.longitude)===St(i.geoPointValue.longitude)}(e,t);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return St(s.integerValue)===St(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=St(s.doubleValue),a=St(i.doubleValue);return o===a?Ni(o)===Ni(a):isNaN(o)&&isNaN(a)}return!1}(e,t);case 9:return Tr(e.arrayValue.values||[],t.arrayValue.values||[],je);case 10:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(Wu(o)!==Wu(a))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!je(o[c],a[c])))return!1;return!0}(e,t);default:return H()}}function As(e,t){return(e.values||[]).find(n=>je(n,t))!==void 0}function wr(e,t){if(e===t)return 0;const n=Kn(e),r=Kn(t);if(n!==r)return ut(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ut(e.booleanValue,t.booleanValue);case 2:return function(i,o){const a=St(i.integerValue||i.doubleValue),c=St(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(e,t);case 3:return Qu(e.timestampValue,t.timestampValue);case 4:return Qu(ws(e),ws(t));case 5:return ut(e.stringValue,t.stringValue);case 6:return function(i,o){const a=Hn(i),c=Hn(o);return a.compareTo(c)}(e.bytesValue,t.bytesValue);case 7:return function(i,o){const a=i.split("/"),c=o.split("/");for(let l=0;l<a.length&&l<c.length;l++){const u=ut(a[l],c[l]);if(u!==0)return u}return ut(a.length,c.length)}(e.referenceValue,t.referenceValue);case 8:return function(i,o){const a=ut(St(i.latitude),St(o.latitude));return a!==0?a:ut(St(i.longitude),St(o.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(i,o){const a=i.values||[],c=o.values||[];for(let l=0;l<a.length&&l<c.length;++l){const u=wr(a[l],c[l]);if(u)return u}return ut(a.length,c.length)}(e.arrayValue,t.arrayValue);case 10:return function(i,o){if(i===oi.mapValue&&o===oi.mapValue)return 0;if(i===oi.mapValue)return 1;if(o===oi.mapValue)return-1;const a=i.fields||{},c=Object.keys(a),l=o.fields||{},u=Object.keys(l);c.sort(),u.sort();for(let h=0;h<c.length&&h<u.length;++h){const f=ut(c[h],u[h]);if(f!==0)return f;const m=wr(a[c[h]],l[u[h]]);if(m!==0)return m}return ut(c.length,u.length)}(e.mapValue,t.mapValue);default:throw H()}}function Qu(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return ut(e,t);const n=yn(e),r=yn(t),s=ut(n.seconds,r.seconds);return s!==0?s:ut(n.nanos,r.nanos)}function Ir(e){return Ja(e)}function Ja(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(n){const r=yn(n);return`time(${r.seconds},${r.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(n){return Hn(n).toBase64()}(e.bytesValue):"referenceValue"in e?function(n){return j.fromName(n).toString()}(e.referenceValue):"geoPointValue"in e?function(n){return`geo(${n.latitude},${n.longitude})`}(e.geoPointValue):"arrayValue"in e?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Ja(i);return r+"]"}(e.arrayValue):"mapValue"in e?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Ja(n.fields[o])}`;return s+"}"}(e.mapValue):H()}function Za(e){return!!e&&"integerValue"in e}function ul(e){return!!e&&"arrayValue"in e}function Xu(e){return!!e&&"nullValue"in e}function Yu(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function fi(e){return!!e&&"mapValue"in e}function ns(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Nr(e.mapValue.fields,(n,r)=>t.mapValue.fields[n]=ns(r)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=ns(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Pw(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ge{constructor(t){this.value=t}static empty(){return new ge({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let n=this.value;for(let r=0;r<t.length-1;++r)if(n=(n.mapValue.fields||{})[t.get(r)],!fi(n))return null;return n=(n.mapValue.fields||{})[t.lastSegment()],n||null}}set(t,n){this.getFieldsMap(t.popLast())[t.lastSegment()]=ns(n)}setAll(t){let n=zt.emptyPath(),r={},s=[];t.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=ns(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(t){const n=this.field(t.popLast());fi(n)&&n.mapValue.fields&&delete n.mapValue.fields[t.lastSegment()]}isEqual(t){return je(this.value,t.value)}getFieldsMap(t){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<t.length;++r){let s=n.mapValue.fields[t.get(r)];fi(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[t.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(t,n,r){Nr(n,(s,i)=>t[s]=i);for(const s of r)delete t[s]}clone(){return new ge(ns(this.value))}}function hp(e){const t=[];return Nr(e.fields,(n,r)=>{const s=new zt([n]);if(fi(r)){const i=hp(r.mapValue).fields;if(i.length===0)t.push(s);else for(const o of i)t.push(s.child(o))}else t.push(s)}),new Ie(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(t,n,r,s,i,o,a){this.key=t,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(t){return new Qt(t,0,Q.min(),Q.min(),Q.min(),ge.empty(),0)}static newFoundDocument(t,n,r,s){return new Qt(t,1,n,Q.min(),r,s,0)}static newNoDocument(t,n){return new Qt(t,2,n,Q.min(),Q.min(),ge.empty(),0)}static newUnknownDocument(t,n){return new Qt(t,3,n,Q.min(),Q.min(),ge.empty(),2)}convertToFoundDocument(t,n){return!this.createTime.isEqual(Q.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=ge.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=ge.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Q.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Qt&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Qt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oi{constructor(t,n){this.position=t,this.inclusive=n}}function Ju(e,t,n){let r=0;for(let s=0;s<e.position.length;s++){const i=t[s],o=e.position[s];if(i.field.isKeyField()?r=j.comparator(j.fromName(o.referenceValue),n.key):r=wr(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Zu(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!je(e.position[n],t.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi{constructor(t,n="asc"){this.field=t,this.dir=n}}function Vw(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fp{}class Vt extends fp{constructor(t,n,r){super(),this.field=t,this.op=n,this.value=r}static create(t,n,r){return t.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(t,n,r):new xw(t,n,r):n==="array-contains"?new Ow(t,r):n==="in"?new Mw(t,r):n==="not-in"?new Lw(t,r):n==="array-contains-any"?new Fw(t,r):new Vt(t,n,r)}static createKeyFieldInFilter(t,n,r){return n==="in"?new kw(t,r):new Nw(t,r)}matches(t){const n=t.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(wr(n,this.value)):n!==null&&Kn(this.value)===Kn(n)&&this.matchesComparison(wr(n,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return H()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ze extends fp{constructor(t,n){super(),this.filters=t,this.op=n,this.ue=null}static create(t,n){return new ze(t,n)}matches(t){return dp(this)?this.filters.find(n=>!n.matches(t))===void 0:this.filters.find(n=>n.matches(t))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((t,n)=>t.concat(n.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function dp(e){return e.op==="and"}function pp(e){return Dw(e)&&dp(e)}function Dw(e){for(const t of e.filters)if(t instanceof ze)return!1;return!0}function tc(e){if(e instanceof Vt)return e.field.canonicalString()+e.op.toString()+Ir(e.value);if(pp(e))return e.filters.map(t=>tc(t)).join(",");{const t=e.filters.map(n=>tc(n)).join(",");return`${e.op}(${t})`}}function mp(e,t){return e instanceof Vt?function(r,s){return s instanceof Vt&&r.op===s.op&&r.field.isEqual(s.field)&&je(r.value,s.value)}(e,t):e instanceof ze?function(r,s){return s instanceof ze&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&mp(o,s.filters[a]),!0):!1}(e,t):void H()}function gp(e){return e instanceof Vt?function(n){return`${n.field.canonicalString()} ${n.op} ${Ir(n.value)}`}(e):e instanceof ze?function(n){return n.op.toString()+" {"+n.getFilters().map(gp).join(" ,")+"}"}(e):"Filter"}class xw extends Vt{constructor(t,n,r){super(t,n,r),this.key=j.fromName(r.referenceValue)}matches(t){const n=j.comparator(t.key,this.key);return this.matchesComparison(n)}}class kw extends Vt{constructor(t,n){super(t,"in",n),this.keys=_p("in",n)}matches(t){return this.keys.some(n=>n.isEqual(t.key))}}class Nw extends Vt{constructor(t,n){super(t,"not-in",n),this.keys=_p("not-in",n)}matches(t){return!this.keys.some(n=>n.isEqual(t.key))}}function _p(e,t){var n;return(((n=t.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>j.fromName(r.referenceValue))}class Ow extends Vt{constructor(t,n){super(t,"array-contains",n)}matches(t){const n=t.data.field(this.field);return ul(n)&&As(n.arrayValue,this.value)}}class Mw extends Vt{constructor(t,n){super(t,"in",n)}matches(t){const n=t.data.field(this.field);return n!==null&&As(this.value.arrayValue,n)}}class Lw extends Vt{constructor(t,n){super(t,"not-in",n)}matches(t){if(As(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=t.data.field(this.field);return n!==null&&!As(this.value.arrayValue,n)}}class Fw extends Vt{constructor(t,n){super(t,"array-contains-any",n)}matches(t){const n=t.data.field(this.field);return!(!ul(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>As(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uw{constructor(t,n=null,r=[],s=[],i=null,o=null,a=null){this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.ce=null}}function th(e,t=null,n=[],r=[],s=null,i=null,o=null){return new Uw(e,t,n,r,s,i,o)}function hl(e){const t=J(e);if(t.ce===null){let n=t.path.canonicalString();t.collectionGroup!==null&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(r=>tc(r)).join(","),n+="|ob:",n+=t.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Ro(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(r=>Ir(r)).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(r=>Ir(r)).join(",")),t.ce=n}return t.ce}function fl(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Vw(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!mp(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Zu(e.startAt,t.startAt)&&Zu(e.endAt,t.endAt)}function ec(e){return j.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class So{constructor(t,n=null,r=[],s=[],i=null,o="F",a=null,c=null){this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=c,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function Bw(e,t,n,r,s,i,o,a){return new So(e,t,n,r,s,i,o,a)}function yp(e){return new So(e)}function eh(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function $w(e){return e.collectionGroup!==null}function rs(e){const t=J(e);if(t.le===null){t.le=[];const n=new Set;for(const i of t.explicitOrderBy)t.le.push(i),n.add(i.field.canonicalString());const r=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ht(zt.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(t).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||t.le.push(new Mi(i,r))}),n.has(zt.keyField().canonicalString())||t.le.push(new Mi(zt.keyField(),r))}return t.le}function Le(e){const t=J(e);return t.he||(t.he=jw(t,rs(e))),t.he}function jw(e,t){if(e.limitType==="F")return th(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Mi(s.field,i)});const n=e.endAt?new Oi(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Oi(e.startAt.position,e.startAt.inclusive):null;return th(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function nc(e,t,n){return new So(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Co(e,t){return fl(Le(e),Le(t))&&e.limitType===t.limitType}function vp(e){return`${hl(Le(e))}|lt:${e.limitType}`}function rr(e){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>gp(s)).join(", ")}]`),Ro(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Ir(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Ir(s)).join(",")),`Target(${r})`}(Le(e))}; limitType=${e.limitType})`}function Po(e,t){return t.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):j.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(e,t)&&function(r,s){for(const i of rs(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(e,t)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(e,t)&&function(r,s){return!(r.startAt&&!function(o,a,c){const l=Ju(o,a,c);return o.inclusive?l<=0:l<0}(r.startAt,rs(r),s)||r.endAt&&!function(o,a,c){const l=Ju(o,a,c);return o.inclusive?l>=0:l>0}(r.endAt,rs(r),s))}(e,t)}function zw(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Ep(e){return(t,n)=>{let r=!1;for(const s of rs(e)){const i=qw(s,t,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function qw(e,t,n){const r=e.field.isKeyField()?j.comparator(t.key,n.key):function(i,o,a){const c=o.data.field(i),l=a.data.field(i);return c!==null&&l!==null?wr(c,l):H()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return H()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(t,n){this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}get(t){const n=this.mapKeyFn(t),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,t))return i}}has(t){return this.get(t)!==void 0}set(t,n){const r=this.mapKeyFn(t),s=this.inner[r];if(s===void 0)return this.inner[r]=[[t,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],t))return void(s[i]=[t,n]);s.push([t,n]),this.innerSize++}delete(t){const n=this.mapKeyFn(t),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],t))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(t){Nr(this.inner,(n,r)=>{for(const[s,i]of r)t(s,i)})}isEmpty(){return lp(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hw=new It(j.comparator);function Ye(){return Hw}const Tp=new It(j.comparator);function Wr(...e){let t=Tp;for(const n of e)t=t.insert(n.key,n);return t}function wp(e){let t=Tp;return e.forEach((n,r)=>t=t.insert(n,r.overlayedDocument)),t}function On(){return ss()}function Ip(){return ss()}function ss(){return new Or(e=>e.toString(),(e,t)=>e.isEqual(t))}const Kw=new It(j.comparator),Ww=new Ht(j.comparator);function it(...e){let t=Ww;for(const n of e)t=t.add(n);return t}const Gw=new Ht(ut);function Qw(){return Gw}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ap(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ni(t)?"-0":t}}function bp(e){return{integerValue:""+e}}function Xw(e,t){return Rw(t)?bp(t):Ap(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vo{constructor(){this._=void 0}}function Yw(e,t,n){return e instanceof Li?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&cl(i)&&(i=ll(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(n,t):e instanceof bs?Sp(e,t):e instanceof Rs?Cp(e,t):function(s,i){const o=Rp(s,i),a=nh(o)+nh(s.Ie);return Za(o)&&Za(s.Ie)?bp(a):Ap(s.serializer,a)}(e,t)}function Jw(e,t,n){return e instanceof bs?Sp(e,t):e instanceof Rs?Cp(e,t):n}function Rp(e,t){return e instanceof Fi?function(r){return Za(r)||function(i){return!!i&&"doubleValue"in i}(r)}(t)?t:{integerValue:0}:null}class Li extends Vo{}class bs extends Vo{constructor(t){super(),this.elements=t}}function Sp(e,t){const n=Pp(t);for(const r of e.elements)n.some(s=>je(s,r))||n.push(r);return{arrayValue:{values:n}}}class Rs extends Vo{constructor(t){super(),this.elements=t}}function Cp(e,t){let n=Pp(t);for(const r of e.elements)n=n.filter(s=>!je(s,r));return{arrayValue:{values:n}}}class Fi extends Vo{constructor(t,n){super(),this.serializer=t,this.Ie=n}}function nh(e){return St(e.integerValue||e.doubleValue)}function Pp(e){return ul(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}function Zw(e,t){return e.field.isEqual(t.field)&&function(r,s){return r instanceof bs&&s instanceof bs||r instanceof Rs&&s instanceof Rs?Tr(r.elements,s.elements,je):r instanceof Fi&&s instanceof Fi?je(r.Ie,s.Ie):r instanceof Li&&s instanceof Li}(e.transform,t.transform)}class t0{constructor(t,n){this.version=t,this.transformResults=n}}class Qe{constructor(t,n){this.updateTime=t,this.exists=n}static none(){return new Qe}static exists(t){return new Qe(void 0,t)}static updateTime(t){return new Qe(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function di(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class Do{}function Vp(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new xp(e.key,Qe.none()):new Bs(e.key,e.data,Qe.none());{const n=e.data,r=ge.empty();let s=new Ht(zt.comparator);for(let i of t.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Xn(e.key,r,new Ie(s.toArray()),Qe.none())}}function e0(e,t,n){e instanceof Bs?function(s,i,o){const a=s.value.clone(),c=sh(s.fieldTransforms,i,o.transformResults);a.setAll(c),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(e,t,n):e instanceof Xn?function(s,i,o){if(!di(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=sh(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(Dp(s)),c.setAll(a),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(e,t,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,t,n)}function is(e,t,n,r){return e instanceof Bs?function(i,o,a,c){if(!di(i.precondition,o))return a;const l=i.value.clone(),u=ih(i.fieldTransforms,c,o);return l.setAll(u),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(e,t,n,r):e instanceof Xn?function(i,o,a,c){if(!di(i.precondition,o))return a;const l=ih(i.fieldTransforms,c,o),u=o.data;return u.setAll(Dp(i)),u.setAll(l),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(h=>h.field))}(e,t,n,r):function(i,o,a){return di(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(e,t,n)}function n0(e,t){let n=null;for(const r of e.fieldTransforms){const s=t.data.field(r.field),i=Rp(r.transform,s||null);i!=null&&(n===null&&(n=ge.empty()),n.set(r.field,i))}return n||null}function rh(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Tr(r,s,(i,o)=>Zw(i,o))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Bs extends Do{constructor(t,n,r,s=[]){super(),this.key=t,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Xn extends Do{constructor(t,n,r,s,i=[]){super(),this.key=t,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Dp(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function sh(e,t,n){const r=new Map;gt(e.length===n.length);for(let s=0;s<n.length;s++){const i=e[s],o=i.transform,a=t.data.field(i.field);r.set(i.field,Jw(o,a,n[s]))}return r}function ih(e,t,n){const r=new Map;for(const s of e){const i=s.transform,o=n.data.field(s.field);r.set(s.field,Yw(i,o,t))}return r}class xp extends Do{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class r0 extends Do{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s0{constructor(t,n,r,s){this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(t,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(t.key)&&e0(i,t,r[s])}}applyToLocalView(t,n){for(const r of this.baseMutations)r.key.isEqual(t.key)&&(n=is(r,t,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(t.key)&&(n=is(r,t,n,this.localWriteTime));return n}applyToLocalDocumentSet(t,n){const r=Ip();return this.mutations.forEach(s=>{const i=t.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const c=Vp(o,a);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(Q.min())}),r}keys(){return this.mutations.reduce((t,n)=>t.add(n.key),it())}isEqual(t){return this.batchId===t.batchId&&Tr(this.mutations,t.mutations,(n,r)=>rh(n,r))&&Tr(this.baseMutations,t.baseMutations,(n,r)=>rh(n,r))}}class dl{constructor(t,n,r,s){this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(t,n,r){gt(t.mutations.length===r.length);let s=function(){return Kw}();const i=t.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new dl(t,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i0{constructor(t,n){this.largestBatchId=t,this.mutation=n}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o0{constructor(t,n){this.count=t,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Rt,ot;function a0(e){switch(e){default:return H();case b.CANCELLED:case b.UNKNOWN:case b.DEADLINE_EXCEEDED:case b.RESOURCE_EXHAUSTED:case b.INTERNAL:case b.UNAVAILABLE:case b.UNAUTHENTICATED:return!1;case b.INVALID_ARGUMENT:case b.NOT_FOUND:case b.ALREADY_EXISTS:case b.PERMISSION_DENIED:case b.FAILED_PRECONDITION:case b.ABORTED:case b.OUT_OF_RANGE:case b.UNIMPLEMENTED:case b.DATA_LOSS:return!0}}function kp(e){if(e===void 0)return $e("GRPC error has no .code"),b.UNKNOWN;switch(e){case Rt.OK:return b.OK;case Rt.CANCELLED:return b.CANCELLED;case Rt.UNKNOWN:return b.UNKNOWN;case Rt.DEADLINE_EXCEEDED:return b.DEADLINE_EXCEEDED;case Rt.RESOURCE_EXHAUSTED:return b.RESOURCE_EXHAUSTED;case Rt.INTERNAL:return b.INTERNAL;case Rt.UNAVAILABLE:return b.UNAVAILABLE;case Rt.UNAUTHENTICATED:return b.UNAUTHENTICATED;case Rt.INVALID_ARGUMENT:return b.INVALID_ARGUMENT;case Rt.NOT_FOUND:return b.NOT_FOUND;case Rt.ALREADY_EXISTS:return b.ALREADY_EXISTS;case Rt.PERMISSION_DENIED:return b.PERMISSION_DENIED;case Rt.FAILED_PRECONDITION:return b.FAILED_PRECONDITION;case Rt.ABORTED:return b.ABORTED;case Rt.OUT_OF_RANGE:return b.OUT_OF_RANGE;case Rt.UNIMPLEMENTED:return b.UNIMPLEMENTED;case Rt.DATA_LOSS:return b.DATA_LOSS;default:return H()}}(ot=Rt||(Rt={}))[ot.OK=0]="OK",ot[ot.CANCELLED=1]="CANCELLED",ot[ot.UNKNOWN=2]="UNKNOWN",ot[ot.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ot[ot.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ot[ot.NOT_FOUND=5]="NOT_FOUND",ot[ot.ALREADY_EXISTS=6]="ALREADY_EXISTS",ot[ot.PERMISSION_DENIED=7]="PERMISSION_DENIED",ot[ot.UNAUTHENTICATED=16]="UNAUTHENTICATED",ot[ot.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ot[ot.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ot[ot.ABORTED=10]="ABORTED",ot[ot.OUT_OF_RANGE=11]="OUT_OF_RANGE",ot[ot.UNIMPLEMENTED=12]="UNIMPLEMENTED",ot[ot.INTERNAL=13]="INTERNAL",ot[ot.UNAVAILABLE=14]="UNAVAILABLE",ot[ot.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c0(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l0=new mr([4294967295,4294967295],0);function oh(e){const t=c0().encode(e),n=new lw;return n.update(t),new Uint8Array(n.digest())}function ah(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),s=t.getUint32(8,!0),i=t.getUint32(12,!0);return[new mr([n,r],0),new mr([s,i],0)]}class pl{constructor(t,n,r){if(this.bitmap=t,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Gr(`Invalid padding: ${n}`);if(r<0)throw new Gr(`Invalid hash count: ${r}`);if(t.length>0&&this.hashCount===0)throw new Gr(`Invalid hash count: ${r}`);if(t.length===0&&n!==0)throw new Gr(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*t.length-n,this.Ee=mr.fromNumber(this.Te)}de(t,n,r){let s=t.add(n.multiply(mr.fromNumber(r)));return s.compare(l0)===1&&(s=new mr([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Ee).toNumber()}Ae(t){return(this.bitmap[Math.floor(t/8)]&1<<t%8)!=0}mightContain(t){if(this.Te===0)return!1;const n=oh(t),[r,s]=ah(n);for(let i=0;i<this.hashCount;i++){const o=this.de(r,s,i);if(!this.Ae(o))return!1}return!0}static create(t,n,r){const s=t%8==0?0:8-t%8,i=new Uint8Array(Math.ceil(t/8)),o=new pl(i,s,n);return r.forEach(a=>o.insert(a)),o}insert(t){if(this.Te===0)return;const n=oh(t),[r,s]=ah(n);for(let i=0;i<this.hashCount;i++){const o=this.de(r,s,i);this.Re(o)}}Re(t){const n=Math.floor(t/8),r=t%8;this.bitmap[n]|=1<<r}}class Gr extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(t,n,r,s,i){this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(t,n,r){const s=new Map;return s.set(t,$s.createSynthesizedTargetChangeForCurrentChange(t,n,r)),new xo(Q.min(),s,new It(ut),Ye(),it())}}class $s{constructor(t,n,r,s,i){this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(t,n,r){return new $s(r,n,it(),it(),it())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(t,n,r,s){this.Ve=t,this.removedTargetIds=n,this.key=r,this.me=s}}class Np{constructor(t,n){this.targetId=t,this.fe=n}}class Op{constructor(t,n,r=te.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=s}}class ch{constructor(){this.ge=0,this.pe=uh(),this.ye=te.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(t){t.approximateByteSize()>0&&(this.Se=!0,this.ye=t)}ve(){let t=it(),n=it(),r=it();return this.pe.forEach((s,i)=>{switch(i){case 0:t=t.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:H()}}),new $s(this.ye,this.we,t,n,r)}Fe(){this.Se=!1,this.pe=uh()}Me(t,n){this.Se=!0,this.pe=this.pe.insert(t,n)}xe(t){this.Se=!0,this.pe=this.pe.remove(t)}Oe(){this.ge+=1}Ne(){this.ge-=1,gt(this.ge>=0)}Be(){this.Se=!0,this.we=!0}}class u0{constructor(t){this.Le=t,this.ke=new Map,this.qe=Ye(),this.Qe=lh(),this.Ke=new It(ut)}$e(t){for(const n of t.Ve)t.me&&t.me.isFoundDocument()?this.Ue(n,t.me):this.We(n,t.key,t.me);for(const n of t.removedTargetIds)this.We(n,t.key,t.me)}Ge(t){this.forEachTarget(t,n=>{const r=this.ze(n);switch(t.state){case 0:this.je(n)&&r.Ce(t.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(t.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(n);break;case 3:this.je(n)&&(r.Be(),r.Ce(t.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.Ce(t.resumeToken));break;default:H()}})}forEachTarget(t,n){t.targetIds.length>0?t.targetIds.forEach(n):this.ke.forEach((r,s)=>{this.je(s)&&n(s)})}Je(t){const n=t.targetId,r=t.fe.count,s=this.Ye(n);if(s){const i=s.target;if(ec(i))if(r===0){const o=new j(i.path);this.We(n,o,Qt.newNoDocument(o,Q.min()))}else gt(r===1);else{const o=this.Ze(n);if(o!==r){const a=this.Xe(t),c=a?this.et(a,t,o):1;if(c!==0){this.He(n);const l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,l)}}}}}Xe(t){const n=t.fe.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,a;try{o=Hn(r).toUint8Array()}catch(c){if(c instanceof up)return Er("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new pl(o,s,i)}catch(c){return Er(c instanceof Gr?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Te===0?null:a}et(t,n,r){return n.fe.count===r-this.rt(t,n.targetId)?0:2}rt(t,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Le.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;t.mightContain(a)||(this.We(n,i,null),s++)}),s}it(t){const n=new Map;this.ke.forEach((i,o)=>{const a=this.Ye(o);if(a){if(i.current&&ec(a.target)){const c=new j(a.target.path);this.qe.get(c)!==null||this.st(o,c)||this.We(o,c,Qt.newNoDocument(c,t))}i.De&&(n.set(o,i.ve()),i.Fe())}});let r=it();this.Qe.forEach((i,o)=>{let a=!0;o.forEachWhile(c=>{const l=this.Ye(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.qe.forEach((i,o)=>o.setReadTime(t));const s=new xo(t,n,this.Ke,this.qe,r);return this.qe=Ye(),this.Qe=lh(),this.Ke=new It(ut),s}Ue(t,n){if(!this.je(t))return;const r=this.st(t,n.key)?2:0;this.ze(t).Me(n.key,r),this.qe=this.qe.insert(n.key,n),this.Qe=this.Qe.insert(n.key,this.ot(n.key).add(t))}We(t,n,r){if(!this.je(t))return;const s=this.ze(t);this.st(t,n)?s.Me(n,1):s.xe(n),this.Qe=this.Qe.insert(n,this.ot(n).delete(t)),r&&(this.qe=this.qe.insert(n,r))}removeTarget(t){this.ke.delete(t)}Ze(t){const n=this.ze(t).ve();return this.Le.getRemoteKeysForTarget(t).size+n.addedDocuments.size-n.removedDocuments.size}Oe(t){this.ze(t).Oe()}ze(t){let n=this.ke.get(t);return n||(n=new ch,this.ke.set(t,n)),n}ot(t){let n=this.Qe.get(t);return n||(n=new Ht(ut),this.Qe=this.Qe.insert(t,n)),n}je(t){const n=this.Ye(t)!==null;return n||k("WatchChangeAggregator","Detected inactive target",t),n}Ye(t){const n=this.ke.get(t);return n&&n.be?null:this.Le._t(t)}He(t){this.ke.set(t,new ch),this.Le.getRemoteKeysForTarget(t).forEach(n=>{this.We(t,n,null)})}st(t,n){return this.Le.getRemoteKeysForTarget(t).has(n)}}function lh(){return new It(j.comparator)}function uh(){return new It(j.comparator)}const h0={asc:"ASCENDING",desc:"DESCENDING"},f0={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},d0={and:"AND",or:"OR"};class p0{constructor(t,n){this.databaseId=t,this.useProto3Json=n}}function rc(e,t){return e.useProto3Json||Ro(t)?t:{value:t}}function Ui(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Mp(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function m0(e,t){return Ui(e,t.toTimestamp())}function Fe(e){return gt(!!e),Q.fromTimestamp(function(n){const r=yn(n);return new Dt(r.seconds,r.nanos)}(e))}function ml(e,t){return sc(e,t).canonicalString()}function sc(e,t){const n=function(s){return new Et(["projects",s.projectId,"databases",s.database])}(e).child("documents");return t===void 0?n:n.child(t)}function Lp(e){const t=Et.fromString(e);return gt(jp(t)),t}function ic(e,t){return ml(e.databaseId,t.path)}function ma(e,t){const n=Lp(t);if(n.get(1)!==e.databaseId.projectId)throw new B(b.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new B(b.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new j(Up(n))}function Fp(e,t){return ml(e.databaseId,t)}function g0(e){const t=Lp(e);return t.length===4?Et.emptyPath():Up(t)}function oc(e){return new Et(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Up(e){return gt(e.length>4&&e.get(4)==="documents"),e.popFirst(5)}function hh(e,t,n){return{name:ic(e,t),fields:n.value.mapValue.fields}}function _0(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:H()}(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],i=function(l,u){return l.useProto3Json?(gt(u===void 0||typeof u=="string"),te.fromBase64String(u||"")):(gt(u===void 0||u instanceof Uint8Array),te.fromUint8Array(u||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(l){const u=l.code===void 0?b.UNKNOWN:kp(l.code);return new B(u,l.message||"")}(o);n=new Op(r,s,i,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const s=ma(e,r.document.name),i=Fe(r.document.updateTime),o=r.document.createTime?Fe(r.document.createTime):Q.min(),a=new ge({mapValue:{fields:r.document.fields}}),c=Qt.newFoundDocument(s,i,o,a),l=r.targetIds||[],u=r.removedTargetIds||[];n=new pi(l,u,c.key,c)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const s=ma(e,r.document),i=r.readTime?Fe(r.readTime):Q.min(),o=Qt.newNoDocument(s,i),a=r.removedTargetIds||[];n=new pi([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const s=ma(e,r.document),i=r.removedTargetIds||[];n=new pi([],i,s,null)}else{if(!("filter"in t))return H();{t.filter;const r=t.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new o0(s,i),a=r.targetId;n=new Np(a,o)}}return n}function y0(e,t){let n;if(t instanceof Bs)n={update:hh(e,t.key,t.value)};else if(t instanceof xp)n={delete:ic(e,t.key)};else if(t instanceof Xn)n={update:hh(e,t.key,t.data),updateMask:S0(t.fieldMask)};else{if(!(t instanceof r0))return H();n={verify:ic(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof Li)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof bs)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Rs)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Fi)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw H()}(0,r))),t.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:m0(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:H()}(e,t.precondition)),n}function v0(e,t){return e&&e.length>0?(gt(t!==void 0),e.map(n=>function(s,i){let o=s.updateTime?Fe(s.updateTime):Fe(i);return o.isEqual(Q.min())&&(o=Fe(i)),new t0(o,s.transformResults||[])}(n,t))):[]}function E0(e,t){return{documents:[Fp(e,t.path)]}}function T0(e,t){const n={structuredQuery:{}},r=t.path;let s;t.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Fp(e,s);const i=function(l){if(l.length!==0)return $p(ze.create(l,"and"))}(t.filters);i&&(n.structuredQuery.where=i);const o=function(l){if(l.length!==0)return l.map(u=>function(f){return{field:sr(f.field),direction:A0(f.dir)}}(u))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const a=rc(e,t.limit);return a!==null&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(t.endAt)),{ut:n,parent:s}}function w0(e){let t=g0(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){gt(r===1);const u=n.from[0];u.allDescendants?s=u.collectionId:t=t.child(u.collectionId)}let i=[];n.where&&(i=function(h){const f=Bp(h);return f instanceof ze&&pp(f)?f.getFilters():[f]}(n.where));let o=[];n.orderBy&&(o=function(h){return h.map(f=>function(R){return new Mi(ir(R.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(R.direction))}(f))}(n.orderBy));let a=null;n.limit&&(a=function(h){let f;return f=typeof h=="object"?h.value:h,Ro(f)?null:f}(n.limit));let c=null;n.startAt&&(c=function(h){const f=!!h.before,m=h.values||[];return new Oi(m,f)}(n.startAt));let l=null;return n.endAt&&(l=function(h){const f=!h.before,m=h.values||[];return new Oi(m,f)}(n.endAt)),Bw(t,s,o,i,a,"F",c,l)}function I0(e,t){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return H()}}(t.purpose);return n==null?null:{"goog-listen-tags":n}}function Bp(e){return e.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=ir(n.unaryFilter.field);return Vt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=ir(n.unaryFilter.field);return Vt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=ir(n.unaryFilter.field);return Vt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=ir(n.unaryFilter.field);return Vt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return H()}}(e):e.fieldFilter!==void 0?function(n){return Vt.create(ir(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return H()}}(n.fieldFilter.op),n.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(n){return ze.create(n.compositeFilter.filters.map(r=>Bp(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return H()}}(n.compositeFilter.op))}(e):H()}function A0(e){return h0[e]}function b0(e){return f0[e]}function R0(e){return d0[e]}function sr(e){return{fieldPath:e.canonicalString()}}function ir(e){return zt.fromServerFormat(e.fieldPath)}function $p(e){return e instanceof Vt?function(n){if(n.op==="=="){if(Yu(n.value))return{unaryFilter:{field:sr(n.field),op:"IS_NAN"}};if(Xu(n.value))return{unaryFilter:{field:sr(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Yu(n.value))return{unaryFilter:{field:sr(n.field),op:"IS_NOT_NAN"}};if(Xu(n.value))return{unaryFilter:{field:sr(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:sr(n.field),op:b0(n.op),value:n.value}}}(e):e instanceof ze?function(n){const r=n.getFilters().map(s=>$p(s));return r.length===1?r[0]:{compositeFilter:{op:R0(n.op),filters:r}}}(e):H()}function S0(e){const t=[];return e.fields.forEach(n=>t.push(n.canonicalString())),{fieldPaths:t}}function jp(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(t,n,r,s,i=Q.min(),o=Q.min(),a=te.EMPTY_BYTE_STRING,c=null){this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(t){return new ln(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,n){return new ln(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new ln(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new ln(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C0{constructor(t){this.ct=t}}function P0(e){const t=w0({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?nc(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V0{constructor(){this._n=new D0}addToCollectionParentIndex(t,n){return this._n.add(n),E.resolve()}getCollectionParents(t,n){return E.resolve(this._n.getEntries(n))}addFieldIndex(t,n){return E.resolve()}deleteFieldIndex(t,n){return E.resolve()}deleteAllFieldIndexes(t){return E.resolve()}createTargetIndexes(t,n){return E.resolve()}getDocumentsMatchingTarget(t,n){return E.resolve(null)}getIndexType(t,n){return E.resolve(0)}getFieldIndexes(t,n){return E.resolve([])}getNextCollectionGroupToUpdate(t){return E.resolve(null)}getMinOffset(t,n){return E.resolve(_n.min())}getMinOffsetFromCollectionGroup(t,n){return E.resolve(_n.min())}updateCollectionGroup(t,n,r){return E.resolve()}updateIndexEntries(t,n){return E.resolve()}}class D0{constructor(){this.index={}}add(t){const n=t.lastSegment(),r=t.popLast(),s=this.index[n]||new Ht(Et.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(t){const n=t.lastSegment(),r=t.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(t){return(this.index[t]||new Ht(Et.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ar{constructor(t){this.On=t}next(){return this.On+=2,this.On}static Nn(){return new Ar(0)}static Bn(){return new Ar(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x0{constructor(){this.changes=new Or(t=>t.toString(),(t,n)=>t.isEqual(n)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,n){this.assertNotApplied(),this.changes.set(t,Qt.newInvalidDocument(t).setReadTime(n))}getEntry(t,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?E.resolve(r):this.getFromCache(t,n)}getEntries(t,n){return this.getAllFromCache(t,n)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k0{constructor(t,n){this.overlayedDocument=t,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N0{constructor(t,n,r,s){this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(t,n){let r=null;return this.documentOverlayCache.getOverlay(t,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(t,n))).next(s=>(r!==null&&is(r.mutation,s,Ie.empty(),Dt.now()),s))}getDocuments(t,n){return this.remoteDocumentCache.getEntries(t,n).next(r=>this.getLocalViewOfDocuments(t,r,it()).next(()=>r))}getLocalViewOfDocuments(t,n,r=it()){const s=On();return this.populateOverlays(t,s,n).next(()=>this.computeViews(t,n,s,r).next(i=>{let o=Wr();return i.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(t,n){const r=On();return this.populateOverlays(t,r,n).next(()=>this.computeViews(t,n,r,it()))}populateOverlays(t,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(t,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(t,n,r,s){let i=Ye();const o=ss(),a=function(){return ss()}();return n.forEach((c,l)=>{const u=r.get(l.key);s.has(l.key)&&(u===void 0||u.mutation instanceof Xn)?i=i.insert(l.key,l):u!==void 0?(o.set(l.key,u.mutation.getFieldMask()),is(u.mutation,l,u.mutation.getFieldMask(),Dt.now())):o.set(l.key,Ie.empty())}),this.recalculateAndSaveOverlays(t,i).next(c=>(c.forEach((l,u)=>o.set(l,u)),n.forEach((l,u)=>{var h;return a.set(l,new k0(u,(h=o.get(l))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(t,n){const r=ss();let s=new It((o,a)=>o-a),i=it();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,n).next(o=>{for(const a of o)a.keys().forEach(c=>{const l=n.get(c);if(l===null)return;let u=r.get(c)||Ie.empty();u=a.applyToLocalView(l,u),r.set(c,u);const h=(s.get(a.batchId)||it()).add(c);s=s.insert(a.batchId,h)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),l=c.key,u=c.value,h=Ip();u.forEach(f=>{if(!i.has(f)){const m=Vp(n.get(f),r.get(f));m!==null&&h.set(f,m),i=i.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(t,l,h))}return E.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(t,n){return this.remoteDocumentCache.getEntries(t,n).next(r=>this.recalculateAndSaveOverlays(t,r))}getDocumentsMatchingQuery(t,n,r,s){return function(o){return j.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(t,n.path):$w(n)?this.getDocumentsMatchingCollectionGroupQuery(t,n,r,s):this.getDocumentsMatchingCollectionQuery(t,n,r,s)}getNextDocuments(t,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,n,r.largestBatchId,s-i.size):E.resolve(On());let a=-1,c=i;return o.next(l=>E.forEach(l,(u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),i.get(u)?E.resolve():this.remoteDocumentCache.getEntry(t,u).next(f=>{c=c.insert(u,f)}))).next(()=>this.populateOverlays(t,l,i)).next(()=>this.computeViews(t,c,l,it())).next(u=>({batchId:a,changes:wp(u)})))})}getDocumentsMatchingDocumentQuery(t,n){return this.getDocument(t,new j(n)).next(r=>{let s=Wr();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(t,n,r,s){const i=n.collectionGroup;let o=Wr();return this.indexManager.getCollectionParents(t,i).next(a=>E.forEach(a,c=>{const l=function(h,f){return new So(f,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(t,l,r,s).next(u=>{u.forEach((h,f)=>{o=o.insert(h,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(t,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(t,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(t,n,r,i,s))).next(o=>{i.forEach((c,l)=>{const u=l.getKey();o.get(u)===null&&(o=o.insert(u,Qt.newInvalidDocument(u)))});let a=Wr();return o.forEach((c,l)=>{const u=i.get(c);u!==void 0&&is(u.mutation,l,Ie.empty(),Dt.now()),Po(n,l)&&(a=a.insert(c,l))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O0{constructor(t){this.serializer=t,this.cr=new Map,this.lr=new Map}getBundleMetadata(t,n){return E.resolve(this.cr.get(n))}saveBundleMetadata(t,n){return this.cr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Fe(s.createTime)}}(n)),E.resolve()}getNamedQuery(t,n){return E.resolve(this.lr.get(n))}saveNamedQuery(t,n){return this.lr.set(n.name,function(s){return{name:s.name,query:P0(s.bundledQuery),readTime:Fe(s.readTime)}}(n)),E.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M0{constructor(){this.overlays=new It(j.comparator),this.hr=new Map}getOverlay(t,n){return E.resolve(this.overlays.get(n))}getOverlays(t,n){const r=On();return E.forEach(n,s=>this.getOverlay(t,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(t,n,r){return r.forEach((s,i)=>{this.ht(t,n,i)}),E.resolve()}removeOverlaysForBatchId(t,n,r){const s=this.hr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.hr.delete(r)),E.resolve()}getOverlaysForCollection(t,n,r){const s=On(),i=n.length+1,o=new j(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,l=c.getKey();if(!n.isPrefixOf(l.path))break;l.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return E.resolve(s)}getOverlaysForCollectionGroup(t,n,r,s){let i=new It((l,u)=>l-u);const o=this.overlays.getIterator();for(;o.hasNext();){const l=o.getNext().value;if(l.getKey().getCollectionGroup()===n&&l.largestBatchId>r){let u=i.get(l.largestBatchId);u===null&&(u=On(),i=i.insert(l.largestBatchId,u)),u.set(l.getKey(),l)}}const a=On(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,u)=>a.set(l,u)),!(a.size()>=s)););return E.resolve(a)}ht(t,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.hr.get(s.largestBatchId).delete(r.key);this.hr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new i0(n,r));let i=this.hr.get(n);i===void 0&&(i=it(),this.hr.set(n,i)),this.hr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gl{constructor(){this.Pr=new Ht(Nt.Ir),this.Tr=new Ht(Nt.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(t,n){const r=new Nt(t,n);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(t,n){t.forEach(r=>this.addReference(r,n))}removeReference(t,n){this.Ar(new Nt(t,n))}Rr(t,n){t.forEach(r=>this.removeReference(r,n))}Vr(t){const n=new j(new Et([])),r=new Nt(n,t),s=new Nt(n,t+1),i=[];return this.Tr.forEachInRange([r,s],o=>{this.Ar(o),i.push(o.key)}),i}mr(){this.Pr.forEach(t=>this.Ar(t))}Ar(t){this.Pr=this.Pr.delete(t),this.Tr=this.Tr.delete(t)}gr(t){const n=new j(new Et([])),r=new Nt(n,t),s=new Nt(n,t+1);let i=it();return this.Tr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(t){const n=new Nt(t,0),r=this.Pr.firstAfterOrEqual(n);return r!==null&&t.isEqual(r.key)}}class Nt{constructor(t,n){this.key=t,this.pr=n}static Ir(t,n){return j.comparator(t.key,n.key)||ut(t.pr,n.pr)}static Er(t,n){return ut(t.pr,n.pr)||j.comparator(t.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L0{constructor(t,n){this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.yr=1,this.wr=new Ht(Nt.Ir)}checkEmpty(t){return E.resolve(this.mutationQueue.length===0)}addMutationBatch(t,n,r,s){const i=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new s0(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.wr=this.wr.add(new Nt(a.key,i)),this.indexManager.addToCollectionParentIndex(t,a.key.path.popLast());return E.resolve(o)}lookupMutationBatch(t,n){return E.resolve(this.Sr(n))}getNextMutationBatchAfterBatchId(t,n){const r=n+1,s=this.br(r),i=s<0?0:s;return E.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return E.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(t){return E.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,n){const r=new Nt(n,0),s=new Nt(n,Number.POSITIVE_INFINITY),i=[];return this.wr.forEachInRange([r,s],o=>{const a=this.Sr(o.pr);i.push(a)}),E.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(t,n){let r=new Ht(ut);return n.forEach(s=>{const i=new Nt(s,0),o=new Nt(s,Number.POSITIVE_INFINITY);this.wr.forEachInRange([i,o],a=>{r=r.add(a.pr)})}),E.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(t,n){const r=n.path,s=r.length+1;let i=r;j.isDocumentKey(i)||(i=i.child(""));const o=new Nt(new j(i),0);let a=new Ht(ut);return this.wr.forEachWhile(c=>{const l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===s&&(a=a.add(c.pr)),!0)},o),E.resolve(this.Dr(a))}Dr(t){const n=[];return t.forEach(r=>{const s=this.Sr(r);s!==null&&n.push(s)}),n}removeMutationBatch(t,n){gt(this.Cr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return E.forEach(n.mutations,s=>{const i=new Nt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)}).next(()=>{this.wr=r})}Mn(t){}containsKey(t,n){const r=new Nt(n,0),s=this.wr.firstAfterOrEqual(r);return E.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(t){return this.mutationQueue.length,E.resolve()}Cr(t,n){return this.br(t)}br(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Sr(t){const n=this.br(t);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F0{constructor(t){this.vr=t,this.docs=function(){return new It(j.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.vr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())}removeEntry(t){const n=this.docs.get(t);n&&(this.docs=this.docs.remove(t),this.size-=n.size)}getEntry(t,n){const r=this.docs.get(n);return E.resolve(r?r.document.mutableCopy():Qt.newInvalidDocument(n))}getEntries(t,n){let r=Ye();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Qt.newInvalidDocument(s))}),E.resolve(r)}getDocumentsMatchingQuery(t,n,r,s){let i=Ye();const o=n.path,a=new j(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:l,value:{document:u}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||Tw(Ew(u),r)<=0||(s.has(u.key)||Po(n,u))&&(i=i.insert(u.key,u.mutableCopy()))}return E.resolve(i)}getAllFromCollectionGroup(t,n,r,s){H()}Fr(t,n){return E.forEach(this.docs,r=>n(r))}newChangeBuffer(t){return new U0(this)}getSize(t){return E.resolve(this.size)}}class U0 extends x0{constructor(t){super(),this.ar=t}applyChanges(t){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.ar.addEntry(t,s)):this.ar.removeEntry(r)}),E.waitFor(n)}getFromCache(t,n){return this.ar.getEntry(t,n)}getAllFromCache(t,n){return this.ar.getEntries(t,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B0{constructor(t){this.persistence=t,this.Mr=new Or(n=>hl(n),fl),this.lastRemoteSnapshotVersion=Q.min(),this.highestTargetId=0,this.Or=0,this.Nr=new gl,this.targetCount=0,this.Br=Ar.Nn()}forEachTarget(t,n){return this.Mr.forEach((r,s)=>n(s)),E.resolve()}getLastRemoteSnapshotVersion(t){return E.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return E.resolve(this.Or)}allocateTargetId(t){return this.highestTargetId=this.Br.next(),E.resolve(this.highestTargetId)}setTargetsMetadata(t,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Or&&(this.Or=n),E.resolve()}qn(t){this.Mr.set(t.target,t);const n=t.targetId;n>this.highestTargetId&&(this.Br=new Ar(n),this.highestTargetId=n),t.sequenceNumber>this.Or&&(this.Or=t.sequenceNumber)}addTargetData(t,n){return this.qn(n),this.targetCount+=1,E.resolve()}updateTargetData(t,n){return this.qn(n),E.resolve()}removeTargetData(t,n){return this.Mr.delete(n.target),this.Nr.Vr(n.targetId),this.targetCount-=1,E.resolve()}removeTargets(t,n,r){let s=0;const i=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Mr.delete(o),i.push(this.removeMatchingKeysForTargetId(t,a.targetId)),s++)}),E.waitFor(i).next(()=>s)}getTargetCount(t){return E.resolve(this.targetCount)}getTargetData(t,n){const r=this.Mr.get(n)||null;return E.resolve(r)}addMatchingKeys(t,n,r){return this.Nr.dr(n,r),E.resolve()}removeMatchingKeys(t,n,r){this.Nr.Rr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(t,o))}),E.waitFor(i)}removeMatchingKeysForTargetId(t,n){return this.Nr.Vr(n),E.resolve()}getMatchingKeysForTargetId(t,n){const r=this.Nr.gr(n);return E.resolve(r)}containsKey(t,n){return E.resolve(this.Nr.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $0{constructor(t,n){this.Lr={},this.overlays={},this.kr=new al(0),this.qr=!1,this.qr=!0,this.referenceDelegate=t(this),this.Qr=new B0(this),this.indexManager=new V0,this.remoteDocumentCache=function(s){return new F0(s)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new C0(n),this.$r=new O0(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let n=this.overlays[t.toKey()];return n||(n=new M0,this.overlays[t.toKey()]=n),n}getMutationQueue(t,n){let r=this.Lr[t.toKey()];return r||(r=new L0(n,this.referenceDelegate),this.Lr[t.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(t,n,r){k("MemoryPersistence","Starting transaction:",t);const s=new j0(this.kr.next());return this.referenceDelegate.Ur(),r(s).next(i=>this.referenceDelegate.Wr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Gr(t,n){return E.or(Object.values(this.Lr).map(r=>()=>r.containsKey(t,n)))}}class j0 extends Iw{constructor(t){super(),this.currentSequenceNumber=t}}class _l{constructor(t){this.persistence=t,this.zr=new gl,this.jr=null}static Hr(t){return new _l(t)}get Jr(){if(this.jr)return this.jr;throw H()}addReference(t,n,r){return this.zr.addReference(r,n),this.Jr.delete(r.toString()),E.resolve()}removeReference(t,n,r){return this.zr.removeReference(r,n),this.Jr.add(r.toString()),E.resolve()}markPotentiallyOrphaned(t,n){return this.Jr.add(n.toString()),E.resolve()}removeTarget(t,n){this.zr.Vr(n.targetId).forEach(s=>this.Jr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,n.targetId).next(s=>{s.forEach(i=>this.Jr.add(i.toString()))}).next(()=>r.removeTargetData(t,n))}Ur(){this.jr=new Set}Wr(t){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return E.forEach(this.Jr,r=>{const s=j.fromPath(r);return this.Yr(t,s).next(i=>{i||n.removeEntry(s,Q.min())})}).next(()=>(this.jr=null,n.apply(t)))}updateLimboDocument(t,n){return this.Yr(t,n).next(r=>{r?this.Jr.delete(n.toString()):this.Jr.add(n.toString())})}Kr(t){return 0}Yr(t,n){return E.or([()=>E.resolve(this.zr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(t,n),()=>this.persistence.Gr(t,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yl{constructor(t,n,r,s){this.targetId=t,this.fromCache=n,this.qi=r,this.Qi=s}static Ki(t,n){let r=it(),s=it();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new yl(t,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z0{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q0{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return Hv()?8:Nn.v(bi())>0?6:4}()}initialize(t,n){this.zi=t,this.indexManager=n,this.$i=!0}getDocumentsMatchingQuery(t,n,r,s){const i={result:null};return this.ji(t,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Hi(t,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new z0;return this.Ji(t,n,o).next(a=>{if(i.result=a,this.Ui)return this.Yi(t,n,o,a.size)})}).next(()=>i.result)}Yi(t,n,r,s){return r.documentReadCount<this.Wi?(jr()<=ct.DEBUG&&k("QueryEngine","SDK will not create cache indexes for query:",rr(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),E.resolve()):(jr()<=ct.DEBUG&&k("QueryEngine","Query:",rr(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Gi*s?(jr()<=ct.DEBUG&&k("QueryEngine","The SDK decides to create cache indexes for query:",rr(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Le(n))):E.resolve())}ji(t,n){if(eh(n))return E.resolve(null);let r=Le(n);return this.indexManager.getIndexType(t,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=nc(n,null,"F"),r=Le(n)),this.indexManager.getDocumentsMatchingTarget(t,r).next(i=>{const o=it(...i);return this.zi.getDocuments(t,o).next(a=>this.indexManager.getMinOffset(t,r).next(c=>{const l=this.Zi(n,a);return this.Xi(n,l,o,c.readTime)?this.ji(t,nc(n,null,"F")):this.es(t,l,n,c)}))})))}Hi(t,n,r,s){return eh(n)||s.isEqual(Q.min())?E.resolve(null):this.zi.getDocuments(t,r).next(i=>{const o=this.Zi(n,i);return this.Xi(n,o,r,s)?E.resolve(null):(jr()<=ct.DEBUG&&k("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),rr(n)),this.es(t,o,n,vw(s,-1)).next(a=>a))})}Zi(t,n){let r=new Ht(Ep(t));return n.forEach((s,i)=>{Po(t,i)&&(r=r.add(i))}),r}Xi(t,n,r,s){if(t.limit===null)return!1;if(r.size!==n.size)return!0;const i=t.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ji(t,n,r){return jr()<=ct.DEBUG&&k("QueryEngine","Using full collection scan to execute query:",rr(n)),this.zi.getDocumentsMatchingQuery(t,n,_n.min(),r)}es(t,n,r,s){return this.zi.getDocumentsMatchingQuery(t,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H0{constructor(t,n,r,s){this.persistence=t,this.ts=n,this.serializer=s,this.ns=new It(ut),this.rs=new Or(i=>hl(i),fl),this.ss=new Map,this.os=t.getRemoteDocumentCache(),this.Qr=t.getTargetCache(),this.$r=t.getBundleCache(),this._s(r)}_s(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new N0(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>t.collect(n,this.ns))}}function K0(e,t,n,r){return new H0(e,t,n,r)}async function zp(e,t){const n=J(e);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n._s(t),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let c=it();for(const l of s){o.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}for(const l of i){a.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}return n.localDocuments.getDocuments(r,c).next(l=>({us:l,removedBatchIds:o,addedBatchIds:a}))})})}function W0(e,t){const n=J(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=t.batch.keys(),i=n.os.newChangeBuffer({trackRemovals:!0});return function(a,c,l,u){const h=l.batch,f=h.keys();let m=E.resolve();return f.forEach(R=>{m=m.next(()=>u.getEntry(c,R)).next(T=>{const w=l.docVersions.get(R);gt(w!==null),T.version.compareTo(w)<0&&(h.applyToRemoteDocument(T,l),T.isValidDocument()&&(T.setReadTime(l.commitVersion),u.addEntry(T)))})}),m.next(()=>a.mutationQueue.removeMutationBatch(c,h))}(n,r,t,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=it();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(c=c.add(a.batch.mutations[l].key));return c}(t))).next(()=>n.localDocuments.getDocuments(r,s))})}function qp(e){const t=J(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",n=>t.Qr.getLastRemoteSnapshotVersion(n))}function G0(e,t){const n=J(e),r=t.snapshotVersion;let s=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.os.newChangeBuffer({trackRemovals:!0});s=n.ns;const a=[];t.targetChanges.forEach((u,h)=>{const f=s.get(h);if(!f)return;a.push(n.Qr.removeMatchingKeys(i,u.removedDocuments,h).next(()=>n.Qr.addMatchingKeys(i,u.addedDocuments,h)));let m=f.withSequenceNumber(i.currentSequenceNumber);t.targetMismatches.get(h)!==null?m=m.withResumeToken(te.EMPTY_BYTE_STRING,Q.min()).withLastLimboFreeSnapshotVersion(Q.min()):u.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(u.resumeToken,r)),s=s.insert(h,m),function(T,w,L){return T.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-T.snapshotVersion.toMicroseconds()>=3e8?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0}(f,m,u)&&a.push(n.Qr.updateTargetData(i,m))});let c=Ye(),l=it();if(t.documentUpdates.forEach(u=>{t.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,u))}),a.push(Q0(i,o,t.documentUpdates).next(u=>{c=u.cs,l=u.ls})),!r.isEqual(Q.min())){const u=n.Qr.getLastRemoteSnapshotVersion(i).next(h=>n.Qr.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(u)}return E.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,l)).next(()=>c)}).then(i=>(n.ns=s,i))}function Q0(e,t,n){let r=it(),s=it();return n.forEach(i=>r=r.add(i)),t.getEntries(e,r).next(i=>{let o=Ye();return n.forEach((a,c)=>{const l=i.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(s=s.add(a)),c.isNoDocument()&&c.version.isEqual(Q.min())?(t.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(t.addEntry(c),o=o.insert(a,c)):k("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{cs:o,ls:s}})}function X0(e,t){const n=J(e);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(t===void 0&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,t)))}function Y0(e,t){const n=J(e);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Qr.getTargetData(r,t).next(i=>i?(s=i,E.resolve(s)):n.Qr.allocateTargetId(r).next(o=>(s=new ln(t,o,"TargetPurposeListen",r.currentSequenceNumber),n.Qr.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.ns.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.ns=n.ns.insert(r.targetId,r),n.rs.set(t,r.targetId)),r})}async function ac(e,t,n){const r=J(e),s=r.ns.get(t),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Us(o))throw o;k("LocalStore",`Failed to update sequence numbers for target ${t}: ${o}`)}r.ns=r.ns.remove(t),r.rs.delete(s.target)}function fh(e,t,n){const r=J(e);let s=Q.min(),i=it();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,l,u){const h=J(c),f=h.rs.get(u);return f!==void 0?E.resolve(h.ns.get(f)):h.Qr.getTargetData(l,u)}(r,o,Le(t)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(o,a.targetId).next(c=>{i=c})}).next(()=>r.ts.getDocumentsMatchingQuery(o,t,n?s:Q.min(),n?i:it())).next(a=>(J0(r,zw(t),a),{documents:a,hs:i})))}function J0(e,t,n){let r=e.ss.get(t)||Q.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),e.ss.set(t,r)}class dh{constructor(){this.activeTargetIds=Qw()}As(t){this.activeTargetIds=this.activeTargetIds.add(t)}Rs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}ds(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Z0{constructor(){this.no=new dh,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,n,r){}addLocalQueryTarget(t){return this.no.As(t),this.ro[t]||"not-current"}updateQueryState(t,n,r){this.ro[t]=n}removeLocalQueryTarget(t){this.no.Rs(t)}isLocalQueryTarget(t){return this.no.activeTargetIds.has(t)}clearQueryState(t){delete this.ro[t]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(t){return this.no.activeTargetIds.has(t)}start(){return this.no=new dh,Promise.resolve()}handleUserChange(t,n,r){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tI{io(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ph{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(t){this.uo.push(t)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){k("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.uo)t(0)}ao(){k("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.uo)t(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ai=null;function ga(){return ai===null?ai=function(){return 268435456+Math.round(2147483648*Math.random())}():ai++,"0x"+ai.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eI={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nI{constructor(t){this.lo=t.lo,this.ho=t.ho}Po(t){this.Io=t}To(t){this.Eo=t}onMessage(t){this.Ao=t}close(){this.ho()}send(t){this.lo(t)}Ro(){this.Io()}Vo(t){this.Eo(t)}mo(t){this.Ao(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wt="WebChannelConnection";class rI extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.fo=r+"://"+n.host,this.po=`projects/${s}/databases/${i}`,this.yo=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get wo(){return!1}So(n,r,s,i,o){const a=ga(),c=this.bo(n,r.toUriEncodedString());k("RestConnection",`Sending RPC '${n}' ${a}:`,c,s);const l={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(l,i,o),this.Co(n,c,l,s).then(u=>(k("RestConnection",`Received RPC '${n}' ${a}: `,u),u),u=>{throw Er("RestConnection",`RPC '${n}' ${a} failed with error: `,u,"url: ",c,"request:",s),u})}vo(n,r,s,i,o,a){return this.So(n,r,s,i,o)}Do(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+kr}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>n[o]=i),s&&s.headers.forEach((i,o)=>n[o]=i)}bo(n,r){const s=eI[n];return`${this.fo}/v1/${r}:${s}`}terminate(){}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Co(t,n,r,s){const i=ga();return new Promise((o,a)=>{const c=new cw;c.setWithCredentials(!0),c.listenOnce(ow.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case pa.NO_ERROR:const u=c.getResponseJson();k(Wt,`XHR for RPC '${t}' ${i} received:`,JSON.stringify(u)),o(u);break;case pa.TIMEOUT:k(Wt,`RPC '${t}' ${i} timed out`),a(new B(b.DEADLINE_EXCEEDED,"Request time out"));break;case pa.HTTP_ERROR:const h=c.getStatus();if(k(Wt,`RPC '${t}' ${i} failed with status:`,h,"response text:",c.getResponseText()),h>0){let f=c.getResponseJson();Array.isArray(f)&&(f=f[0]);const m=f==null?void 0:f.error;if(m&&m.status&&m.message){const R=function(w){const L=w.toLowerCase().replace(/_/g,"-");return Object.values(b).indexOf(L)>=0?L:b.UNKNOWN}(m.status);a(new B(R,m.message))}else a(new B(b.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new B(b.UNAVAILABLE,"Connection failed."));break;default:H()}}finally{k(Wt,`RPC '${t}' ${i} completed.`)}});const l=JSON.stringify(s);k(Wt,`RPC '${t}' ${i} sending request:`,s),c.send(n,"POST",l,r,15)})}Fo(t,n,r){const s=ga(),i=[this.fo,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=sw(),a=iw(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Do(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const u=i.join("");k(Wt,`Creating RPC '${t}' stream ${s}: ${u}`,c);const h=o.createWebChannel(u,c);let f=!1,m=!1;const R=new nI({lo:w=>{m?k(Wt,`Not sending because RPC '${t}' stream ${s} is closed:`,w):(f||(k(Wt,`Opening RPC '${t}' stream ${s} transport.`),h.open(),f=!0),k(Wt,`RPC '${t}' stream ${s} sending:`,w),h.send(w))},ho:()=>h.close()}),T=(w,L,v)=>{w.listen(L,y=>{try{v(y)}catch(_){setTimeout(()=>{throw _},0)}})};return T(h,si.EventType.OPEN,()=>{m||k(Wt,`RPC '${t}' stream ${s} transport opened.`)}),T(h,si.EventType.CLOSE,()=>{m||(m=!0,k(Wt,`RPC '${t}' stream ${s} transport closed`),R.Vo())}),T(h,si.EventType.ERROR,w=>{m||(m=!0,Er(Wt,`RPC '${t}' stream ${s} transport errored:`,w),R.Vo(new B(b.UNAVAILABLE,"The operation could not be completed")))}),T(h,si.EventType.MESSAGE,w=>{var L;if(!m){const v=w.data[0];gt(!!v);const y=v,_=y.error||((L=y[0])===null||L===void 0?void 0:L.error);if(_){k(Wt,`RPC '${t}' stream ${s} received error:`,_);const q=_.status;let S=function(nt){const et=Rt[nt];if(et!==void 0)return kp(et)}(q),D=_.message;S===void 0&&(S=b.INTERNAL,D="Unknown error status: "+q+" with message "+_.message),m=!0,R.Vo(new B(S,D)),h.close()}else k(Wt,`RPC '${t}' stream ${s} received:`,v),R.mo(v)}}),T(a,aw.STAT_EVENT,w=>{w.stat===qu.PROXY?k(Wt,`RPC '${t}' stream ${s} detected buffering proxy`):w.stat===qu.NOPROXY&&k(Wt,`RPC '${t}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{R.Ro()},0),R}}function _a(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ko(e){return new p0(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hp{constructor(t,n,r=1e3,s=1.5,i=6e4){this.oi=t,this.timerId=n,this.Mo=r,this.xo=s,this.Oo=i,this.No=0,this.Bo=null,this.Lo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(t){this.cancel();const n=Math.floor(this.No+this.Qo()),r=Math.max(0,Date.now()-this.Lo),s=Math.max(0,n-r);s>0&&k("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.No} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Bo=this.oi.enqueueAfterDelay(this.timerId,s,()=>(this.Lo=Date.now(),t())),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){this.Bo!==null&&(this.Bo.skipDelay(),this.Bo=null)}cancel(){this.Bo!==null&&(this.Bo.cancel(),this.Bo=null)}Qo(){return(Math.random()-.5)*this.No}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kp{constructor(t,n,r,s,i,o,a,c){this.oi=t,this.$o=r,this.Uo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new Hp(t,n)}Ho(){return this.state===1||this.state===5||this.Jo()}Jo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Yo()}async stop(){this.Ho()&&await this.close(0)}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&this.Go===null&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,()=>this.e_()))}t_(t){this.n_(),this.stream.send(t)}async e_(){if(this.Jo())return this.close(0)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}async close(t,n){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,t!==4?this.jo.reset():n&&n.code===b.RESOURCE_EXHAUSTED?($e(n.toString()),$e("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):n&&n.code===b.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.i_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.To(n)}i_(){}auth(){this.state=1;const t=this.s_(this.Wo),n=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Wo===n&&this.o_(r,s)},r=>{t(()=>{const s=new B(b.UNKNOWN,"Fetching auth token failed: "+r.message);return this.__(s)})})}o_(t,n){const r=this.s_(this.Wo);this.stream=this.a_(t,n),this.stream.Po(()=>{r(()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,()=>(this.Jo()&&(this.state=3),Promise.resolve())),this.listener.Po()))}),this.stream.To(s=>{r(()=>this.__(s))}),this.stream.onMessage(s=>{r(()=>this.onMessage(s))})}Yo(){this.state=5,this.jo.qo(async()=>{this.state=0,this.start()})}__(t){return k("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}s_(t){return n=>{this.oi.enqueueAndForget(()=>this.Wo===t?n():(k("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class sI extends Kp{constructor(t,n,r,s,i,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}a_(t,n){return this.connection.Fo("Listen",t,n)}onMessage(t){this.jo.reset();const n=_0(this.serializer,t),r=function(i){if(!("targetChange"in i))return Q.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?Q.min():o.readTime?Fe(o.readTime):Q.min()}(t);return this.listener.u_(n,r)}c_(t){const n={};n.database=oc(this.serializer),n.addTarget=function(i,o){let a;const c=o.target;if(a=ec(c)?{documents:E0(i,c)}:{query:T0(i,c).ut},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=Mp(i,o.resumeToken);const l=rc(i,o.expectedCount);l!==null&&(a.expectedCount=l)}else if(o.snapshotVersion.compareTo(Q.min())>0){a.readTime=Ui(i,o.snapshotVersion.toTimestamp());const l=rc(i,o.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,t);const r=I0(this.serializer,t);r&&(n.labels=r),this.t_(n)}l_(t){const n={};n.database=oc(this.serializer),n.removeTarget=t,this.t_(n)}}class iI extends Kp{constructor(t,n,r,s,i,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(t,n){return this.connection.Fo("Write",t,n)}onMessage(t){if(gt(!!t.streamToken),this.lastStreamToken=t.streamToken,this.h_){this.jo.reset();const n=v0(t.writeResults,t.commitTime),r=Fe(t.commitTime);return this.listener.T_(r,n)}return gt(!t.writeResults||t.writeResults.length===0),this.h_=!0,this.listener.E_()}d_(){const t={};t.database=oc(this.serializer),this.t_(t)}I_(t){const n={streamToken:this.lastStreamToken,writes:t.map(r=>y0(this.serializer,r))};this.t_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oI extends class{}{constructor(t,n,r,s){super(),this.authCredentials=t,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.A_=!1}R_(){if(this.A_)throw new B(b.FAILED_PRECONDITION,"The client has already been terminated.")}So(t,n,r,s){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.So(t,sc(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===b.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new B(b.UNKNOWN,i.toString())})}vo(t,n,r,s,i){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.vo(t,sc(n,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===b.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new B(b.UNKNOWN,o.toString())})}terminate(){this.A_=!0,this.connection.terminate()}}class aI{constructor(t,n){this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){this.m_===0&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve())))}S_(t){this.state==="Online"?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.y_("Offline")))}set(t){this.b_(),this.m_=0,t==="Online"&&(this.g_=!1),this.y_(t)}y_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}w_(t){const n=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?($e(n),this.g_=!1):k("OnlineStateTracker",n)}b_(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cI{constructor(t,n,r,s,i){this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=i,this.M_.io(o=>{r.enqueueAndForget(async()=>{Yn(this)&&(k("RemoteStore","Restarting streams for network reachability change."),await async function(c){const l=J(c);l.v_.add(4),await js(l),l.x_.set("Unknown"),l.v_.delete(4),await No(l)}(this))})}),this.x_=new aI(r,s)}}async function No(e){if(Yn(e))for(const t of e.F_)await t(!0)}async function js(e){for(const t of e.F_)await t(!1)}function Wp(e,t){const n=J(e);n.C_.has(t.targetId)||(n.C_.set(t.targetId,t),Tl(n)?El(n):Mr(n).Jo()&&vl(n,t))}function Gp(e,t){const n=J(e),r=Mr(n);n.C_.delete(t),r.Jo()&&Qp(n,t),n.C_.size===0&&(r.Jo()?r.Xo():Yn(n)&&n.x_.set("Unknown"))}function vl(e,t){if(e.O_.Oe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Q.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Mr(e).c_(t)}function Qp(e,t){e.O_.Oe(t),Mr(e).l_(t)}function El(e){e.O_=new u0({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),_t:t=>e.C_.get(t)||null,nt:()=>e.datastore.serializer.databaseId}),Mr(e).start(),e.x_.p_()}function Tl(e){return Yn(e)&&!Mr(e).Ho()&&e.C_.size>0}function Yn(e){return J(e).v_.size===0}function Xp(e){e.O_=void 0}async function lI(e){e.C_.forEach((t,n)=>{vl(e,t)})}async function uI(e,t){Xp(e),Tl(e)?(e.x_.S_(t),El(e)):e.x_.set("Unknown")}async function hI(e,t,n){if(e.x_.set("Online"),t instanceof Op&&t.state===2&&t.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.C_.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.C_.delete(a),s.O_.removeTarget(a))}(e,t)}catch(r){k("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),r),await Bi(e,r)}else if(t instanceof pi?e.O_.$e(t):t instanceof Np?e.O_.Je(t):e.O_.Ge(t),!n.isEqual(Q.min()))try{const r=await qp(e.localStore);n.compareTo(r)>=0&&await function(i,o){const a=i.O_.it(o);return a.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){const u=i.C_.get(l);u&&i.C_.set(l,u.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,l)=>{const u=i.C_.get(c);if(!u)return;i.C_.set(c,u.withResumeToken(te.EMPTY_BYTE_STRING,u.snapshotVersion)),Qp(i,c);const h=new ln(u.target,c,l,u.sequenceNumber);vl(i,h)}),i.remoteSyncer.applyRemoteEvent(a)}(e,n)}catch(r){k("RemoteStore","Failed to raise snapshot:",r),await Bi(e,r)}}async function Bi(e,t,n){if(!Us(t))throw t;e.v_.add(1),await js(e),e.x_.set("Offline"),n||(n=()=>qp(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{k("RemoteStore","Retrying IndexedDB access"),await n(),e.v_.delete(1),await No(e)})}function Yp(e,t){return t().catch(n=>Bi(e,n,t))}async function Oo(e){const t=J(e),n=vn(t);let r=t.D_.length>0?t.D_[t.D_.length-1].batchId:-1;for(;fI(t);)try{const s=await X0(t.localStore,r);if(s===null){t.D_.length===0&&n.Xo();break}r=s.batchId,dI(t,s)}catch(s){await Bi(t,s)}Jp(t)&&Zp(t)}function fI(e){return Yn(e)&&e.D_.length<10}function dI(e,t){e.D_.push(t);const n=vn(e);n.Jo()&&n.P_&&n.I_(t.mutations)}function Jp(e){return Yn(e)&&!vn(e).Ho()&&e.D_.length>0}function Zp(e){vn(e).start()}async function pI(e){vn(e).d_()}async function mI(e){const t=vn(e);for(const n of e.D_)t.I_(n.mutations)}async function gI(e,t,n){const r=e.D_.shift(),s=dl.from(r,t,n);await Yp(e,()=>e.remoteSyncer.applySuccessfulWrite(s)),await Oo(e)}async function _I(e,t){t&&vn(e).P_&&await async function(r,s){if(function(o){return a0(o)&&o!==b.ABORTED}(s.code)){const i=r.D_.shift();vn(r).Zo(),await Yp(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Oo(r)}}(e,t),Jp(e)&&Zp(e)}async function mh(e,t){const n=J(e);n.asyncQueue.verifyOperationInProgress(),k("RemoteStore","RemoteStore received new credentials");const r=Yn(n);n.v_.add(3),await js(n),r&&n.x_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.v_.delete(3),await No(n)}async function yI(e,t){const n=J(e);t?(n.v_.delete(2),await No(n)):t||(n.v_.add(2),await js(n),n.x_.set("Unknown"))}function Mr(e){return e.N_||(e.N_=function(n,r,s){const i=J(n);return i.R_(),new sI(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(e.datastore,e.asyncQueue,{Po:lI.bind(null,e),To:uI.bind(null,e),u_:hI.bind(null,e)}),e.F_.push(async t=>{t?(e.N_.Zo(),Tl(e)?El(e):e.x_.set("Unknown")):(await e.N_.stop(),Xp(e))})),e.N_}function vn(e){return e.B_||(e.B_=function(n,r,s){const i=J(n);return i.R_(),new iI(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(e.datastore,e.asyncQueue,{Po:pI.bind(null,e),To:_I.bind(null,e),E_:mI.bind(null,e),T_:gI.bind(null,e)}),e.F_.push(async t=>{t?(e.B_.Zo(),await Oo(e)):(await e.B_.stop(),e.D_.length>0&&(k("RemoteStore",`Stopping write stream with ${e.D_.length} pending writes`),e.D_=[]))})),e.B_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wl{constructor(t,n,r,s,i){this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Ge,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,n,r,s,i){const o=Date.now()+r,a=new wl(t,n,o,s,i);return a.start(r),a}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new B(b.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Il(e,t){if($e("AsyncQueue",`${t}: ${e}`),Us(e))return new B(b.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(t){this.comparator=t?(n,r)=>t(n,r)||j.comparator(n.key,r.key):(n,r)=>j.comparator(n.key,r.key),this.keyedMap=Wr(),this.sortedSet=new It(this.comparator)}static emptySet(t){return new gr(t.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const n=this.keyedMap.get(t);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((n,r)=>(t(n),!1))}add(t){const n=this.delete(t.key);return n.copy(n.keyedMap.insert(t.key,t),n.sortedSet.insert(t,null))}delete(t){const n=this.get(t);return n?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(n)):this}isEqual(t){if(!(t instanceof gr)||this.size!==t.size)return!1;const n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const t=[];return this.forEach(n=>{t.push(n.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,n){const r=new gr;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gh{constructor(){this.L_=new It(j.comparator)}track(t){const n=t.doc.key,r=this.L_.get(n);r?t.type!==0&&r.type===3?this.L_=this.L_.insert(n,t):t.type===3&&r.type!==1?this.L_=this.L_.insert(n,{type:r.type,doc:t.doc}):t.type===2&&r.type===2?this.L_=this.L_.insert(n,{type:2,doc:t.doc}):t.type===2&&r.type===0?this.L_=this.L_.insert(n,{type:0,doc:t.doc}):t.type===1&&r.type===0?this.L_=this.L_.remove(n):t.type===1&&r.type===2?this.L_=this.L_.insert(n,{type:1,doc:r.doc}):t.type===0&&r.type===1?this.L_=this.L_.insert(n,{type:2,doc:t.doc}):H():this.L_=this.L_.insert(n,t)}k_(){const t=[];return this.L_.inorderTraversal((n,r)=>{t.push(r)}),t}}class br{constructor(t,n,r,s,i,o,a,c,l){this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(t,n,r,s,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new br(t,n,gr.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Co(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const n=this.docChanges,r=t.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vI{constructor(){this.q_=void 0,this.Q_=[]}}class EI{constructor(){this.queries=new Or(t=>vp(t),Co),this.onlineState="Unknown",this.K_=new Set}}async function TI(e,t){const n=J(e),r=t.query;let s=!1,i=n.queries.get(r);if(i||(s=!0,i=new vI),s)try{i.q_=await n.onListen(r)}catch(o){const a=Il(o,`Initialization of query '${rr(t.query)}' failed`);return void t.onError(a)}n.queries.set(r,i),i.Q_.push(t),t.U_(n.onlineState),i.q_&&t.W_(i.q_)&&Al(n)}async function wI(e,t){const n=J(e),r=t.query;let s=!1;const i=n.queries.get(r);if(i){const o=i.Q_.indexOf(t);o>=0&&(i.Q_.splice(o,1),s=i.Q_.length===0)}if(s)return n.queries.delete(r),n.onUnlisten(r)}function II(e,t){const n=J(e);let r=!1;for(const s of t){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.Q_)a.W_(s)&&(r=!0);o.q_=s}}r&&Al(n)}function AI(e,t,n){const r=J(e),s=r.queries.get(t);if(s)for(const i of s.Q_)i.onError(n);r.queries.delete(t)}function Al(e){e.K_.forEach(t=>{t.next()})}class bI{constructor(t,n,r){this.query=t,this.G_=n,this.z_=!1,this.j_=null,this.onlineState="Unknown",this.options=r||{}}W_(t){if(!this.options.includeMetadataChanges){const r=[];for(const s of t.docChanges)s.type!==3&&r.push(s);t=new br(t.query,t.docs,t.oldDocs,r,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let n=!1;return this.z_?this.H_(t)&&(this.G_.next(t),n=!0):this.J_(t,this.onlineState)&&(this.Y_(t),n=!0),this.j_=t,n}onError(t){this.G_.error(t)}U_(t){this.onlineState=t;let n=!1;return this.j_&&!this.z_&&this.J_(this.j_,t)&&(this.Y_(this.j_),n=!0),n}J_(t,n){if(!t.fromCache)return!0;const r=n!=="Offline";return(!this.options.Z_||!r)&&(!t.docs.isEmpty()||t.hasCachedResults||n==="Offline")}H_(t){if(t.docChanges.length>0)return!0;const n=this.j_&&this.j_.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Y_(t){t=br.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.z_=!0,this.G_.next(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tm{constructor(t){this.key=t}}class em{constructor(t){this.key=t}}class RI{constructor(t,n){this.query=t,this.oa=n,this._a=null,this.hasCachedResults=!1,this.current=!1,this.aa=it(),this.mutatedKeys=it(),this.ua=Ep(t),this.ca=new gr(this.ua)}get la(){return this.oa}ha(t,n){const r=n?n.Pa:new gh,s=n?n.ca:this.ca;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,l=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal((u,h)=>{const f=s.get(u),m=Po(this.query,h)?h:null,R=!!f&&this.mutatedKeys.has(f.key),T=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let w=!1;f&&m?f.data.isEqual(m.data)?R!==T&&(r.track({type:3,doc:m}),w=!0):this.Ia(f,m)||(r.track({type:2,doc:m}),w=!0,(c&&this.ua(m,c)>0||l&&this.ua(m,l)<0)&&(a=!0)):!f&&m?(r.track({type:0,doc:m}),w=!0):f&&!m&&(r.track({type:1,doc:f}),w=!0,(c||l)&&(a=!0)),w&&(m?(o=o.add(m),i=T?i.add(u):i.delete(u)):(o=o.delete(u),i=i.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),i=i.delete(u.key),r.track({type:1,doc:u})}return{ca:o,Pa:r,Xi:a,mutatedKeys:i}}Ia(t,n){return t.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(t,n,r,s){const i=this.ca;this.ca=t.ca,this.mutatedKeys=t.mutatedKeys;const o=t.Pa.k_();o.sort((u,h)=>function(m,R){const T=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return H()}};return T(m)-T(R)}(u.type,h.type)||this.ua(u.doc,h.doc)),this.Ta(r),s=s!=null&&s;const a=n&&!s?this.Ea():[],c=this.aa.size===0&&this.current&&!s?1:0,l=c!==this._a;return this._a=c,o.length!==0||l?{snapshot:new br(this.query,t.ca,i,o,t.mutatedKeys,c===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),da:a}:{da:a}}U_(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({ca:this.ca,Pa:new gh,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{da:[]}}Aa(t){return!this.oa.has(t)&&!!this.ca.has(t)&&!this.ca.get(t).hasLocalMutations}Ta(t){t&&(t.addedDocuments.forEach(n=>this.oa=this.oa.add(n)),t.modifiedDocuments.forEach(n=>{}),t.removedDocuments.forEach(n=>this.oa=this.oa.delete(n)),this.current=t.current)}Ea(){if(!this.current)return[];const t=this.aa;this.aa=it(),this.ca.forEach(r=>{this.Aa(r.key)&&(this.aa=this.aa.add(r.key))});const n=[];return t.forEach(r=>{this.aa.has(r)||n.push(new em(r))}),this.aa.forEach(r=>{t.has(r)||n.push(new tm(r))}),n}Ra(t){this.oa=t.hs,this.aa=it();const n=this.ha(t.documents);return this.applyChanges(n,!0)}Va(){return br.fromInitialDocuments(this.query,this.ca,this.mutatedKeys,this._a===0,this.hasCachedResults)}}class SI{constructor(t,n,r){this.query=t,this.targetId=n,this.view=r}}class CI{constructor(t){this.key=t,this.ma=!1}}class PI{constructor(t,n,r,s,i,o){this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.fa={},this.ga=new Or(a=>vp(a),Co),this.pa=new Map,this.ya=new Set,this.wa=new It(j.comparator),this.Sa=new Map,this.ba=new gl,this.Da={},this.Ca=new Map,this.va=Ar.Bn(),this.onlineState="Unknown",this.Fa=void 0}get isPrimaryClient(){return this.Fa===!0}}async function VI(e,t){const n=BI(e);let r,s;const i=n.ga.get(t);if(i)r=i.targetId,n.sharedClientState.addLocalQueryTarget(r),s=i.view.Va();else{const o=await Y0(n.localStore,Le(t)),a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,s=await DI(n,t,r,a==="current",o.resumeToken),n.isPrimaryClient&&Wp(n.remoteStore,o)}return s}async function DI(e,t,n,r,s){e.Ma=(h,f,m)=>async function(T,w,L,v){let y=w.view.ha(L);y.Xi&&(y=await fh(T.localStore,w.query,!1).then(({documents:D})=>w.view.ha(D,y)));const _=v&&v.targetChanges.get(w.targetId),q=v&&v.targetMismatches.get(w.targetId)!=null,S=w.view.applyChanges(y,T.isPrimaryClient,_,q);return yh(T,w.targetId,S.da),S.snapshot}(e,h,f,m);const i=await fh(e.localStore,t,!0),o=new RI(t,i.hs),a=o.ha(i.documents),c=$s.createSynthesizedTargetChangeForCurrentChange(n,r&&e.onlineState!=="Offline",s),l=o.applyChanges(a,e.isPrimaryClient,c);yh(e,n,l.da);const u=new SI(t,n,o);return e.ga.set(t,u),e.pa.has(n)?e.pa.get(n).push(t):e.pa.set(n,[t]),l.snapshot}async function xI(e,t){const n=J(e),r=n.ga.get(t),s=n.pa.get(r.targetId);if(s.length>1)return n.pa.set(r.targetId,s.filter(i=>!Co(i,t))),void n.ga.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await ac(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),Gp(n.remoteStore,r.targetId),cc(n,r.targetId)}).catch(Fs)):(cc(n,r.targetId),await ac(n.localStore,r.targetId,!0))}async function kI(e,t,n){const r=$I(e);try{const s=await function(o,a){const c=J(o),l=Dt.now(),u=a.reduce((m,R)=>m.add(R.key),it());let h,f;return c.persistence.runTransaction("Locally write mutations","readwrite",m=>{let R=Ye(),T=it();return c.os.getEntries(m,u).next(w=>{R=w,R.forEach((L,v)=>{v.isValidDocument()||(T=T.add(L))})}).next(()=>c.localDocuments.getOverlayedDocuments(m,R)).next(w=>{h=w;const L=[];for(const v of a){const y=n0(v,h.get(v.key).overlayedDocument);y!=null&&L.push(new Xn(v.key,y,hp(y.value.mapValue),Qe.exists(!0)))}return c.mutationQueue.addMutationBatch(m,l,L,a)}).next(w=>{f=w;const L=w.applyToLocalDocumentSet(h,T);return c.documentOverlayCache.saveOverlays(m,w.batchId,L)})}).then(()=>({batchId:f.batchId,changes:wp(h)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,c){let l=o.Da[o.currentUser.toKey()];l||(l=new It(ut)),l=l.insert(a,c),o.Da[o.currentUser.toKey()]=l}(r,s.batchId,n),await zs(r,s.changes),await Oo(r.remoteStore)}catch(s){const i=Il(s,"Failed to persist write");n.reject(i)}}async function nm(e,t){const n=J(e);try{const r=await G0(n.localStore,t);t.targetChanges.forEach((s,i)=>{const o=n.Sa.get(i);o&&(gt(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.ma=!0:s.modifiedDocuments.size>0?gt(o.ma):s.removedDocuments.size>0&&(gt(o.ma),o.ma=!1))}),await zs(n,r,t)}catch(r){await Fs(r)}}function _h(e,t,n){const r=J(e);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.ga.forEach((i,o)=>{const a=o.view.U_(t);a.snapshot&&s.push(a.snapshot)}),function(o,a){const c=J(o);c.onlineState=a;let l=!1;c.queries.forEach((u,h)=>{for(const f of h.Q_)f.U_(a)&&(l=!0)}),l&&Al(c)}(r.eventManager,t),s.length&&r.fa.u_(s),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function NI(e,t,n){const r=J(e);r.sharedClientState.updateQueryState(t,"rejected",n);const s=r.Sa.get(t),i=s&&s.key;if(i){let o=new It(j.comparator);o=o.insert(i,Qt.newNoDocument(i,Q.min()));const a=it().add(i),c=new xo(Q.min(),new Map,new It(ut),o,a);await nm(r,c),r.wa=r.wa.remove(i),r.Sa.delete(t),bl(r)}else await ac(r.localStore,t,!1).then(()=>cc(r,t,n)).catch(Fs)}async function OI(e,t){const n=J(e),r=t.batch.batchId;try{const s=await W0(n.localStore,t);sm(n,r,null),rm(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await zs(n,s)}catch(s){await Fs(s)}}async function MI(e,t,n){const r=J(e);try{const s=await function(o,a){const c=J(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let u;return c.mutationQueue.lookupMutationBatch(l,a).next(h=>(gt(h!==null),u=h.keys(),c.mutationQueue.removeMutationBatch(l,h))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,u,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,u)).next(()=>c.localDocuments.getDocuments(l,u))})}(r.localStore,t);sm(r,t,n),rm(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await zs(r,s)}catch(s){await Fs(s)}}function rm(e,t){(e.Ca.get(t)||[]).forEach(n=>{n.resolve()}),e.Ca.delete(t)}function sm(e,t,n){const r=J(e);let s=r.Da[r.currentUser.toKey()];if(s){const i=s.get(t);i&&(n?i.reject(n):i.resolve(),s=s.remove(t)),r.Da[r.currentUser.toKey()]=s}}function cc(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.pa.get(t))e.ga.delete(r),n&&e.fa.xa(r,n);e.pa.delete(t),e.isPrimaryClient&&e.ba.Vr(t).forEach(r=>{e.ba.containsKey(r)||im(e,r)})}function im(e,t){e.ya.delete(t.path.canonicalString());const n=e.wa.get(t);n!==null&&(Gp(e.remoteStore,n),e.wa=e.wa.remove(t),e.Sa.delete(n),bl(e))}function yh(e,t,n){for(const r of n)r instanceof tm?(e.ba.addReference(r.key,t),LI(e,r)):r instanceof em?(k("SyncEngine","Document no longer in limbo: "+r.key),e.ba.removeReference(r.key,t),e.ba.containsKey(r.key)||im(e,r.key)):H()}function LI(e,t){const n=t.key,r=n.path.canonicalString();e.wa.get(n)||e.ya.has(r)||(k("SyncEngine","New document in limbo: "+n),e.ya.add(r),bl(e))}function bl(e){for(;e.ya.size>0&&e.wa.size<e.maxConcurrentLimboResolutions;){const t=e.ya.values().next().value;e.ya.delete(t);const n=new j(Et.fromString(t)),r=e.va.next();e.Sa.set(r,new CI(n)),e.wa=e.wa.insert(n,r),Wp(e.remoteStore,new ln(Le(yp(n.path)),r,"TargetPurposeLimboResolution",al._e))}}async function zs(e,t,n){const r=J(e),s=[],i=[],o=[];r.ga.isEmpty()||(r.ga.forEach((a,c)=>{o.push(r.Ma(c,t,n).then(l=>{if((l||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(c.targetId,l!=null&&l.fromCache?"not-current":"current"),l){s.push(l);const u=yl.Ki(c.targetId,l);i.push(u)}}))}),await Promise.all(o),r.fa.u_(s),await async function(c,l){const u=J(c);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>E.forEach(l,f=>E.forEach(f.qi,m=>u.persistence.referenceDelegate.addReference(h,f.targetId,m)).next(()=>E.forEach(f.Qi,m=>u.persistence.referenceDelegate.removeReference(h,f.targetId,m)))))}catch(h){if(!Us(h))throw h;k("LocalStore","Failed to update sequence numbers: "+h)}for(const h of l){const f=h.targetId;if(!h.fromCache){const m=u.ns.get(f),R=m.snapshotVersion,T=m.withLastLimboFreeSnapshotVersion(R);u.ns=u.ns.insert(f,T)}}}(r.localStore,i))}async function FI(e,t){const n=J(e);if(!n.currentUser.isEqual(t)){k("SyncEngine","User change. New user:",t.toKey());const r=await zp(n.localStore,t);n.currentUser=t,function(i,o){i.Ca.forEach(a=>{a.forEach(c=>{c.reject(new B(b.CANCELLED,o))})}),i.Ca.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),await zs(n,r.us)}}function UI(e,t){const n=J(e),r=n.Sa.get(t);if(r&&r.ma)return it().add(r.key);{let s=it();const i=n.pa.get(t);if(!i)return s;for(const o of i){const a=n.ga.get(o);s=s.unionWith(a.view.la)}return s}}function BI(e){const t=J(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=nm.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=UI.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=NI.bind(null,t),t.fa.u_=II.bind(null,t.eventManager),t.fa.xa=AI.bind(null,t.eventManager),t}function $I(e){const t=J(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=OI.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=MI.bind(null,t),t}class vh{constructor(){this.synchronizeTabs=!1}async initialize(t){this.serializer=ko(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),await this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)}createGarbageCollectionScheduler(t,n){return null}createIndexBackfillerScheduler(t,n){return null}createLocalStore(t){return K0(this.persistence,new q0,t.initialUser,this.serializer)}createPersistence(t){return new $0(_l.Hr,this.serializer)}createSharedClientState(t){return new Z0}async terminate(){var t,n;(t=this.gcScheduler)===null||t===void 0||t.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class jI{async initialize(t,n){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>_h(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=FI.bind(null,this.syncEngine),await yI(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new EI}()}createDatastore(t){const n=ko(t.databaseInfo.databaseId),r=function(i){return new rI(i)}(t.databaseInfo);return function(i,o,a,c){return new oI(i,o,a,c)}(t.authCredentials,t.appCheckCredentials,r,n)}createRemoteStore(t){return function(r,s,i,o,a){return new cI(r,s,i,o,a)}(this.localStore,this.datastore,t.asyncQueue,n=>_h(this.syncEngine,n,0),function(){return ph.D()?new ph:new tI}())}createSyncEngine(t,n){return function(s,i,o,a,c,l,u){const h=new PI(s,i,o,a,c,l);return u&&(h.Fa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,n)}async terminate(){var t;await async function(r){const s=J(r);k("RemoteStore","RemoteStore shutting down."),s.v_.add(5),await js(s),s.M_.shutdown(),s.x_.set("Unknown")}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zI{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Ba(this.observer.next,t)}error(t){this.observer.error?this.Ba(this.observer.error,t):$e("Uncaught Error in snapshot listener:",t.toString())}La(){this.muted=!0}Ba(t,n){this.muted||setTimeout(()=>{this.muted||t(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qI{constructor(t,n,r,s){this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Gt.UNAUTHENTICATED,this.clientId=cp.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async i=>{k("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(r,i=>(k("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new B(b.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Ge;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(n){const r=Il(n,"Failed to shutdown persistence");t.reject(r)}}),t.promise}}async function ya(e,t){e.asyncQueue.verifyOperationInProgress(),k("FirestoreClient","Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async s=>{r.isEqual(s)||(await zp(t.localStore,s),r=s)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function Eh(e,t){e.asyncQueue.verifyOperationInProgress();const n=await KI(e);k("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(r=>mh(t.remoteStore,r)),e.setAppCheckTokenChangeListener((r,s)=>mh(t.remoteStore,s)),e._onlineComponents=t}function HI(e){return e.name==="FirebaseError"?e.code===b.FAILED_PRECONDITION||e.code===b.UNIMPLEMENTED:!(typeof DOMException<"u"&&e instanceof DOMException)||e.code===22||e.code===20||e.code===11}async function KI(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){k("FirestoreClient","Using user provided OfflineComponentProvider");try{await ya(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!HI(n))throw n;Er("Error using user provided cache. Falling back to memory cache: "+n),await ya(e,new vh)}}else k("FirestoreClient","Using default OfflineComponentProvider"),await ya(e,new vh);return e._offlineComponents}async function om(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(k("FirestoreClient","Using user provided OnlineComponentProvider"),await Eh(e,e._uninitializedComponentsProvider._online)):(k("FirestoreClient","Using default OnlineComponentProvider"),await Eh(e,new jI))),e._onlineComponents}function WI(e){return om(e).then(t=>t.syncEngine)}async function GI(e){const t=await om(e),n=t.eventManager;return n.onListen=VI.bind(null,t.syncEngine),n.onUnlisten=xI.bind(null,t.syncEngine),n}function QI(e,t,n={}){const r=new Ge;return e.asyncQueue.enqueueAndForget(async()=>function(i,o,a,c,l){const u=new zI({next:f=>{o.enqueueAndForget(()=>wI(i,h)),f.fromCache&&c.source==="server"?l.reject(new B(b.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(f)},error:f=>l.reject(f)}),h=new bI(a,u,{includeMetadataChanges:!0,Z_:!0});return TI(i,h)}(await GI(e),e.asyncQueue,t,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function am(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Th=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cm(e,t,n){if(!n)throw new B(b.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function XI(e,t,n,r){if(t===!0&&r===!0)throw new B(b.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function wh(e){if(!j.isDocumentKey(e))throw new B(b.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Ih(e){if(j.isDocumentKey(e))throw new B(b.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Rl(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(r){return r.constructor?r.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":H()}function $i(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new B(b.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Rl(e);throw new B(b.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ah{constructor(t){var n,r;if(t.host===void 0){if(t.ssl!==void 0)throw new B(b.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=(n=t.ssl)===null||n===void 0||n;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<1048576)throw new B(b.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}XI("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=am((r=t.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new B(b.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new B(b.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new B(b.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Mo{constructor(t,n,r,s){this._authCredentials=t,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ah({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new B(b.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(t){if(this._settingsFrozen)throw new B(b.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ah(t),t.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new uw;switch(r.type){case"firstParty":return new pw(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new B(b.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Th.get(n);r&&(k("ComponentProvider","Removing Datastore"),Th.delete(n),r.terminate())}(this),Promise.resolve()}}function YI(e,t,n,r={}){var s;const i=(e=$i(e,Mo))._getSettings(),o=`${t}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&Er("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=Gt.MOCK_USER;else{a=zv(r.mockUserToken,(s=e._app)===null||s===void 0?void 0:s.options.projectId);const l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new B(b.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Gt(l)}e._authCredentials=new hw(new ap(a,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(t,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=t}withConverter(t){return new Lo(this.firestore,t,this._query)}}class be{constructor(t,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new mn(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new be(this.firestore,t,this._key)}}class mn extends Lo{constructor(t,n,r){super(t,n,yp(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new be(this.firestore,null,new j(t))}withConverter(t){return new mn(this.firestore,t,this._path)}}function lm(e,t,...n){if(e=us(e),cm("collection","path",t),e instanceof Mo){const r=Et.fromString(t,...n);return Ih(r),new mn(e,null,r)}{if(!(e instanceof be||e instanceof mn))throw new B(b.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(Et.fromString(t,...n));return Ih(r),new mn(e.firestore,null,r)}}function JI(e,t,...n){if(e=us(e),arguments.length===1&&(t=cp.newId()),cm("doc","path",t),e instanceof Mo){const r=Et.fromString(t,...n);return wh(r),new be(e,null,new j(r))}{if(!(e instanceof be||e instanceof mn))throw new B(b.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(Et.fromString(t,...n));return wh(r),new be(e.firestore,e instanceof mn?e.converter:null,new j(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZI{constructor(){this.Xa=Promise.resolve(),this.eu=[],this.tu=!1,this.nu=[],this.ru=null,this.iu=!1,this.su=!1,this.ou=[],this.jo=new Hp(this,"async_queue_retry"),this._u=()=>{const n=_a();n&&k("AsyncQueue","Visibility state changed to "+n.visibilityState),this.jo.Ko()};const t=_a();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._u)}get isShuttingDown(){return this.tu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.au(),this.uu(t)}enterRestrictedMode(t){if(!this.tu){this.tu=!0,this.su=t||!1;const n=_a();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._u)}}enqueue(t){if(this.au(),this.tu)return new Promise(()=>{});const n=new Ge;return this.uu(()=>this.tu&&this.su?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.eu.push(t),this.cu()))}async cu(){if(this.eu.length!==0){try{await this.eu[0](),this.eu.shift(),this.jo.reset()}catch(t){if(!Us(t))throw t;k("AsyncQueue","Operation failed with retryable error: "+t)}this.eu.length>0&&this.jo.qo(()=>this.cu())}}uu(t){const n=this.Xa.then(()=>(this.iu=!0,t().catch(r=>{this.ru=r,this.iu=!1;const s=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw $e("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.iu=!1,r))));return this.Xa=n,n}enqueueAfterDelay(t,n,r){this.au(),this.ou.indexOf(t)>-1&&(n=0);const s=wl.createAndSchedule(this,t,n,r,i=>this.lu(i));return this.nu.push(s),s}au(){this.ru&&H()}verifyOperationInProgress(){}async hu(){let t;do t=this.Xa,await t;while(t!==this.Xa)}Pu(t){for(const n of this.nu)if(n.timerId===t)return!0;return!1}Iu(t){return this.hu().then(()=>{this.nu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.nu)if(n.skipDelay(),t!=="all"&&n.timerId===t)break;return this.hu()})}Tu(t){this.ou.push(t)}lu(t){const n=this.nu.indexOf(t);this.nu.splice(n,1)}}class Sl extends Mo{constructor(t,n,r,s){super(t,n,r,s),this.type="firestore",this._queue=function(){return new ZI}(),this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||hm(this),this._firestoreClient.terminate()}}function tA(e,t){const n=typeof e=="object"?e:GE(),r=typeof e=="string"?e:t||"(default)",s=qE(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=$v("firestore");i&&YI(s,...i)}return s}function um(e){return e._firestoreClient||hm(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function hm(e){var t,n,r;const s=e._freezeSettings(),i=function(a,c,l,u){return new Cw(a,c,l,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,am(u.experimentalLongPollingOptions),u.useFetchStreams)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,s);e._firestoreClient=new qI(e._authCredentials,e._appCheckCredentials,e._queue,i),!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:s.localCache.kind,_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Rr(te.fromBase64String(t))}catch(n){throw new B(b.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(t){return new Rr(te.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cl{constructor(...t){for(let n=0;n<t.length;++n)if(t[n].length===0)throw new B(b.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new zt(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fm{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pl{constructor(t,n){if(!isFinite(t)||t<-90||t>90)throw new B(b.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new B(b.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return ut(this._lat,t._lat)||ut(this._long,t._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eA=/^__.*__$/;class nA{constructor(t,n,r){this.data=t,this.fieldMask=n,this.fieldTransforms=r}toMutation(t,n){return this.fieldMask!==null?new Xn(t,this.data,this.fieldMask,n,this.fieldTransforms):new Bs(t,this.data,n,this.fieldTransforms)}}function dm(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw H()}}class Vl{constructor(t,n,r,s,i,o){this.settings=t,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Eu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get du(){return this.settings.du}Au(t){return new Vl(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ru(t){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(t),s=this.Au({path:r,Vu:!1});return s.mu(t),s}fu(t){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(t),s=this.Au({path:r,Vu:!1});return s.Eu(),s}gu(t){return this.Au({path:void 0,Vu:!0})}pu(t){return ji(t,this.settings.methodName,this.settings.yu||!1,this.path,this.settings.wu)}contains(t){return this.fieldMask.find(n=>t.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>t.isPrefixOf(n.field))!==void 0}Eu(){if(this.path)for(let t=0;t<this.path.length;t++)this.mu(this.path.get(t))}mu(t){if(t.length===0)throw this.pu("Document fields must not be empty");if(dm(this.du)&&eA.test(t))throw this.pu('Document fields cannot begin and end with "__"')}}class rA{constructor(t,n,r){this.databaseId=t,this.ignoreUndefinedProperties=n,this.serializer=r||ko(t)}Su(t,n,r,s=!1){return new Vl({du:t,methodName:n,wu:r,path:zt.emptyPath(),Vu:!1,yu:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function sA(e){const t=e._freezeSettings(),n=ko(e._databaseId);return new rA(e._databaseId,!!t.ignoreUndefinedProperties,n)}function iA(e,t,n,r,s,i={}){const o=e.Su(i.merge||i.mergeFields?2:0,t,n,s);_m("Data must be an object, but it was:",o,r);const a=mm(r,o);let c,l;if(i.merge)c=new Ie(o.fieldMask),l=o.fieldTransforms;else if(i.mergeFields){const u=[];for(const h of i.mergeFields){const f=oA(t,h,n);if(!o.contains(f))throw new B(b.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);cA(u,f)||u.push(f)}c=new Ie(u),l=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,l=o.fieldTransforms;return new nA(new ge(a),c,l)}function pm(e,t){if(gm(e=us(e)))return _m("Unsupported field value:",t,e),mm(e,t);if(e instanceof fm)return function(r,s){if(!dm(s.du))throw s.pu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.pu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Vu&&t.du!==4)throw t.pu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let c=pm(a,s.gu(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(e,t)}return function(r,s){if((r=us(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Xw(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Dt.fromDate(r);return{timestampValue:Ui(s.serializer,i)}}if(r instanceof Dt){const i=new Dt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ui(s.serializer,i)}}if(r instanceof Pl)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Rr)return{bytesValue:Mp(s.serializer,r._byteString)};if(r instanceof be){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.pu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:ml(r.firestore._databaseId||s.databaseId,r._key.path)}}throw s.pu(`Unsupported field value: ${Rl(r)}`)}(e,t)}function mm(e,t){const n={};return lp(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Nr(e,(r,s)=>{const i=pm(s,t.Ru(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function gm(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof Dt||e instanceof Pl||e instanceof Rr||e instanceof be||e instanceof fm)}function _m(e,t,n){if(!gm(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=Rl(n);throw r==="an object"?t.pu(e+" a custom object"):t.pu(e+" "+r)}}function oA(e,t,n){if((t=us(t))instanceof Cl)return t._internalPath;if(typeof t=="string")return ym(e,t);throw ji("Field path arguments must be of type string or ",e,!1,void 0,n)}const aA=new RegExp("[~\\*/\\[\\]]");function ym(e,t,n){if(t.search(aA)>=0)throw ji(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Cl(...t.split("."))._internalPath}catch{throw ji(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function ji(e,t,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new B(b.INVALID_ARGUMENT,a+e+c)}function cA(e,t){return e.some(n=>n.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vm{constructor(t,n,r,s,i){this._firestore=t,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new be(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new lA(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const n=this._document.data.field(Em("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n)}}}class lA extends vm{data(){return super.data()}}function Em(e,t){return typeof t=="string"?ym(e,t):t instanceof Cl?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uA(e){if(e.limitType==="L"&&e.explicitOrderBy.length===0)throw new B(b.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class hA{convertValue(t,n="none"){switch(Kn(t)){case 0:return null;case 1:return t.booleanValue;case 2:return St(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,n);case 5:return t.stringValue;case 6:return this.convertBytes(Hn(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,n);case 10:return this.convertObject(t.mapValue,n);default:throw H()}}convertObject(t,n){return this.convertObjectMap(t.fields,n)}convertObjectMap(t,n="none"){const r={};return Nr(t,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertGeoPoint(t){return new Pl(St(t.latitude),St(t.longitude))}convertArray(t,n){return(t.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(t,n){switch(n){case"previous":const r=ll(t);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(ws(t));default:return null}}convertTimestamp(t){const n=yn(t);return new Dt(n.seconds,n.nanos)}convertDocumentKey(t,n){const r=Et.fromString(t);gt(jp(r));const s=new Is(r.get(1),r.get(3)),i=new j(r.popFirst(5));return s.isEqual(n)||$e(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fA(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci{constructor(t,n){this.hasPendingWrites=t,this.fromCache=n}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class dA extends vm{constructor(t,n,r,s,i,o){super(t,n,r,s,o),this._firestore=t,this._firestoreImpl=t,this.metadata=i}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const n=new mi(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,n={}){if(this._document){const r=this._document.data.field(Em("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class mi extends dA{data(t={}){return super.data(t)}}class pA{constructor(t,n,r,s){this._firestore=t,this._userDataWriter=n,this._snapshot=s,this.metadata=new ci(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const t=[];return this.forEach(n=>t.push(n)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,n){this._snapshot.docs.forEach(r=>{t.call(n,new mi(this._firestore,this._userDataWriter,r.key,r,new ci(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const n=!!t.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new B(b.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const c=new mi(s._firestore,s._userDataWriter,a.doc.key,a.doc,new ci(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const c=new mi(s._firestore,s._userDataWriter,a.doc.key,a.doc,new ci(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let l=-1,u=-1;return a.type!==0&&(l=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:mA(a.type),doc:c,oldIndex:l,newIndex:u}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function mA(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return H()}}class gA extends hA{constructor(t){super(),this.firestore=t}convertBytes(t){return new Rr(t)}convertReference(t){const n=this.convertDocumentKey(t,this.firestore._databaseId);return new be(this.firestore,null,n)}}function _A(e){e=$i(e,Lo);const t=$i(e.firestore,Sl),n=um(t),r=new gA(t);return uA(e._query),QI(n,e._query).then(s=>new pA(t,r,e,s))}function yA(e,t){const n=$i(e.firestore,Sl),r=JI(e),s=fA(e.converter,t);return vA(n,[iA(sA(e.firestore),"addDoc",r._key,s,e.converter!==null,{}).toMutation(r._key,Qe.exists(!1))]).then(()=>r)}function vA(e,t){return function(r,s){const i=new Ge;return r.asyncQueue.enqueueAndForget(async()=>kI(await WI(r),s,i)),i.promise}(um(e),t)}(function(t,n=!0){(function(s){kr=s})(WE),Si(new hs("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new Sl(new fw(r.getProvider("auth-internal")),new gw(r.getProvider("app-check-internal")),function(l,u){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new B(b.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Is(l.options.projectId,u)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),dr(Hu,"4.4.3",t),dr(Hu,"4.4.3","esm2017")})();const Se=e=>(Tg("data-v-374f591c"),e=e(),wg(),e),EA={class:"card-creator"},TA={class:"card-creator__wrapper"},wA={class:"card-creator__editor"},IA=Se(()=>M("h1",{class:"card-creator-type-card__title"},"Тип",-1)),AA={class:"card-creator__type-card card-creator-type-card"},bA={class:"card-creator__type"},RA=Se(()=>M("h2",{class:"card-creator-type-card__title"},"Тип создаваемой карты:",-1)),SA={class:"card-creator__act"},CA=Se(()=>M("h2",{class:"card-creator-type-card__title"},"Для какого акта:",-1)),PA={class:"card-creator__name-card"},VA=Se(()=>M("h2",{class:"card-creator-type-card__title"},"Название",-1)),DA=Se(()=>M("h1",{class:"card-creator-type-card__title"},"Верхний путь",-1)),xA={class:"card-creator__texts"},kA={class:"card-creator__name-card"},NA=Se(()=>M("h2",{class:"card-creator-type-card__title"},"Название и доп сложность",-1)),OA={class:"card-creator__path-row"},MA=["checked"],LA={class:"card-creator__name-card"},FA=Se(()=>M("h2",{class:"card-creator-type-card__title"},"Награды",-1)),UA={class:"card-creator__rewards card-creator__rewards--top"},BA=Se(()=>M("h1",{class:"card-creator-type-card__title"},"Нижний путь",-1)),$A={class:"card-creator__texts"},jA={class:"card-creator__name-card"},zA=Se(()=>M("h2",{class:"card-creator-type-card__title"},"Нижний путь",-1)),qA={class:"card-creator__path-row"},HA=["checked"],KA={class:"card-creator__name-card"},WA=Se(()=>M("h2",{class:"card-creator-type-card__title"},"Награды",-1)),GA={class:"card-creator__rewards card-creator__rewards--top"},QA={class:"card-creator__difficulty card-creator-difficulty"},XA=Se(()=>M("h1",{class:"card-creator-type-card__title"},"Сложность и руны",-1)),YA={class:"card-creator-difficulty__runes"},JA={class:"card-creator__preview"},ZA={class:"card-creator__zoom"},tb=Je({__name:"CardCreator",emits:["openBook"],setup(e){const t=Un("client"),n=Un("db"),r=ft({type:0,act:0,name:"",topPath:{name:"",extraDifficulty:0,rewards:[],isDark:!1},botPath:{name:"",extraDifficulty:0,rewards:[],isDark:!1},difficulty:{value:0,runes:[]},imageUrl:null,imageBlob:null,imageId:null});Fn(r,()=>console.log("CARD: ",tt(r)),{immediate:!0,deep:!0});const s=ft(6),i=S=>{+S==6&&(r.value.type=+S)};ft(0);const o=S=>r.value.act=+S,a=kt(()=>s.value!==null?Ii[s.value]:null);kt(()=>tt(s)===0),kt(()=>tt(s)===0),kt(()=>tt(s)===0),kt(()=>tt(s)===0),kt(()=>tt(s)===0),kt(()=>tt(s)===0),kt(()=>tt(s)===0),kt(()=>tt(s)===0),kt(()=>tt(s)===0),kt(()=>tt(s)===0);const c=ft(""),l=ft(null);ft(""),ft(""),ft(""),ft([]);const u=S=>{r.value.difficulty.runes.includes(+S)?r.value.difficulty.runes=r.value.difficulty.runes.filter(D=>D!==+S):r.value.difficulty.runes.push(+S)},h=ft([]),f=ft([]);Fn([h,f],()=>console.log(tt(h),tt(f)),{immediate:!0,deep:!0});const m=S=>{r.value.topPath.rewards.find(D=>D.id==S)?r.value.topPath.rewards=[...tt(r).topPath.rewards.filter(D=>D.id!==S)]:r.value.topPath.rewards.push({id:S,count:null})},R=S=>{console.log(tt(h)),r.value.botPath.rewards.find(D=>D.id==S)?r.value.botPath.rewards=[...tt(r).botPath.rewards.filter(D=>D.id!==S)]:r.value.botPath.rewards.push({id:S,count:null})},T=S=>{switch(S){case"top":r.value.topPath.isDark=!r.value.topPath.isDark;break;case"bot":r.value.botPath.isDark=!r.value.botPath.isDark;break;default:return}};ft(0),ft(0),ft(0);const w=ft(100),L=S=>{S.deltaY===-100?w.value<150&&(w.value+=5):w.value>100&&(w.value-=5)},v=()=>{c.value="",l.value=null},y=S=>{r.value.imageUrl=S.previewUrl,r.value.imageBlob=S.imageContainer},_=async()=>{try{console.log("uploading...");const S=await t.uploadFile(tt(r).imageBlob);r.value.imageId=S.uuid}catch(S){console.log(S)}},q=async()=>{await _();try{const S=await yA(lm(n,"cards"),JSON.parse(JSON.stringify(tt(r))))}catch(S){console.error("Error adding document: ",S)}};return Fn(a,()=>console.log(a)),(S,D)=>(X(),ht("div",EA,[M("div",TA,[M("div",wA,[M("div",null,[IA,M("div",AA,[M("div",bA,[RA,ne(_u,{items:tt(Ii),selected:r.value.type,onSelect:i},null,8,["items","selected"])]),M("div",SA,[CA,ne(_u,{items:tt(Cc),selected:r.value.act,onSelect:o},null,8,["items","selected"])]),M("div",PA,[VA,ne(ea,{min:"0",max:"30",text:r.value.name,"onUpdate:text":D[0]||(D[0]=U=>r.value.name=U)},null,8,["text"])])])]),M("div",null,[DA,M("div",xA,[M("div",kA,[NA,M("div",OA,[ne(ea,{min:"0",max:"30",text:r.value.topPath.name,"onUpdate:text":D[1]||(D[1]=U=>r.value.topPath.name=U)},null,8,["text"]),or(M("input",{text:"number",type:"number",class:"card-creator-difficulty__points",min:"0",max:"5","onUpdate:modelValue":D[2]||(D[2]=U=>r.value.topPath.extraDifficulty=U)},null,512),[[Zs,r.value.topPath.extraDifficulty]]),M("input",{type:"checkbox",class:"card-creator__checkbox",checked:r.value.topPath.isDark,onChange:D[3]||(D[3]=U=>T("top"))},null,40,MA)])]),M("div",LA,[FA,M("div",UA,[(X(!0),ht(Pt,null,fn(tt(xe),(U,nt)=>(X(),ye(na,{items:tt(xe),id:nt,allowedCount:!!U.count&&r.value.topPath.rewards.find(et=>et===+nt),checked:r.value.topPath.rewards.find(et=>et==nt),onToggle:et=>m(nt)},null,8,["items","id","allowedCount","checked","onToggle"]))),256))])])])]),M("div",null,[BA,M("div",$A,[M("div",jA,[zA,M("div",qA,[ne(ea,{text:r.value.botPath.name,"onUpdate:text":D[4]||(D[4]=U=>r.value.botPath.name=U),min:"0",max:"30"},null,8,["text"]),or(M("input",{type:"number",class:"card-creator-difficulty__points",min:"0",max:"5","onUpdate:modelValue":D[5]||(D[5]=U=>r.value.botPath.extraDifficulty=U)},null,512),[[Zs,r.value.botPath.extraDifficulty]]),M("input",{type:"checkbox",class:"card-creator__checkbox",checked:r.value.botPath.isDark,onChange:D[6]||(D[6]=U=>T("bot"))},null,40,HA)])]),M("div",KA,[WA,M("div",GA,[(X(!0),ht(Pt,null,fn(tt(xe),(U,nt)=>(X(),ye(na,{items:tt(xe),id:nt,allowedCount:!!U.count&&r.value.botPath.rewards.find(et=>et===+nt),checked:r.value.botPath.rewards.find(et=>et==nt),onToggle:et=>R(nt)},null,8,["items","id","allowedCount","checked","onToggle"]))),256))])])])]),M("div",QA,[XA,M("div",YA,[or(M("input",{type:"number",class:"card-creator-difficulty__points card-creator-difficulty__points--mr","onUpdate:modelValue":D[7]||(D[7]=U=>r.value.difficulty.value=U),min:"0",minlength:"0",max:"20",maxlength:"20"},null,512),[[Zs,r.value.difficulty.value]]),(X(!0),ht(Pt,null,fn(tt(ka),(U,nt)=>(X(),ye(na,{id:nt,items:tt(ka),checked:r.value.difficulty.runes.includes(+nt),onToggle:et=>u(+nt),disabled:!r.value.difficulty.runes.includes(+nt)&&r.value.difficulty.runes.length===2},null,8,["id","items","checked","onToggle","disabled"]))),256))])])]),M("div",JA,[a.value?(X(),ye(Kf,{key:0,class:"card-creator__preview-card",width:a.value.cardSize.width,height:a.value.cardSize.height,backImg:a.value.backImg,act:r.value.act,frontImg:r.value.imageUrl,onOnImageParse:y,topPath:r.value.topPath.name,botPath:r.value.botPath.name,difficulty:r.value.difficulty.value,cardName:r.value.name,challengeRunes:r.value.difficulty.runes,zoom:w.value,topPathExtraDif:r.value.topPath.extraDifficulty,botPathExtraDif:r.value.botPath.extraDifficulty,topRewards:r.value.topPath.rewards,botRewards:r.value.botPath.rewards,card:r.value,onWheel:L},null,8,["width","height","backImg","act","frontImg","topPath","botPath","difficulty","cardName","challengeRunes","zoom","topPathExtraDif","botPathExtraDif","topRewards","botRewards","card"])):le("",!0),c.value?(X(),ht("button",{key:1,class:"card-creator__clear-image",onClick:v}," Изменить ")):le("",!0),M("div",ZA,[or(M("input",{type:"range",name:"zoom",id:"zoom",min:"100",max:"150",step:"5","onUpdate:modelValue":D[8]||(D[8]=U=>w.value=U),onWheel:L},null,544),[[Zs,w.value]])]),M("button",{class:"card-creator__apply",onClick:q}," Создать "),M("button",{class:"card-creator__book-open",onClick:D[9]||(D[9]=U=>S.$emit("openBook"))}," Открыть книгу карт ")])])]))}}),eb=tn(tb,[["__scopeId","data-v-374f591c"]]);var nb="firebase",rb="10.8.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */dr(nb,rb,"app");const sb={apiKey:"AIzaSyBoyp3aAQvqSUc0XCWouNfoOiVXeLrhQOk",authDomain:"cards-adventure.firebaseapp.com",projectId:"cards-adventure",storageBucket:"cards-adventure.appspot.com",messagingSenderId:"1039014346368",appId:"1:1039014346368:web:1773de44f0ee2f1618f065"},ib={class:"book"},ob={key:0,class:"book__container"},ab={key:1},cb=Je({__name:"Book",emits:["close"],setup(e,{emit:t}){const n=t,r=Un("db"),s=ft([]),i=()=>n("close");return Ac(async()=>{try{const o=await _A(lm(r,"cards"));s.value=o.docs.map(a=>a.data()),console.log(s)}catch(o){console.log(o)}}),(o,a)=>{const c=rf("outclick");return or((X(),ht("div",ib,[s.value.length?(X(),ht("div",ob,[(X(!0),ht(Pt,null,fn(s.value,l=>(X(),ye(Kf,{class:"book__card",book:!0,"top-path-extra-dif":l.topPath.extraDifficulty,"card-name":l.name,"top-rewards":l.topPath.rewards,zoom:100,"challenge-runes":l.difficulty.runes,difficulty:l.difficulty.value,"back-img":tt(Cc)[l.act].backImage,act:l.act,"front-img":l.imageId,"top-path":l.topPath.name,"bot-path-extra-dif":l.botPath.extraDifficulty,width:tt(Ii)[l.type].cardSize.width,height:tt(Ii)[l.type].cardSize.height,"bot-path":l.botPath.name,"bot-rewards":l.botPath.rewards,card:l},null,8,["top-path-extra-dif","card-name","top-rewards","challenge-runes","difficulty","back-img","act","front-img","top-path","bot-path-extra-dif","width","height","bot-path","bot-rewards","card"]))),256))])):(X(),ht("h1",ab,"Loading..."))])),[[c,i]])}}}),lb=tn(cb,[["__scopeId","data-v-09443ea5"]]),ub={},hb={class:"version"};function fb(e,t){return X(),ht("span",hb," v 0.1 (26.03.24) ")}const db=tn(ub,[["render",fb],["__scopeId","data-v-535e47e0"]]),pb=Je({__name:"App",setup(e){const t=ed(sb),n=tA(t),r=new Hf({publicKey:"10a6fd7ad4acb396dfe1"}),s=ft(!1),i=()=>s.value=!tt(s);return Sa("client",r),Sa("db",n),(o,a)=>(X(),ht(Pt,null,[(X(),ye(Lg,null,[s.value?le("",!0):(X(),ye(eb,{key:0,onOpenBook:i}))],1024)),s.value?(X(),ye(lb,{key:0,onClose:i})):le("",!0),ne(db)],64))}}),mb=tn(pb,[["__scopeId","data-v-d34413fe"]]);class gb{static install(t){let n=()=>{};t.directive("outclick",{mounted(r,s){const{value:i}=s;n=o=>{o.composedPath().includes(r)||i()},window.addEventListener("click",n,{capture:!0})},unmounted(){window.removeEventListener("click",n,{capture:!0})}}),t.directive("autoheight",{mounted(r){if(!r)return;const s=document.createElement("p"),i=getComputedStyle(r);s.style.fontSize=i.fontSize,s.style.fontWeight=i.fontWeight,s.style.lineHeight=i.lineHeight,s.style.fontFamily=i.fontFamily,s.style.fontStyle=i.fontStyle,s.style.fontStretch=i.fontStretch,s.style.margin=i.margin,s.style.padding=i.padding,s.style.border=i.border,s.style.outline=i.outline,document.body.append(s);let o=0;const a=c=>{s.innerText=c.target.value;const l=c.target.value.length;let u;c.inputType==="insertLineBreak"||o>l?u=r.scrollHeight:(u=s.offsetHeight,console.log(u)),r.style.height=`${u>42?u:42}px`,o=l};r.addEventListener("input",a)}}),t.directive("focus",{mounted(r){r.focus()},beforeUnmount(){}})}}const Tm=J_(mb);Tm.use(ry()).use(gb);Tm.mount("#app");
